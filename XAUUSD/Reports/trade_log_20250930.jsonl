{"stage": "status_update", "t": "2025-09-30 12:17:22", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:17:22", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:17:22", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:17:22", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:17:22", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:17:22", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:17:23", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:17:23", "message": "Đã lưu thành công file: ctx_20250930_121723.json"}
{"stage": "run-end", "t": "2025-09-30 12:17:23"}
{"stage": "status_update", "t": "2025-09-30 12:17:23", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:17:23", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:17:28", "message": "Xem JSON: ctx_20250930_121723.json"}
{"stage": "status_update", "t": "2025-09-30 12:17:30", "message": "Xem: report_20250930_121723.md"}
{"stage": "status_update", "t": "2025-09-30 12:17:31", "message": "Xem: report_20250923_083648.md"}
{"stage": "status_update", "t": "2025-09-30 12:17:32", "message": "Xem JSON: ctx_20250923_083648.json"}
{"stage": "status_update", "t": "2025-09-30 12:17:37", "message": "Xem JSON: ctx_20250923_083142.json"}
{"stage": "status_update", "t": "2025-09-30 12:17:38", "message": "Xem JSON: ctx_20250923_083009.json"}
{"stage": "status_update", "t": "2025-09-30 12:17:39", "message": "Xem JSON: ctx_20250923_082552.json"}
{"stage": "status_update", "t": "2025-09-30 12:17:40", "message": "Xem JSON: ctx_20250923_082418.json"}
{"stage": "status_update", "t": "2025-09-30 12:17:41", "message": "Xem JSON: ctx_20250923_081824.json"}
{"stage": "status_update", "t": "2025-09-30 12:17:41", "message": "Xem JSON: ctx_20250923_081625.json"}
{"stage": "status_update", "t": "2025-09-30 12:17:43", "message": "Xem: report_20250923_083009.md"}
{"stage": "status_update", "t": "2025-09-30 12:17:44", "message": "Xem: report_20250923_083142.md"}
{"stage": "status_update", "t": "2025-09-30 12:17:53", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:17:53", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:17:53", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:17:53", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:17:53", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:17:53", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:17:53", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:17:53", "message": "Đã lưu thành công file: ctx_20250930_121753.json"}
{"stage": "run-end", "t": "2025-09-30 12:17:53"}
{"stage": "status_update", "t": "2025-09-30 12:17:53", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:17:53", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:18:23", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:18:23", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:18:23", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:18:23", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:18:23", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:18:23", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:18:23", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:18:23", "message": "Đã lưu thành công file: ctx_20250930_121823.json"}
{"stage": "run-end", "t": "2025-09-30 12:18:23"}
{"stage": "status_update", "t": "2025-09-30 12:18:23", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:18:23", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:18:53", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:18:53", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:18:53", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:18:53", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:18:53", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:18:53", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:18:53", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:18:53", "message": "Đã lưu thành công file: ctx_20250930_121853.json"}
{"stage": "run-end", "t": "2025-09-30 12:18:53"}
{"stage": "status_update", "t": "2025-09-30 12:18:53", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:18:53", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:19:23", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:19:23", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:19:23", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:19:23", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:19:23", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:19:23", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:19:23", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:19:23", "message": "Đã lưu thành công file: ctx_20250930_121923.json"}
{"stage": "run-end", "t": "2025-09-30 12:19:23"}
{"stage": "status_update", "t": "2025-09-30 12:19:23", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:19:23", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:19:53", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:19:53", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:19:53", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:19:53", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:19:53", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:19:53", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:19:53", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:19:53", "message": "Đã lưu thành công file: ctx_20250930_121953.json"}
{"stage": "run-end", "t": "2025-09-30 12:19:53"}
{"stage": "status_update", "t": "2025-09-30 12:19:53", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:19:53", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:20:23", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:20:23", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:20:23", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:20:23", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:20:23", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:20:23", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:20:23", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:20:23", "message": "Đã lưu thành công file: ctx_20250930_122023.json"}
{"stage": "run-end", "t": "2025-09-30 12:20:23"}
{"stage": "status_update", "t": "2025-09-30 12:20:23", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:20:23", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:20:53", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:20:53", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:20:53", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:20:53", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "no-run-skip", "t": "2025-09-30 12:20:54", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:20:54", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:20:54", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:20:54", "message": "Đã lưu thành công file: ctx_20250930_122054.json"}
{"stage": "run-end", "t": "2025-09-30 12:20:54"}
{"stage": "status_update", "t": "2025-09-30 12:20:54", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:20:54", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:21:24", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:21:24", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:21:24", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:21:24", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:21:24", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:21:24", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:21:24", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:21:24", "message": "Đã lưu thành công file: ctx_20250930_122124.json"}
{"stage": "run-end", "t": "2025-09-30 12:21:24"}
{"stage": "status_update", "t": "2025-09-30 12:21:24", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:21:24", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:21:54", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:21:54", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:21:54", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:21:54", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:21:54", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:21:54", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:21:54", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:21:54", "message": "Đã lưu thành công file: ctx_20250930_122154.json"}
{"stage": "run-end", "t": "2025-09-30 12:21:54"}
{"stage": "status_update", "t": "2025-09-30 12:21:54", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:21:54", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:22:24", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:22:24", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:22:24", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:22:24", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:22:24", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:22:24", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:22:24", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:22:24", "message": "Đã lưu thành công file: ctx_20250930_122224.json"}
{"stage": "run-end", "t": "2025-09-30 12:22:24"}
{"stage": "status_update", "t": "2025-09-30 12:22:24", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:22:24", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:22:54", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:22:54", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:22:54", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:22:54", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:22:54", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:22:54", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:22:54", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:22:54", "message": "Đã lưu thành công file: ctx_20250930_122254.json"}
{"stage": "run-end", "t": "2025-09-30 12:22:54"}
{"stage": "status_update", "t": "2025-09-30 12:22:54", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:22:54", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:23:24", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:23:24", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:23:24", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:23:24", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:23:24", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:23:24", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:23:24", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:23:24", "message": "Đã lưu thành công file: ctx_20250930_122324.json"}
{"stage": "run-end", "t": "2025-09-30 12:23:24"}
{"stage": "status_update", "t": "2025-09-30 12:23:24", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:23:24", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:23:54", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:23:54", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:23:54", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:23:54", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:23:55", "message": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "no-run-skip", "t": "2025-09-30 12:23:55", "reason": "Bỏ qua vì ngoài giờ Kill Zone"}
{"stage": "status_update", "t": "2025-09-30 12:23:55", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:23:55", "message": "Đã lưu thành công file: ctx_20250930_122355.json"}
{"stage": "run-end", "t": "2025-09-30 12:23:55"}
{"stage": "status_update", "t": "2025-09-30 12:23:55", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:23:55", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:24:25", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:24:25", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:24:25", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:24:25", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:24:32", "message": "Upload xong 4 ảnh trong 6.86s"}
{"stage": "run-start", "t": "2025-09-30 12:24:32", "cycle": "2025-09-30 12:24:32", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": null, "recent_history_summary": null, "run_meta": {"analysis_id": "2025-09-30T05:24:32Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:24:32", "message": "Context+MT5 xong trong 0.14s"}
{"stage": "status_update", "t": "2025-09-30 12:24:32", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:24:32", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:25:15", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:25:15", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:25:15", "message": "Đã lưu thành công file: ctx_20250930_122515.json"}
{"stage": "run-end", "t": "2025-09-30 12:25:15"}
{"stage": "status_update", "t": "2025-09-30 12:25:15", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:25:15", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:25:45", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:25:45", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:25:45", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:25:45", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:25:52", "message": "Upload xong 4 ảnh trong 6.83s"}
{"stage": "run-start", "t": "2025-09-30 12:25:52", "cycle": "2025-09-30 12:25:52", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:25:15) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:25:52Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:25:52", "message": "Context+MT5 xong trong 0.03s"}
{"stage": "status_update", "t": "2025-09-30 12:25:52", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:25:52", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:26:34", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:26:34", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:26:34", "message": "Đã lưu thành công file: ctx_20250930_122634.json"}
{"stage": "run-end", "t": "2025-09-30 12:26:34"}
{"stage": "status_update", "t": "2025-09-30 12:26:34", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:26:34", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:27:04", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:27:04", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:27:04", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:27:04", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:28:07", "message": "Lỗi nghiêm trọng trong worker: The read operation timed out"}
{"stage": "status_update", "t": "2025-09-30 12:28:07", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:28:07", "message": "Đã lưu thành công file: ctx_20250930_122807.json"}
{"stage": "run-end", "t": "2025-09-30 12:28:07"}
{"stage": "status_update", "t": "2025-09-30 12:28:07", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:28:07", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:28:37", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:28:37", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:28:37", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:28:37", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:28:45", "message": "Upload xong 4 ảnh trong 7.23s"}
{"stage": "run-start", "t": "2025-09-30 12:28:45", "cycle": "2025-09-30 12:28:45", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: The read operation timed out", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:28:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:26:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:25:15) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:28:45Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:28:45", "message": "Context+MT5 xong trong 0.05s"}
{"stage": "status_update", "t": "2025-09-30 12:28:45", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:28:45", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:29:26", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:29:26", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:29:26", "message": "Đã lưu thành công file: ctx_20250930_122926.json"}
{"stage": "run-end", "t": "2025-09-30 12:29:26"}
{"stage": "status_update", "t": "2025-09-30 12:29:26", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:29:26", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:29:56", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:29:56", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:29:56", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:29:56", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:30:11", "message": "Upload xong 4 ảnh trong 15.21s"}
{"stage": "run-start", "t": "2025-09-30 12:30:11", "cycle": "2025-09-30 12:30:11", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:29:26) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:28:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:26:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:30:11Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:30:11", "message": "Context+MT5 xong trong 0.03s"}
{"stage": "status_update", "t": "2025-09-30 12:30:11", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:30:11", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:30:53", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:30:53", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:30:53", "message": "Đã lưu thành công file: ctx_20250930_123053.json"}
{"stage": "run-end", "t": "2025-09-30 12:30:53"}
{"stage": "status_update", "t": "2025-09-30 12:30:53", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:30:53", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:31:23", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:31:23", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:31:23", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:31:23", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:32:44", "message": "Lỗi nghiêm trọng trong worker: The read operation timed out"}
{"stage": "status_update", "t": "2025-09-30 12:32:44", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:32:44", "message": "Đã lưu thành công file: ctx_20250930_123244.json"}
{"stage": "run-end", "t": "2025-09-30 12:32:45"}
{"stage": "status_update", "t": "2025-09-30 12:32:45", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:32:45", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:33:15", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:33:15", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:33:15", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:33:15", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:33:29", "message": "Upload xong 4 ảnh trong 14.30s"}
{"stage": "run-start", "t": "2025-09-30 12:33:29", "cycle": "2025-09-30 12:33:29", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: The read operation timed out", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:32:44) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:30:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:29:26) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:33:29Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:33:29", "message": "Context+MT5 xong trong 0.04s"}
{"stage": "status_update", "t": "2025-09-30 12:33:29", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:33:29", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:34:09", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:34:09", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:34:09", "message": "Đã lưu thành công file: ctx_20250930_123409.json"}
{"stage": "run-end", "t": "2025-09-30 12:34:09"}
{"stage": "status_update", "t": "2025-09-30 12:34:09", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:34:09", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:34:39", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:34:39", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:34:39", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:34:39", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:35:07", "message": "Upload xong 4 ảnh trong 27.79s"}
{"stage": "run-start", "t": "2025-09-30 12:35:07", "cycle": "2025-09-30 12:35:07", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:34:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:32:44) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:30:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:35:07Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:35:07", "message": "Context+MT5 xong trong 0.04s"}
{"stage": "status_update", "t": "2025-09-30 12:35:07", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:35:07", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:35:59", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:35:59", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:35:59", "message": "Đã lưu thành công file: ctx_20250930_123559.json"}
{"stage": "run-end", "t": "2025-09-30 12:35:59"}
{"stage": "status_update", "t": "2025-09-30 12:35:59", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:35:59", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:36:29", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:36:29", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:36:29", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:36:29", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:36:38", "message": "Upload xong 4 ảnh trong 8.88s"}
{"stage": "run-start", "t": "2025-09-30 12:36:38", "cycle": "2025-09-30 12:36:38", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:35:59) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:34:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:32:44) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:36:38Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:36:38", "message": "Context+MT5 xong trong 0.04s"}
{"stage": "status_update", "t": "2025-09-30 12:36:38", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:36:38", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:37:17", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:37:17", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:37:17", "message": "Đã lưu thành công file: ctx_20250930_123717.json"}
{"stage": "run-end", "t": "2025-09-30 12:37:17"}
{"stage": "status_update", "t": "2025-09-30 12:37:17", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:37:17", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:37:47", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:37:47", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:37:47", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:37:47", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:39:10", "message": "Lỗi nghiêm trọng trong worker: The read operation timed out"}
{"stage": "status_update", "t": "2025-09-30 12:39:10", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:39:10", "message": "Đã lưu thành công file: ctx_20250930_123910.json"}
{"stage": "run-end", "t": "2025-09-30 12:39:10"}
{"stage": "status_update", "t": "2025-09-30 12:39:10", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:39:10", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:39:40", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:39:40", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:39:40", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:39:40", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:39:52", "message": "Upload xong 4 ảnh trong 11.85s"}
{"stage": "run-start", "t": "2025-09-30 12:39:52", "cycle": "2025-09-30 12:39:52", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: The read operation timed out", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:39:10) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:37:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:35:59) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:39:52Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:39:52", "message": "Context+MT5 xong trong 0.03s"}
{"stage": "status_update", "t": "2025-09-30 12:39:52", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:39:52", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:40:33", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:40:33", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:40:33", "message": "Đã lưu thành công file: ctx_20250930_124033.json"}
{"stage": "run-end", "t": "2025-09-30 12:40:33"}
{"stage": "status_update", "t": "2025-09-30 12:40:33", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:40:33", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:41:03", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:41:03", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:41:03", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:41:03", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:41:11", "message": "Upload xong 4 ảnh trong 8.11s"}
{"stage": "run-start", "t": "2025-09-30 12:41:12", "cycle": "2025-09-30 12:41:12", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:40:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:39:10) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:37:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:41:12Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:41:12", "message": "Context+MT5 xong trong 0.02s"}
{"stage": "status_update", "t": "2025-09-30 12:41:12", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:41:12", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:42:02", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:42:02", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:42:02", "message": "Đã lưu thành công file: ctx_20250930_124202.json"}
{"stage": "run-end", "t": "2025-09-30 12:42:02"}
{"stage": "status_update", "t": "2025-09-30 12:42:02", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:42:02", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:42:32", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:42:32", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:42:32", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:42:32", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:42:37", "message": "Upload xong 4 ảnh trong 5.17s"}
{"stage": "run-start", "t": "2025-09-30 12:42:37", "cycle": "2025-09-30 12:42:37", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:42:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:40:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:39:10) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:42:37Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:42:37", "message": "Context+MT5 xong trong 0.03s"}
{"stage": "status_update", "t": "2025-09-30 12:42:37", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:42:37", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:43:19", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:43:19", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:43:19", "message": "Đã lưu thành công file: ctx_20250930_124319.json"}
{"stage": "run-end", "t": "2025-09-30 12:43:20"}
{"stage": "status_update", "t": "2025-09-30 12:43:20", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:43:20", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:43:50", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:43:50", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:43:50", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:43:50", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:43:57", "message": "Upload xong 4 ảnh trong 7.85s"}
{"stage": "run-start", "t": "2025-09-30 12:43:58", "cycle": "2025-09-30 12:43:58", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:43:19) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:42:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:40:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:43:58Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:43:58", "message": "Context+MT5 xong trong 0.03s"}
{"stage": "status_update", "t": "2025-09-30 12:43:58", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:43:58", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:44:41", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:44:41", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:44:41", "message": "Đã lưu thành công file: ctx_20250930_124441.json"}
{"stage": "run-end", "t": "2025-09-30 12:44:41"}
{"stage": "status_update", "t": "2025-09-30 12:44:41", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:44:41", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:45:11", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:45:11", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:45:11", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:45:11", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:46:02", "message": "Upload xong 4 ảnh trong 50.88s"}
{"stage": "run-start", "t": "2025-09-30 12:46:02", "cycle": "2025-09-30 12:46:02", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:44:41) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:43:19) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:42:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:46:02Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:46:02", "message": "Context+MT5 xong trong 0.02s"}
{"stage": "status_update", "t": "2025-09-30 12:46:02", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:46:02", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:46:40", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:46:40", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:46:40", "message": "Đã lưu thành công file: ctx_20250930_124640.json"}
{"stage": "run-end", "t": "2025-09-30 12:46:40"}
{"stage": "status_update", "t": "2025-09-30 12:46:40", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:46:40", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:47:10", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:47:10", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:47:10", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:47:10", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:47:39", "message": "Upload xong 4 ảnh trong 28.87s"}
{"stage": "run-start", "t": "2025-09-30 12:47:39", "cycle": "2025-09-30 12:47:39", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:46:40) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:44:41) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:43:19) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:47:39Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:47:39", "message": "Context+MT5 xong trong 0.03s"}
{"stage": "status_update", "t": "2025-09-30 12:47:39", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:47:39", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:48:20", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:48:20", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:48:20", "message": "Đã lưu thành công file: ctx_20250930_124820.json"}
{"stage": "run-end", "t": "2025-09-30 12:48:20"}
{"stage": "status_update", "t": "2025-09-30 12:48:20", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:48:20", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:48:50", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:48:50", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:48:50", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:48:50", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:48:56", "message": "Upload xong 4 ảnh trong 5.78s"}
{"stage": "run-start", "t": "2025-09-30 12:48:56", "cycle": "2025-09-30 12:48:56", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:48:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:46:40) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:44:41) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:48:56Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:48:56", "message": "Context+MT5 xong trong 0.04s"}
{"stage": "status_update", "t": "2025-09-30 12:48:56", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:48:56", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:49:37", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:49:37", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:49:37", "message": "Đã lưu thành công file: ctx_20250930_124937.json"}
{"stage": "run-end", "t": "2025-09-30 12:49:37"}
{"stage": "status_update", "t": "2025-09-30 12:49:37", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:49:37", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:50:07", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:50:07", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:50:07", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:50:07", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:50:28", "message": "Lỗi nghiêm trọng trong worker: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond"}
{"stage": "status_update", "t": "2025-09-30 12:50:28", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:50:28", "message": "Đã lưu thành công file: ctx_20250930_125028.json"}
{"stage": "run-end", "t": "2025-09-30 12:50:28"}
{"stage": "status_update", "t": "2025-09-30 12:50:28", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:50:28", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:50:58", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:50:58", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:50:58", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:50:58", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:51:19", "message": "Upload xong 4 ảnh trong 20.85s"}
{"stage": "run-start", "t": "2025-09-30 12:51:19", "cycle": "2025-09-30 12:51:19", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:50:28) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:49:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:48:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:51:19Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:51:19", "message": "Context+MT5 xong trong 0.04s"}
{"stage": "status_update", "t": "2025-09-30 12:51:19", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:51:19", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:52:23", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:52:23", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:52:23", "message": "Đã lưu thành công file: ctx_20250930_125223.json"}
{"stage": "run-end", "t": "2025-09-30 12:52:23"}
{"stage": "status_update", "t": "2025-09-30 12:52:23", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:52:23", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:52:53", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:52:53", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:52:53", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:52:53", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:52:56", "message": "Xem: report_20250930_125223.md"}
{"stage": "status_update", "t": "2025-09-30 12:52:58", "message": "Upload xong 4 ảnh trong 4.73s"}
{"stage": "run-start", "t": "2025-09-30 12:52:58", "cycle": "2025-09-30 12:52:58", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:52:23) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:50:28) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:49:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:52:58Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": null, "median_ticks_per_min": null}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": null, "mt5": null, "mt5_lite": null, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:52:58", "message": "Context+MT5 xong trong 0.03s"}
{"stage": "status_update", "t": "2025-09-30 12:52:58", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:52:58", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:53:02", "message": "Xem JSON: ctx_20250930_125223.json"}
{"stage": "status_update", "t": "2025-09-30 12:53:46", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:53:46", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:53:46", "message": "Đã lưu thành công file: ctx_20250930_125346.json"}
{"stage": "run-end", "t": "2025-09-30 12:53:46"}
{"stage": "status_update", "t": "2025-09-30 12:53:46", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:53:46", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:54:16", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:54:16", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:54:16", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:54:16", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:54:21", "message": "Upload xong 4 ảnh trong 4.75s"}
{"stage": "run-start", "t": "2025-09-30 12:54:27", "cycle": "2025-09-30 12:54:27", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:53:46) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:52:23) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:50:28) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:54:27Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 164}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 12:54:27", "broker_time": "2025-09-30T05:54:27Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.095, "ask": 3869.132, "last": 0.0, "time": 1759211660}, "tick_stats_5m": {"ticks_per_min": 164, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 209, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3870.101, "low": 3763.997, "eq50": 3817.049, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.101, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.101, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.10400000000027, "day_range_pct_of_adr20": 252.46236703693933, "position_in_day_range": 0.9905187363341598, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.079987174620913, "M1": 1.524791255874034, "M15": 4.929984261197833, "H1": 10.839135243503124}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.5367066438785, "ema200": 3861.579665719298}, "M5": {"ema50": 3859.2052368806335, "ema200": 3839.126010905906}, "M15": {"ema50": 3844.474302948121, "ema200": 3806.4704517338205}, "H1": {"ema50": 3807.2529772056123, "ema200": 3747.206886148982}}}, "vwap": {"day": 3854.2617084624003, "asia": 3844.5093922406336, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 66, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35032.9999999999}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105097.99999999996}, {"name": "EQ50_D", "price": 3817.049, "relation": "BELOW", "distance_pips": 52045.99999999982}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102174.99999999972}], "round_levels": [{"level": "900", "price": 3869.09, "distance_pips": 0.5}, {"level": "925", "price": 3869.093, "distance_pips": 0.25}, {"level": "950", "price": 3869.095, "distance_pips": 0.0}, {"level": "975", "price": 3869.098, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2013037036368803}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 297}, {"price": 3834.062, "bar_index": 291}, {"price": 3833.647, "bar_index": 287}, {"price": 3831.428, "bar_index": 282}, {"price": 3819.936, "bar_index": 277}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 123}, {"price": 3632.264, "bar_index": 134}, {"price": 3633.892, "bar_index": 116}, {"price": 3640.568, "bar_index": 128}, {"price": 3643.331, "bar_index": 139}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 298, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 272, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.101, "range_low": 3627.806, "equilibrium": 3748.9535, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 297}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 295}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 281}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 297}, {"price": 3867.242, "bar_index": 291}, {"price": 3852.113, "bar_index": 284}, {"price": 3850.722, "bar_index": 282}, {"price": 3840.666, "bar_index": 277}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 105}, {"price": 3737.664, "bar_index": 102}, {"price": 3739.268, "bar_index": 120}, {"price": 3741.553, "bar_index": 116}, {"price": 3742.965, "bar_index": 135}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 291, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 287, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.101, "range_low": 3734.526, "equilibrium": 3802.3135, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 290}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 275}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 294}, {"price": 3870.097, "bar_index": 292}, {"price": 3870.062, "bar_index": 289}, {"price": 3869.806, "bar_index": 296}, {"price": 3867.242, "bar_index": 275}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 109}, {"price": 3812.655, "bar_index": 103}, {"price": 3816.725, "bar_index": 125}, {"price": 3818.303, "bar_index": 115}, {"price": 3819.23, "bar_index": 119}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 274, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 272, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3870.101, "range_low": 3809.251, "equilibrium": 3839.6760000000004, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 291}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 275}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 273}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 272}, {"price": 3870.097, "bar_index": 264}, {"price": 3870.062, "bar_index": 249}, {"price": 3869.806, "bar_index": 282}, {"price": 3869.75, "bar_index": 298}], "swing_lows_SSL": [{"price": 3844.705, "bar_index": 101}, {"price": 3845.815, "bar_index": 104}, {"price": 3845.851, "bar_index": 128}, {"price": 3847.279, "bar_index": 107}, {"price": 3847.279, "bar_index": 110}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.839, "bottom": 3868.64, "created_at_bar": 299, "lo": 3868.64, "hi": 3868.839}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.101, "range_low": 3844.705, "equilibrium": 3857.4030000000002, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 298}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 283}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 278}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.095, "spread_points": 37, "atr_m5_pips": 307.9987174620913, "ticks_per_min": 164, "pdh_pdl_distance_pips": {"PDH": 35032.9999999999, "PDL": 105097.99999999996}, "eq50_d_distance_pips": 52045.99999999982, "session_active": null, "mins_to_next_killzone": 66}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:54:28", "message": "Context+MT5 xong trong 6.63s"}
{"stage": "status_update", "t": "2025-09-30 12:54:30", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:54:30", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:55:08", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:55:08", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:55:08", "message": "Đã lưu thành công file: ctx_20250930_125508.json"}
{"stage": "run-end", "t": "2025-09-30 12:55:08"}
{"stage": "status_update", "t": "2025-09-30 12:55:08", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:55:08", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:55:38", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:55:38", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:55:38", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:55:38", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:55:42", "message": "Upload xong 4 ảnh trong 4.16s"}
{"stage": "run-start", "t": "2025-09-30 12:55:43", "cycle": "2025-09-30 12:55:43", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:55:08) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:53:46) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:52:23) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:55:43Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 152}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 12:55:43", "broker_time": "2025-09-30T05:55:43Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.234, "ask": 3869.271, "last": 0.0, "time": 1759211743}, "tick_stats_5m": {"ticks_per_min": 152, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 207, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3870.101, "low": 3763.997, "eq50": 3817.049, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.101, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.101, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.10400000000027, "day_range_pct_of_adr20": 252.46236703693933, "position_in_day_range": 0.9918287717710907, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.901488090758866, "M1": 1.46944902331929, "M15": 4.929984261197833, "H1": 10.839135243503124}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.5999083701317, "ema200": 3861.6105425342475}, "M5": {"ema50": 3859.5951704811605, "ema200": 3839.4417428781676}, "M15": {"ema50": 3844.4784598108663, "ema200": 3806.4715064601883}, "H1": {"ema50": 3807.2571340683576, "ema200": 3747.20794087535}}}, "vwap": {"day": 3854.374749517537, "asia": 3844.6046240947876, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 65, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35172.00000000002}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105237.00000000007}, {"name": "EQ50_D", "price": 3817.049, "relation": "BELOW", "distance_pips": 52184.99999999994}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102313.99999999985}], "round_levels": [{"level": "2300", "price": 3869.23, "distance_pips": 0.4}, {"level": "2325", "price": 3869.233, "distance_pips": 0.15}, {"level": "2350", "price": 3869.235, "distance_pips": 0.1}, {"level": "2375", "price": 3869.238, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2752077155893071}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 297}, {"price": 3834.062, "bar_index": 291}, {"price": 3833.647, "bar_index": 287}, {"price": 3831.428, "bar_index": 282}, {"price": 3819.936, "bar_index": 277}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 123}, {"price": 3632.264, "bar_index": 134}, {"price": 3633.892, "bar_index": 116}, {"price": 3640.568, "bar_index": 128}, {"price": 3643.331, "bar_index": 139}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 298, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 272, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.101, "range_low": 3627.806, "equilibrium": 3748.9535, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 297}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 295}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 281}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 297}, {"price": 3867.242, "bar_index": 291}, {"price": 3852.113, "bar_index": 284}, {"price": 3850.722, "bar_index": 282}, {"price": 3840.666, "bar_index": 277}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 105}, {"price": 3737.664, "bar_index": 102}, {"price": 3739.268, "bar_index": 120}, {"price": 3741.553, "bar_index": 116}, {"price": 3742.965, "bar_index": 135}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 291, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 287, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.101, "range_low": 3734.526, "equilibrium": 3802.3135, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 290}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 275}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 293}, {"price": 3870.097, "bar_index": 291}, {"price": 3870.062, "bar_index": 288}, {"price": 3869.806, "bar_index": 295}, {"price": 3869.75, "bar_index": 298}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 108}, {"price": 3812.655, "bar_index": 102}, {"price": 3816.725, "bar_index": 124}, {"price": 3818.303, "bar_index": 114}, {"price": 3819.23, "bar_index": 118}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 273, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 297, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3870.101, "range_low": 3809.251, "equilibrium": 3839.6760000000004, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 290}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 274}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 272}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 271}, {"price": 3870.097, "bar_index": 263}, {"price": 3870.062, "bar_index": 248}, {"price": 3869.806, "bar_index": 281}, {"price": 3869.75, "bar_index": 297}], "swing_lows_SSL": [{"price": 3845.815, "bar_index": 103}, {"price": 3845.851, "bar_index": 127}, {"price": 3847.279, "bar_index": 106}, {"price": 3847.279, "bar_index": 109}, {"price": 3847.722, "bar_index": 122}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.657, "bottom": 3868.64, "created_at_bar": 298, "lo": 3868.64, "hi": 3868.657}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.101, "range_low": 3844.705, "equilibrium": 3857.4030000000002, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 297}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 282}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 277}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.234, "spread_points": 37, "atr_m5_pips": 290.14880907588656, "ticks_per_min": 152, "pdh_pdl_distance_pips": {"PDH": 35172.00000000002, "PDL": 105237.00000000007}, "eq50_d_distance_pips": 52184.99999999994, "session_active": null, "mins_to_next_killzone": 65}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:55:43", "message": "Context+MT5 xong trong 0.53s"}
{"stage": "status_update", "t": "2025-09-30 12:55:45", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:55:45", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:56:23", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:56:23", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:56:23", "message": "Đã lưu thành công file: ctx_20250930_125623.json"}
{"stage": "run-end", "t": "2025-09-30 12:56:23"}
{"stage": "status_update", "t": "2025-09-30 12:56:23", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:56:23", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:56:53", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:56:53", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:56:53", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:56:53", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:56:57", "message": "Upload xong 4 ảnh trong 4.07s"}
{"stage": "run-start", "t": "2025-09-30 12:56:57", "cycle": "2025-09-30 12:56:57", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:56:23) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:55:08) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:53:46) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:56:57Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 132}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 12:56:57", "broker_time": "2025-09-30T05:56:57Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.574, "ask": 3869.611, "last": 0.0, "time": 1759211792}, "tick_stats_5m": {"ticks_per_min": 132, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 204, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3870.101, "low": 3763.997, "eq50": 3817.049, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.101, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.101, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.10400000000027, "day_range_pct_of_adr20": 252.46236703693933, "position_in_day_range": 0.9950331749981146, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.930059519330301, "M1": 1.405508786937579, "M15": 4.93698426119783, "H1": 10.839135243503124}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.6921050690576, "ema200": 3861.7880863111195}, "M5": {"ema50": 3859.608503814494, "ema200": 3839.445125962745}, "M15": {"ema50": 3844.4917931441996, "ema200": 3806.4748895447656}, "H1": {"ema50": 3807.270467401691, "ema200": 3747.211323959927}}}, "vwap": {"day": 3854.4721520931566, "asia": 3844.716963660489, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 64, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35512.00000000017}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105577.00000000022}, {"name": "EQ50_D", "price": 3817.049, "relation": "BELOW", "distance_pips": 52525.00000000009}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102654.0}], "round_levels": [{"level": "5700", "price": 3869.57, "distance_pips": 0.4}, {"level": "5725", "price": 3869.573, "distance_pips": 0.15}, {"level": "5750", "price": 3869.575, "distance_pips": 0.1}, {"level": "5775", "price": 3869.578, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2627729831325736}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 297}, {"price": 3834.062, "bar_index": 291}, {"price": 3833.647, "bar_index": 287}, {"price": 3831.428, "bar_index": 282}, {"price": 3819.936, "bar_index": 277}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 123}, {"price": 3632.264, "bar_index": 134}, {"price": 3633.892, "bar_index": 116}, {"price": 3640.568, "bar_index": 128}, {"price": 3643.331, "bar_index": 139}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 298, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 272, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.101, "range_low": 3627.806, "equilibrium": 3748.9535, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 297}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 295}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 281}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 297}, {"price": 3867.242, "bar_index": 291}, {"price": 3852.113, "bar_index": 284}, {"price": 3850.722, "bar_index": 282}, {"price": 3840.666, "bar_index": 277}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 105}, {"price": 3737.664, "bar_index": 102}, {"price": 3739.268, "bar_index": 120}, {"price": 3741.553, "bar_index": 116}, {"price": 3742.965, "bar_index": 135}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 291, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 287, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.101, "range_low": 3734.526, "equilibrium": 3802.3135, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 290}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 275}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 293}, {"price": 3870.097, "bar_index": 291}, {"price": 3870.062, "bar_index": 288}, {"price": 3869.806, "bar_index": 295}, {"price": 3867.242, "bar_index": 274}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 108}, {"price": 3812.655, "bar_index": 102}, {"price": 3816.725, "bar_index": 124}, {"price": 3818.303, "bar_index": 114}, {"price": 3819.23, "bar_index": 118}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 273, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 297, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3870.101, "range_low": 3809.251, "equilibrium": 3839.6760000000004, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 290}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 274}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 272}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 270}, {"price": 3870.097, "bar_index": 262}, {"price": 3870.062, "bar_index": 247}, {"price": 3869.806, "bar_index": 280}, {"price": 3869.75, "bar_index": 296}], "swing_lows_SSL": [{"price": 3845.815, "bar_index": 102}, {"price": 3845.851, "bar_index": 126}, {"price": 3847.279, "bar_index": 105}, {"price": 3847.279, "bar_index": 108}, {"price": 3847.722, "bar_index": 121}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.657, "bottom": 3868.64, "created_at_bar": 297, "lo": 3868.64, "hi": 3868.657}], "order_blocks_m1": [{"top": 3869.613, "bottom": 3868.657, "bar_index": 297, "lo": 3868.657, "hi": 3869.613, "type": "bull"}], "premium_discount_m1": {"range_high": 3870.101, "range_low": 3844.892, "equilibrium": 3857.4965, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.626, "bottom": 3868.867, "bar_index": 298}, {"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 296}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 281}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.574, "spread_points": 37, "atr_m5_pips": 293.0059519330301, "ticks_per_min": 132, "pdh_pdl_distance_pips": {"PDH": 35512.00000000017, "PDL": 105577.00000000022}, "eq50_d_distance_pips": 52525.00000000009, "session_active": null, "mins_to_next_killzone": 64}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:56:58", "message": "Context+MT5 xong trong 0.15s"}
{"stage": "status_update", "t": "2025-09-30 12:56:59", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:56:59", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:58:02", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:58:02", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:58:02", "message": "Đã lưu thành công file: ctx_20250930_125802.json"}
{"stage": "run-end", "t": "2025-09-30 12:58:02"}
{"stage": "status_update", "t": "2025-09-30 12:58:02", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:58:02", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:58:32", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:58:32", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:58:32", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:58:32", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:58:37", "message": "Upload xong 4 ảnh trong 4.57s"}
{"stage": "run-start", "t": "2025-09-30 12:58:37", "cycle": "2025-09-30 12:58:37", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:58:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:56:23) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:55:08) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:58:37Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 153}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 12:58:37", "broker_time": "2025-09-30T05:58:37Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.303, "ask": 3869.34, "last": 0.0, "time": 1759211917}, "tick_stats_5m": {"ticks_per_min": 153, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 209, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3870.309, "low": 3763.997, "eq50": 3817.1530000000002, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.309, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.309, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.31200000000035, "day_range_pct_of_adr20": 252.95727931492794, "position_in_day_range": 0.9905372864775349, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.9689880907589097, "M1": 1.3690753608291621, "M15": 4.969912832626418, "H1": 10.853992386360272}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.8398303629906, "ema200": 3861.966344492483}, "M5": {"ema50": 3859.5978763635135, "ema200": 3839.442429445332}, "M15": {"ema50": 3844.4811656932193, "ema200": 3806.4721930273527}, "H1": {"ema50": 3807.2598399507106, "ema200": 3747.208627442514}}}, "vwap": {"day": 3854.6666890436327, "asia": 3844.856703728444, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 62, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35240.999999999985}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105306.00000000004}, {"name": "EQ50_D", "price": 3817.1530000000002, "relation": "BELOW", "distance_pips": 52149.999999999636}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102382.99999999981}], "round_levels": [{"level": "3000", "price": 3869.3, "distance_pips": 0.3}, {"level": "3025", "price": 3869.303, "distance_pips": 0.05}, {"level": "3050", "price": 3869.305, "distance_pips": 0.2}, {"level": "3075", "price": 3869.308, "distance_pips": 0.45}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.246215844227394}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 297}, {"price": 3834.062, "bar_index": 291}, {"price": 3833.647, "bar_index": 287}, {"price": 3831.428, "bar_index": 282}, {"price": 3819.936, "bar_index": 277}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 123}, {"price": 3632.264, "bar_index": 134}, {"price": 3633.892, "bar_index": 116}, {"price": 3640.568, "bar_index": 128}, {"price": 3643.331, "bar_index": 139}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 298, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 272, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.309, "range_low": 3627.806, "equilibrium": 3749.0575, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 297}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 295}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 281}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 297}, {"price": 3867.242, "bar_index": 291}, {"price": 3852.113, "bar_index": 284}, {"price": 3850.722, "bar_index": 282}, {"price": 3840.666, "bar_index": 277}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 105}, {"price": 3737.664, "bar_index": 102}, {"price": 3739.268, "bar_index": 120}, {"price": 3741.553, "bar_index": 116}, {"price": 3742.965, "bar_index": 135}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 291, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 287, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.309, "range_low": 3734.526, "equilibrium": 3802.4175, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 290}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 275}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 293}, {"price": 3870.097, "bar_index": 291}, {"price": 3870.062, "bar_index": 288}, {"price": 3869.806, "bar_index": 295}, {"price": 3867.242, "bar_index": 274}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 108}, {"price": 3812.655, "bar_index": 102}, {"price": 3816.725, "bar_index": 124}, {"price": 3818.303, "bar_index": 114}, {"price": 3819.23, "bar_index": 118}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 273, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 297, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3870.309, "range_low": 3809.251, "equilibrium": 3839.78, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 290}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 274}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 272}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.309, "bar_index": 298}, {"price": 3870.101, "bar_index": 268}, {"price": 3870.097, "bar_index": 260}, {"price": 3870.062, "bar_index": 245}, {"price": 3869.806, "bar_index": 278}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 124}, {"price": 3847.279, "bar_index": 103}, {"price": 3847.279, "bar_index": 106}, {"price": 3847.722, "bar_index": 119}, {"price": 3848.122, "bar_index": 111}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.657, "bottom": 3868.64, "created_at_bar": 295, "lo": 3868.64, "hi": 3868.657}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.309, "range_low": 3845.815, "equilibrium": 3858.062, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 294}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 279}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 274}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.303, "spread_points": 37, "atr_m5_pips": 296.89880907589094, "ticks_per_min": 153, "pdh_pdl_distance_pips": {"PDH": 35240.999999999985, "PDL": 105306.00000000004}, "eq50_d_distance_pips": 52149.999999999636, "session_active": null, "mins_to_next_killzone": 62}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:58:38", "message": "Context+MT5 xong trong 1.09s"}
{"stage": "status_update", "t": "2025-09-30 12:58:38", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 12:58:38", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 12:59:17", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 12:59:17", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:59:17", "message": "Đã lưu thành công file: ctx_20250930_125917.json"}
{"stage": "run-end", "t": "2025-09-30 12:59:17"}
{"stage": "status_update", "t": "2025-09-30 12:59:17", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:59:17", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 12:59:47", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 12:59:47", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 12:59:47", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 12:59:47", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 12:59:52", "message": "Upload xong 4 ảnh trong 4.77s"}
{"stage": "run-start", "t": "2025-09-30 12:59:52", "cycle": "2025-09-30 12:59:52", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 12:59:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:58:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:56:23) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T05:59:52Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 144}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": true, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 12:59:52", "broker_time": "2025-09-30T05:59:52Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3870.015, "ask": 3870.092, "last": 0.0, "time": 1759211992}, "tick_stats_5m": {"ticks_per_min": 144, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 208, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3870.478, "low": 3763.997, "eq50": 3817.2375, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.478, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.478, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.48100000000022, "day_range_pct_of_adr20": 253.3593955407932, "position_in_day_range": 0.9956518064255577, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.981059519330329, "M1": 1.3594067125450702, "M15": 4.981984261197838, "H1": 10.86606381493169}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.939010400622, "ema200": 3862.149871316766}, "M5": {"ema50": 3859.6200724419446, "ema200": 3839.448061286128}, "M15": {"ema50": 3844.5033617716504, "ema200": 3806.4778248681487}, "H1": {"ema50": 3807.2820360291416, "ema200": 3747.21425928331}}}, "vwap": {"day": 3854.765625311286, "asia": 3844.930921335876, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 61, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35952.99999999997}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 106018.00000000003}, {"name": "EQ50_D", "price": 3817.2375, "relation": "BELOW", "distance_pips": 52777.49999999969}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 103094.9999999998}], "round_levels": [{"level": "100", "price": 3870.01, "distance_pips": 0.5}, {"level": "125", "price": 3870.013, "distance_pips": 0.25}, {"level": "150", "price": 3870.015, "distance_pips": 0.0}, {"level": "175", "price": 3870.018, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 2.5829742580088766}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 297}, {"price": 3834.062, "bar_index": 291}, {"price": 3833.647, "bar_index": 287}, {"price": 3831.428, "bar_index": 282}, {"price": 3819.936, "bar_index": 277}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 123}, {"price": 3632.264, "bar_index": 134}, {"price": 3633.892, "bar_index": 116}, {"price": 3640.568, "bar_index": 128}, {"price": 3643.331, "bar_index": 139}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 298, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 272, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.478, "range_low": 3627.806, "equilibrium": 3749.142, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 297}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 295}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 281}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 297}, {"price": 3867.242, "bar_index": 291}, {"price": 3852.113, "bar_index": 284}, {"price": 3850.722, "bar_index": 282}, {"price": 3840.666, "bar_index": 277}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 105}, {"price": 3737.664, "bar_index": 102}, {"price": 3739.268, "bar_index": 120}, {"price": 3741.553, "bar_index": 116}, {"price": 3742.965, "bar_index": 135}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 291, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 287, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.478, "range_low": 3734.526, "equilibrium": 3802.502, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 290}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 275}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 293}, {"price": 3870.097, "bar_index": 291}, {"price": 3870.062, "bar_index": 288}, {"price": 3869.806, "bar_index": 295}, {"price": 3867.242, "bar_index": 274}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 108}, {"price": 3812.655, "bar_index": 102}, {"price": 3816.725, "bar_index": 124}, {"price": 3818.303, "bar_index": 114}, {"price": 3819.23, "bar_index": 118}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 273, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 297, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3870.478, "range_low": 3809.251, "equilibrium": 3839.8645, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 290}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 274}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 272}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.309, "bar_index": 297}, {"price": 3870.101, "bar_index": 267}, {"price": 3870.097, "bar_index": 259}, {"price": 3870.062, "bar_index": 244}, {"price": 3869.806, "bar_index": 277}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 123}, {"price": 3847.279, "bar_index": 102}, {"price": 3847.279, "bar_index": 105}, {"price": 3847.722, "bar_index": 118}, {"price": 3848.122, "bar_index": 110}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.657, "bottom": 3868.64, "created_at_bar": 294, "lo": 3868.64, "hi": 3868.657}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.478, "range_low": 3845.851, "equilibrium": 3858.1645, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 293}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 278}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 273}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3870.015, "spread_points": 77, "atr_m5_pips": 298.1059519330329, "ticks_per_min": 144, "pdh_pdl_distance_pips": {"PDH": 35952.99999999997, "PDL": 106018.00000000003}, "eq50_d_distance_pips": 52777.49999999969, "session_active": null, "mins_to_next_killzone": 61}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 12:59:52", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "no-trade", "t": "2025-09-30 12:59:53", "reasons": ["Spread cao (cur=77, p90=37, factor=1.2)"]}
{"stage": "status_update", "t": "2025-09-30 12:59:53", "message": "Lỗi nghiêm trọng trong worker: 'TradingToolApp' object has no attribute '_auto_save_report'"}
{"stage": "status_update", "t": "2025-09-30 12:59:53", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 12:59:53", "message": "Đã lưu thành công file: ctx_20250930_125953.json"}
{"stage": "run-end", "t": "2025-09-30 12:59:54"}
{"stage": "status_update", "t": "2025-09-30 12:59:54", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 12:59:54", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:00:24", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:00:24", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:00:24", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:00:24", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:00:45", "message": "Lỗi nghiêm trọng trong worker: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond"}
{"stage": "status_update", "t": "2025-09-30 13:00:45", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:00:45", "message": "Đã lưu thành công file: ctx_20250930_130045.json"}
{"stage": "run-end", "t": "2025-09-30 13:00:45"}
{"stage": "status_update", "t": "2025-09-30 13:00:45", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:00:45", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:01:15", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:01:15", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:01:15", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:01:15", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:01:19", "message": "Upload xong 4 ảnh trong 4.05s"}
{"stage": "run-start", "t": "2025-09-30 13:01:20", "cycle": "2025-09-30 13:01:20", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:00:45) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 12:59:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:59:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:01:20Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 138}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:01:20", "broker_time": "2025-09-30T06:01:20Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.776, "ask": 3869.813, "last": 0.0, "time": 1759212080}, "tick_stats_5m": {"ticks_per_min": 138, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 197, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3870.478, "low": 3763.997, "eq50": 3817.2375, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.478, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.478, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.48100000000022, "day_range_pct_of_adr20": 253.3593955407932, "position_in_day_range": 0.9934072745372393, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.836698125184881, "M1": 1.2469833387979334, "M15": 4.694699671230359, "H1": 10.158487827935748}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.07787162464, "ema200": 3862.3281284974137}, "M5": {"ema50": 3860.015025714855, "ema200": 3839.726660862346}, "M15": {"ema50": 3845.4911327118525, "ema200": 3807.1289950246546}, "H1": {"ema50": 3809.7295140739707, "ema200": 3748.8387662169075}}}, "vwap": {"day": 3855.0704586940187, "asia": 3845.192980694216, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 59, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35713.99999999994}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105779.0}, {"name": "EQ50_D", "price": 3817.2375, "relation": "BELOW", "distance_pips": 52538.49999999966}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102855.99999999977}], "round_levels": [{"level": "7700", "price": 3869.77, "distance_pips": 0.6}, {"level": "7725", "price": 3869.773, "distance_pips": 0.35}, {"level": "7750", "price": 3869.775, "distance_pips": 0.1}, {"level": "7775", "price": 3869.778, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.304333361092149}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3869.469, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3869.469}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.478, "range_low": 3627.806, "equilibrium": 3749.142, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.478, "range_low": 3734.526, "equilibrium": 3802.502, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 292}, {"price": 3870.097, "bar_index": 290}, {"price": 3870.062, "bar_index": 287}, {"price": 3869.806, "bar_index": 294}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 107}, {"price": 3812.655, "bar_index": 101}, {"price": 3816.725, "bar_index": 123}, {"price": 3818.303, "bar_index": 113}, {"price": 3819.23, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 272, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 296, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3870.478, "range_low": 3809.251, "equilibrium": 3839.8645, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 289}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 273}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 271}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 297}, {"price": 3870.309, "bar_index": 295}, {"price": 3870.101, "bar_index": 265}, {"price": 3870.097, "bar_index": 257}, {"price": 3870.062, "bar_index": 242}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 121}, {"price": 3847.279, "bar_index": 103}, {"price": 3847.722, "bar_index": 116}, {"price": 3848.122, "bar_index": 108}, {"price": 3852.421, "bar_index": 133}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.657, "bottom": 3868.64, "created_at_bar": 292, "lo": 3868.64, "hi": 3868.657}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.478, "range_low": 3845.851, "equilibrium": 3858.1645, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 291}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 276}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 271}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.776, "spread_points": 37, "atr_m5_pips": 283.6698125184881, "ticks_per_min": 138, "pdh_pdl_distance_pips": {"PDH": 35713.99999999994, "PDL": 105779.0}, "eq50_d_distance_pips": 52538.49999999966, "session_active": null, "mins_to_next_killzone": 59}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:01:20", "message": "Context+MT5 xong trong 0.92s"}
{"stage": "status_update", "t": "2025-09-30 13:01:21", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:01:21", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:02:00", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:02:00", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:02:00", "message": "Đã lưu thành công file: ctx_20250930_130200.json"}
{"stage": "run-end", "t": "2025-09-30 13:02:00"}
{"stage": "status_update", "t": "2025-09-30 13:02:00", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:02:00", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:02:30", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:02:30", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:02:30", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:02:30", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:02:35", "message": "Upload xong 4 ảnh trong 5.36s"}
{"stage": "run-start", "t": "2025-09-30 13:02:35", "cycle": "2025-09-30 13:02:35", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:02:00) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:00:45) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 12:59:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:02:35Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 118}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:02:35", "broker_time": "2025-09-30T06:02:35Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.515, "ask": 3869.552, "last": 0.0, "time": 1759212154}, "tick_stats_5m": {"ticks_per_min": 118, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 190, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3870.478, "low": 3763.997, "eq50": 3817.2375, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.478, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.478, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.48100000000022, "day_range_pct_of_adr20": 253.3593955407932, "position_in_day_range": 0.9909561330190345, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.885412410899184, "M1": 1.2486477941717942, "M15": 4.7434139569446625, "H1": 10.20720211365005}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.1077046935693, "ema200": 3862.39494474483}, "M5": {"ema50": 3860.004790420737, "ema200": 3839.724063847421}, "M15": {"ema50": 3845.480897417735, "ema200": 3807.1263980097297}, "H1": {"ema50": 3809.719278779853, "ema200": 3748.8361692019826}}}, "vwap": {"day": 3855.202104882234, "asia": 3845.28645167223, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 58, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35452.99999999997}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105518.00000000003}, {"name": "EQ50_D", "price": 3817.2375, "relation": "BELOW", "distance_pips": 52277.49999999969}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102594.9999999998}], "round_levels": [{"level": "5100", "price": 3869.51, "distance_pips": 0.5}, {"level": "5125", "price": 3869.513, "distance_pips": 0.25}, {"level": "5150", "price": 3869.515, "distance_pips": 0.0}, {"level": "5175", "price": 3869.518, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2823123606351852}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3868.787, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3868.787}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.478, "range_low": 3627.806, "equilibrium": 3749.142, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.478, "range_low": 3734.526, "equilibrium": 3802.502, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 292}, {"price": 3870.097, "bar_index": 290}, {"price": 3870.062, "bar_index": 287}, {"price": 3869.806, "bar_index": 294}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 107}, {"price": 3812.655, "bar_index": 101}, {"price": 3816.725, "bar_index": 123}, {"price": 3818.303, "bar_index": 113}, {"price": 3819.23, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 272, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 296, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3870.478, "range_low": 3809.251, "equilibrium": 3839.8645, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 289}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 273}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 271}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 296}, {"price": 3870.309, "bar_index": 294}, {"price": 3870.101, "bar_index": 264}, {"price": 3870.097, "bar_index": 256}, {"price": 3870.062, "bar_index": 241}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 120}, {"price": 3847.279, "bar_index": 102}, {"price": 3847.722, "bar_index": 115}, {"price": 3848.122, "bar_index": 107}, {"price": 3852.421, "bar_index": 132}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.657, "bottom": 3868.64, "created_at_bar": 291, "lo": 3868.64, "hi": 3868.657}, {"type": "Bearish", "top": 3869.74, "bottom": 3869.709, "created_at_bar": 299, "lo": 3869.709, "hi": 3869.74}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.478, "range_low": 3845.851, "equilibrium": 3858.1645, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 290}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 275}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 270}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.515, "spread_points": 37, "atr_m5_pips": 288.5412410899184, "ticks_per_min": 118, "pdh_pdl_distance_pips": {"PDH": 35452.99999999997, "PDL": 105518.00000000003}, "eq50_d_distance_pips": 52277.49999999969, "session_active": null, "mins_to_next_killzone": 58}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:02:36", "message": "Context+MT5 xong trong 0.15s"}
{"stage": "status_update", "t": "2025-09-30 13:02:37", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:02:37", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:03:16", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:03:16", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:03:16", "message": "Đã lưu thành công file: ctx_20250930_130316.json"}
{"stage": "run-end", "t": "2025-09-30 13:03:16"}
{"stage": "status_update", "t": "2025-09-30 13:03:16", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:03:16", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:03:46", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:03:46", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:03:46", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:03:46", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:03:50", "message": "Upload xong 4 ảnh trong 4.71s"}
{"stage": "run-start", "t": "2025-09-30 13:03:51", "cycle": "2025-09-30 13:03:51", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:03:16) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:02:00) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:00:45) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:03:51Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 107}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:03:51", "broker_time": "2025-09-30T06:03:51Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.348, "ask": 3869.385, "last": 0.0, "time": 1759212230}, "tick_stats_5m": {"ticks_per_min": 107, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 181, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3870.478, "low": 3763.997, "eq50": 3817.2375, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.478, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.478, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.48100000000022, "day_range_pct_of_adr20": 253.3593955407932, "position_in_day_range": 0.9893877781012564, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.885412410899184, "M1": 1.217530094577919, "M15": 4.7434139569446625, "H1": 10.20720211365005}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.1523546463322, "ema200": 3862.420690541098}, "M5": {"ema50": 3859.995613950149, "ema200": 3839.721735489212}, "M15": {"ema50": 3845.471720947147, "ema200": 3807.1240696515206}, "H1": {"ema50": 3809.710102309265, "ema200": 3748.8338408437735}}}, "vwap": {"day": 3855.327409207735, "asia": 3845.3875801201466, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 57, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35286.00000000006}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105351.00000000012}, {"name": "EQ50_D", "price": 3817.2375, "relation": "BELOW", "distance_pips": 52110.499999999774}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102427.99999999988}], "round_levels": [{"level": "3400", "price": 3869.34, "distance_pips": 0.8}, {"level": "3425", "price": 3869.343, "distance_pips": 0.55}, {"level": "3450", "price": 3869.345, "distance_pips": 0.3}, {"level": "3475", "price": 3869.348, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2823123606351852}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3868.787, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3868.787}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.478, "range_low": 3627.806, "equilibrium": 3749.142, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.478, "range_low": 3734.526, "equilibrium": 3802.502, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 292}, {"price": 3870.097, "bar_index": 290}, {"price": 3870.062, "bar_index": 287}, {"price": 3869.806, "bar_index": 294}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 107}, {"price": 3812.655, "bar_index": 101}, {"price": 3816.725, "bar_index": 123}, {"price": 3818.303, "bar_index": 113}, {"price": 3819.23, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 272, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 296, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3870.478, "range_low": 3809.251, "equilibrium": 3839.8645, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 289}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 273}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 271}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 295}, {"price": 3870.309, "bar_index": 293}, {"price": 3870.101, "bar_index": 263}, {"price": 3870.097, "bar_index": 255}, {"price": 3870.062, "bar_index": 240}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 119}, {"price": 3847.279, "bar_index": 101}, {"price": 3847.722, "bar_index": 114}, {"price": 3848.122, "bar_index": 106}, {"price": 3852.421, "bar_index": 131}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.657, "bottom": 3868.64, "created_at_bar": 290, "lo": 3868.64, "hi": 3868.657}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.478, "range_low": 3845.851, "equilibrium": 3858.1645, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 289}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 274}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 269}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.348, "spread_points": 37, "atr_m5_pips": 288.5412410899184, "ticks_per_min": 107, "pdh_pdl_distance_pips": {"PDH": 35286.00000000006, "PDL": 105351.00000000012}, "eq50_d_distance_pips": 52110.499999999774, "session_active": null, "mins_to_next_killzone": 57}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:03:51", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "status_update", "t": "2025-09-30 13:03:52", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:03:52", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:04:35", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:04:35", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:04:35", "message": "Đã lưu thành công file: ctx_20250930_130435.json"}
{"stage": "run-end", "t": "2025-09-30 13:04:35"}
{"stage": "status_update", "t": "2025-09-30 13:04:35", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:04:35", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:05:05", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:05:05", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:05:05", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:05:05", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:05:09", "message": "Upload xong 4 ảnh trong 3.58s"}
{"stage": "run-start", "t": "2025-09-30 13:05:09", "cycle": "2025-09-30 13:05:09", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:04:35) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:03:16) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:02:00) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:05:09Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 120}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:05:09", "broker_time": "2025-09-30T06:05:09Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3868.345, "ask": 3868.382, "last": 0.0, "time": 1759212309}, "tick_stats_5m": {"ticks_per_min": 120, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 179, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3870.478, "low": 3763.997, "eq50": 3817.2375, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.478, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.478, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.48100000000022, "day_range_pct_of_adr20": 253.3593955407932, "position_in_day_range": 0.9799682572477695, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.7664390754993025, "M1": 1.1773674211023974, "M15": 4.812628242658919, "H1": 10.276416399364308}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.1641591008947, "ema200": 3862.4831070677897}, "M5": {"ema50": 3860.29060956016, "ema200": 3840.073587267083}, "M15": {"ema50": 3845.435015064794, "ema200": 3807.1147562186848}, "H1": {"ema50": 3809.673396426912, "ema200": 3748.8245274109377}}}, "vwap": {"day": 3855.577306171466, "asia": 3845.6728716723064, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 55, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 34282.9999999999}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 104347.99999999996}, {"name": "EQ50_D", "price": 3817.2375, "relation": "BELOW", "distance_pips": 51107.499999999614}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 101424.99999999972}], "round_levels": [{"level": "3400", "price": 3868.34, "distance_pips": 0.5}, {"level": "3425", "price": 3868.343, "distance_pips": 0.25}, {"level": "3450", "price": 3868.345, "distance_pips": 0.0}, {"level": "3475", "price": 3868.348, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.3374594195096803}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3867.818, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3867.818}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.478, "range_low": 3627.806, "equilibrium": 3749.142, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.478, "range_low": 3734.526, "equilibrium": 3802.502, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 297}, {"price": 3870.101, "bar_index": 291}, {"price": 3870.097, "bar_index": 289}, {"price": 3870.062, "bar_index": 286}, {"price": 3869.806, "bar_index": 293}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 106}, {"price": 3816.725, "bar_index": 122}, {"price": 3818.303, "bar_index": 112}, {"price": 3819.23, "bar_index": 116}, {"price": 3819.574, "bar_index": 118}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 271, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3868.783, "bottom": 3868.478, "created_at_bar": 299, "lo": 3868.478, "hi": 3868.783}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 295, "lo": 3865.236, "hi": 3869.013, "type": "bull"}, {"top": 3870.478, "bottom": 3868.783, "bar_index": 297, "lo": 3868.783, "hi": 3870.478, "type": "bear"}], "premium_discount_m5": {"range_high": 3870.478, "range_low": 3809.251, "equilibrium": 3839.8645, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 288}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 272}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 270}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 293}, {"price": 3870.309, "bar_index": 291}, {"price": 3870.101, "bar_index": 261}, {"price": 3870.097, "bar_index": 253}, {"price": 3870.062, "bar_index": 238}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 117}, {"price": 3847.722, "bar_index": 112}, {"price": 3848.122, "bar_index": 104}, {"price": 3852.421, "bar_index": 129}, {"price": 3854.566, "bar_index": 133}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 157, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3869.019, "bottom": 3868.478, "created_at_bar": 299, "lo": 3868.478, "hi": 3869.019}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.478, "range_low": 3845.851, "equilibrium": 3858.1645, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 287}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 272}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 267}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3868.345, "spread_points": 37, "atr_m5_pips": 276.64390754993025, "ticks_per_min": 120, "pdh_pdl_distance_pips": {"PDH": 34282.9999999999, "PDL": 104347.99999999996}, "eq50_d_distance_pips": 51107.499999999614, "session_active": null, "mins_to_next_killzone": 55}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:05:09", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "status_update", "t": "2025-09-30 13:05:10", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:05:10", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:05:49", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:05:49", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:05:49", "message": "Đã lưu thành công file: ctx_20250930_130549.json"}
{"stage": "run-end", "t": "2025-09-30 13:05:49"}
{"stage": "status_update", "t": "2025-09-30 13:05:49", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:05:49", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:06:19", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:06:19", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:06:19", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:06:19", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:06:23", "message": "Upload xong 4 ảnh trong 3.80s"}
{"stage": "run-start", "t": "2025-09-30 13:06:23", "cycle": "2025-09-30 13:06:23", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:05:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:04:35) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:03:16) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:06:23Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 148}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:06:23", "broker_time": "2025-09-30T06:06:23Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3867.998, "ask": 3868.035, "last": 0.0, "time": 1759212383}, "tick_stats_5m": {"ticks_per_min": 148, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 178, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3870.478, "low": 3763.997, "eq50": 3817.2375, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.478, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.478, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.48100000000022, "day_range_pct_of_adr20": 253.3593955407932, "position_in_day_range": 0.9767094599036447, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.847581932642157, "M1": 1.2267697481561888, "M15": 4.812628242658919, "H1": 10.276416399364308}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.1767305684, "ema200": 3862.5885415537773}, "M5": {"ema50": 3860.281276226827, "ema200": 3840.0712191078787}, "M15": {"ema50": 3845.4256817314604, "ema200": 3807.1123880594805}, "H1": {"ema50": 3809.6640630935785, "ema200": 3748.8221592517334}}}, "vwap": {"day": 3855.7579342388935, "asia": 3845.86361192371, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 54, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 33936.000000000146}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 104001.0000000002}, {"name": "EQ50_D", "price": 3817.2375, "relation": "BELOW", "distance_pips": 50760.49999999986}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 101077.99999999997}], "round_levels": [{"level": "9900", "price": 3867.99, "distance_pips": 0.8}, {"level": "9925", "price": 3867.993, "distance_pips": 0.55}, {"level": "9950", "price": 3867.995, "distance_pips": 0.3}, {"level": "9975", "price": 3867.998, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2993480389685004}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3867.818, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3867.818}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.478, "range_low": 3627.806, "equilibrium": 3749.142, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.478, "range_low": 3734.526, "equilibrium": 3802.502, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 297}, {"price": 3870.101, "bar_index": 291}, {"price": 3870.097, "bar_index": 289}, {"price": 3870.062, "bar_index": 286}, {"price": 3869.806, "bar_index": 293}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 106}, {"price": 3816.725, "bar_index": 122}, {"price": 3818.303, "bar_index": 112}, {"price": 3819.23, "bar_index": 116}, {"price": 3819.574, "bar_index": 118}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 271, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 295, "lo": 3865.236, "hi": 3869.013, "type": "bull"}, {"top": 3870.478, "bottom": 3868.783, "bar_index": 297, "lo": 3868.783, "hi": 3870.478, "type": "bear"}], "premium_discount_m5": {"range_high": 3870.478, "range_low": 3809.251, "equilibrium": 3839.8645, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 288}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 272}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 270}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 292}, {"price": 3870.309, "bar_index": 290}, {"price": 3870.101, "bar_index": 260}, {"price": 3870.097, "bar_index": 252}, {"price": 3870.062, "bar_index": 237}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 116}, {"price": 3847.722, "bar_index": 111}, {"price": 3848.122, "bar_index": 103}, {"price": 3852.421, "bar_index": 128}, {"price": 3854.566, "bar_index": 132}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 156, "lo": 3861.968, "hi": 3862.604}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.478, "range_low": 3845.851, "equilibrium": 3858.1645, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 286}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 271}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 266}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3867.998, "spread_points": 37, "atr_m5_pips": 284.7581932642157, "ticks_per_min": 148, "pdh_pdl_distance_pips": {"PDH": 33936.000000000146, "PDL": 104001.0000000002}, "eq50_d_distance_pips": 50760.49999999986, "session_active": null, "mins_to_next_killzone": 54}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:06:23", "message": "Context+MT5 xong trong 0.33s"}
{"stage": "status_update", "t": "2025-09-30 13:06:24", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:06:24", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:07:03", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:07:03", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:07:03", "message": "Đã lưu thành công file: ctx_20250930_130703.json"}
{"stage": "run-end", "t": "2025-09-30 13:07:03"}
{"stage": "status_update", "t": "2025-09-30 13:07:03", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:07:03", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:07:33", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:07:33", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:07:33", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:07:33", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:07:37", "message": "Upload xong 4 ảnh trong 4.25s"}
{"stage": "run-start", "t": "2025-09-30 13:07:37", "cycle": "2025-09-30 13:07:37", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:07:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:05:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:04:35) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:07:37Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 180}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:07:37", "broker_time": "2025-09-30T06:07:37Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3868.783, "ask": 3868.82, "last": 0.0, "time": 1759212457}, "tick_stats_5m": {"ticks_per_min": 180, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 176, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3870.478, "low": 3763.997, "eq50": 3817.2375, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.478, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.478, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.48100000000022, "day_range_pct_of_adr20": 253.3593955407932, "position_in_day_range": 0.9840816671518847, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.8835819326421506, "M1": 1.2697810926570163, "M15": 4.8267710998018, "H1": 10.290559256507187}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.2433174152384, "ema200": 3862.739084637126}, "M5": {"ema50": 3860.3077860307485, "ema200": 3840.077945476038}, "M15": {"ema50": 3845.452191535382, "ema200": 3807.11911442764}, "H1": {"ema50": 3809.6905728975003, "ema200": 3748.828885619893}}}, "vwap": {"day": 3855.8968298748955, "asia": 3845.974580741659, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 53, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 34721.0}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 104786.00000000006}, {"name": "EQ50_D", "price": 3817.2375, "relation": "BELOW", "distance_pips": 51545.499999999716}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 101862.99999999983}], "round_levels": [{"level": "7800", "price": 3868.78, "distance_pips": 0.3}, {"level": "7825", "price": 3868.783, "distance_pips": 0.05}, {"level": "7850", "price": 3868.785, "distance_pips": 0.2}, {"level": "7875", "price": 3868.788, "distance_pips": 0.45}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.28312636382625}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3867.62, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3867.62}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.478, "range_low": 3627.806, "equilibrium": 3749.142, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.478, "range_low": 3734.526, "equilibrium": 3802.502, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 297}, {"price": 3870.101, "bar_index": 291}, {"price": 3870.097, "bar_index": 289}, {"price": 3870.062, "bar_index": 286}, {"price": 3869.806, "bar_index": 293}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 106}, {"price": 3816.725, "bar_index": 122}, {"price": 3818.303, "bar_index": 112}, {"price": 3819.23, "bar_index": 116}, {"price": 3819.574, "bar_index": 118}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 271, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 295, "lo": 3865.236, "hi": 3869.013, "type": "bull"}, {"top": 3870.478, "bottom": 3868.783, "bar_index": 297, "lo": 3868.783, "hi": 3870.478, "type": "bear"}], "premium_discount_m5": {"range_high": 3870.478, "range_low": 3809.251, "equilibrium": 3839.8645, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 288}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 272}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 270}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 291}, {"price": 3870.309, "bar_index": 289}, {"price": 3870.101, "bar_index": 259}, {"price": 3870.097, "bar_index": 251}, {"price": 3870.062, "bar_index": 236}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 115}, {"price": 3847.722, "bar_index": 110}, {"price": 3848.122, "bar_index": 102}, {"price": 3852.421, "bar_index": 127}, {"price": 3854.566, "bar_index": 131}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 155, "lo": 3861.968, "hi": 3862.604}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.478, "range_low": 3845.851, "equilibrium": 3858.1645, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 285}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 270}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 265}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3868.783, "spread_points": 37, "atr_m5_pips": 288.35819326421506, "ticks_per_min": 180, "pdh_pdl_distance_pips": {"PDH": 34721.0, "PDL": 104786.00000000006}, "eq50_d_distance_pips": 51545.499999999716, "session_active": null, "mins_to_next_killzone": 53}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:07:37", "message": "Context+MT5 xong trong 0.15s"}
{"stage": "status_update", "t": "2025-09-30 13:07:39", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:07:39", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:08:17", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:08:17", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:08:17", "message": "Đã lưu thành công file: ctx_20250930_130817.json"}
{"stage": "run-end", "t": "2025-09-30 13:08:17"}
{"stage": "status_update", "t": "2025-09-30 13:08:17", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:08:17", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:08:47", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:08:47", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:08:47", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:08:47", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:08:51", "message": "Upload xong 4 ảnh trong 3.78s"}
{"stage": "run-start", "t": "2025-09-30 13:08:51", "cycle": "2025-09-30 13:08:51", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:08:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:07:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:05:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:08:51Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 200}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:08:51", "broker_time": "2025-09-30T06:08:51Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3868.95, "ask": 3868.987, "last": 0.0, "time": 1759212531}, "tick_stats_5m": {"ticks_per_min": 200, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 176, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3870.478, "low": 3763.997, "eq50": 3817.2375, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.478, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.478, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.48100000000022, "day_range_pct_of_adr20": 253.3593955407932, "position_in_day_range": 0.9856500220696627, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.8835819326421506, "M1": 1.2957457084979278, "M15": 4.8267710998018, "H1": 10.290559256507187}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.259999260974, "ema200": 3862.778876080573}, "M5": {"ema50": 3860.3088448542776, "ema200": 3840.0782141327545}, "M15": {"ema50": 3845.453250358911, "ema200": 3807.1193830843563}, "H1": {"ema50": 3809.6916317210294, "ema200": 3748.829154276609}}}, "vwap": {"day": 3856.0303605048, "asia": 3846.080513416344, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 52, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 34887.99999999992}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 104952.99999999997}, {"name": "EQ50_D", "price": 3817.2375, "relation": "BELOW", "distance_pips": 51712.499999999636}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102029.99999999974}], "round_levels": [{"level": "9500", "price": 3868.95, "distance_pips": 0.0}, {"level": "9525", "price": 3868.953, "distance_pips": 0.25}, {"level": "9550", "price": 3868.955, "distance_pips": 0.5}, {"level": "9575", "price": 3868.958, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.28312636382625}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3867.62, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3867.62}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.478, "range_low": 3627.806, "equilibrium": 3749.142, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.478, "range_low": 3734.526, "equilibrium": 3802.502, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 297}, {"price": 3870.101, "bar_index": 291}, {"price": 3870.097, "bar_index": 289}, {"price": 3870.062, "bar_index": 286}, {"price": 3869.806, "bar_index": 293}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 106}, {"price": 3816.725, "bar_index": 122}, {"price": 3818.303, "bar_index": 112}, {"price": 3819.23, "bar_index": 116}, {"price": 3819.574, "bar_index": 118}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 271, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 295, "lo": 3865.236, "hi": 3869.013, "type": "bull"}, {"top": 3870.478, "bottom": 3868.783, "bar_index": 297, "lo": 3868.783, "hi": 3870.478, "type": "bear"}], "premium_discount_m5": {"range_high": 3870.478, "range_low": 3809.251, "equilibrium": 3839.8645, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 288}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 272}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 270}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 290}, {"price": 3870.309, "bar_index": 288}, {"price": 3870.101, "bar_index": 258}, {"price": 3870.097, "bar_index": 250}, {"price": 3870.062, "bar_index": 235}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 114}, {"price": 3847.722, "bar_index": 109}, {"price": 3848.122, "bar_index": 101}, {"price": 3852.421, "bar_index": 126}, {"price": 3854.566, "bar_index": 130}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 154, "lo": 3861.968, "hi": 3862.604}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3870.478, "range_low": 3845.851, "equilibrium": 3858.1645, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 284}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 269}, {"type": "Bullish", "top": 3867.204, "bottom": 3864.233, "bar_index": 264}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3868.95, "spread_points": 37, "atr_m5_pips": 288.35819326421506, "ticks_per_min": 200, "pdh_pdl_distance_pips": {"PDH": 34887.99999999992, "PDL": 104952.99999999997}, "eq50_d_distance_pips": 51712.499999999636, "session_active": null, "mins_to_next_killzone": 52}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:08:51", "message": "Context+MT5 xong trong 0.22s"}
{"stage": "status_update", "t": "2025-09-30 13:08:52", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:08:52", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:09:31", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:09:31", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:09:31", "message": "Đã lưu thành công file: ctx_20250930_130931.json"}
{"stage": "run-end", "t": "2025-09-30 13:09:31"}
{"stage": "status_update", "t": "2025-09-30 13:09:31", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:09:31", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:10:01", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:10:01", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:10:01", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:10:01", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:10:05", "message": "Upload xong 4 ảnh trong 3.96s"}
{"stage": "run-start", "t": "2025-09-30 13:10:05", "cycle": "2025-09-30 13:10:05", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:09:31) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:08:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:07:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:10:05Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 204}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:10:05", "broker_time": "2025-09-30T06:10:05Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3870.39, "ask": 3870.427, "last": 0.0, "time": 1759212605}, "tick_stats_5m": {"ticks_per_min": 204, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 175, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3870.478, "low": 3763.997, "eq50": 3817.2375, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3870.478, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3870.478, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 106.48100000000022, "day_range_pct_of_adr20": 253.3593955407932, "position_in_day_range": 0.9991735614804501, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.741499549747999, "M1": 1.2594695139502472, "M15": 4.8267710998018, "H1": 10.290559256507187}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.373507237814, "ema200": 3862.912759080837}, "M5": {"ema50": 3860.7274451846592, "ema200": 3840.3474084396976}, "M15": {"ema50": 3845.5041523196955, "ema200": 3807.132298507242}, "H1": {"ema50": 3809.7425336818137, "ema200": 3748.842069699495}}}, "vwap": {"day": 3856.2089852862337, "asia": 3846.242573398151, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 50, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 36327.99999999997}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 106393.00000000003}, {"name": "EQ50_D", "price": 3817.2375, "relation": "BELOW", "distance_pips": 53152.49999999969}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 103469.9999999998}], "round_levels": [{"level": "3900", "price": 3870.39, "distance_pips": 0.0}, {"level": "3925", "price": 3870.392, "distance_pips": 0.25}, {"level": "3950", "price": 3870.395, "distance_pips": 0.5}, {"level": "3975", "price": 3870.398, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.3496263387554819}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3867.62, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3867.62}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3870.478, "range_low": 3627.806, "equilibrium": 3749.142, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 298}, {"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3870.478, "range_low": 3734.526, "equilibrium": 3802.502, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 296}, {"price": 3870.101, "bar_index": 290}, {"price": 3870.097, "bar_index": 288}, {"price": 3870.062, "bar_index": 285}, {"price": 3869.806, "bar_index": 292}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 105}, {"price": 3816.725, "bar_index": 121}, {"price": 3818.303, "bar_index": 111}, {"price": 3819.23, "bar_index": 115}, {"price": 3819.574, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 270, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 294, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3870.478, "range_low": 3809.251, "equilibrium": 3839.8645, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 287}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 271}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 269}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 288}, {"price": 3870.309, "bar_index": 286}, {"price": 3870.101, "bar_index": 256}, {"price": 3870.097, "bar_index": 248}, {"price": 3870.062, "bar_index": 233}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 112}, {"price": 3847.722, "bar_index": 107}, {"price": 3852.421, "bar_index": 124}, {"price": 3854.566, "bar_index": 128}, {"price": 3855.845, "bar_index": 133}]}, "fvgs_m1": [{"type": "Bullish", "top": 3869.619, "bottom": 3869.463, "created_at_bar": 299, "lo": 3869.463, "hi": 3869.619}], "order_blocks_m1": [{"top": 3869.463, "bottom": 3868.19, "bar_index": 297, "lo": 3868.19, "hi": 3869.463, "type": "bull"}], "premium_discount_m1": {"range_high": 3870.478, "range_low": 3845.851, "equilibrium": 3858.1645, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.77, "bottom": 3868.399, "bar_index": 298}, {"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 282}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 267}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3870.39, "spread_points": 37, "atr_m5_pips": 274.14995497479987, "ticks_per_min": 204, "pdh_pdl_distance_pips": {"PDH": 36327.99999999997, "PDL": 106393.00000000003}, "eq50_d_distance_pips": 53152.49999999969, "session_active": null, "mins_to_next_killzone": 50}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:10:05", "message": "Context+MT5 xong trong 0.68s"}
{"stage": "status_update", "t": "2025-09-30 13:10:12", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:10:12", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:10:51", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:10:51", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:10:51", "message": "Đã lưu thành công file: ctx_20250930_131051.json"}
{"stage": "run-end", "t": "2025-09-30 13:10:51"}
{"stage": "status_update", "t": "2025-09-30 13:10:51", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:10:51", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:11:21", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:11:21", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:11:21", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:11:21", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:11:25", "message": "Upload xong 4 ảnh trong 3.78s"}
{"stage": "run-start", "t": "2025-09-30 13:11:25", "cycle": "2025-09-30 13:11:25", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:10:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:09:31) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:08:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:11:25Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 209}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:11:25", "broker_time": "2025-09-30T06:11:25Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3870.945, "ask": 3870.982, "last": 0.0, "time": 1759212685}, "tick_stats_5m": {"ticks_per_min": 209, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 178, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9924278979993337, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.843213835462283, "M1": 1.3146706711162794, "M15": 4.921913956944648, "H1": 10.385702113650035}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.5172664612105, "ema200": 3863.014755749464}, "M5": {"ema50": 3860.760268714071, "ema200": 3840.3557367979065}, "M15": {"ema50": 3845.5369758491074, "ema200": 3807.140626865451}, "H1": {"ema50": 3809.7753572112256, "ema200": 3748.850398057704}}}, "vwap": {"day": 3856.358912769155, "asia": 3846.3283571949314, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 49, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 36883.00000000026}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 106948.00000000032}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 53066.000000000255}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 104025.00000000009}], "round_levels": [{"level": "9400", "price": 3870.94, "distance_pips": 0.5}, {"level": "9425", "price": 3870.943, "distance_pips": 0.25}, {"level": "9450", "price": 3870.945, "distance_pips": 0.0}, {"level": "9475", "price": 3870.948, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.3013442583291064}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3867.62, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3867.62}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}, {"price": 3840.666, "bar_index": 276}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 296}, {"price": 3870.101, "bar_index": 290}, {"price": 3870.097, "bar_index": 288}, {"price": 3870.062, "bar_index": 285}, {"price": 3869.806, "bar_index": 292}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 105}, {"price": 3816.725, "bar_index": 121}, {"price": 3818.303, "bar_index": 111}, {"price": 3819.23, "bar_index": 115}, {"price": 3819.574, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 270, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 294, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 287}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 271}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 269}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.478, "bar_index": 287}, {"price": 3870.309, "bar_index": 285}, {"price": 3870.101, "bar_index": 255}, {"price": 3870.097, "bar_index": 247}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 111}, {"price": 3847.722, "bar_index": 106}, {"price": 3852.421, "bar_index": 123}, {"price": 3854.566, "bar_index": 127}, {"price": 3855.845, "bar_index": 132}]}, "fvgs_m1": [{"type": "Bullish", "top": 3869.619, "bottom": 3869.463, "created_at_bar": 298, "lo": 3869.463, "hi": 3869.619}], "order_blocks_m1": [{"top": 3869.463, "bottom": 3868.19, "bar_index": 296, "lo": 3868.19, "hi": 3869.463, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.851, "equilibrium": 3858.806, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3869.77, "bottom": 3868.399, "bar_index": 297}, {"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 281}, {"type": "Bearish", "top": 3869.658, "bottom": 3867.264, "bar_index": 266}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3870.945, "spread_points": 37, "atr_m5_pips": 284.3213835462283, "ticks_per_min": 209, "pdh_pdl_distance_pips": {"PDH": 36883.00000000026, "PDL": 106948.00000000032}, "eq50_d_distance_pips": 53066.000000000255, "session_active": null, "mins_to_next_killzone": 49}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:11:25", "message": "Context+MT5 xong trong 0.15s"}
{"stage": "status_update", "t": "2025-09-30 13:11:26", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:11:26", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:12:05", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:12:05", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:12:05", "message": "Đã lưu thành công file: ctx_20250930_131205.json"}
{"stage": "run-end", "t": "2025-09-30 13:12:05"}
{"stage": "status_update", "t": "2025-09-30 13:12:05", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:12:05", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:12:35", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:12:35", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:12:35", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:12:35", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:12:40", "message": "Upload xong 4 ảnh trong 5.42s"}
{"stage": "run-start", "t": "2025-09-30 13:12:40", "cycle": "2025-09-30 13:12:40", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:12:05) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:10:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:09:31) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:12:40Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 229}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:12:40", "broker_time": "2025-09-30T06:12:40Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.302, "ask": 3869.339, "last": 0.0, "time": 1759212760}, "tick_stats_5m": {"ticks_per_min": 229, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 183, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9771816190935765, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.8658566926051403, "M1": 1.4047146027888622, "M15": 4.921913956944648, "H1": 10.385702113650035}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.508252250958, "ema200": 3863.0644729775677}, "M5": {"ema50": 3860.6958373415223, "ema200": 3840.3393885391997}, "M15": {"ema50": 3845.4725444765586, "ema200": 3807.124278606744}, "H1": {"ema50": 3809.7109258386768, "ema200": 3748.8340497989975}}}, "vwap": {"day": 3856.504698433842, "asia": 3846.415092408394, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 48, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35240.00000000023}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105305.00000000029}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 51423.000000000226}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102382.00000000006}], "round_levels": [{"level": "3000", "price": 3869.3, "distance_pips": 0.2}, {"level": "3025", "price": 3869.303, "distance_pips": 0.05}, {"level": "3050", "price": 3869.305, "distance_pips": 0.3}, {"level": "3075", "price": 3869.308, "distance_pips": 0.55}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.291062462937503}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3867.62, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3867.62}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}, {"price": 3840.666, "bar_index": 276}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 296}, {"price": 3870.101, "bar_index": 290}, {"price": 3870.097, "bar_index": 288}, {"price": 3870.062, "bar_index": 285}, {"price": 3869.806, "bar_index": 292}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 105}, {"price": 3816.725, "bar_index": 121}, {"price": 3818.303, "bar_index": 111}, {"price": 3819.23, "bar_index": 115}, {"price": 3819.574, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 270, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 294, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 287}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 271}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 269}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.478, "bar_index": 286}, {"price": 3870.309, "bar_index": 284}, {"price": 3870.101, "bar_index": 254}, {"price": 3870.097, "bar_index": 246}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 110}, {"price": 3847.722, "bar_index": 105}, {"price": 3852.421, "bar_index": 122}, {"price": 3854.566, "bar_index": 126}, {"price": 3855.845, "bar_index": 131}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 150, "lo": 3861.968, "hi": 3862.604}], "order_blocks_m1": [{"top": 3869.463, "bottom": 3868.19, "bar_index": 295, "lo": 3868.19, "hi": 3869.463, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.851, "equilibrium": 3858.806, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3871.655, "bottom": 3869.703, "bar_index": 298}, {"type": "Bullish", "top": 3869.77, "bottom": 3868.399, "bar_index": 296}, {"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 280}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.302, "spread_points": 37, "atr_m5_pips": 286.585669260514, "ticks_per_min": 229, "pdh_pdl_distance_pips": {"PDH": 35240.00000000023, "PDL": 105305.00000000029}, "eq50_d_distance_pips": 51423.000000000226, "session_active": null, "mins_to_next_killzone": 48}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:12:40", "message": "Context+MT5 xong trong 0.16s"}
{"stage": "status_update", "t": "2025-09-30 13:12:41", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:12:41", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:13:20", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:13:20", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:13:20", "message": "Đã lưu thành công file: ctx_20250930_131320.json"}
{"stage": "run-end", "t": "2025-09-30 13:13:20"}
{"stage": "status_update", "t": "2025-09-30 13:13:20", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:13:20", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:13:50", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:13:50", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:13:50", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:13:50", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:13:55", "message": "Upload xong 4 ảnh trong 4.44s"}
{"stage": "run-start", "t": "2025-09-30 13:13:55", "cycle": "2025-09-30 13:13:55", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:13:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:12:05) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:10:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:13:55Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 250}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:13:55", "broker_time": "2025-09-30T06:13:55Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3868.397, "ask": 3868.434, "last": 0.0, "time": 1759212835}, "tick_stats_5m": {"ticks_per_min": 250, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 185, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9687836383207747, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.939928121176588, "M1": 1.3991227434398066, "M15": 4.921913956944648, "H1": 10.385702113650035}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.4980892668054, "ema200": 3863.1341378966026}, "M5": {"ema50": 3860.6603471454437, "ema200": 3840.3303835640754}, "M15": {"ema50": 3845.43705428048, "ema200": 3807.11527363162}, "H1": {"ema50": 3809.675435642598, "ema200": 3748.8250448238728}}}, "vwap": {"day": 3856.6443632116984, "asia": 3846.511392944679, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 47, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 34335.00000000004}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 104400.00000000009}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 50518.00000000003}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 101476.99999999985}], "round_levels": [{"level": "3900", "price": 3868.39, "distance_pips": 0.7}, {"level": "3925", "price": 3868.392, "distance_pips": 0.45}, {"level": "3950", "price": 3868.395, "distance_pips": 0.2}, {"level": "3975", "price": 3868.398, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2585341707420443}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3867.62, "bottom": 3867.168, "created_at_bar": 299, "lo": 3867.168, "hi": 3867.62}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3870.101, "bar_index": 296}, {"price": 3867.242, "bar_index": 290}, {"price": 3852.113, "bar_index": 283}, {"price": 3850.722, "bar_index": 281}, {"price": 3840.666, "bar_index": 276}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 104}, {"price": 3737.664, "bar_index": 101}, {"price": 3739.268, "bar_index": 119}, {"price": 3741.553, "bar_index": 115}, {"price": 3742.965, "bar_index": 134}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 290, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 286, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 289}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 274}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3870.478, "bar_index": 296}, {"price": 3870.101, "bar_index": 290}, {"price": 3870.097, "bar_index": 288}, {"price": 3870.062, "bar_index": 285}, {"price": 3869.806, "bar_index": 292}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 105}, {"price": 3816.725, "bar_index": 121}, {"price": 3818.303, "bar_index": 111}, {"price": 3819.23, "bar_index": 115}, {"price": 3819.574, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 270, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3869.013, "bottom": 3865.236, "bar_index": 294, "lo": 3865.236, "hi": 3869.013, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 287}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 271}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 269}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3870.478, "bar_index": 285}, {"price": 3870.309, "bar_index": 283}, {"price": 3870.101, "bar_index": 253}, {"price": 3870.097, "bar_index": 245}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 109}, {"price": 3847.722, "bar_index": 104}, {"price": 3852.421, "bar_index": 121}, {"price": 3854.566, "bar_index": 125}, {"price": 3855.845, "bar_index": 130}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 149, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3869.703, "bottom": 3869.363, "created_at_bar": 299, "lo": 3869.363, "hi": 3869.703}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.851, "equilibrium": 3858.806, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3871.655, "bottom": 3869.703, "bar_index": 297}, {"type": "Bullish", "top": 3869.77, "bottom": 3868.399, "bar_index": 295}, {"type": "Bullish", "top": 3869.75, "bottom": 3868.087, "bar_index": 279}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3868.397, "spread_points": 37, "atr_m5_pips": 293.9928121176588, "ticks_per_min": 250, "pdh_pdl_distance_pips": {"PDH": 34335.00000000004, "PDL": 104400.00000000009}, "eq50_d_distance_pips": 50518.00000000003, "session_active": null, "mins_to_next_killzone": 47}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:13:55", "message": "Context+MT5 xong trong 0.20s"}
{"stage": "status_update", "t": "2025-09-30 13:13:56", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:13:56", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:14:34", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:14:34", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:14:34", "message": "Đã lưu thành công file: ctx_20250930_131434.json"}
{"stage": "run-end", "t": "2025-09-30 13:14:34"}
{"stage": "status_update", "t": "2025-09-30 13:14:34", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:14:34", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:15:04", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:15:04", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:15:04", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:15:04", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:15:08", "message": "Upload xong 4 ảnh trong 3.85s"}
{"stage": "run-start", "t": "2025-09-30 13:15:08", "cycle": "2025-09-30 13:15:08", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:14:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:13:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:12:05) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:15:08Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 270}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:15:08", "broker_time": "2025-09-30T06:15:08Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3866.07, "ask": 3866.107, "last": 0.0, "time": 1759212909}, "tick_stats_5m": {"ticks_per_min": 270, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 189, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.947190156267401, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.8829944798457734, "M1": 1.372821942853399, "M15": 4.680629286593191, "H1": 10.464559256507165}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.349276778634, "ema200": 3863.2275748829375}, "M5": {"ema50": 3860.8373869823945, "ema200": 3840.764388602506}, "M15": {"ema50": 3846.211048096245, "ema200": 3807.5722004575987}, "H1": {"ema50": 3809.612729760245, "ema200": 3748.8091343761116}}}, "vwap": {"day": 3856.8070489111856, "asia": 3846.6580594666434, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 45, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 32008.000000000266}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 102073.00000000032}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 48191.000000000255}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 99150.00000000009}], "round_levels": [{"level": "700", "price": 3866.07, "distance_pips": 0.0}, {"level": "725", "price": 3866.073, "distance_pips": 0.25}, {"level": "750", "price": 3866.075, "distance_pips": 0.5}, {"level": "775", "price": 3866.078, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2833878197986184}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.478, "bar_index": 295}, {"price": 3870.101, "bar_index": 289}, {"price": 3870.097, "bar_index": 287}, {"price": 3870.062, "bar_index": 284}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 104}, {"price": 3816.725, "bar_index": 120}, {"price": 3818.303, "bar_index": 110}, {"price": 3819.23, "bar_index": 114}, {"price": 3819.574, "bar_index": 116}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 269, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3867.62, "bottom": 3867.097, "created_at_bar": 299, "lo": 3867.097, "hi": 3867.62}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 267, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 297, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 286}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 270}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 268}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3870.478, "bar_index": 283}, {"price": 3870.309, "bar_index": 281}, {"price": 3870.101, "bar_index": 251}, {"price": 3870.097, "bar_index": 243}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 107}, {"price": 3847.722, "bar_index": 102}, {"price": 3852.421, "bar_index": 119}, {"price": 3854.566, "bar_index": 123}, {"price": 3855.845, "bar_index": 128}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 147, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 299, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.851, "equilibrium": 3858.806, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3868.202, "bottom": 3866.583, "bar_index": 298}, {"type": "Bearish", "top": 3869.363, "bottom": 3867.98, "bar_index": 297}, {"type": "Bearish", "top": 3871.655, "bottom": 3869.703, "bar_index": 295}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3866.07, "spread_points": 37, "atr_m5_pips": 288.29944798457734, "ticks_per_min": 270, "pdh_pdl_distance_pips": {"PDH": 32008.000000000266, "PDL": 102073.00000000032}, "eq50_d_distance_pips": 48191.000000000255, "session_active": null, "mins_to_next_killzone": 45}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:15:09", "message": "Context+MT5 xong trong 0.60s"}
{"stage": "status_update", "t": "2025-09-30 13:15:10", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:15:11", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:15:49", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:15:50", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:15:50", "message": "Đã lưu thành công file: ctx_20250930_131549.json"}
{"stage": "run-end", "t": "2025-09-30 13:15:50"}
{"stage": "status_update", "t": "2025-09-30 13:15:50", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:15:50", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:16:20", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:16:20", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:16:20", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:16:20", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:16:24", "message": "Upload xong 4 ảnh trong 4.24s"}
{"stage": "run-start", "t": "2025-09-30 13:16:24", "cycle": "2025-09-30 13:16:24", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:15:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:14:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:13:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:16:24Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 291}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:16:24", "broker_time": "2025-09-30T06:16:24Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3866.814, "ask": 3866.851, "last": 0.0, "time": 1759212983}, "tick_stats_5m": {"ticks_per_min": 291, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 195, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9540941316209485, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 2.9962087655600618, "M1": 1.4321050694214879, "M15": 4.7938435723074795, "H1": 10.577773542221454}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.240695914331, "ema200": 3863.2739351991227}, "M5": {"ema50": 3860.8092301196493, "ema200": 3840.757244323899}, "M15": {"ema50": 3846.1828912335, "ema200": 3807.5650561789917}, "H1": {"ema50": 3809.5845728975, "ema200": 3748.8019900975046}}}, "vwap": {"day": 3856.908823135223, "asia": 3846.716798914544, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 44, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 32751.999999999953}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 102817.0}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 48934.99999999994}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 99893.99999999978}], "round_levels": [{"level": "8100", "price": 3866.81, "distance_pips": 0.4}, {"level": "8125", "price": 3866.812, "distance_pips": 0.15}, {"level": "8150", "price": 3866.815, "distance_pips": 0.1}, {"level": "8175", "price": 3866.818, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2348939241336798}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.478, "bar_index": 295}, {"price": 3870.101, "bar_index": 289}, {"price": 3870.097, "bar_index": 287}, {"price": 3870.062, "bar_index": 284}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 104}, {"price": 3816.725, "bar_index": 120}, {"price": 3818.303, "bar_index": 110}, {"price": 3819.23, "bar_index": 114}, {"price": 3819.574, "bar_index": 116}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 269, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3867.62, "bottom": 3867.097, "created_at_bar": 299, "lo": 3867.097, "hi": 3867.62}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 267, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 297, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 286}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 270}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 268}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3870.478, "bar_index": 282}, {"price": 3870.309, "bar_index": 280}, {"price": 3870.101, "bar_index": 250}, {"price": 3870.097, "bar_index": 242}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 106}, {"price": 3847.722, "bar_index": 101}, {"price": 3852.421, "bar_index": 118}, {"price": 3854.566, "bar_index": 122}, {"price": 3855.845, "bar_index": 127}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 146, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 298, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.851, "equilibrium": 3858.806, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3868.202, "bottom": 3866.583, "bar_index": 297}, {"type": "Bearish", "top": 3869.363, "bottom": 3867.98, "bar_index": 296}, {"type": "Bearish", "top": 3871.655, "bottom": 3869.703, "bar_index": 294}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3866.814, "spread_points": 37, "atr_m5_pips": 299.6208765560062, "ticks_per_min": 291, "pdh_pdl_distance_pips": {"PDH": 32751.999999999953, "PDL": 102817.0}, "eq50_d_distance_pips": 48934.99999999994, "session_active": null, "mins_to_next_killzone": 44}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:16:24", "message": "Context+MT5 xong trong 0.33s"}
{"stage": "status_update", "t": "2025-09-30 13:16:26", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:16:26", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:17:04", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:17:04", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:17:04", "message": "Đã lưu thành công file: ctx_20250930_131704.json"}
{"stage": "run-end", "t": "2025-09-30 13:17:04"}
{"stage": "status_update", "t": "2025-09-30 13:17:04", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:17:04", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:17:34", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:17:34", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:17:34", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:17:34", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:17:38", "message": "Upload xong 4 ảnh trong 4.07s"}
{"stage": "run-start", "t": "2025-09-30 13:17:39", "cycle": "2025-09-30 13:17:39", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:17:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:15:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:14:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:17:39Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 319}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": true, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:17:39", "broker_time": "2025-09-30T06:17:39Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3865.321, "ask": 3865.398, "last": 0.0, "time": 1759213059}, "tick_stats_5m": {"ticks_per_min": 319, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 201, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9402397832300207, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.0322087655600547, "M1": 1.5097506256627282, "M15": 4.829843572307473, "H1": 10.595773542221451}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.0837025825035, "ema200": 3863.212580698584}, "M5": {"ema50": 3860.7625242372965, "ema200": 3840.7453935776307}, "M15": {"ema50": 3846.136185351147, "ema200": 3807.553205432723}, "H1": {"ema50": 3809.537867015147, "ema200": 3748.790139351236}}}, "vwap": {"day": 3857.026327081774, "asia": 3846.7738112802326, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 43, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 31259.000000000015}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 101324.00000000007}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 47442.00000000001}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 98400.99999999984}], "round_levels": [{"level": "3200", "price": 3865.32, "distance_pips": 0.1}, {"level": "3225", "price": 3865.323, "distance_pips": 0.15}, {"level": "3250", "price": 3865.325, "distance_pips": 0.4}, {"level": "3275", "price": 3865.328, "distance_pips": 0.65}], "atr_norm": {"spread_as_pct_of_atr_m5": 2.5394029881713474}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3864.679, "bar_index": 299}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.478, "bar_index": 295}, {"price": 3870.101, "bar_index": 289}, {"price": 3870.097, "bar_index": 287}, {"price": 3870.062, "bar_index": 284}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 104}, {"price": 3816.725, "bar_index": 120}, {"price": 3818.303, "bar_index": 110}, {"price": 3819.23, "bar_index": 114}, {"price": 3819.574, "bar_index": 116}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 269, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3867.62, "bottom": 3867.349, "created_at_bar": 299, "lo": 3867.349, "hi": 3867.62}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 267, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 297, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 286}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 270}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 268}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3870.478, "bar_index": 281}, {"price": 3870.309, "bar_index": 279}, {"price": 3870.101, "bar_index": 249}, {"price": 3870.097, "bar_index": 241}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 105}, {"price": 3852.421, "bar_index": 117}, {"price": 3854.566, "bar_index": 121}, {"price": 3855.845, "bar_index": 126}, {"price": 3856.642, "bar_index": 130}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 145, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 297, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.851, "equilibrium": 3858.806, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3868.202, "bottom": 3866.583, "bar_index": 296}, {"type": "Bearish", "top": 3869.363, "bottom": 3867.98, "bar_index": 295}, {"type": "Bearish", "top": 3871.655, "bottom": 3869.703, "bar_index": 293}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3865.321, "spread_points": 77, "atr_m5_pips": 303.22087655600546, "ticks_per_min": 319, "pdh_pdl_distance_pips": {"PDH": 31259.000000000015, "PDL": 101324.00000000007}, "eq50_d_distance_pips": 47442.00000000001, "session_active": null, "mins_to_next_killzone": 43}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:17:39", "message": "Context+MT5 xong trong 0.56s"}
{"stage": "no-trade", "t": "2025-09-30 13:18:00", "reasons": ["Spread cao (cur=77, p90=37, factor=1.2)"]}
{"stage": "status_update", "t": "2025-09-30 13:18:00", "message": "Lỗi nghiêm trọng trong worker: 'TradingToolApp' object has no attribute '_auto_save_report'"}
{"stage": "status_update", "t": "2025-09-30 13:18:00", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:18:00", "message": "Đã lưu thành công file: ctx_20250930_131800.json"}
{"stage": "run-end", "t": "2025-09-30 13:18:01"}
{"stage": "status_update", "t": "2025-09-30 13:18:01", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:18:01", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:18:31", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:18:31", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:18:31", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:18:31", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:18:35", "message": "Upload xong 4 ảnh trong 4.24s"}
{"stage": "run-start", "t": "2025-09-30 13:18:38", "cycle": "2025-09-30 13:18:38", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:18:00) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:17:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:15:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:18:38Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 323}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:18:38", "broker_time": "2025-09-30T06:18:38Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3864.085, "ask": 3864.122, "last": 0.0, "time": 1759213115}, "tick_stats_5m": {"ticks_per_min": 323, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 201, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9287702757878334, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.082351622702928, "M1": 1.5973704789569303, "M15": 4.879986429450346, "H1": 10.645916399364324}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.9382287586536, "ema200": 3863.2873596751415}, "M5": {"ema50": 3860.7364850216104, "ema200": 3840.7387866124564}, "M15": {"ema50": 3846.110146135461, "ema200": 3807.546598467549}, "H1": {"ema50": 3809.511827799461, "ema200": 3748.783532386062}}}, "vwap": {"day": 3857.1628002101543, "asia": 3846.9233972615953, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 42, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 30023.00000000014}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 100088.00000000019}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 46206.00000000013}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 97164.99999999996}], "round_levels": [{"level": "800", "price": 3864.08, "distance_pips": 0.5}, {"level": "825", "price": 3864.082, "distance_pips": 0.25}, {"level": "850", "price": 3864.085, "distance_pips": 0.0}, {"level": "875", "price": 3864.088, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2003821928454004}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3863.977, "bar_index": 299}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3867.349, "bottom": 3863.977, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.478, "bar_index": 295}, {"price": 3870.101, "bar_index": 289}, {"price": 3870.097, "bar_index": 287}, {"price": 3870.062, "bar_index": 284}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 104}, {"price": 3816.725, "bar_index": 120}, {"price": 3818.303, "bar_index": 110}, {"price": 3819.23, "bar_index": 114}, {"price": 3819.574, "bar_index": 116}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 269, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3867.62, "bottom": 3867.349, "created_at_bar": 299, "lo": 3867.349, "hi": 3867.62}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 267, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 297, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3867.349, "bottom": 3863.977, "bar_index": 299}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 286}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 270}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3870.478, "bar_index": 280}, {"price": 3870.309, "bar_index": 278}, {"price": 3870.101, "bar_index": 248}, {"price": 3870.097, "bar_index": 240}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 104}, {"price": 3852.421, "bar_index": 116}, {"price": 3854.566, "bar_index": 120}, {"price": 3855.845, "bar_index": 125}, {"price": 3856.642, "bar_index": 129}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 144, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 296, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.851, "equilibrium": 3858.806, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3868.202, "bottom": 3866.583, "bar_index": 295}, {"type": "Bearish", "top": 3869.363, "bottom": 3867.98, "bar_index": 294}, {"type": "Bearish", "top": 3871.655, "bottom": 3869.703, "bar_index": 292}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3864.085, "spread_points": 37, "atr_m5_pips": 308.2351622702928, "ticks_per_min": 323, "pdh_pdl_distance_pips": {"PDH": 30023.00000000014, "PDL": 100088.00000000019}, "eq50_d_distance_pips": 46206.00000000013, "session_active": null, "mins_to_next_killzone": 42}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:18:38", "message": "Context+MT5 xong trong 3.32s"}
{"stage": "status_update", "t": "2025-09-30 13:18:39", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:18:39", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:19:22", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:19:22", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:19:22", "message": "Đã lưu thành công file: ctx_20250930_131922.json"}
{"stage": "run-end", "t": "2025-09-30 13:19:22"}
{"stage": "status_update", "t": "2025-09-30 13:19:22", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:19:22", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:19:52", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:19:52", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:19:52", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:19:52", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:19:56", "message": "Upload xong 4 ảnh trong 4.21s"}
{"stage": "run-start", "t": "2025-09-30 13:19:57", "cycle": "2025-09-30 13:19:57", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:19:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:18:00) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:17:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:19:57Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 384}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:19:57", "broker_time": "2025-09-30T06:19:57Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3863.112, "ask": 3863.149, "last": 0.0, "time": 1759213197}, "tick_stats_5m": {"ticks_per_min": 384, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 212, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9197412865149783, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.2179944798457774, "M1": 1.7099613631264297, "M15": 5.015629286593195, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.7048886758657, "ema200": 3863.235931375359}, "M5": {"ema50": 3860.696014433375, "ema200": 3840.7285179557402}, "M15": {"ema50": 3846.0696755472254, "ema200": 3807.5363298108327}, "H1": {"ema50": 3809.4713572112255, "ema200": 3748.7732637293457}}}, "vwap": {"day": 3857.2943724342067, "asia": 3847.031605847838, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 41, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 29050.000000000182}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 99115.00000000023}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 45233.000000000175}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 96192.0}], "round_levels": [{"level": "1100", "price": 3863.11, "distance_pips": 0.2}, {"level": "1125", "price": 3863.113, "distance_pips": 0.05}, {"level": "1150", "price": 3863.115, "distance_pips": 0.3}, {"level": "1175", "price": 3863.118, "distance_pips": 0.55}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1497844459192612}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.478, "bar_index": 295}, {"price": 3870.101, "bar_index": 289}, {"price": 3870.097, "bar_index": 287}, {"price": 3870.062, "bar_index": 284}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 104}, {"price": 3816.725, "bar_index": 120}, {"price": 3818.303, "bar_index": 110}, {"price": 3819.23, "bar_index": 114}, {"price": 3819.574, "bar_index": 116}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 269, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3867.62, "bottom": 3867.349, "created_at_bar": 299, "lo": 3867.349, "hi": 3867.62}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 267, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 297, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 286}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 270}, {"type": "Bullish", "top": 3863.963, "bottom": 3859.707, "bar_index": 268}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 290}, {"price": 3870.478, "bar_index": 279}, {"price": 3870.309, "bar_index": 277}, {"price": 3870.101, "bar_index": 247}, {"price": 3870.097, "bar_index": 239}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 103}, {"price": 3852.421, "bar_index": 115}, {"price": 3854.566, "bar_index": 119}, {"price": 3855.845, "bar_index": 124}, {"price": 3856.642, "bar_index": 128}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 143, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3864.083, "bottom": 3863.505, "created_at_bar": 299, "lo": 3863.505, "hi": 3864.083}], "order_blocks_m1": [], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.851, "equilibrium": 3858.806, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3868.202, "bottom": 3866.583, "bar_index": 294}, {"type": "Bearish", "top": 3869.363, "bottom": 3867.98, "bar_index": 293}, {"type": "Bearish", "top": 3871.655, "bottom": 3869.703, "bar_index": 291}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3863.112, "spread_points": 37, "atr_m5_pips": 321.79944798457774, "ticks_per_min": 384, "pdh_pdl_distance_pips": {"PDH": 29050.000000000182, "PDL": 99115.00000000023}, "eq50_d_distance_pips": 45233.000000000175, "session_active": null, "mins_to_next_killzone": 41}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:19:57", "message": "Context+MT5 xong trong 0.21s"}
{"stage": "status_update", "t": "2025-09-30 13:20:10", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:20:10", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:20:48", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:20:48", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:20:48", "message": "Đã lưu thành công file: ctx_20250930_132048.json"}
{"stage": "run-end", "t": "2025-09-30 13:20:49"}
{"stage": "status_update", "t": "2025-09-30 13:20:49", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:20:49", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:21:19", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:21:19", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:21:19", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:21:19", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:21:23", "message": "Upload xong 4 ảnh trong 4.04s"}
{"stage": "run-start", "t": "2025-09-30 13:21:23", "cycle": "2025-09-30 13:21:23", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:20:48) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:19:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:18:00) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:21:23Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 365}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:21:23", "broker_time": "2025-09-30T06:21:23Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3864.435, "ask": 3864.472, "last": 0.0, "time": 1759213283}, "tick_stats_5m": {"ticks_per_min": 365, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 218, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9320181136557661, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.208994874218384, "M1": 1.7684870937699315, "M15": 5.015629286593195, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.475408471269, "ema200": 3863.278464372954}, "M5": {"ema50": 3860.821886276667, "ema200": 3841.0030855550435}, "M15": {"ema50": 3846.1183814295787, "ema200": 3807.5486880197877}, "H1": {"ema50": 3809.5200630935788, "ema200": 3748.7856219383007}}}, "vwap": {"day": 3857.4729436193716, "asia": 3847.270695045045, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 39, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 30373.000000000047}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 100438.0000000001}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 46556.00000000004}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 97514.99999999987}], "round_levels": [{"level": "4300", "price": 3864.43, "distance_pips": 0.5}, {"level": "4325", "price": 3864.433, "distance_pips": 0.25}, {"level": "4350", "price": 3864.435, "distance_pips": 0.0}, {"level": "4375", "price": 3864.438, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1530090090678018}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.478, "bar_index": 294}, {"price": 3870.101, "bar_index": 288}, {"price": 3870.097, "bar_index": 286}, {"price": 3870.062, "bar_index": 283}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 103}, {"price": 3816.725, "bar_index": 119}, {"price": 3818.303, "bar_index": 109}, {"price": 3819.23, "bar_index": 113}, {"price": 3819.574, "bar_index": 115}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 268, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3866.583, "bottom": 3865.547, "created_at_bar": 299, "lo": 3865.547, "hi": 3866.583}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 266, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 296, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3867.349, "bottom": 3862.078, "bar_index": 298}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 285}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 269}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 288}, {"price": 3870.478, "bar_index": 277}, {"price": 3870.309, "bar_index": 275}, {"price": 3870.101, "bar_index": 245}, {"price": 3870.097, "bar_index": 237}], "swing_lows_SSL": [{"price": 3845.851, "bar_index": 101}, {"price": 3852.421, "bar_index": 113}, {"price": 3854.566, "bar_index": 117}, {"price": 3855.845, "bar_index": 122}, {"price": 3856.642, "bar_index": 126}]}, "fvgs_m1": [{"type": "Bullish", "top": 3864.301, "bottom": 3863.505, "created_at_bar": 299, "lo": 3863.505, "hi": 3864.301}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 293, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 297, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.851, "equilibrium": 3858.806, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.465, "bottom": 3864.301, "bar_index": 299}, {"type": "Bullish", "top": 3865.547, "bottom": 3862.455, "bar_index": 298}, {"type": "Bearish", "top": 3868.202, "bottom": 3866.583, "bar_index": 292}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3864.435, "spread_points": 37, "atr_m5_pips": 320.8994874218384, "ticks_per_min": 365, "pdh_pdl_distance_pips": {"PDH": 30373.000000000047, "PDL": 100438.0000000001}, "eq50_d_distance_pips": 46556.00000000004, "session_active": null, "mins_to_next_killzone": 39}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:21:23", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "status_update", "t": "2025-09-30 13:21:24", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:21:24", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:22:02", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:22:02", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:22:02", "message": "Đã lưu thành công file: ctx_20250930_132202.json"}
{"stage": "run-end", "t": "2025-09-30 13:22:02"}
{"stage": "status_update", "t": "2025-09-30 13:22:02", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:22:02", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:22:32", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:22:32", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:22:32", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:22:32", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:22:37", "message": "Upload xong 4 ảnh trong 4.98s"}
{"stage": "run-start", "t": "2025-09-30 13:22:38", "cycle": "2025-09-30 13:22:38", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:22:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:20:48) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:19:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:22:38Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 372}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:22:38", "broker_time": "2025-09-30T06:22:38Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3863.71, "ask": 3863.787, "last": 0.0, "time": 1759213357}, "tick_stats_5m": {"ticks_per_min": 372, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 227, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9252904495007617, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.208994874218384, "M1": 1.8292227095627465, "M15": 5.015629286593195, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.303258696486, "ema200": 3863.3078693793364}, "M5": {"ema50": 3860.793454904118, "ema200": 3840.995871624695}, "M15": {"ema50": 3846.0899500570295, "ema200": 3807.5414740894394}, "H1": {"ema50": 3809.4916317210295, "ema200": 3748.7784080079523}}}, "vwap": {"day": 3857.5765389558514, "asia": 3847.35941445256, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 38, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 29648.00000000014}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 99713.00000000019}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 45831.00000000013}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 96789.99999999996}], "round_levels": [{"level": "7100", "price": 3863.71, "distance_pips": 0.0}, {"level": "7125", "price": 3863.713, "distance_pips": 0.25}, {"level": "7150", "price": 3863.715, "distance_pips": 0.5}, {"level": "7175", "price": 3863.718, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 2.3995052350629176}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.478, "bar_index": 294}, {"price": 3870.101, "bar_index": 288}, {"price": 3870.097, "bar_index": 286}, {"price": 3870.062, "bar_index": 283}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 103}, {"price": 3816.725, "bar_index": 119}, {"price": 3818.303, "bar_index": 109}, {"price": 3819.23, "bar_index": 113}, {"price": 3819.574, "bar_index": 115}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 268, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3866.583, "bottom": 3865.547, "created_at_bar": 299, "lo": 3865.547, "hi": 3866.583}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 266, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 296, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3867.349, "bottom": 3862.078, "bar_index": 298}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 285}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 269}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 287}, {"price": 3870.478, "bar_index": 276}, {"price": 3870.309, "bar_index": 274}, {"price": 3870.101, "bar_index": 244}, {"price": 3870.097, "bar_index": 236}], "swing_lows_SSL": [{"price": 3852.421, "bar_index": 112}, {"price": 3854.566, "bar_index": 116}, {"price": 3855.845, "bar_index": 121}, {"price": 3856.642, "bar_index": 125}, {"price": 3858.866, "bar_index": 131}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 140, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 292, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 296, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.851, "equilibrium": 3858.806, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.465, "bottom": 3863.458, "bar_index": 298}, {"type": "Bullish", "top": 3865.547, "bottom": 3862.455, "bar_index": 297}, {"type": "Bearish", "top": 3868.202, "bottom": 3866.583, "bar_index": 291}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3863.71, "spread_points": 77, "atr_m5_pips": 320.8994874218384, "ticks_per_min": 372, "pdh_pdl_distance_pips": {"PDH": 29648.00000000014, "PDL": 99713.00000000019}, "eq50_d_distance_pips": 45831.00000000013, "session_active": null, "mins_to_next_killzone": 38}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:22:38", "message": "Context+MT5 xong trong 0.17s"}
{"stage": "status_update", "t": "2025-09-30 13:22:40", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:22:40", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:23:18", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:23:18", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:23:18", "message": "Đã lưu thành công file: ctx_20250930_132318.json"}
{"stage": "run-end", "t": "2025-09-30 13:23:18"}
{"stage": "status_update", "t": "2025-09-30 13:23:18", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:23:18", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:23:48", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:23:48", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:23:48", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:23:48", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:23:53", "message": "Upload xong 4 ảnh trong 4.14s"}
{"stage": "run-start", "t": "2025-09-30 13:23:53", "cycle": "2025-09-30 13:23:53", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:23:18) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:22:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:20:48) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:23:53Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 334}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:23:53", "broker_time": "2025-09-30T06:23:53Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3865.731, "ask": 3865.768, "last": 0.0, "time": 1759213433}, "tick_stats_5m": {"ticks_per_min": 334, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 231, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9440443933038887, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.231280588504091, "M1": 1.8174210873410241, "M15": 5.015629286593195, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.294301107988, "ema200": 3863.5569934170335}, "M5": {"ema50": 3860.8727098060785, "ema200": 3841.0159810774317}, "M15": {"ema50": 3846.16920495899, "ema200": 3807.561583542176}, "H1": {"ema50": 3809.57088662299, "ema200": 3748.798517460689}}}, "vwap": {"day": 3857.6800484619444, "asia": 3847.4612337376357, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 37, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 31669.000000000324}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 101734.00000000038}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 47852.00000000031}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 98811.00000000015}], "round_levels": [{"level": "7300", "price": 3865.73, "distance_pips": 0.1}, {"level": "7325", "price": 3865.733, "distance_pips": 0.15}, {"level": "7350", "price": 3865.735, "distance_pips": 0.4}, {"level": "7375", "price": 3865.738, "distance_pips": 0.65}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1450568586164223}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.478, "bar_index": 294}, {"price": 3870.101, "bar_index": 288}, {"price": 3870.097, "bar_index": 286}, {"price": 3870.062, "bar_index": 283}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 103}, {"price": 3816.725, "bar_index": 119}, {"price": 3818.303, "bar_index": 109}, {"price": 3819.23, "bar_index": 113}, {"price": 3819.574, "bar_index": 115}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 268, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3866.583, "bottom": 3865.859, "created_at_bar": 299, "lo": 3865.859, "hi": 3866.583}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 266, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 296, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3865.859, "bottom": 3862.455, "bar_index": 299}, {"type": "Bearish", "top": 3867.349, "bottom": 3862.078, "bar_index": 298}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 285}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 286}, {"price": 3870.478, "bar_index": 275}, {"price": 3870.309, "bar_index": 273}, {"price": 3870.101, "bar_index": 243}, {"price": 3870.097, "bar_index": 235}], "swing_lows_SSL": [{"price": 3852.421, "bar_index": 111}, {"price": 3854.566, "bar_index": 115}, {"price": 3855.845, "bar_index": 120}, {"price": 3856.642, "bar_index": 124}, {"price": 3858.866, "bar_index": 130}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 139, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 291, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 295, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.965, "equilibrium": 3858.8630000000003, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 298}, {"type": "Bullish", "top": 3865.547, "bottom": 3862.455, "bar_index": 296}, {"type": "Bearish", "top": 3868.202, "bottom": 3866.583, "bar_index": 290}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3865.731, "spread_points": 37, "atr_m5_pips": 323.1280588504091, "ticks_per_min": 334, "pdh_pdl_distance_pips": {"PDH": 31669.000000000324, "PDL": 101734.00000000038}, "eq50_d_distance_pips": 47852.00000000031, "session_active": null, "mins_to_next_killzone": 37}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:23:53", "message": "Context+MT5 xong trong 0.21s"}
{"stage": "status_update", "t": "2025-09-30 13:23:54", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:23:54", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:24:33", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:24:33", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:24:33", "message": "Đã lưu thành công file: ctx_20250930_132433.json"}
{"stage": "run-end", "t": "2025-09-30 13:24:33"}
{"stage": "status_update", "t": "2025-09-30 13:24:33", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:24:33", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:25:04", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:25:04", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:25:04", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:25:04", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:25:08", "message": "Upload xong 4 ảnh trong 4.13s"}
{"stage": "run-start", "t": "2025-09-30 13:25:08", "cycle": "2025-09-30 13:25:08", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:24:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:23:18) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:22:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:25:08Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 284}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:25:08", "broker_time": "2025-09-30T06:25:08Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3865.902, "ask": 3865.939, "last": 0.0, "time": 1759213507}, "tick_stats_5m": {"ticks_per_min": 284, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 234, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9456311940907918, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.0626483015863073, "M1": 1.6755551358011915, "M15": 5.015629286593195, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.1918911277985, "ema200": 3863.540506465185}, "M5": {"ema50": 3861.070515774644, "ema200": 3841.3752213841203}, "M15": {"ema50": 3846.175910841343, "ema200": 3807.5632850347133}, "H1": {"ema50": 3809.577592505343, "ema200": 3748.8002189532262}}}, "vwap": {"day": 3857.8729670059465, "asia": 3847.581274711017, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 35, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 31840.000000000146}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 101905.0000000002}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 48023.00000000014}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 98981.99999999997}], "round_levels": [{"level": "9000", "price": 3865.9, "distance_pips": 0.2}, {"level": "9025", "price": 3865.903, "distance_pips": 0.05}, {"level": "9050", "price": 3865.905, "distance_pips": 0.3}, {"level": "9075", "price": 3865.908, "distance_pips": 0.55}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2081047628172956}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3870.478, "bar_index": 293}, {"price": 3870.101, "bar_index": 287}, {"price": 3870.097, "bar_index": 285}, {"price": 3870.062, "bar_index": 282}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 102}, {"price": 3816.725, "bar_index": 118}, {"price": 3818.303, "bar_index": 108}, {"price": 3819.23, "bar_index": 112}, {"price": 3819.574, "bar_index": 114}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 267, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3866.583, "bottom": 3866.273, "created_at_bar": 298, "lo": 3866.273, "hi": 3866.583}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 265, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 295, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 298}, {"type": "Bearish", "top": 3867.349, "bottom": 3862.078, "bar_index": 297}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 284}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 284}, {"price": 3870.478, "bar_index": 273}, {"price": 3870.309, "bar_index": 271}, {"price": 3870.101, "bar_index": 241}, {"price": 3870.097, "bar_index": 233}], "swing_lows_SSL": [{"price": 3852.421, "bar_index": 109}, {"price": 3854.566, "bar_index": 113}, {"price": 3855.845, "bar_index": 118}, {"price": 3856.642, "bar_index": 122}, {"price": 3858.866, "bar_index": 128}]}, "fvgs_m1": [{"type": "Bullish", "top": 3865.312, "bottom": 3865.255, "created_at_bar": 298, "lo": 3865.255, "hi": 3865.312}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 289, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 293, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3847.372, "equilibrium": 3859.5665, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 296}, {"type": "Bullish", "top": 3865.547, "bottom": 3862.455, "bar_index": 294}, {"type": "Bearish", "top": 3868.202, "bottom": 3866.583, "bar_index": 288}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3865.902, "spread_points": 37, "atr_m5_pips": 306.26483015863073, "ticks_per_min": 284, "pdh_pdl_distance_pips": {"PDH": 31840.000000000146, "PDL": 101905.0000000002}, "eq50_d_distance_pips": 48023.00000000014, "session_active": null, "mins_to_next_killzone": 35}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:25:08", "message": "Context+MT5 xong trong 0.31s"}
{"stage": "status_update", "t": "2025-09-30 13:25:10", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:25:10", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:25:48", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:25:48", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:25:48", "message": "Đã lưu thành công file: ctx_20250930_132548.json"}
{"stage": "run-end", "t": "2025-09-30 13:25:48"}
{"stage": "status_update", "t": "2025-09-30 13:25:48", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:25:48", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:26:18", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:26:18", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:26:18", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:26:18", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:26:22", "message": "Upload xong 4 ảnh trong 3.77s"}
{"stage": "run-start", "t": "2025-09-30 13:26:22", "cycle": "2025-09-30 13:26:22", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:25:48) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:24:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:23:18) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:26:22Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 272}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:26:22", "broker_time": "2025-09-30T06:26:22Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3865.502, "ask": 3865.579, "last": 0.0, "time": 1759213583}, "tick_stats_5m": {"ticks_per_min": 272, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 238, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.941919379384581, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.118791158729169, "M1": 1.6261532383488169, "M15": 5.015629286593195, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.113218996944, "ema200": 3863.5089883646597}, "M5": {"ema50": 3861.054829500134, "ema200": 3841.3712412846176}, "M15": {"ema50": 3846.160224566833, "ema200": 3807.5593049352105}, "H1": {"ema50": 3809.5619062308333, "ema200": 3748.7962388537235}}}, "vwap": {"day": 3857.9578887569, "asia": 3847.616585155491, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 34, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 31440.000000000055}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 101505.0000000001}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 47623.000000000044}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 98581.99999999988}], "round_levels": [{"level": "5000", "price": 3865.5, "distance_pips": 0.2}, {"level": "5025", "price": 3865.503, "distance_pips": 0.05}, {"level": "5050", "price": 3865.505, "distance_pips": 0.3}, {"level": "5075", "price": 3865.508, "distance_pips": 0.55}], "atr_norm": {"spread_as_pct_of_atr_m5": 2.4689052931521447}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3870.478, "bar_index": 293}, {"price": 3870.101, "bar_index": 287}, {"price": 3870.097, "bar_index": 285}, {"price": 3870.062, "bar_index": 282}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 102}, {"price": 3816.725, "bar_index": 118}, {"price": 3818.303, "bar_index": 108}, {"price": 3819.23, "bar_index": 112}, {"price": 3819.574, "bar_index": 114}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 267, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3866.583, "bottom": 3866.273, "created_at_bar": 298, "lo": 3866.273, "hi": 3866.583}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 265, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 295, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 298}, {"type": "Bearish", "top": 3867.349, "bottom": 3862.078, "bar_index": 297}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 284}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 283}, {"price": 3870.478, "bar_index": 272}, {"price": 3870.309, "bar_index": 270}, {"price": 3870.101, "bar_index": 240}, {"price": 3870.097, "bar_index": 232}], "swing_lows_SSL": [{"price": 3852.421, "bar_index": 108}, {"price": 3854.566, "bar_index": 112}, {"price": 3855.845, "bar_index": 117}, {"price": 3856.642, "bar_index": 121}, {"price": 3858.866, "bar_index": 127}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 136, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 288, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 292, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3847.486, "equilibrium": 3859.6234999999997, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 295}, {"type": "Bullish", "top": 3865.547, "bottom": 3862.455, "bar_index": 293}, {"type": "Bearish", "top": 3868.202, "bottom": 3866.583, "bar_index": 287}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3865.502, "spread_points": 77, "atr_m5_pips": 311.8791158729169, "ticks_per_min": 272, "pdh_pdl_distance_pips": {"PDH": 31440.000000000055, "PDL": 101505.0000000001}, "eq50_d_distance_pips": 47623.000000000044, "session_active": null, "mins_to_next_killzone": 34}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:26:22", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "status_update", "t": "2025-09-30 13:26:24", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:26:24", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:27:03", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:27:03", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:27:03", "message": "Đã lưu thành công file: ctx_20250930_132703.json"}
{"stage": "run-end", "t": "2025-09-30 13:27:03"}
{"stage": "status_update", "t": "2025-09-30 13:27:03", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:27:03", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:27:33", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:27:33", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:27:33", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:27:33", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:27:37", "message": "Upload xong 4 ảnh trong 4.50s"}
{"stage": "run-start", "t": "2025-09-30 13:27:38", "cycle": "2025-09-30 13:27:37", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:27:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:25:48) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:24:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:27:37Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 239}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:27:37", "broker_time": "2025-09-30T06:27:37Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3865.188, "ask": 3865.225, "last": 0.0, "time": 1759213657}, "tick_stats_5m": {"ticks_per_min": 239, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 241, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9390056048402077, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.1773625873005766, "M1": 1.6335504560456584, "M15": 5.015629286593195, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3866.999791067603, "ema200": 3863.491699483099}, "M5": {"ema50": 3861.0467510687618, "ema200": 3841.369191533374}, "M15": {"ema50": 3846.152146135461, "ema200": 3807.557255183967}, "H1": {"ema50": 3809.553827799461, "ema200": 3748.79418910248}}}, "vwap": {"day": 3858.04036814512, "asia": 3847.667473415515, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 33, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 31126.000000000204}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 101191.00000000026}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 47309.0000000002}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 98268.00000000003}], "round_levels": [{"level": "1800", "price": 3865.18, "distance_pips": 0.8}, {"level": "1825", "price": 3865.183, "distance_pips": 0.55}, {"level": "1850", "price": 3865.185, "distance_pips": 0.3}, {"level": "1875", "price": 3865.188, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1644878097227689}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3870.478, "bar_index": 293}, {"price": 3870.101, "bar_index": 287}, {"price": 3870.097, "bar_index": 285}, {"price": 3870.062, "bar_index": 282}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 102}, {"price": 3816.725, "bar_index": 118}, {"price": 3818.303, "bar_index": 108}, {"price": 3819.23, "bar_index": 112}, {"price": 3819.574, "bar_index": 114}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 267, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3866.583, "bottom": 3866.273, "created_at_bar": 298, "lo": 3866.273, "hi": 3866.583}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 265, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 295, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 298}, {"type": "Bearish", "top": 3867.349, "bottom": 3862.078, "bar_index": 297}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 284}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 282}, {"price": 3870.478, "bar_index": 271}, {"price": 3870.309, "bar_index": 269}, {"price": 3870.101, "bar_index": 239}, {"price": 3870.097, "bar_index": 231}], "swing_lows_SSL": [{"price": 3852.421, "bar_index": 107}, {"price": 3854.566, "bar_index": 111}, {"price": 3855.845, "bar_index": 116}, {"price": 3856.642, "bar_index": 120}, {"price": 3858.866, "bar_index": 126}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 135, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3865.508, "bottom": 3865.335, "created_at_bar": 299, "lo": 3865.335, "hi": 3865.508}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 291, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.03, "equilibrium": 3859.8955, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3865.335, "bottom": 3864.155, "bar_index": 299}, {"type": "Bearish", "top": 3865.724, "bottom": 3864.383, "bar_index": 298}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 294}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3865.188, "spread_points": 37, "atr_m5_pips": 317.73625873005767, "ticks_per_min": 239, "pdh_pdl_distance_pips": {"PDH": 31126.000000000204, "PDL": 101191.00000000026}, "eq50_d_distance_pips": 47309.0000000002, "session_active": null, "mins_to_next_killzone": 33}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:27:38", "message": "Context+MT5 xong trong 0.26s"}
{"stage": "status_update", "t": "2025-09-30 13:27:39", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:27:39", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:28:17", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:28:17", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:28:17", "message": "Đã lưu thành công file: ctx_20250930_132817.json"}
{"stage": "run-end", "t": "2025-09-30 13:28:17"}
{"stage": "status_update", "t": "2025-09-30 13:28:17", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:28:17", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:28:47", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:28:47", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:28:47", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:28:47", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:28:52", "message": "Upload xong 4 ảnh trong 4.22s"}
{"stage": "run-start", "t": "2025-09-30 13:28:52", "cycle": "2025-09-30 13:28:52", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:28:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:27:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:25:48) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:28:52Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 222}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:28:52", "broker_time": "2025-09-30T06:28:52Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3866.161, "ask": 3866.198, "last": 0.0, "time": 1759213732}, "tick_stats_5m": {"ticks_per_min": 222, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 244, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9480345941130628, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.186362587300591, "M1": 1.6579448112656556, "M15": 5.015629286593195, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3866.940860052112, "ema200": 3863.496218017456}, "M5": {"ema50": 3861.080672637389, "ema200": 3841.377798498548}, "M15": {"ema50": 3846.186067704088, "ema200": 3807.565862149141}, "H1": {"ema50": 3809.587749368088, "ema200": 3748.802796067654}}}, "vwap": {"day": 3858.1242299693645, "asia": 3847.740803565336, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 32, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 32099.00000000016}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 102164.00000000022}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 48282.00000000015}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 99240.99999999999}], "round_levels": [{"level": "1600", "price": 3866.16, "distance_pips": 0.1}, {"level": "1625", "price": 3866.162, "distance_pips": 0.15}, {"level": "1650", "price": 3866.165, "distance_pips": 0.4}, {"level": "1675", "price": 3866.168, "distance_pips": 0.65}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1611986704611883}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3870.101, "bar_index": 295}, {"price": 3867.242, "bar_index": 289}, {"price": 3852.113, "bar_index": 282}, {"price": 3850.722, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 103}, {"price": 3739.268, "bar_index": 118}, {"price": 3741.553, "bar_index": 114}, {"price": 3742.965, "bar_index": 133}, {"price": 3744.591, "bar_index": 111}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 289, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 285, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 288}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 273}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3870.478, "bar_index": 293}, {"price": 3870.101, "bar_index": 287}, {"price": 3870.097, "bar_index": 285}, {"price": 3870.062, "bar_index": 282}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 102}, {"price": 3816.725, "bar_index": 118}, {"price": 3818.303, "bar_index": 108}, {"price": 3819.23, "bar_index": 112}, {"price": 3819.574, "bar_index": 114}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 267, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3866.583, "bottom": 3866.273, "created_at_bar": 298, "lo": 3866.273, "hi": 3866.583}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 265, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 295, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 298}, {"type": "Bearish", "top": 3867.349, "bottom": 3862.078, "bar_index": 297}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 284}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 281}, {"price": 3870.478, "bar_index": 270}, {"price": 3870.309, "bar_index": 268}, {"price": 3870.101, "bar_index": 238}, {"price": 3870.097, "bar_index": 230}], "swing_lows_SSL": [{"price": 3852.421, "bar_index": 106}, {"price": 3854.566, "bar_index": 110}, {"price": 3855.845, "bar_index": 115}, {"price": 3856.642, "bar_index": 119}, {"price": 3858.866, "bar_index": 125}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 134, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 286, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 290, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.861, "equilibrium": 3860.3109999999997, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 299}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 293}, {"type": "Bullish", "top": 3865.547, "bottom": 3862.455, "bar_index": 291}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3866.161, "spread_points": 37, "atr_m5_pips": 318.6362587300591, "ticks_per_min": 222, "pdh_pdl_distance_pips": {"PDH": 32099.00000000016, "PDL": 102164.00000000022}, "eq50_d_distance_pips": 48282.00000000015, "session_active": null, "mins_to_next_killzone": 32}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:28:52", "message": "Context+MT5 xong trong 0.38s"}
{"stage": "status_update", "t": "2025-09-30 13:28:53", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:28:53", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:29:32", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:29:32", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:29:32", "message": "Đã lưu thành công file: ctx_20250930_132932.json"}
{"stage": "run-end", "t": "2025-09-30 13:29:32"}
{"stage": "status_update", "t": "2025-09-30 13:29:32", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:29:32", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:30:02", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:30:02", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:30:02", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:30:02", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:30:07", "message": "Upload xong 4 ảnh trong 4.81s"}
{"stage": "run-start", "t": "2025-09-30 13:30:07", "cycle": "2025-09-30 13:30:07", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:29:32) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:28:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:27:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:30:07Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 197}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:30:07", "broker_time": "2025-09-30T06:30:07Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3866.303, "ask": 3866.34, "last": 0.0, "time": 1759213807}, "tick_stats_5m": {"ticks_per_min": 197, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 243, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9493522883337656, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.0078775045035506, "M1": 1.509176903546931, "M15": 4.689370051952446, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3866.903756718385, "ema200": 3863.6260921766884}, "M5": {"ema50": 3861.297025535553, "ema200": 3841.842555474719}, "M15": {"ema50": 3846.9865023105867, "ema200": 3808.201120152568}, "H1": {"ema50": 3809.593317995539, "ema200": 3748.8042090029776}}}, "vwap": {"day": 3858.2699871591926, "asia": 3848.0035199144245, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 30, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 32240.999999999985}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 102306.00000000004}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 48423.99999999998}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 99382.99999999981}], "round_levels": [{"level": "3000", "price": 3866.3, "distance_pips": 0.3}, {"level": "3025", "price": 3866.303, "distance_pips": 0.05}, {"level": "3050", "price": 3866.305, "distance_pips": 0.2}, {"level": "3075", "price": 3866.308, "distance_pips": 0.45}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2301032852855083}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3870.478, "bar_index": 292}, {"price": 3870.101, "bar_index": 286}, {"price": 3870.097, "bar_index": 284}, {"price": 3870.062, "bar_index": 281}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 101}, {"price": 3816.725, "bar_index": 117}, {"price": 3818.303, "bar_index": 107}, {"price": 3819.23, "bar_index": 111}, {"price": 3819.574, "bar_index": 113}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 266, "lo": 3861.378, "hi": 3862.708}, {"type": "Bearish", "top": 3867.62, "bottom": 3867.349, "created_at_bar": 296, "lo": 3867.349, "hi": 3867.62}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 264, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 294, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 297}, {"type": "Bearish", "top": 3867.349, "bottom": 3862.078, "bar_index": 296}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 279}, {"price": 3870.478, "bar_index": 268}, {"price": 3870.309, "bar_index": 266}, {"price": 3870.101, "bar_index": 236}, {"price": 3870.097, "bar_index": 228}], "swing_lows_SSL": [{"price": 3852.421, "bar_index": 104}, {"price": 3854.566, "bar_index": 108}, {"price": 3855.845, "bar_index": 113}, {"price": 3856.642, "bar_index": 117}, {"price": 3858.866, "bar_index": 123}]}, "fvgs_m1": [{"type": "Bullish", "top": 3865.913, "bottom": 3865.558, "created_at_bar": 298, "lo": 3865.558, "hi": 3865.913}, {"type": "Bearish", "top": 3867.98, "bottom": 3867.097, "created_at_bar": 284, "lo": 3867.097, "hi": 3867.98}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 288, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.061, "equilibrium": 3860.911, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 297}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 291}, {"type": "Bullish", "top": 3865.547, "bottom": 3862.455, "bar_index": 289}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3866.303, "spread_points": 37, "atr_m5_pips": 300.7877504503551, "ticks_per_min": 197, "pdh_pdl_distance_pips": {"PDH": 32240.999999999985, "PDL": 102306.00000000004}, "eq50_d_distance_pips": 48423.99999999998, "session_active": null, "mins_to_next_killzone": 30}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:30:07", "message": "Context+MT5 xong trong 0.16s"}
{"stage": "status_update", "t": "2025-09-30 13:30:08", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:30:08", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:30:46", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:30:46", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:30:46", "message": "Đã lưu thành công file: ctx_20250930_133046.json"}
{"stage": "run-end", "t": "2025-09-30 13:30:46"}
{"stage": "status_update", "t": "2025-09-30 13:30:46", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:30:46", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:31:16", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:31:16", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:31:16", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:31:16", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:31:21", "message": "Upload xong 4 ảnh trong 4.46s"}
{"stage": "run-start", "t": "2025-09-30 13:31:21", "cycle": "2025-09-30 13:31:21", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:30:46) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:29:32) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:28:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:31:21Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 185}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:31:21", "broker_time": "2025-09-30T06:31:21Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3867.745, "ask": 3867.782, "last": 0.0, "time": 1759213881}, "tick_stats_5m": {"ticks_per_min": 185, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 245, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9627333803496523, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.093234647360673, "M1": 1.500337736911076, "M15": 4.774727194809568, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3866.9602347757223, "ema200": 3863.793695350792}, "M5": {"ema50": 3861.353574555161, "ema200": 3841.8569037334255}, "M15": {"ema50": 3847.0430513301944, "ema200": 3808.2154684112743}, "H1": {"ema50": 3809.6498670151473, "ema200": 3748.818557261684}}}, "vwap": {"day": 3858.366305522892, "asia": 3848.1194361087432, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 29, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 33682.99999999999}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 103748.00000000004}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 49865.999999999985}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 100824.99999999981}], "round_levels": [{"level": "7400", "price": 3867.74, "distance_pips": 0.5}, {"level": "7425", "price": 3867.743, "distance_pips": 0.25}, {"level": "7450", "price": 3867.745, "distance_pips": 0.0}, {"level": "7475", "price": 3867.748, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1961588504717056}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3867.792, "bottom": 3866.149, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3870.478, "bar_index": 292}, {"price": 3870.101, "bar_index": 286}, {"price": 3870.097, "bar_index": 284}, {"price": 3870.062, "bar_index": 281}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 101}, {"price": 3816.725, "bar_index": 117}, {"price": 3818.303, "bar_index": 107}, {"price": 3819.23, "bar_index": 111}, {"price": 3819.574, "bar_index": 113}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 266, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 264, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3869.77, "bottom": 3867.62, "bar_index": 294, "lo": 3867.62, "hi": 3869.77, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3867.792, "bottom": 3866.149, "bar_index": 299}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 297}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 278}, {"price": 3870.478, "bar_index": 267}, {"price": 3870.309, "bar_index": 265}, {"price": 3870.101, "bar_index": 235}, {"price": 3870.097, "bar_index": 227}], "swing_lows_SSL": [{"price": 3852.421, "bar_index": 103}, {"price": 3854.566, "bar_index": 107}, {"price": 3855.845, "bar_index": 112}, {"price": 3856.642, "bar_index": 116}, {"price": 3858.866, "bar_index": 122}]}, "fvgs_m1": [{"type": "Bullish", "top": 3866.908, "bottom": 3866.631, "created_at_bar": 299, "lo": 3866.631, "hi": 3866.908}, {"type": "Bearish", "top": 3869.056, "bottom": 3868.202, "created_at_bar": 282, "lo": 3868.202, "hi": 3869.056}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 287, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3851.254, "equilibrium": 3861.5074999999997, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3867.792, "bottom": 3866.908, "bar_index": 299}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 296}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 290}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3867.745, "spread_points": 37, "atr_m5_pips": 309.3234647360673, "ticks_per_min": 185, "pdh_pdl_distance_pips": {"PDH": 33682.99999999999, "PDL": 103748.00000000004}, "eq50_d_distance_pips": 49865.999999999985, "session_active": null, "mins_to_next_killzone": 29}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:31:21", "message": "Context+MT5 xong trong 0.16s"}
{"stage": "status_update", "t": "2025-09-30 13:31:22", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:31:22", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:32:00", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:32:00", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:32:00", "message": "Đã lưu thành công file: ctx_20250930_133200.json"}
{"stage": "run-end", "t": "2025-09-30 13:32:00"}
{"stage": "status_update", "t": "2025-09-30 13:32:00", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:32:00", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:32:30", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:32:30", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:32:30", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:32:30", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:32:35", "message": "Upload xong 4 ảnh trong 4.14s"}
{"stage": "run-start", "t": "2025-09-30 13:32:35", "cycle": "2025-09-30 13:32:35", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:32:00) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:30:46) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:29:32) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:32:35Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 180}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": true, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:32:35", "broker_time": "2025-09-30T06:32:35Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3868.496, "ask": 3868.573, "last": 0.0, "time": 1759213954}, "tick_stats_5m": {"ticks_per_min": 180, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 251, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9697023124605632, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.1831632187892454, "M1": 1.5160432046936838, "M15": 4.8646557662381404, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.0492464569, "ema200": 3863.845919795542}, "M5": {"ema50": 3861.383025535553, "ema200": 3841.864376370241}, "M15": {"ema50": 3847.0725023105865, "ema200": 3808.22294104809}, "H1": {"ema50": 3809.6793179955393, "ema200": 3748.8260298984997}}}, "vwap": {"day": 3858.4826394412235, "asia": 3848.155768144058, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 28, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 34434.0000000002}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 104499.00000000025}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 50617.00000000019}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 101576.00000000001}], "round_levels": [{"level": "4900", "price": 3868.49, "distance_pips": 0.6}, {"level": "4925", "price": 3868.493, "distance_pips": 0.35}, {"level": "4950", "price": 3868.495, "distance_pips": 0.1}, {"level": "4975", "price": 3868.498, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 2.4189774355667093}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3870.478, "bar_index": 292}, {"price": 3870.101, "bar_index": 286}, {"price": 3870.097, "bar_index": 284}, {"price": 3870.062, "bar_index": 281}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 101}, {"price": 3816.725, "bar_index": 117}, {"price": 3818.303, "bar_index": 107}, {"price": 3819.23, "bar_index": 111}, {"price": 3819.574, "bar_index": 113}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 266, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 264, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 297}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 283}, {"type": "Bullish", "top": 3867.242, "bottom": 3862.75, "bar_index": 267}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 277}, {"price": 3870.478, "bar_index": 266}, {"price": 3870.309, "bar_index": 264}, {"price": 3870.101, "bar_index": 234}, {"price": 3870.097, "bar_index": 226}], "swing_lows_SSL": [{"price": 3852.421, "bar_index": 102}, {"price": 3854.566, "bar_index": 106}, {"price": 3855.845, "bar_index": 111}, {"price": 3856.642, "bar_index": 115}, {"price": 3858.866, "bar_index": 121}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.017, "bottom": 3867.137, "created_at_bar": 299, "lo": 3867.137, "hi": 3868.017}, {"type": "Bearish", "top": 3869.703, "bottom": 3869.363, "created_at_bar": 280, "lo": 3869.363, "hi": 3869.703}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 286, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3852.421, "equilibrium": 3862.091, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 298}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 295}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 289}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3868.496, "spread_points": 77, "atr_m5_pips": 318.31632187892455, "ticks_per_min": 180, "pdh_pdl_distance_pips": {"PDH": 34434.0000000002, "PDL": 104499.00000000025}, "eq50_d_distance_pips": 50617.00000000019, "session_active": null, "mins_to_next_killzone": 28}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:32:35", "message": "Context+MT5 xong trong 0.18s"}
{"stage": "no-trade", "t": "2025-09-30 13:32:36", "reasons": ["Spread cao (cur=77, p90=37, factor=1.2)"]}
{"stage": "status_update", "t": "2025-09-30 13:32:36", "message": "Lỗi nghiêm trọng trong worker: 'TradingToolApp' object has no attribute '_auto_save_report'"}
{"stage": "status_update", "t": "2025-09-30 13:32:36", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:32:36", "message": "Đã lưu thành công file: ctx_20250930_133236.json"}
{"stage": "run-end", "t": "2025-09-30 13:32:36"}
{"stage": "status_update", "t": "2025-09-30 13:32:36", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:32:36", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:33:06", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:33:06", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:33:06", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:33:06", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:33:10", "message": "Upload xong 4 ảnh trong 3.86s"}
{"stage": "run-start", "t": "2025-09-30 13:33:11", "cycle": "2025-09-30 13:33:11", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:32:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:32:00) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:30:46) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:33:11Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 182}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:33:11", "broker_time": "2025-09-30T06:33:11Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.797, "ask": 3869.834, "last": 0.0, "time": 1759213990}, "tick_stats_5m": {"ticks_per_min": 182, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 256, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9817749897925101, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.28523464736068, "M1": 1.5283921594811574, "M15": 4.966727194809575, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.200155677824, "ema200": 3863.891514897416}, "M5": {"ema50": 3861.4354176924157, "ema200": 3841.87766990258}, "M15": {"ema50": 3847.1248944674494, "ema200": 3808.2362345804286}, "H1": {"ema50": 3809.7317101524022, "ema200": 3748.8393234308382}}}, "vwap": {"day": 3858.5810636486563, "asia": 3848.15966995511, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 27, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35735.000000000124}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105800.00000000017}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 51918.00000000012}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102876.99999999996}], "round_levels": [{"level": "7900", "price": 3869.79, "distance_pips": 0.7}, {"level": "7925", "price": 3869.793, "distance_pips": 0.45}, {"level": "7950", "price": 3869.795, "distance_pips": 0.2}, {"level": "7975", "price": 3869.798, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.126251363187484}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3870.48, "bottom": 3866.149, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3870.478, "bar_index": 292}, {"price": 3870.101, "bar_index": 286}, {"price": 3870.097, "bar_index": 284}, {"price": 3870.062, "bar_index": 281}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 101}, {"price": 3816.725, "bar_index": 117}, {"price": 3818.303, "bar_index": 107}, {"price": 3819.23, "bar_index": 111}, {"price": 3819.574, "bar_index": 113}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 266, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 264, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.48, "bottom": 3866.149, "bar_index": 299}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 297}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 276}, {"price": 3870.48, "bar_index": 298}, {"price": 3870.478, "bar_index": 265}, {"price": 3870.309, "bar_index": 263}, {"price": 3870.101, "bar_index": 233}], "swing_lows_SSL": [{"price": 3852.421, "bar_index": 101}, {"price": 3854.566, "bar_index": 105}, {"price": 3855.845, "bar_index": 110}, {"price": 3856.642, "bar_index": 114}, {"price": 3858.866, "bar_index": 120}]}, "fvgs_m1": [{"type": "Bullish", "top": 3869.612, "bottom": 3868.531, "created_at_bar": 299, "lo": 3868.531, "hi": 3869.612}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 285, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3852.421, "equilibrium": 3862.091, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 297}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 294}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 288}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.797, "spread_points": 37, "atr_m5_pips": 328.52346473606804, "ticks_per_min": 182, "pdh_pdl_distance_pips": {"PDH": 35735.000000000124, "PDL": 105800.00000000017}, "eq50_d_distance_pips": 51918.00000000012, "session_active": null, "mins_to_next_killzone": 27}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:33:11", "message": "Context+MT5 xong trong 0.59s"}
{"stage": "status_update", "t": "2025-09-30 13:33:12", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:33:12", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:33:50", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:33:50", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:33:50", "message": "Đã lưu thành công file: ctx_20250930_133350.json"}
{"stage": "run-end", "t": "2025-09-30 13:33:50"}
{"stage": "status_update", "t": "2025-09-30 13:33:50", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:33:50", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:34:20", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:34:20", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:34:20", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:34:20", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:34:25", "message": "Upload xong 4 ảnh trong 4.66s"}
{"stage": "run-start", "t": "2025-09-30 13:34:25", "cycle": "2025-09-30 13:34:25", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:33:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:32:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:32:00) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:34:25Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 200}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:34:25", "broker_time": "2025-09-30T06:34:25Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.704, "ask": 3869.741, "last": 0.0, "time": 1759214065}, "tick_stats_5m": {"ticks_per_min": 200, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 259, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9809119928733178, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.28523464736068, "M1": 1.5123131276802537, "M15": 4.966727194809575, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.300923626052, "ema200": 3863.9853564738323}, "M5": {"ema50": 3861.4258882806507, "ema200": 3841.875251992132}, "M15": {"ema50": 3847.1153650556844, "ema200": 3808.2338166699806}, "H1": {"ema50": 3809.723553289657, "ema200": 3748.837253779097}}}, "vwap": {"day": 3858.689724934598, "asia": 3848.15962288182, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 26, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35642.00000000028}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105707.00000000033}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 51825.00000000027}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102784.0000000001}], "round_levels": [{"level": "7000", "price": 3869.7, "distance_pips": 0.4}, {"level": "7025", "price": 3869.703, "distance_pips": 0.15}, {"level": "7050", "price": 3869.705, "distance_pips": 0.1}, {"level": "7075", "price": 3869.708, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.126251363187484}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3870.48, "bottom": 3866.149, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3870.478, "bar_index": 292}, {"price": 3870.101, "bar_index": 286}, {"price": 3870.097, "bar_index": 284}, {"price": 3870.062, "bar_index": 281}], "swing_lows_SSL": [{"price": 3809.251, "bar_index": 101}, {"price": 3816.725, "bar_index": 117}, {"price": 3818.303, "bar_index": 107}, {"price": 3819.23, "bar_index": 111}, {"price": 3819.574, "bar_index": 113}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 266, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 264, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.48, "bottom": 3866.149, "bar_index": 299}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 297}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 275}, {"price": 3870.48, "bar_index": 297}, {"price": 3870.478, "bar_index": 264}, {"price": 3870.309, "bar_index": 262}, {"price": 3870.101, "bar_index": 232}], "swing_lows_SSL": [{"price": 3854.566, "bar_index": 104}, {"price": 3855.845, "bar_index": 109}, {"price": 3856.642, "bar_index": 113}, {"price": 3858.866, "bar_index": 119}, {"price": 3859.154, "bar_index": 124}]}, "fvgs_m1": [{"type": "Bullish", "top": 3869.612, "bottom": 3868.531, "created_at_bar": 298, "lo": 3868.531, "hi": 3869.612}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 284, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3852.421, "equilibrium": 3862.091, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 296}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 293}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 287}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.704, "spread_points": 37, "atr_m5_pips": 328.52346473606804, "ticks_per_min": 200, "pdh_pdl_distance_pips": {"PDH": 35642.00000000028, "PDL": 105707.00000000033}, "eq50_d_distance_pips": 51825.00000000027, "session_active": null, "mins_to_next_killzone": 26}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:34:25", "message": "Context+MT5 xong trong 0.38s"}
{"stage": "status_update", "t": "2025-09-30 13:34:26", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:34:26", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:35:04", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:35:04", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:35:04", "message": "Đã lưu thành công file: ctx_20250930_133504.json"}
{"stage": "run-end", "t": "2025-09-30 13:35:05"}
{"stage": "status_update", "t": "2025-09-30 13:35:05", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:35:05", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:35:35", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:35:35", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:35:35", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:35:35", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:35:39", "message": "Upload xong 4 ảnh trong 4.70s"}
{"stage": "run-start", "t": "2025-09-30 13:35:39", "cycle": "2025-09-30 13:35:39", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:35:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:33:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:32:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:35:39Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 225}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:35:39", "broker_time": "2025-09-30T06:35:39Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3870.641, "ask": 3870.678, "last": 0.0, "time": 1759214139}, "tick_stats_5m": {"ticks_per_min": 225, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 259, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9896069188226134, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.114386254245309, "M1": 1.4872040266979698, "M15": 5.015727194809586, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.463179913586, "ema200": 3864.062297389842}, "M5": {"ema50": 3861.8185306210553, "ema200": 3842.111405457039}, "M15": {"ema50": 3847.1566199576455, "ema200": 3808.244284331672}, "H1": {"ema50": 3809.7634356425983, "ema200": 3748.847373182082}}}, "vwap": {"day": 3858.814040665257, "asia": 3848.174779171749, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 25, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 36579.000000000175}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 106644.00000000023}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 52762.00000000017}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 103721.0}], "round_levels": [{"level": "6400", "price": 3870.64, "distance_pips": 0.1}, {"level": "6425", "price": 3870.642, "distance_pips": 0.15}, {"level": "6450", "price": 3870.645, "distance_pips": 0.4}, {"level": "6475", "price": 3870.648, "distance_pips": 0.65}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1880350405917517}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3871.166, "bottom": 3866.149, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3870.478, "bar_index": 291}, {"price": 3870.101, "bar_index": 285}, {"price": 3870.097, "bar_index": 283}, {"price": 3870.062, "bar_index": 280}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 116}, {"price": 3818.303, "bar_index": 106}, {"price": 3819.23, "bar_index": 110}, {"price": 3819.574, "bar_index": 112}, {"price": 3820.97, "bar_index": 130}]}, "fvgs_m5": [{"type": "Bullish", "top": 3870.372, "bottom": 3866.631, "created_at_bar": 299, "lo": 3866.631, "hi": 3870.372}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 263, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.587, "bottom": 3866.149, "bar_index": 298}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 296}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 282}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 274}, {"price": 3870.48, "bar_index": 296}, {"price": 3870.478, "bar_index": 263}, {"price": 3870.309, "bar_index": 261}, {"price": 3870.101, "bar_index": 231}], "swing_lows_SSL": [{"price": 3854.566, "bar_index": 103}, {"price": 3855.845, "bar_index": 108}, {"price": 3856.642, "bar_index": 112}, {"price": 3858.866, "bar_index": 118}, {"price": 3859.154, "bar_index": 123}]}, "fvgs_m1": [{"type": "Bullish", "top": 3870.372, "bottom": 3870.313, "created_at_bar": 299, "lo": 3870.313, "hi": 3870.372}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 283, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3852.511, "equilibrium": 3862.136, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 295}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 292}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 286}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3870.641, "spread_points": 37, "atr_m5_pips": 311.43862542453087, "ticks_per_min": 225, "pdh_pdl_distance_pips": {"PDH": 36579.000000000175, "PDL": 106644.00000000023}, "eq50_d_distance_pips": 52762.00000000017, "session_active": null, "mins_to_next_killzone": 25}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:35:40", "message": "Context+MT5 xong trong 0.36s"}
{"stage": "status_update", "t": "2025-09-30 13:35:40", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:35:40", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:36:38", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:36:38", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:36:38", "message": "Đã lưu thành công file: ctx_20250930_133638.json"}
{"stage": "run-end", "t": "2025-09-30 13:36:39"}
{"stage": "status_update", "t": "2025-09-30 13:36:39", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:36:39", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:37:09", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:37:09", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:37:09", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:37:09", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:37:16", "message": "Upload xong 4 ảnh trong 7.50s"}
{"stage": "run-start", "t": "2025-09-30 13:37:51", "cycle": "2025-09-30 13:37:51", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:36:38) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:35:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:33:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:37:51Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 221}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:37:51", "broker_time": "2025-09-30T06:37:51Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3870.943, "ask": 3870.98, "last": 0.0, "time": 1759214218}, "tick_stats_5m": {"ticks_per_min": 221, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 257, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9924093389258031, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.176029111388121, "M1": 1.455505002590098, "M15": 5.036655766238133, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.7187025909034, "ema200": 3864.1434230372834}, "M5": {"ema50": 3861.818412973996, "ema200": 3842.1113756062928}, "M15": {"ema50": 3847.1565023105863, "ema200": 3808.244254480926}, "H1": {"ema50": 3809.763317995539, "ema200": 3748.8473433313357}}}, "vwap": {"day": 3859.0302749801895, "asia": 3848.0647418411436, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 23, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 36881.00000000031}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 106946.00000000036}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 53064.000000000306}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 104023.00000000013}], "round_levels": [{"level": "9400", "price": 3870.94, "distance_pips": 0.3}, {"level": "9425", "price": 3870.943, "distance_pips": 0.05}, {"level": "9450", "price": 3870.945, "distance_pips": 0.2}, {"level": "9475", "price": 3870.948, "distance_pips": 0.45}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1649767272956733}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3871.459, "bottom": 3866.149, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3870.478, "bar_index": 291}, {"price": 3870.101, "bar_index": 285}, {"price": 3870.097, "bar_index": 283}, {"price": 3870.062, "bar_index": 280}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 116}, {"price": 3818.303, "bar_index": 106}, {"price": 3819.23, "bar_index": 110}, {"price": 3819.574, "bar_index": 112}, {"price": 3820.97, "bar_index": 130}]}, "fvgs_m5": [{"type": "Bullish", "top": 3869.802, "bottom": 3866.631, "created_at_bar": 299, "lo": 3866.631, "hi": 3869.802}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 263, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.587, "bottom": 3866.149, "bar_index": 298}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 296}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 282}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 272}, {"price": 3871.166, "bar_index": 297}, {"price": 3870.48, "bar_index": 294}, {"price": 3870.478, "bar_index": 261}, {"price": 3870.309, "bar_index": 259}], "swing_lows_SSL": [{"price": 3854.566, "bar_index": 101}, {"price": 3855.845, "bar_index": 106}, {"price": 3856.642, "bar_index": 110}, {"price": 3858.866, "bar_index": 116}, {"price": 3859.154, "bar_index": 121}]}, "fvgs_m1": [{"type": "Bullish", "top": 3869.612, "bottom": 3868.531, "created_at_bar": 295, "lo": 3868.531, "hi": 3869.612}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 281, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3854.566, "equilibrium": 3863.1634999999997, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 293}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 290}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 284}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3870.943, "spread_points": 37, "atr_m5_pips": 317.6029111388121, "ticks_per_min": 221, "pdh_pdl_distance_pips": {"PDH": 36881.00000000031, "PDL": 106946.00000000036}, "eq50_d_distance_pips": 53064.000000000306, "session_active": null, "mins_to_next_killzone": 23}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:37:51", "message": "Context+MT5 xong trong 34.87s"}
{"stage": "status_update", "t": "2025-09-30 13:37:52", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:37:52", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:38:31", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:38:31", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:38:31", "message": "Đã lưu thành công file: ctx_20250930_133831.json"}
{"stage": "run-end", "t": "2025-09-30 13:38:31"}
{"stage": "status_update", "t": "2025-09-30 13:38:31", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:38:31", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:39:01", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:39:01", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:39:01", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:39:01", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:39:05", "message": "Upload xong 4 ảnh trong 4.12s"}
{"stage": "run-start", "t": "2025-09-30 13:39:05", "cycle": "2025-09-30 13:39:05", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:38:31) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:36:38) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:35:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:39:05Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 224}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": true, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:39:05", "broker_time": "2025-09-30T06:39:05Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.279, "ask": 3869.356, "last": 0.0, "time": 1759214345}, "tick_stats_5m": {"ticks_per_min": 224, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 262, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9769681897479681, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.271886254245271, "M1": 1.5251242113892431, "M15": 5.036655766238133, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.8193589333137, "ema200": 3864.314866762184}, "M5": {"ema50": 3861.765118856349, "ema200": 3842.097853218233}, "M15": {"ema50": 3847.1032081929393, "ema200": 3808.230732092866}, "H1": {"ema50": 3809.710023877892, "ema200": 3748.833820943276}}}, "vwap": {"day": 3859.2224882346563, "asia": 3848.1276727477466, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 21, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35217.000000000095}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105282.00000000015}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 51400.00000000009}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102358.99999999993}], "round_levels": [{"level": "2700", "price": 3869.27, "distance_pips": 0.9}, {"level": "2725", "price": 3869.273, "distance_pips": 0.65}, {"level": "2750", "price": 3869.275, "distance_pips": 0.4}, {"level": "2775", "price": 3869.278, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 2.353382545017208}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3870.478, "bar_index": 291}, {"price": 3870.101, "bar_index": 285}, {"price": 3870.097, "bar_index": 283}, {"price": 3870.062, "bar_index": 280}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 116}, {"price": 3818.303, "bar_index": 106}, {"price": 3819.23, "bar_index": 110}, {"price": 3819.574, "bar_index": 112}, {"price": 3820.97, "bar_index": 130}]}, "fvgs_m5": [{"type": "Bullish", "top": 3868.46, "bottom": 3866.631, "created_at_bar": 299, "lo": 3866.631, "hi": 3868.46}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 263, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.587, "bottom": 3866.149, "bar_index": 298}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 296}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 282}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 270}, {"price": 3871.459, "bar_index": 297}, {"price": 3871.166, "bar_index": 295}, {"price": 3870.48, "bar_index": 292}, {"price": 3870.478, "bar_index": 259}], "swing_lows_SSL": [{"price": 3855.845, "bar_index": 104}, {"price": 3856.642, "bar_index": 108}, {"price": 3858.866, "bar_index": 114}, {"price": 3859.154, "bar_index": 119}, {"price": 3862.04, "bar_index": 158}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.017, "bottom": 3867.137, "created_at_bar": 292, "lo": 3867.137, "hi": 3868.017}, {"type": "Bearish", "top": 3870.258, "bottom": 3869.791, "created_at_bar": 299, "lo": 3869.791, "hi": 3870.258}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 279, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3854.778, "equilibrium": 3863.2695, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 291}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 288}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 282}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.279, "spread_points": 77, "atr_m5_pips": 327.18862542452706, "ticks_per_min": 224, "pdh_pdl_distance_pips": {"PDH": 35217.000000000095, "PDL": 105282.00000000015}, "eq50_d_distance_pips": 51400.00000000009, "session_active": null, "mins_to_next_killzone": 21}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:39:05", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "no-trade", "t": "2025-09-30 13:39:06", "reasons": ["Spread cao (cur=77, p90=37, factor=1.2)"]}
{"stage": "status_update", "t": "2025-09-30 13:39:06", "message": "Lỗi nghiêm trọng trong worker: 'TradingToolApp' object has no attribute '_auto_save_report'"}
{"stage": "status_update", "t": "2025-09-30 13:39:06", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:39:06", "message": "Đã lưu thành công file: ctx_20250930_133906.json"}
{"stage": "run-end", "t": "2025-09-30 13:39:07"}
{"stage": "status_update", "t": "2025-09-30 13:39:07", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:39:07", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:39:37", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:39:37", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:39:37", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:39:37", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:39:41", "message": "Upload xong 4 ảnh trong 4.03s"}
{"stage": "run-start", "t": "2025-09-30 13:39:41", "cycle": "2025-09-30 13:39:41", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:39:06) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:38:31) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:36:38) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:39:41Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 222}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:39:41", "broker_time": "2025-09-30T06:39:41Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.5, "ask": 3869.537, "last": 0.0, "time": 1759214381}, "tick_stats_5m": {"ticks_per_min": 222, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 263, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9790189673731491, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.271886254245271, "M1": 1.5251242113892431, "M15": 5.036655766238133, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.828260894098, "ema200": 3864.3171254686517}, "M5": {"ema50": 3861.7740208171335, "ema200": 3842.1001119247007}, "M15": {"ema50": 3847.1121101537237, "ema200": 3808.232990799334}, "H1": {"ema50": 3809.7189258386766, "ema200": 3748.8360796497436}}}, "vwap": {"day": 3859.244910461936, "asia": 3848.1276727477466, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 21, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35438.0000000001}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105503.00000000016}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 51621.000000000095}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102579.99999999993}], "round_levels": [{"level": "5000", "price": 3869.5, "distance_pips": 0.0}, {"level": "5025", "price": 3869.503, "distance_pips": 0.25}, {"level": "5050", "price": 3869.505, "distance_pips": 0.5}, {"level": "5075", "price": 3869.508, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1308461579860762}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3870.478, "bar_index": 291}, {"price": 3870.101, "bar_index": 285}, {"price": 3870.097, "bar_index": 283}, {"price": 3870.062, "bar_index": 280}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 116}, {"price": 3818.303, "bar_index": 106}, {"price": 3819.23, "bar_index": 110}, {"price": 3819.574, "bar_index": 112}, {"price": 3820.97, "bar_index": 130}]}, "fvgs_m5": [{"type": "Bullish", "top": 3868.46, "bottom": 3866.631, "created_at_bar": 299, "lo": 3866.631, "hi": 3868.46}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 263, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.251, "equilibrium": 3840.5060000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.587, "bottom": 3866.149, "bar_index": 298}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 296}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 282}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 270}, {"price": 3871.459, "bar_index": 297}, {"price": 3871.166, "bar_index": 295}, {"price": 3870.48, "bar_index": 292}, {"price": 3870.478, "bar_index": 259}], "swing_lows_SSL": [{"price": 3855.845, "bar_index": 104}, {"price": 3856.642, "bar_index": 108}, {"price": 3858.866, "bar_index": 114}, {"price": 3859.154, "bar_index": 119}, {"price": 3862.04, "bar_index": 158}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.017, "bottom": 3867.137, "created_at_bar": 292, "lo": 3867.137, "hi": 3868.017}, {"type": "Bearish", "top": 3870.258, "bottom": 3869.791, "created_at_bar": 299, "lo": 3869.791, "hi": 3870.258}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 279, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3854.778, "equilibrium": 3863.2695, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 291}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 288}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 282}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.5, "spread_points": 37, "atr_m5_pips": 327.18862542452706, "ticks_per_min": 222, "pdh_pdl_distance_pips": {"PDH": 35438.0000000001, "PDL": 105503.00000000016}, "eq50_d_distance_pips": 51621.000000000095, "session_active": null, "mins_to_next_killzone": 21}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:39:41", "message": "Context+MT5 xong trong 0.22s"}
{"stage": "status_update", "t": "2025-09-30 13:39:42", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:39:42", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:40:21", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:40:21", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:40:21", "message": "Đã lưu thành công file: ctx_20250930_134021.json"}
{"stage": "run-end", "t": "2025-09-30 13:40:21"}
{"stage": "status_update", "t": "2025-09-30 13:40:21", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:40:21", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:40:51", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:40:51", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:40:51", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:40:51", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:40:55", "message": "Upload xong 4 ảnh trong 4.55s"}
{"stage": "run-start", "t": "2025-09-30 13:40:56", "cycle": "2025-09-30 13:40:56", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:40:21) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:39:06) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:38:31) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:40:56Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 228}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:40:56", "broker_time": "2025-09-30T06:40:56Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3868.998, "ask": 3869.035, "last": 0.0, "time": 1759214456}, "tick_stats_5m": {"ticks_per_min": 228, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 261, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9743606399168562, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.1248229503676463, "M1": 1.524982686074382, "M15": 5.036655766238133, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.8657741229886, "ema200": 3864.4068194586207}, "M5": {"ema50": 3862.0489550292123, "ema200": 3842.409277579694}, "M15": {"ema50": 3847.092188585096, "ema200": 3808.227936072966}, "H1": {"ema50": 3809.699004270049, "ema200": 3748.8310249233755}}}, "vwap": {"day": 3859.3485132981123, "asia": 3848.106418587896, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 20, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 34936.000000000146}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105001.0000000002}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 51119.00000000014}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102077.99999999997}], "round_levels": [{"level": "9900", "price": 3868.99, "distance_pips": 0.8}, {"level": "9925", "price": 3868.993, "distance_pips": 0.55}, {"level": "9950", "price": 3868.995, "distance_pips": 0.3}, {"level": "9975", "price": 3868.998, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1840670843592598}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.478, "bar_index": 290}, {"price": 3870.101, "bar_index": 284}, {"price": 3870.097, "bar_index": 282}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 115}, {"price": 3818.303, "bar_index": 105}, {"price": 3819.23, "bar_index": 109}, {"price": 3819.574, "bar_index": 111}, {"price": 3820.97, "bar_index": 129}]}, "fvgs_m5": [{"type": "Bullish", "top": 3868.46, "bottom": 3866.631, "created_at_bar": 298, "lo": 3866.631, "hi": 3868.46}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 262, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.938, "equilibrium": 3840.8495000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.587, "bottom": 3866.149, "bar_index": 297}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 295}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 281}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 269}, {"price": 3871.459, "bar_index": 296}, {"price": 3871.166, "bar_index": 294}, {"price": 3870.48, "bar_index": 291}, {"price": 3870.478, "bar_index": 258}], "swing_lows_SSL": [{"price": 3855.845, "bar_index": 103}, {"price": 3856.642, "bar_index": 107}, {"price": 3858.866, "bar_index": 113}, {"price": 3859.154, "bar_index": 118}, {"price": 3862.04, "bar_index": 157}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.017, "bottom": 3867.137, "created_at_bar": 291, "lo": 3867.137, "hi": 3868.017}, {"type": "Bearish", "top": 3870.258, "bottom": 3870.125, "created_at_bar": 298, "lo": 3870.125, "hi": 3870.258}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 278, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3855.195, "equilibrium": 3863.478, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 290}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 287}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 281}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3868.998, "spread_points": 37, "atr_m5_pips": 312.48229503676464, "ticks_per_min": 228, "pdh_pdl_distance_pips": {"PDH": 34936.000000000146, "PDL": 105001.0000000002}, "eq50_d_distance_pips": 51119.00000000014, "session_active": null, "mins_to_next_killzone": 20}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:40:56", "message": "Context+MT5 xong trong 0.41s"}
{"stage": "status_update", "t": "2025-09-30 13:40:57", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:40:57", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:41:35", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:41:35", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:41:35", "message": "Đã lưu thành công file: ctx_20250930_134135.json"}
{"stage": "run-end", "t": "2025-09-30 13:41:35"}
{"stage": "status_update", "t": "2025-09-30 13:41:35", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:41:35", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:42:06", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:42:06", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:42:06", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:42:06", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:42:15", "message": "Upload xong 4 ảnh trong 9.03s"}
{"stage": "run-start", "t": "2025-09-30 13:42:15", "cycle": "2025-09-30 13:42:15", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:41:35) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:40:21) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:39:06) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:42:15Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 238}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:42:15", "broker_time": "2025-09-30T06:42:15Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.528, "ask": 3869.565, "last": 0.0, "time": 1759214534}, "tick_stats_5m": {"ticks_per_min": 238, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 259, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9792787944025818, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.1856800932247795, "M1": 1.4803626221821056, "M15": 5.036655766238133, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.984832166671, "ema200": 3864.497149334675}, "M5": {"ema50": 3862.0697393429377, "ema200": 3842.4145512115347}, "M15": {"ema50": 3847.1129728988217, "ema200": 3808.2332097048065}, "H1": {"ema50": 3809.7197885837745, "ema200": 3748.836298555216}}}, "vwap": {"day": 3859.50049518891, "asia": 3847.877684522157, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 18, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35465.99999999989}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105530.99999999994}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 51648.99999999988}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102607.99999999972}], "round_levels": [{"level": "5200", "price": 3869.52, "distance_pips": 0.8}, {"level": "5225", "price": 3869.523, "distance_pips": 0.55}, {"level": "5250", "price": 3869.525, "distance_pips": 0.3}, {"level": "5275", "price": 3869.528, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.161447443481615}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.478, "bar_index": 290}, {"price": 3870.101, "bar_index": 284}, {"price": 3870.097, "bar_index": 282}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 115}, {"price": 3818.303, "bar_index": 105}, {"price": 3819.23, "bar_index": 109}, {"price": 3819.574, "bar_index": 111}, {"price": 3820.97, "bar_index": 129}]}, "fvgs_m5": [{"type": "Bullish", "top": 3868.46, "bottom": 3866.631, "created_at_bar": 298, "lo": 3866.631, "hi": 3868.46}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 262, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.938, "equilibrium": 3840.8495000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.587, "bottom": 3866.149, "bar_index": 297}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 295}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 281}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 267}, {"price": 3871.459, "bar_index": 294}, {"price": 3871.166, "bar_index": 292}, {"price": 3870.48, "bar_index": 289}, {"price": 3870.478, "bar_index": 256}], "swing_lows_SSL": [{"price": 3855.845, "bar_index": 101}, {"price": 3856.642, "bar_index": 105}, {"price": 3858.866, "bar_index": 111}, {"price": 3859.154, "bar_index": 116}, {"price": 3862.04, "bar_index": 155}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.017, "bottom": 3867.137, "created_at_bar": 289, "lo": 3867.137, "hi": 3868.017}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 276, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3855.845, "equilibrium": 3863.803, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 288}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 285}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 279}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.528, "spread_points": 37, "atr_m5_pips": 318.56800932247796, "ticks_per_min": 238, "pdh_pdl_distance_pips": {"PDH": 35465.99999999989, "PDL": 105530.99999999994}, "eq50_d_distance_pips": 51648.99999999988, "session_active": null, "mins_to_next_killzone": 18}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:42:15", "message": "Context+MT5 xong trong 0.16s"}
{"stage": "status_update", "t": "2025-09-30 13:42:16", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:42:16", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:42:54", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:42:54", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:42:54", "message": "Đã lưu thành công file: ctx_20250930_134254.json"}
{"stage": "run-end", "t": "2025-09-30 13:42:54"}
{"stage": "status_update", "t": "2025-09-30 13:42:54", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:42:54", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:43:24", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:43:24", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:43:24", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:43:24", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:43:28", "message": "Upload xong 4 ảnh trong 4.19s"}
{"stage": "run-start", "t": "2025-09-30 13:43:29", "cycle": "2025-09-30 13:43:29", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:42:54) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:41:35) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:40:21) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:43:29Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 221}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:43:29", "broker_time": "2025-09-30T06:43:29Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3870.619, "ask": 3870.656, "last": 0.0, "time": 1759214609}, "tick_stats_5m": {"ticks_per_min": 221, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 256, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9894027690137724, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.2429658075105032, "M1": 1.5067857001866436, "M15": 5.036655766238133, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.114762518483, "ema200": 3864.4955270893784}, "M5": {"ema50": 3862.112523656663, "ema200": 3842.4254069329277}, "M15": {"ema50": 3847.1557572125475, "ema200": 3808.2440654261995}, "H1": {"ema50": 3809.7625728975, "ema200": 3748.847154276609}}}, "vwap": {"day": 3859.5844110151334, "asia": 3847.7966982074636, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 17, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 36557.00000000024}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 106622.00000000029}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 52740.00000000023}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 103699.00000000007}], "round_levels": [{"level": "6100", "price": 3870.61, "distance_pips": 0.9}, {"level": "6125", "price": 3870.613, "distance_pips": 0.65}, {"level": "6150", "price": 3870.615, "distance_pips": 0.4}, {"level": "6175", "price": 3870.618, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1409309316218361}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3871.459, "bottom": 3866.149, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.478, "bar_index": 290}, {"price": 3870.101, "bar_index": 284}, {"price": 3870.097, "bar_index": 282}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 115}, {"price": 3818.303, "bar_index": 105}, {"price": 3819.23, "bar_index": 109}, {"price": 3819.574, "bar_index": 111}, {"price": 3820.97, "bar_index": 129}]}, "fvgs_m5": [{"type": "Bullish", "top": 3868.46, "bottom": 3866.631, "created_at_bar": 298, "lo": 3866.631, "hi": 3868.46}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 262, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.938, "equilibrium": 3840.8495000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.587, "bottom": 3866.149, "bar_index": 297}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 295}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 281}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 266}, {"price": 3871.459, "bar_index": 293}, {"price": 3871.166, "bar_index": 291}, {"price": 3870.48, "bar_index": 288}, {"price": 3870.478, "bar_index": 255}], "swing_lows_SSL": [{"price": 3856.642, "bar_index": 104}, {"price": 3858.866, "bar_index": 110}, {"price": 3859.154, "bar_index": 115}, {"price": 3862.04, "bar_index": 154}, {"price": 3862.069, "bar_index": 151}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.017, "bottom": 3867.137, "created_at_bar": 288, "lo": 3867.137, "hi": 3868.017}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 275, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3855.845, "equilibrium": 3863.803, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 287}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 284}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 278}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3870.619, "spread_points": 37, "atr_m5_pips": 324.2965807510503, "ticks_per_min": 221, "pdh_pdl_distance_pips": {"PDH": 36557.00000000024, "PDL": 106622.00000000029}, "eq50_d_distance_pips": 52740.00000000023, "session_active": null, "mins_to_next_killzone": 17}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:43:29", "message": "Context+MT5 xong trong 0.53s"}
{"stage": "status_update", "t": "2025-09-30 13:43:30", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:43:30", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:44:09", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:44:09", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:44:09", "message": "Đã lưu thành công file: ctx_20250930_134409.json"}
{"stage": "run-end", "t": "2025-09-30 13:44:09"}
{"stage": "status_update", "t": "2025-09-30 13:44:09", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:44:09", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:44:39", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:44:39", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:44:39", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:44:39", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:44:43", "message": "Upload xong 4 ảnh trong 4.19s"}
{"stage": "run-start", "t": "2025-09-30 13:44:44", "cycle": "2025-09-30 13:44:44", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:44:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:42:54) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:41:35) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:44:43Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 210}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:44:43", "broker_time": "2025-09-30T06:44:43Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.609, "ask": 3869.646, "last": 0.0, "time": 1759214684}, "tick_stats_5m": {"ticks_per_min": 210, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 254, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9800304368805905, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.2429658075105032, "M1": 1.5200867216053577, "M15": 5.036655766238133, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.188897734944, "ema200": 3864.511392919823}, "M5": {"ema50": 3862.0724452252907, "ema200": 3842.4152377786986}, "M15": {"ema50": 3847.1156787811747, "ema200": 3808.2338962719705}, "H1": {"ema50": 3809.7224944661275, "ema200": 3748.83698512238}}}, "vwap": {"day": 3859.6714225497294, "asia": 3847.745560831781, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 16, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35547.00000000002}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105612.00000000007}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 51730.000000000015}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102688.99999999985}], "round_levels": [{"level": "6000", "price": 3869.6, "distance_pips": 0.9}, {"level": "6025", "price": 3869.602, "distance_pips": 0.65}, {"level": "6050", "price": 3869.605, "distance_pips": 0.4}, {"level": "6075", "price": 3869.608, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.140930931635859}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3870.101, "bar_index": 294}, {"price": 3867.242, "bar_index": 288}, {"price": 3852.113, "bar_index": 281}, {"price": 3850.722, "bar_index": 279}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 102}, {"price": 3739.268, "bar_index": 117}, {"price": 3741.553, "bar_index": 113}, {"price": 3742.965, "bar_index": 132}, {"price": 3744.591, "bar_index": 110}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 288, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 284, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 287}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 272}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.478, "bar_index": 290}, {"price": 3870.101, "bar_index": 284}, {"price": 3870.097, "bar_index": 282}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 115}, {"price": 3818.303, "bar_index": 105}, {"price": 3819.23, "bar_index": 109}, {"price": 3819.574, "bar_index": 111}, {"price": 3820.97, "bar_index": 129}]}, "fvgs_m5": [{"type": "Bullish", "top": 3868.46, "bottom": 3866.631, "created_at_bar": 298, "lo": 3866.631, "hi": 3868.46}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 262, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3809.938, "equilibrium": 3840.8495000000003, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.587, "bottom": 3866.149, "bar_index": 297}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 295}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 281}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 265}, {"price": 3871.459, "bar_index": 292}, {"price": 3871.268, "bar_index": 298}, {"price": 3871.166, "bar_index": 290}, {"price": 3870.48, "bar_index": 287}], "swing_lows_SSL": [{"price": 3856.642, "bar_index": 103}, {"price": 3858.866, "bar_index": 109}, {"price": 3859.154, "bar_index": 114}, {"price": 3862.04, "bar_index": 153}, {"price": 3862.069, "bar_index": 150}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.017, "bottom": 3867.137, "created_at_bar": 287, "lo": 3867.137, "hi": 3868.017}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 274, "lo": 3862.078, "hi": 3863.505, "type": "bull"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3855.846, "equilibrium": 3863.8035, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3871.202, "bottom": 3869.509, "bar_index": 299}, {"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 286}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 283}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.609, "spread_points": 37, "atr_m5_pips": 324.2965807510503, "ticks_per_min": 210, "pdh_pdl_distance_pips": {"PDH": 35547.00000000002, "PDL": 105612.00000000007}, "eq50_d_distance_pips": 51730.000000000015, "session_active": null, "mins_to_next_killzone": 16}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:44:44", "message": "Context+MT5 xong trong 0.95s"}
{"stage": "status_update", "t": "2025-09-30 13:44:45", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:44:45", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:45:24", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:45:24", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:45:24", "message": "Đã lưu thành công file: ctx_20250930_134524.json"}
{"stage": "run-end", "t": "2025-09-30 13:45:24"}
{"stage": "status_update", "t": "2025-09-30 13:45:24", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:45:24", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:45:54", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:45:54", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:45:54", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:45:54", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:45:58", "message": "Upload xong 4 ảnh trong 3.70s"}
{"stage": "run-start", "t": "2025-09-30 13:45:58", "cycle": "2025-09-30 13:45:58", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:45:24) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:44:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:42:54) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:45:58Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 184}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:45:58", "broker_time": "2025-09-30T06:45:58Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.386, "ask": 3869.423, "last": 0.0, "time": 1759214758}, "tick_stats_5m": {"ticks_per_min": 184, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 245, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.977961100181879, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.0759682498925724, "M1": 1.476151955733731, "M15": 4.741537497024797, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.2511864179605, "ema200": 3864.6339047961746}, "M5": {"ema50": 3862.374601661553, "ema200": 3842.813372017793}, "M15": {"ema50": 3848.0043128016914, "ema200": 3808.4667176797943}, "H1": {"ema50": 3809.7142199563236, "ema200": 3748.8348856198927}}}, "vwap": {"day": 3859.760030461824, "asia": 3847.725376692842, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 15, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35324.000000000065}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105389.00000000012}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 51507.00000000006}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102465.9999999999}], "round_levels": [{"level": "3800", "price": 3869.38, "distance_pips": 0.6}, {"level": "3825", "price": 3869.383, "distance_pips": 0.35}, {"level": "3850", "price": 3869.385, "distance_pips": 0.1}, {"level": "3875", "price": 3869.388, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.2028732741665784}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3869.099, "bottom": 3867.349, "created_at_bar": 299, "lo": 3867.349, "hi": 3869.099}], "order_blocks_m15": [{"top": 3867.349, "bottom": 3862.078, "bar_index": 297, "lo": 3862.078, "hi": 3867.349, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.478, "bar_index": 289}, {"price": 3870.101, "bar_index": 283}, {"price": 3870.097, "bar_index": 281}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 114}, {"price": 3818.303, "bar_index": 104}, {"price": 3819.23, "bar_index": 108}, {"price": 3819.574, "bar_index": 110}, {"price": 3820.97, "bar_index": 128}]}, "fvgs_m5": [{"type": "Bullish", "top": 3868.46, "bottom": 3866.631, "created_at_bar": 297, "lo": 3866.631, "hi": 3868.46}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 261, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3813.154, "equilibrium": 3842.4575, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.587, "bottom": 3866.149, "bar_index": 296}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 294}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 280}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 264}, {"price": 3871.459, "bar_index": 291}, {"price": 3871.268, "bar_index": 297}, {"price": 3871.166, "bar_index": 289}, {"price": 3870.48, "bar_index": 286}], "swing_lows_SSL": [{"price": 3856.642, "bar_index": 102}, {"price": 3858.866, "bar_index": 108}, {"price": 3859.154, "bar_index": 113}, {"price": 3862.04, "bar_index": 152}, {"price": 3862.069, "bar_index": 149}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.017, "bottom": 3867.137, "created_at_bar": 286, "lo": 3867.137, "hi": 3868.017}, {"type": "Bearish", "top": 3870.233, "bottom": 3869.909, "created_at_bar": 299, "lo": 3869.909, "hi": 3870.233}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 273, "lo": 3862.078, "hi": 3863.505, "type": "bull"}, {"top": 3871.268, "bottom": 3870.233, "bar_index": 297, "lo": 3870.233, "hi": 3871.268, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3856.642, "equilibrium": 3864.2015, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 285}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 282}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 276}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.386, "spread_points": 37, "atr_m5_pips": 307.59682498925724, "ticks_per_min": 184, "pdh_pdl_distance_pips": {"PDH": 35324.000000000065, "PDL": 105389.00000000012}, "eq50_d_distance_pips": 51507.00000000006, "session_active": null, "mins_to_next_killzone": 15}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:45:58", "message": "Context+MT5 xong trong 0.16s"}
{"stage": "status_update", "t": "2025-09-30 13:45:58", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:45:58", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:46:37", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:46:37", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:46:37", "message": "Đã lưu thành công file: ctx_20250930_134637.json"}
{"stage": "run-end", "t": "2025-09-30 13:46:37"}
{"stage": "status_update", "t": "2025-09-30 13:46:37", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:46:37", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:47:07", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:47:07", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:47:07", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:47:07", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:47:11", "message": "Upload xong 4 ảnh trong 3.84s"}
{"stage": "run-start", "t": "2025-09-30 13:47:11", "cycle": "2025-09-30 13:47:11", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:46:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:45:24) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:44:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:47:11Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 151}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:47:11", "broker_time": "2025-09-30T06:47:11Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3869.344, "ask": 3869.381, "last": 0.0, "time": 1759214830}, "tick_stats_5m": {"ticks_per_min": 151, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 235, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9775713596377277, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.106253964178285, "M1": 1.3740851046532658, "M15": 4.771823211310511, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.3426047008156, "ema200": 3864.61504005824}, "M5": {"ema50": 3862.3729546027294, "ema200": 3842.8129541073454}, "M15": {"ema50": 3848.002665742868, "ema200": 3808.4662997693467}, "H1": {"ema50": 3809.7125728975, "ema200": 3748.834467709445}}}, "vwap": {"day": 3859.8827139666378, "asia": 3847.6574534534534, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 13, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 35282.00000000015}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 105347.0000000002}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 51465.000000000146}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 102423.99999999997}], "round_levels": [{"level": "3400", "price": 3869.34, "distance_pips": 0.4}, {"level": "3425", "price": 3869.343, "distance_pips": 0.15}, {"level": "3450", "price": 3869.345, "distance_pips": 0.1}, {"level": "3475", "price": 3869.348, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.1911453611486982}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3868.675, "bottom": 3867.349, "created_at_bar": 299, "lo": 3867.349, "hi": 3868.675}], "order_blocks_m15": [{"top": 3867.349, "bottom": 3862.078, "bar_index": 297, "lo": 3862.078, "hi": 3867.349, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}, {"type": "Bullish", "top": 3831.258, "bottom": 3827.698, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.478, "bar_index": 289}, {"price": 3870.101, "bar_index": 283}, {"price": 3870.097, "bar_index": 281}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 114}, {"price": 3818.303, "bar_index": 104}, {"price": 3819.23, "bar_index": 108}, {"price": 3819.574, "bar_index": 110}, {"price": 3820.97, "bar_index": 128}]}, "fvgs_m5": [{"type": "Bullish", "top": 3868.46, "bottom": 3866.631, "created_at_bar": 297, "lo": 3866.631, "hi": 3868.46}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 261, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3813.154, "equilibrium": 3842.4575, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3870.587, "bottom": 3866.149, "bar_index": 296}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 294}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 280}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 262}, {"price": 3871.459, "bar_index": 289}, {"price": 3871.268, "bar_index": 295}, {"price": 3871.166, "bar_index": 287}, {"price": 3870.48, "bar_index": 284}], "swing_lows_SSL": [{"price": 3858.866, "bar_index": 106}, {"price": 3859.154, "bar_index": 111}, {"price": 3862.04, "bar_index": 150}, {"price": 3862.069, "bar_index": 147}, {"price": 3862.078, "bar_index": 271}]}, "fvgs_m1": [{"type": "Bullish", "top": 3868.017, "bottom": 3867.137, "created_at_bar": 284, "lo": 3867.137, "hi": 3868.017}, {"type": "Bearish", "top": 3870.233, "bottom": 3869.909, "created_at_bar": 297, "lo": 3869.909, "hi": 3870.233}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 271, "lo": 3862.078, "hi": 3863.505, "type": "bull"}, {"top": 3871.268, "bottom": 3870.233, "bar_index": 295, "lo": 3870.233, "hi": 3871.268, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3856.642, "equilibrium": 3864.2015, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 283}, {"type": "Bullish", "top": 3866.373, "bottom": 3864.644, "bar_index": 280}, {"type": "Bullish", "top": 3865.255, "bottom": 3863.419, "bar_index": 274}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3869.344, "spread_points": 37, "atr_m5_pips": 310.6253964178285, "ticks_per_min": 151, "pdh_pdl_distance_pips": {"PDH": 35282.00000000015, "PDL": 105347.0000000002}, "eq50_d_distance_pips": 51465.000000000146, "session_active": null, "mins_to_next_killzone": 13}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:47:11", "message": "Context+MT5 xong trong 0.17s"}
{"stage": "status_update", "t": "2025-09-30 13:47:12", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:47:12", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:47:51", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:47:51", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:47:51", "message": "Đã lưu thành công file: ctx_20250930_134751.json"}
{"stage": "run-end", "t": "2025-09-30 13:47:51"}
{"stage": "status_update", "t": "2025-09-30 13:47:51", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:47:51", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:48:21", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:48:21", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:48:21", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:48:21", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:48:26", "message": "Upload xong 4 ảnh trong 4.71s"}
{"stage": "run-start", "t": "2025-09-30 13:48:26", "cycle": "2025-09-30 13:48:26", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:47:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:46:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:45:24) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:48:26Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 160}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:48:26", "broker_time": "2025-09-30T06:48:26Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3865.17, "ask": 3865.207, "last": 0.0, "time": 1759214906}, "tick_stats_5m": {"ticks_per_min": 160, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 229, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.938838573178428, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.388753964178312, "M1": 1.607109638002782, "M15": 5.054323211310538, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3868.1309292161977, "ema200": 3864.6156694693736}, "M5": {"ema50": 3862.2092683282194, "ema200": 3842.771421769037}, "M15": {"ema50": 3847.838979468358, "ema200": 3808.424767431038}, "H1": {"ema50": 3809.5488866229903, "ema200": 3748.7929353711365}}}, "vwap": {"day": 3859.9696294910877, "asia": 3847.746629847593, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 12, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 31108.000000000175}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 101173.00000000023}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 47291.00000000017}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 98250.0}], "round_levels": [{"level": "1700", "price": 3865.17, "distance_pips": 0.0}, {"level": "1725", "price": 3865.173, "distance_pips": 0.25}, {"level": "1750", "price": 3865.175, "distance_pips": 0.5}, {"level": "1775", "price": 3865.178, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.0918467493044677}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 287, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3867.349, "bottom": 3862.078, "bar_index": 297, "lo": 3862.078, "hi": 3867.349, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3864.72, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.478, "bar_index": 289}, {"price": 3870.101, "bar_index": 283}, {"price": 3870.097, "bar_index": 281}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 114}, {"price": 3818.303, "bar_index": 104}, {"price": 3819.23, "bar_index": 108}, {"price": 3819.574, "bar_index": 110}, {"price": 3820.97, "bar_index": 128}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 263, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 261, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3813.154, "equilibrium": 3842.4575, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3869.909, "bottom": 3864.72, "bar_index": 299}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 294}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 280}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 261}, {"price": 3871.459, "bar_index": 288}, {"price": 3871.268, "bar_index": 294}, {"price": 3871.166, "bar_index": 286}, {"price": 3870.48, "bar_index": 283}], "swing_lows_SSL": [{"price": 3858.866, "bar_index": 105}, {"price": 3859.154, "bar_index": 110}, {"price": 3862.04, "bar_index": 149}, {"price": 3862.069, "bar_index": 146}, {"price": 3862.078, "bar_index": 270}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 114, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3868.675, "bottom": 3867.295, "created_at_bar": 299, "lo": 3867.295, "hi": 3868.675}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 270, "lo": 3862.078, "hi": 3863.505, "type": "bull"}, {"top": 3869.782, "bottom": 3868.675, "bar_index": 297, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3857.389, "equilibrium": 3864.575, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 299}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 298}, {"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 282}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3865.17, "spread_points": 37, "atr_m5_pips": 338.8753964178312, "ticks_per_min": 160, "pdh_pdl_distance_pips": {"PDH": 31108.000000000175, "PDL": 101173.00000000023}, "eq50_d_distance_pips": 47291.00000000017, "session_active": null, "mins_to_next_killzone": 12}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:48:26", "message": "Context+MT5 xong trong 0.18s"}
{"stage": "status_update", "t": "2025-09-30 13:48:27", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:48:27", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:49:06", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:49:06", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:49:06", "message": "Đã lưu thành công file: ctx_20250930_134906.json"}
{"stage": "run-end", "t": "2025-09-30 13:49:06"}
{"stage": "status_update", "t": "2025-09-30 13:49:06", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:49:06", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:49:36", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:49:36", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:49:36", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:49:36", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:49:40", "message": "Upload xong 4 ảnh trong 4.52s"}
{"stage": "run-start", "t": "2025-09-30 13:49:40", "cycle": "2025-09-30 13:49:40", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:49:06) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:47:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:46:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:49:40Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 174}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:49:40", "broker_time": "2025-09-30T06:49:40Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3864.367, "ask": 3864.404, "last": 0.0, "time": 1759214980}, "tick_stats_5m": {"ticks_per_min": 174, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 221, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9313871051557128, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.41818253560687, "M1": 1.5953160924281657, "M15": 5.083751782739095, "H1": 10.781559256507173}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.9806129349354, "ema200": 3864.6253803852564}, "M5": {"ema50": 3862.177778132141, "ema200": 3842.7634317192856}, "M15": {"ema50": 3847.80748927228, "ema200": 3808.416777381287}, "H1": {"ema50": 3809.517396426912, "ema200": 3748.7849453213853}}}, "vwap": {"day": 3860.059285195031, "asia": 3847.866522895623, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 11, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 30305.00000000029}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 100370.00000000035}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 46488.000000000284}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 97447.00000000012}], "round_levels": [{"level": "3600", "price": 3864.36, "distance_pips": 0.7}, {"level": "3625", "price": 3864.363, "distance_pips": 0.45}, {"level": "3650", "price": 3864.365, "distance_pips": 0.2}, {"level": "3675", "price": 3864.368, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.0824465813157091}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3862.04, "bottom": 3852.113, "created_at_bar": 297, "lo": 3852.113, "hi": 3862.04}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3862.708, "bottom": 3859.574, "created_at_bar": 287, "lo": 3859.574, "hi": 3862.708}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 283, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3864.308, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.478, "bar_index": 289}, {"price": 3870.101, "bar_index": 283}, {"price": 3870.097, "bar_index": 281}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 114}, {"price": 3818.303, "bar_index": 104}, {"price": 3819.23, "bar_index": 108}, {"price": 3819.574, "bar_index": 110}, {"price": 3820.97, "bar_index": 128}]}, "fvgs_m5": [{"type": "Bullish", "top": 3862.708, "bottom": 3861.378, "created_at_bar": 263, "lo": 3861.378, "hi": 3862.708}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 261, "lo": 3859.154, "hi": 3861.378, "type": "bull"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3813.154, "equilibrium": 3842.4575, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3869.909, "bottom": 3864.308, "bar_index": 299}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 294}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 280}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 260}, {"price": 3871.459, "bar_index": 287}, {"price": 3871.268, "bar_index": 293}, {"price": 3871.166, "bar_index": 285}, {"price": 3870.48, "bar_index": 282}], "swing_lows_SSL": [{"price": 3858.866, "bar_index": 104}, {"price": 3859.154, "bar_index": 109}, {"price": 3862.04, "bar_index": 148}, {"price": 3862.069, "bar_index": 145}, {"price": 3862.078, "bar_index": 269}]}, "fvgs_m1": [{"type": "Bullish", "top": 3862.604, "bottom": 3861.968, "created_at_bar": 113, "lo": 3861.968, "hi": 3862.604}, {"type": "Bearish", "top": 3866.917, "bottom": 3865.75, "created_at_bar": 299, "lo": 3865.75, "hi": 3866.917}], "order_blocks_m1": [{"top": 3863.505, "bottom": 3862.078, "bar_index": 269, "lo": 3862.078, "hi": 3863.505, "type": "bull"}, {"top": 3869.782, "bottom": 3868.675, "bar_index": 296, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3857.807, "equilibrium": 3864.7839999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 298}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 297}, {"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 281}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3864.367, "spread_points": 37, "atr_m5_pips": 341.81825356068697, "ticks_per_min": 174, "pdh_pdl_distance_pips": {"PDH": 30305.00000000029, "PDL": 100370.00000000035}, "eq50_d_distance_pips": 46488.000000000284, "session_active": null, "mins_to_next_killzone": 11}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:49:40", "message": "Context+MT5 xong trong 0.28s"}
{"stage": "status_update", "t": "2025-09-30 13:49:41", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:49:41", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:50:20", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:50:20", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:50:20", "message": "Đã lưu thành công file: ctx_20250930_135020.json"}
{"stage": "run-end", "t": "2025-09-30 13:50:20"}
{"stage": "status_update", "t": "2025-09-30 13:50:20", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:50:20", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:50:50", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:50:50", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:50:50", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:50:50", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:50:54", "message": "Upload xong 4 ảnh trong 4.29s"}
{"stage": "run-start", "t": "2025-09-30 13:50:55", "cycle": "2025-09-30 13:50:55", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:50:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:49:06) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:47:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:50:55Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 239}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:50:55", "broker_time": "2025-09-30T06:50:55Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3861.962, "ask": 3862.039, "last": 0.0, "time": 1759215055}, "tick_stats_5m": {"ticks_per_min": 239, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 223, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.9090698192346242, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.459878681058895, "M1": 1.767216983799214, "M15": 5.275823211310513, "H1": 10.814344970792876}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.763172299116, "ema200": 3864.6018623235964}, "M5": {"ema50": 3862.187879089121, "ema200": 3842.790613189969}, "M15": {"ema50": 3847.723959860515, "ema200": 3808.395583351436}, "H1": {"ema50": 3809.434808191618, "ema200": 3748.7639900975046}}}, "vwap": {"day": 3860.1412106106523, "asia": 3847.949353639847, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 10, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 27900.00000000009}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 97965.00000000015}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 44083.00000000008}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 95041.99999999991}], "round_levels": [{"level": "9600", "price": 3861.96, "distance_pips": 0.2}, {"level": "9625", "price": 3861.963, "distance_pips": 0.05}, {"level": "9650", "price": 3861.965, "distance_pips": 0.3}, {"level": "9675", "price": 3861.968, "distance_pips": 0.55}], "atr_norm": {"spread_as_pct_of_atr_m5": 2.225511559748093}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 295, "lo": 3840.666, "hi": 3842.651}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3861.619, "bar_index": 299}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3857.807, "bottom": 3854.844, "created_at_bar": 286, "lo": 3854.844, "hi": 3857.807}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 283, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3861.619, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.478, "bar_index": 288}, {"price": 3870.101, "bar_index": 282}, {"price": 3870.097, "bar_index": 280}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 113}, {"price": 3818.303, "bar_index": 103}, {"price": 3819.23, "bar_index": 107}, {"price": 3819.574, "bar_index": 109}, {"price": 3820.97, "bar_index": 127}]}, "fvgs_m5": [{"type": "Bullish", "top": 3857.807, "bottom": 3856.498, "created_at_bar": 259, "lo": 3856.498, "hi": 3857.807}, {"type": "Bearish", "top": 3868.401, "bottom": 3865.035, "created_at_bar": 299, "lo": 3865.035, "hi": 3868.401}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 260, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 297, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.13, "equilibrium": 3843.9455, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 298}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 293}, {"type": "Bullish", "top": 3866.482, "bottom": 3863.938, "bar_index": 279}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 259}, {"price": 3871.459, "bar_index": 286}, {"price": 3871.268, "bar_index": 292}, {"price": 3871.166, "bar_index": 284}, {"price": 3870.48, "bar_index": 281}], "swing_lows_SSL": [{"price": 3858.866, "bar_index": 103}, {"price": 3859.154, "bar_index": 108}, {"price": 3862.04, "bar_index": 147}, {"price": 3862.069, "bar_index": 144}, {"price": 3862.078, "bar_index": 268}]}, "fvgs_m1": [{"type": "Bullish", "top": 3861.793, "bottom": 3860.886, "created_at_bar": 111, "lo": 3860.886, "hi": 3861.793}, {"type": "Bearish", "top": 3866.917, "bottom": 3865.75, "created_at_bar": 298, "lo": 3865.75, "hi": 3866.917}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 295, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3858.125, "equilibrium": 3864.943, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 297}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 296}, {"type": "Bullish", "top": 3868.531, "bottom": 3866.908, "bar_index": 280}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3861.962, "spread_points": 77, "atr_m5_pips": 345.9878681058895, "ticks_per_min": 239, "pdh_pdl_distance_pips": {"PDH": 27900.00000000009, "PDL": 97965.00000000015}, "eq50_d_distance_pips": 44083.00000000008, "session_active": null, "mins_to_next_killzone": 10}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:50:55", "message": "Context+MT5 xong trong 0.20s"}
{"stage": "status_update", "t": "2025-09-30 13:50:56", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:50:56", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:51:34", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:51:34", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:51:34", "message": "Đã lưu thành công file: ctx_20250930_135134.json"}
{"stage": "run-end", "t": "2025-09-30 13:51:35"}
{"stage": "status_update", "t": "2025-09-30 13:51:35", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:51:35", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:52:05", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:52:05", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:52:05", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:52:05", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:52:09", "message": "Upload xong 4 ảnh trong 4.16s"}
{"stage": "run-start", "t": "2025-09-30 13:52:09", "cycle": "2025-09-30 13:52:09", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:51:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:50:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:49:06) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:52:09Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 324}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:52:09", "broker_time": "2025-09-30T06:52:09Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3860.535, "ask": 3860.572, "last": 0.0, "time": 1759215129}, "tick_stats_5m": {"ticks_per_min": 324, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 227, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8958279202702192, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.5563072524874926, "M1": 1.7819370932080454, "M15": 5.372251782739111, "H1": 10.910773542221472}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3867.2141379839127, "ema200": 3864.603686338681}, "M5": {"ema50": 3862.1211339910815, "ema200": 3842.7736778665862}, "M15": {"ema50": 3847.6572147624756, "ema200": 3808.3786480280532}, "H1": {"ema50": 3809.3657101524022, "ema200": 3748.7464577591963}}}, "vwap": {"day": 3860.238198051128, "asia": 3848.090999032414, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 8, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 26472.999999999956}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 96538.00000000001}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 42655.99999999995}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 93614.99999999978}], "round_levels": [{"level": "5300", "price": 3860.53, "distance_pips": 0.5}, {"level": "5325", "price": 3860.533, "distance_pips": 0.25}, {"level": "5350", "price": 3860.535, "distance_pips": 0.0}, {"level": "5375", "price": 3860.538, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.0404050430227012}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 295, "lo": 3840.666, "hi": 3842.651}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3860.269, "bar_index": 299}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3857.807, "bottom": 3854.844, "created_at_bar": 286, "lo": 3854.844, "hi": 3857.807}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 283, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3860.269, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.478, "bar_index": 288}, {"price": 3870.101, "bar_index": 282}, {"price": 3870.097, "bar_index": 280}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 113}, {"price": 3818.303, "bar_index": 103}, {"price": 3819.23, "bar_index": 107}, {"price": 3819.574, "bar_index": 109}, {"price": 3820.97, "bar_index": 127}]}, "fvgs_m5": [{"type": "Bullish", "top": 3857.807, "bottom": 3856.498, "created_at_bar": 259, "lo": 3856.498, "hi": 3857.807}, {"type": "Bearish", "top": 3868.401, "bottom": 3865.035, "created_at_bar": 299, "lo": 3865.035, "hi": 3868.401}], "order_blocks_m5": [{"top": 3861.378, "bottom": 3859.154, "bar_index": 260, "lo": 3859.154, "hi": 3861.378, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 297, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.13, "equilibrium": 3843.9455, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3860.269, "bar_index": 299}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 298}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 293}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 257}, {"price": 3871.459, "bar_index": 284}, {"price": 3871.268, "bar_index": 290}, {"price": 3871.166, "bar_index": 282}, {"price": 3870.48, "bar_index": 279}], "swing_lows_SSL": [{"price": 3858.866, "bar_index": 101}, {"price": 3859.154, "bar_index": 106}, {"price": 3860.269, "bar_index": 298}, {"price": 3862.04, "bar_index": 145}, {"price": 3862.069, "bar_index": 142}]}, "fvgs_m1": [{"type": "Bullish", "top": 3858.929, "bottom": 3858.717, "created_at_bar": 100, "lo": 3858.717, "hi": 3858.929}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.169, "created_at_bar": 299, "lo": 3861.169, "hi": 3861.619}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 293, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3858.866, "equilibrium": 3865.3135, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 297}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 295}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 294}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3860.535, "spread_points": 37, "atr_m5_pips": 355.63072524874923, "ticks_per_min": 324, "pdh_pdl_distance_pips": {"PDH": 26472.999999999956, "PDL": 96538.00000000001}, "eq50_d_distance_pips": 42655.99999999995, "session_active": null, "mins_to_next_killzone": 8}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:52:09", "message": "Context+MT5 xong trong 0.20s"}
{"stage": "status_update", "t": "2025-09-30 13:52:10", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:52:10", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:52:48", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:52:49", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:52:49", "message": "Đã lưu thành công file: ctx_20250930_135249.json"}
{"stage": "run-end", "t": "2025-09-30 13:52:49"}
{"stage": "status_update", "t": "2025-09-30 13:52:49", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:52:49", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:53:19", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:53:19", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:53:19", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:53:19", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:53:24", "message": "Upload xong 4 ảnh trong 4.91s"}
{"stage": "run-start", "t": "2025-09-30 13:53:24", "cycle": "2025-09-30 13:53:24", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:52:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:51:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:50:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:53:24Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 359}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:53:24", "broker_time": "2025-09-30T06:53:24Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3858.979, "ask": 3859.016, "last": 0.0, "time": 1759215204}, "tick_stats_5m": {"ticks_per_min": 359, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 228, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8813889610630624, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.674592966773203, "M1": 1.851120157993604, "M15": 5.490537497024821, "H1": 11.029059256507184}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3866.8582206079823, "ema200": 3864.517193711872}, "M5": {"ema50": 3862.0601143832387, "ema200": 3842.7581952795213}, "M15": {"ema50": 3847.596195154633, "ema200": 3808.3631654409883}, "H1": {"ema50": 3809.306102309265, "ema200": 3748.7313333810866}}}, "vwap": {"day": 3860.272041225121, "asia": 3848.032631300474, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 7, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 24916.999999999916}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 94981.99999999997}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 41099.999999999905}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 92058.99999999974}], "round_levels": [{"level": "9700", "price": 3858.97, "distance_pips": 0.9}, {"level": "9725", "price": 3858.973, "distance_pips": 0.65}, {"level": "9750", "price": 3858.975, "distance_pips": 0.4}, {"level": "9775", "price": 3858.978, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.0069142442394923}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 295, "lo": 3840.666, "hi": 3842.651}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3858.613, "bar_index": 299}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3857.807, "bottom": 3854.844, "created_at_bar": 286, "lo": 3854.844, "hi": 3857.807}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 283, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3858.613, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.478, "bar_index": 288}, {"price": 3870.101, "bar_index": 282}, {"price": 3870.097, "bar_index": 280}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 113}, {"price": 3818.303, "bar_index": 103}, {"price": 3819.23, "bar_index": 107}, {"price": 3819.574, "bar_index": 109}, {"price": 3820.97, "bar_index": 127}]}, "fvgs_m5": [{"type": "Bullish", "top": 3857.807, "bottom": 3856.498, "created_at_bar": 259, "lo": 3856.498, "hi": 3857.807}, {"type": "Bearish", "top": 3868.401, "bottom": 3865.035, "created_at_bar": 299, "lo": 3865.035, "hi": 3868.401}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 253, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 297, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.13, "equilibrium": 3843.9455, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3858.613, "bar_index": 299}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 298}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 293}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 256}, {"price": 3871.459, "bar_index": 283}, {"price": 3871.268, "bar_index": 289}, {"price": 3871.166, "bar_index": 281}, {"price": 3870.48, "bar_index": 278}], "swing_lows_SSL": [{"price": 3859.154, "bar_index": 105}, {"price": 3862.04, "bar_index": 144}, {"price": 3862.069, "bar_index": 141}, {"price": 3862.078, "bar_index": 265}, {"price": 3862.623, "bar_index": 195}]}, "fvgs_m1": [{"type": "Bullish", "top": 3856.854, "bottom": 3856.498, "created_at_bar": 92, "lo": 3856.498, "hi": 3856.854}, {"type": "Bearish", "top": 3860.269, "bottom": 3859.914, "created_at_bar": 299, "lo": 3859.914, "hi": 3860.269}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 292, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3858.613, "equilibrium": 3865.187, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 296}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 294}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 293}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3858.979, "spread_points": 37, "atr_m5_pips": 367.4592966773203, "ticks_per_min": 359, "pdh_pdl_distance_pips": {"PDH": 24916.999999999916, "PDL": 94981.99999999997}, "eq50_d_distance_pips": 41099.999999999905, "session_active": null, "mins_to_next_killzone": 7}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:53:24", "message": "Context+MT5 xong trong 0.17s"}
{"stage": "status_update", "t": "2025-09-30 13:53:25", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:53:25", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:54:04", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:54:04", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:54:04", "message": "Đã lưu thành công file: ctx_20250930_135404.json"}
{"stage": "run-end", "t": "2025-09-30 13:54:04"}
{"stage": "status_update", "t": "2025-09-30 13:54:04", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:54:04", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:54:34", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:54:34", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:54:34", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:54:34", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:54:38", "message": "Upload xong 4 ảnh trong 4.14s"}
{"stage": "run-start", "t": "2025-09-30 13:54:39", "cycle": "2025-09-30 13:54:39", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:54:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:52:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:51:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:54:39Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 407}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:54:39", "broker_time": "2025-09-30T06:54:39Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3856.82, "ask": 3856.857, "last": 0.0, "time": 1759215278}, "tick_stats_5m": {"ticks_per_min": 407, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 238, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.861354441186298, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.8252358239160547, "M1": 1.972922799763731, "M15": 5.641180354167673, "H1": 11.179702113650034}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3866.4165225720444, "ema200": 3864.402802974439}, "M5": {"ema50": 3861.9754477165716, "ema200": 3842.736712692457}, "M15": {"ema50": 3847.5115284879657, "ema200": 3808.341682853924}, "H1": {"ema50": 3809.2214356425984, "ema200": 3748.7098507940223}}}, "vwap": {"day": 3860.2765400815274, "asia": 3847.976953533398, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 6, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 22758.000000000266}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 92823.00000000032}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 38941.000000000255}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 89900.00000000009}], "round_levels": [{"level": "8200", "price": 3856.82, "distance_pips": 0.0}, {"level": "8225", "price": 3856.823, "distance_pips": 0.25}, {"level": "8250", "price": 3856.825, "distance_pips": 0.5}, {"level": "8275", "price": 3856.828, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.967260626612263}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 295, "lo": 3840.666, "hi": 3842.651}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3856.504, "bar_index": 299}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 285, "lo": 3850.0, "hi": 3852.421}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 283, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3856.504, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.478, "bar_index": 288}, {"price": 3870.101, "bar_index": 282}, {"price": 3870.097, "bar_index": 280}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 113}, {"price": 3818.303, "bar_index": 103}, {"price": 3819.23, "bar_index": 107}, {"price": 3819.574, "bar_index": 109}, {"price": 3820.97, "bar_index": 127}]}, "fvgs_m5": [{"type": "Bullish", "top": 3855.846, "bottom": 3855.836, "created_at_bar": 258, "lo": 3855.836, "hi": 3855.846}, {"type": "Bearish", "top": 3868.401, "bottom": 3865.035, "created_at_bar": 299, "lo": 3865.035, "hi": 3868.401}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 253, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 297, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.13, "equilibrium": 3843.9455, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 299}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 298}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 293}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 255}, {"price": 3871.459, "bar_index": 282}, {"price": 3871.268, "bar_index": 288}, {"price": 3871.166, "bar_index": 280}, {"price": 3870.48, "bar_index": 277}], "swing_lows_SSL": [{"price": 3856.504, "bar_index": 298}, {"price": 3859.154, "bar_index": 104}, {"price": 3862.04, "bar_index": 143}, {"price": 3862.069, "bar_index": 140}, {"price": 3862.078, "bar_index": 264}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 78, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3859.174, "bottom": 3858.344, "created_at_bar": 299, "lo": 3858.344, "hi": 3859.174}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 291, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3856.504, "equilibrium": 3864.1324999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 295}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 293}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 292}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3856.82, "spread_points": 37, "atr_m5_pips": 382.52358239160543, "ticks_per_min": 407, "pdh_pdl_distance_pips": {"PDH": 22758.000000000266, "PDL": 92823.00000000032}, "eq50_d_distance_pips": 38941.000000000255, "session_active": null, "mins_to_next_killzone": 6}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:54:39", "message": "Context+MT5 xong trong 0.21s"}
{"stage": "status_update", "t": "2025-09-30 13:54:40", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:54:40", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:55:19", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:55:19", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:55:19", "message": "Đã lưu thành công file: ctx_20250930_135519.json"}
{"stage": "run-end", "t": "2025-09-30 13:55:19"}
{"stage": "status_update", "t": "2025-09-30 13:55:19", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:55:19", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:55:49", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:55:49", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:55:49", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:55:49", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:55:53", "message": "Upload xong 4 ảnh trong 4.49s"}
{"stage": "run-start", "t": "2025-09-30 13:55:54", "cycle": "2025-09-30 13:55:54", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:55:19) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:54:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:52:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:55:54Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 421}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:55:54", "broker_time": "2025-09-30T06:55:54Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3859.45, "ask": 3859.487, "last": 0.0, "time": 1759215353}, "tick_stats_5m": {"ticks_per_min": 421, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 248, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8857596228796246, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.7937904079070446, "M1": 2.088045661019514, "M15": 5.658180354167661, "H1": 11.196702113650023}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3866.133718133362, "ema200": 3864.3539964356914}, "M5": {"ema50": 3861.866821246197, "ema200": 3843.0509547513534}, "M15": {"ema50": 3847.614665742868, "ema200": 3808.3678520081526}, "H1": {"ema50": 3809.3245728975003, "ema200": 3748.736019948251}}}, "vwap": {"day": 3860.3046525097225, "asia": 3847.8548091666667, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 5, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 25387.99999999992}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 95452.99999999997}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 41570.99999999991}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 92529.99999999974}], "round_levels": [{"level": "4500", "price": 3859.45, "distance_pips": 0.0}, {"level": "4525", "price": 3859.453, "distance_pips": 0.25}, {"level": "4550", "price": 3859.455, "distance_pips": 0.5}, {"level": "4575", "price": 3859.458, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9752779152782473}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 295, "lo": 3840.666, "hi": 3842.651}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}, {"type": "Bullish", "top": 3818.552, "bottom": 3806.56, "bar_index": 280}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3857.807, "bottom": 3854.844, "created_at_bar": 286, "lo": 3854.844, "hi": 3857.807}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 283, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3856.266, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 290}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.478, "bar_index": 287}, {"price": 3870.101, "bar_index": 281}, {"price": 3870.097, "bar_index": 279}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 112}, {"price": 3818.303, "bar_index": 102}, {"price": 3819.23, "bar_index": 106}, {"price": 3819.574, "bar_index": 108}, {"price": 3820.97, "bar_index": 126}]}, "fvgs_m5": [{"type": "Bullish", "top": 3855.846, "bottom": 3855.836, "created_at_bar": 257, "lo": 3855.836, "hi": 3855.846}, {"type": "Bearish", "top": 3863.677, "bottom": 3859.651, "created_at_bar": 299, "lo": 3859.651, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 252, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 296, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3859.651, "bottom": 3856.266, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 298}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 297}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 254}, {"price": 3871.459, "bar_index": 281}, {"price": 3871.268, "bar_index": 287}, {"price": 3871.166, "bar_index": 279}, {"price": 3870.48, "bar_index": 276}], "swing_lows_SSL": [{"price": 3856.504, "bar_index": 297}, {"price": 3859.154, "bar_index": 103}, {"price": 3862.04, "bar_index": 142}, {"price": 3862.069, "bar_index": 139}, {"price": 3862.078, "bar_index": 263}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 77, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3860.269, "bottom": 3859.914, "created_at_bar": 297, "lo": 3859.914, "hi": 3860.269}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 290, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3856.266, "equilibrium": 3864.0135, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3859.651, "bottom": 3856.266, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 294}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 292}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3859.45, "spread_points": 37, "atr_m5_pips": 379.37904079070444, "ticks_per_min": 421, "pdh_pdl_distance_pips": {"PDH": 25387.99999999992, "PDL": 95452.99999999997}, "eq50_d_distance_pips": 41570.99999999991, "session_active": null, "mins_to_next_killzone": 5}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:55:54", "message": "Context+MT5 xong trong 0.28s"}
{"stage": "status_update", "t": "2025-09-30 13:55:55", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:55:55", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:56:34", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:56:34", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:56:34", "message": "Đã lưu thành công file: ctx_20250930_135634.json"}
{"stage": "run-end", "t": "2025-09-30 13:56:34"}
{"stage": "status_update", "t": "2025-09-30 13:56:34", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:56:34", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:57:04", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:57:04", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:57:04", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:57:04", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:57:08", "message": "Upload xong 4 ảnh trong 4.28s"}
{"stage": "run-start", "t": "2025-09-30 13:57:08", "cycle": "2025-09-30 13:57:08", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:56:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:55:19) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:54:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:57:08Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 405}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:57:08", "broker_time": "2025-09-30T06:57:08Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3858.714, "ask": 3858.751, "last": 0.0, "time": 1759215428}, "tick_stats_5m": {"ticks_per_min": 405, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 253, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8789298838201997, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.8415046936213386, "M1": 1.9681975342630116, "M15": 5.658180354167661, "H1": 11.196702113650023}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3865.559539358328, "ema200": 3864.2296590361743}, "M5": {"ema50": 3861.8391741873734, "ema200": 3843.0439398259805}, "M15": {"ema50": 3847.5870186840443, "ema200": 3808.3608370827797}, "H1": {"ema50": 3809.2969258386765, "ema200": 3748.729005022878}}}, "vwap": {"day": 3860.3957168208653, "asia": 3847.86531884058, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 3, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 24652.000000000044}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 94717.0000000001}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 40835.00000000004}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 91793.99999999987}], "round_levels": [{"level": "7100", "price": 3858.71, "distance_pips": 0.4}, {"level": "7125", "price": 3858.713, "distance_pips": 0.15}, {"level": "7150", "price": 3858.715, "distance_pips": 0.1}, {"level": "7175", "price": 3858.718, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9631642533640248}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 295, "lo": 3840.666, "hi": 3842.651}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3856.266, "bar_index": 299}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3857.807, "bottom": 3854.844, "created_at_bar": 286, "lo": 3854.844, "hi": 3857.807}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 283, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3856.266, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 290}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.478, "bar_index": 287}, {"price": 3870.101, "bar_index": 281}, {"price": 3870.097, "bar_index": 279}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 112}, {"price": 3818.303, "bar_index": 102}, {"price": 3819.23, "bar_index": 106}, {"price": 3819.574, "bar_index": 108}, {"price": 3820.97, "bar_index": 126}]}, "fvgs_m5": [{"type": "Bullish", "top": 3855.846, "bottom": 3855.836, "created_at_bar": 257, "lo": 3855.836, "hi": 3855.846}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 299, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 252, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 296, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 298}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 297}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 292}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 252}, {"price": 3871.459, "bar_index": 279}, {"price": 3871.268, "bar_index": 285}, {"price": 3871.166, "bar_index": 277}, {"price": 3870.48, "bar_index": 274}], "swing_lows_SSL": [{"price": 3856.266, "bar_index": 297}, {"price": 3856.504, "bar_index": 295}, {"price": 3859.154, "bar_index": 101}, {"price": 3862.04, "bar_index": 140}, {"price": 3862.069, "bar_index": 137}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 75, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 294, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3858.344, "bottom": 3856.531, "bar_index": 296, "lo": 3856.531, "hi": 3858.344, "type": "bull"}, {"top": 3869.782, "bottom": 3868.675, "bar_index": 288, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3856.266, "equilibrium": 3864.0135, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3859.651, "bottom": 3856.266, "bar_index": 297}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 292}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 290}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3858.714, "spread_points": 37, "atr_m5_pips": 384.15046936213383, "ticks_per_min": 405, "pdh_pdl_distance_pips": {"PDH": 24652.000000000044, "PDL": 94717.0000000001}, "eq50_d_distance_pips": 40835.00000000004, "session_active": null, "mins_to_next_killzone": 3}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:57:08", "message": "Context+MT5 xong trong 0.46s"}
{"stage": "status_update", "t": "2025-09-30 13:57:10", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:57:10", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:57:48", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:57:48", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:57:48", "message": "Đã lưu thành công file: ctx_20250930_135748.json"}
{"stage": "run-end", "t": "2025-09-30 13:57:48"}
{"stage": "status_update", "t": "2025-09-30 13:57:48", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:57:48", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:58:18", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:58:18", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:58:18", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:58:18", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:58:23", "message": "Upload xong 4 ảnh trong 4.95s"}
{"stage": "run-start", "t": "2025-09-30 13:58:23", "cycle": "2025-09-30 13:58:23", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:57:48) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:56:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:55:19) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:58:23Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 420}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:58:23", "broker_time": "2025-09-30T06:58:23Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3857.068, "ask": 3857.105, "last": 0.0, "time": 1759215503}, "tick_stats_5m": {"ticks_per_min": 420, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 259, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8636557663041485, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.9055761221927625, "M1": 2.09667322061785, "M15": 5.722251782739085, "H1": 11.260773542221447}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3865.139202642801, "ema200": 3864.1518435342555}, "M5": {"ema50": 3861.773409481491, "ema200": 3843.027253258816}, "M15": {"ema50": 3847.521253978162, "ema200": 3808.344150515615}, "H1": {"ema50": 3809.231161132794, "ema200": 3748.7123184557136}}}, "vwap": {"day": 3860.40540212453, "asia": 3847.8726666666666, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 2, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 23006.000000000313}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 93071.00000000036}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 39189.000000000306}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 90148.00000000013}], "round_levels": [{"level": "600", "price": 3857.06, "distance_pips": 0.8}, {"level": "625", "price": 3857.062, "distance_pips": 0.55}, {"level": "650", "price": 3857.065, "distance_pips": 0.3}, {"level": "675", "price": 3857.068, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9473634322363114}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 295, "lo": 3840.666, "hi": 3842.651}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3855.369, "bar_index": 299}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 285, "lo": 3850.0, "hi": 3852.421}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 283, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3855.369, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 290}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.478, "bar_index": 287}, {"price": 3870.101, "bar_index": 281}, {"price": 3870.097, "bar_index": 279}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 112}, {"price": 3818.303, "bar_index": 102}, {"price": 3819.23, "bar_index": 106}, {"price": 3819.574, "bar_index": 108}, {"price": 3820.97, "bar_index": 126}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 255, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 299, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 252, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 296, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 298}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 297}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 292}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 251}, {"price": 3871.459, "bar_index": 278}, {"price": 3871.268, "bar_index": 284}, {"price": 3871.166, "bar_index": 276}, {"price": 3870.48, "bar_index": 273}], "swing_lows_SSL": [{"price": 3855.369, "bar_index": 298}, {"price": 3856.266, "bar_index": 296}, {"price": 3856.504, "bar_index": 294}, {"price": 3862.04, "bar_index": 139}, {"price": 3862.069, "bar_index": 136}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 74, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3858.78, "bottom": 3857.152, "created_at_bar": 299, "lo": 3857.152, "hi": 3858.78}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 287, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3855.369, "equilibrium": 3863.565, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3857.152, "bottom": 3856.26, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 291}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 289}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3857.068, "spread_points": 37, "atr_m5_pips": 390.5576122192762, "ticks_per_min": 420, "pdh_pdl_distance_pips": {"PDH": 23006.000000000313, "PDL": 93071.00000000036}, "eq50_d_distance_pips": 39189.000000000306, "session_active": null, "mins_to_next_killzone": 2}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:58:23", "message": "Context+MT5 xong trong 0.17s"}
{"stage": "status_update", "t": "2025-09-30 13:58:24", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:58:24", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 13:59:03", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 13:59:03", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 13:59:03", "message": "Đã lưu thành công file: ctx_20250930_135903.json"}
{"stage": "run-end", "t": "2025-09-30 13:59:03"}
{"stage": "status_update", "t": "2025-09-30 13:59:03", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 13:59:03", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 13:59:33", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 13:59:33", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 13:59:33", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 13:59:33", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 13:59:37", "message": "Upload xong 4 ảnh trong 4.07s"}
{"stage": "run-start", "t": "2025-09-30 13:59:38", "cycle": "2025-09-30 13:59:38", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 13:59:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 13:57:48) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:56:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T06:59:38Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 398}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 13:59:38", "broker_time": "2025-09-30T06:59:38Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3856.635, "ask": 3856.712, "last": 0.0, "time": 1759215578}, "tick_stats_5m": {"ticks_per_min": 398, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 270, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8596377268846764, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {}, "volatility": {"ATR": {"M5": 3.937647550764196, "M1": 2.202216970145921, "M15": 5.754323211310519, "H1": 11.29284497079288}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3864.7455576359775, "ema200": 3864.1610392820676}, "M5": {"ema50": 3861.775958501099, "ema200": 3843.0279000249852}, "M15": {"ema50": 3847.52380299777, "ema200": 3808.3447972817844}, "H1": {"ema50": 3809.233710152402, "ema200": 3748.7129652218828}}}, "vwap": {"day": 3860.398357709164, "asia": null, "london": null, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 1, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 22573.00000000032}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 92638.00000000038}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 38756.00000000031}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 89715.00000000015}], "round_levels": [{"level": "6300", "price": 3856.63, "distance_pips": 0.5}, {"level": "6325", "price": 3856.633, "distance_pips": 0.25}, {"level": "6350", "price": 3856.635, "distance_pips": 0.0}, {"level": "6375", "price": 3856.638, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.955482277351793}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3867.242, "bar_index": 296}, {"price": 3834.062, "bar_index": 290}, {"price": 3833.647, "bar_index": 286}, {"price": 3831.428, "bar_index": 281}, {"price": 3819.936, "bar_index": 276}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 122}, {"price": 3632.264, "bar_index": 133}, {"price": 3633.892, "bar_index": 115}, {"price": 3640.568, "bar_index": 127}, {"price": 3643.331, "bar_index": 138}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 295, "lo": 3840.666, "hi": 3842.651}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 271, "lo": 3767.907, "hi": 3788.842, "type": "bull"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 299}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 296}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 294}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 296}, {"price": 3871.459, "bar_index": 298}, {"price": 3870.101, "bar_index": 293}, {"price": 3867.242, "bar_index": 287}, {"price": 3852.113, "bar_index": 280}], "swing_lows_SSL": [{"price": 3734.526, "bar_index": 101}, {"price": 3739.268, "bar_index": 116}, {"price": 3741.553, "bar_index": 112}, {"price": 3742.965, "bar_index": 131}, {"price": 3744.591, "bar_index": 109}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 285, "lo": 3850.0, "hi": 3852.421}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 283, "lo": 3847.279, "hi": 3850.0, "type": "bull"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 299}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 286}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 271}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 290}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.478, "bar_index": 287}, {"price": 3870.101, "bar_index": 281}, {"price": 3870.097, "bar_index": 279}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 112}, {"price": 3818.303, "bar_index": 102}, {"price": 3819.23, "bar_index": 106}, {"price": 3819.574, "bar_index": 108}, {"price": 3820.97, "bar_index": 126}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 255, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 299, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 252, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 296, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 298}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 297}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 292}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 250}, {"price": 3871.459, "bar_index": 277}, {"price": 3871.268, "bar_index": 283}, {"price": 3871.166, "bar_index": 275}, {"price": 3870.48, "bar_index": 272}], "swing_lows_SSL": [{"price": 3856.266, "bar_index": 295}, {"price": 3856.504, "bar_index": 293}, {"price": 3862.04, "bar_index": 138}, {"price": 3862.069, "bar_index": 135}, {"price": 3862.078, "bar_index": 259}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 73, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3858.78, "bottom": 3857.287, "created_at_bar": 298, "lo": 3857.287, "hi": 3858.78}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 286, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3854.92, "equilibrium": 3863.3405000000002, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3857.133, "bottom": 3854.92, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 290}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 288}], "mss_m1": {"type": "Bearish", "event": "BOS", "price_level": 3856.266, "break_bar_index": 298}}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3856.635, "spread_points": 77, "atr_m5_pips": 393.7647550764196, "ticks_per_min": 398, "pdh_pdl_distance_pips": {"PDH": 22573.00000000032, "PDL": 92638.00000000038}, "eq50_d_distance_pips": 38756.00000000031, "session_active": null, "mins_to_next_killzone": 1}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 13:59:38", "message": "Context+MT5 xong trong 0.22s"}
{"stage": "status_update", "t": "2025-09-30 13:59:39", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 13:59:39", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:00:17", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:00:17", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:00:17", "message": "Đã lưu thành công file: ctx_20250930_140017.json"}
{"stage": "run-end", "t": "2025-09-30 14:00:17"}
{"stage": "status_update", "t": "2025-09-30 14:00:17", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:00:17", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:00:47", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:00:47", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:00:47", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:00:47", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:00:53", "message": "Lỗi nghiêm trọng trong worker: 503 The service is currently unavailable."}
{"stage": "status_update", "t": "2025-09-30 14:00:53", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:00:53", "message": "Đã lưu thành công file: ctx_20250930_140053.json"}
{"stage": "run-end", "t": "2025-09-30 14:00:53"}
{"stage": "status_update", "t": "2025-09-30 14:00:53", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:00:53", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:01:23", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:01:23", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:01:23", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:01:23", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:01:27", "message": "Upload xong 4 ảnh trong 4.07s"}
{"stage": "run-start", "t": "2025-09-30 14:01:27", "cycle": "2025-09-30 14:01:27", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 503 The service is currently unavailable.", "Traceback:", "Traceback (most recent call last):", "File \"C:\\Users\\Windows\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 76, in error_remapped_callable"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:00:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 503 The service is currently unavailable.\nTraceback:\nTraceback (most recent call last):\nFile \"C:\\Users\\Windows\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 76, in error_remapped_callable\n\n--- Context T-1 (2025-09-30 14:00:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 13:59:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:01:27Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 395}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:01:27", "broker_time": "2025-09-30T07:01:27Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3857.365, "ask": 3857.402, "last": 0.0, "time": 1759215687}, "tick_stats_5m": {"ticks_per_min": 395, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 286, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8664117887235053, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.872529868426778, "M1": 2.2355205361438877, "M15": 5.559442981884869, "H1": 10.702356044331896}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3864.0788013967676, "ema200": 3863.9755166638024}, "M5": {"ema50": 3861.552814736236, "ema200": 3843.028998308888}, "M15": {"ema50": 3847.8596008224217, "ema200": 3808.9631303778992}, "H1": {"ema50": 3811.0710416295324, "ema200": 3749.6112481206633}}}, "vwap": {"day": 3860.454066524133, "asia": null, "london": 3856.2435569469294, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 23302.999999999884}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 93367.99999999994}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 39485.999999999876}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 90444.99999999971}], "round_levels": [{"level": "3600", "price": 3857.36, "distance_pips": 0.5}, {"level": "3625", "price": 3857.363, "distance_pips": 0.25}, {"level": "3650", "price": 3857.365, "distance_pips": 0.0}, {"level": "3675", "price": 3857.368, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9554477630225031}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3857.769, "created_at_bar": 299, "lo": 3857.769, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.101, "bar_index": 292}, {"price": 3867.242, "bar_index": 286}, {"price": 3852.113, "bar_index": 279}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 115}, {"price": 3741.553, "bar_index": 111}, {"price": 3742.965, "bar_index": 130}, {"price": 3744.591, "bar_index": 108}, {"price": 3744.709, "bar_index": 105}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 284, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3857.769, "created_at_bar": 299, "lo": 3857.769, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 282, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 297, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 285}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 289}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.478, "bar_index": 286}, {"price": 3870.101, "bar_index": 280}, {"price": 3870.097, "bar_index": 278}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 111}, {"price": 3818.303, "bar_index": 101}, {"price": 3819.23, "bar_index": 105}, {"price": 3819.574, "bar_index": 107}, {"price": 3820.97, "bar_index": 125}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 254, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 298, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 251, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 295, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 297}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 296}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 291}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 248}, {"price": 3871.459, "bar_index": 275}, {"price": 3871.268, "bar_index": 281}, {"price": 3871.166, "bar_index": 273}, {"price": 3870.48, "bar_index": 270}], "swing_lows_SSL": [{"price": 3854.743, "bar_index": 298}, {"price": 3856.266, "bar_index": 293}, {"price": 3856.504, "bar_index": 291}, {"price": 3862.04, "bar_index": 136}, {"price": 3862.069, "bar_index": 133}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 71, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 290, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 284, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3854.743, "equilibrium": 3863.252, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 288}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 286}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 285}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3857.365, "spread_points": 37, "atr_m5_pips": 387.2529868426778, "ticks_per_min": 395, "pdh_pdl_distance_pips": {"PDH": 23302.999999999884, "PDL": 93367.99999999994}, "eq50_d_distance_pips": 39485.999999999876, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:01:27", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "status_update", "t": "2025-09-30 14:01:28", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:01:28", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:02:07", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:02:07", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:02:07", "message": "Đã lưu thành công file: ctx_20250930_140207.json"}
{"stage": "run-end", "t": "2025-09-30 14:02:07"}
{"stage": "status_update", "t": "2025-09-30 14:02:07", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:02:07", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:02:37", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:02:37", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:02:37", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:02:37", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:02:41", "message": "Upload xong 4 ảnh trong 3.83s"}
{"stage": "run-start", "t": "2025-09-30 14:02:41", "cycle": "2025-09-30 14:02:41", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:02:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:00:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 503 The service is currently unavailable.\nTraceback:\nTraceback (most recent call last):\nFile \"C:\\Users\\Windows\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 76, in error_remapped_callable\n\n--- Context T-2 (2025-09-30 14:00:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:02:41Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 384}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:02:41", "broker_time": "2025-09-30T07:02:41Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3857.454, "ask": 3857.491, "last": 0.0, "time": 1759215761}, "tick_stats_5m": {"ticks_per_min": 384, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 290, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8672376674956407, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.8730298684267828, "M1": 2.1927333549980736, "M15": 5.559942981884873, "H1": 10.7028560443319}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3863.7872449747124, "ema200": 3863.9194476776584}, "M5": {"ema50": 3861.5563049323146, "ema200": 3843.029883881027}, "M15": {"ema50": 3847.8630910185, "ema200": 3808.9640159500386}, "H1": {"ema50": 3811.074531825611, "ema200": 3749.6121336928027}}}, "vwap": {"day": 3860.4904799759593, "asia": null, "london": 3856.441857532379, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 23392.00000000028}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 93457.00000000033}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 39575.00000000027}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 90534.0000000001}], "round_levels": [{"level": "4500", "price": 3857.45, "distance_pips": 0.4}, {"level": "4525", "price": 3857.453, "distance_pips": 0.15}, {"level": "4550", "price": 3857.455, "distance_pips": 0.1}, {"level": "4575", "price": 3857.458, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9553244167165825}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3857.776, "created_at_bar": 299, "lo": 3857.776, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.101, "bar_index": 292}, {"price": 3867.242, "bar_index": 286}, {"price": 3852.113, "bar_index": 279}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 115}, {"price": 3741.553, "bar_index": 111}, {"price": 3742.965, "bar_index": 130}, {"price": 3744.591, "bar_index": 108}, {"price": 3744.709, "bar_index": 105}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 284, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3857.776, "created_at_bar": 299, "lo": 3857.776, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 282, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 297, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 285}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 289}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.478, "bar_index": 286}, {"price": 3870.101, "bar_index": 280}, {"price": 3870.097, "bar_index": 278}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 111}, {"price": 3818.303, "bar_index": 101}, {"price": 3819.23, "bar_index": 105}, {"price": 3819.574, "bar_index": 107}, {"price": 3820.97, "bar_index": 125}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 254, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 298, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 251, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 295, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 297}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 296}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 291}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 247}, {"price": 3871.459, "bar_index": 274}, {"price": 3871.268, "bar_index": 280}, {"price": 3871.166, "bar_index": 272}, {"price": 3870.48, "bar_index": 269}], "swing_lows_SSL": [{"price": 3854.743, "bar_index": 297}, {"price": 3856.266, "bar_index": 292}, {"price": 3856.504, "bar_index": 290}, {"price": 3862.04, "bar_index": 135}, {"price": 3862.069, "bar_index": 132}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 70, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 289, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 283, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3854.743, "equilibrium": 3863.252, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 287}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 285}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 284}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3857.454, "spread_points": 37, "atr_m5_pips": 387.30298684267825, "ticks_per_min": 384, "pdh_pdl_distance_pips": {"PDH": 23392.00000000028, "PDL": 93457.00000000033}, "eq50_d_distance_pips": 39575.00000000027, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:02:41", "message": "Context+MT5 xong trong 0.23s"}
{"stage": "status_update", "t": "2025-09-30 14:02:43", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:02:43", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:03:21", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:03:21", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:03:21", "message": "Đã lưu thành công file: ctx_20250930_140321.json"}
{"stage": "run-end", "t": "2025-09-30 14:03:21"}
{"stage": "status_update", "t": "2025-09-30 14:03:21", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:03:21", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:03:51", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:03:51", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:03:51", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:03:51", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:03:57", "message": "Upload xong 4 ảnh trong 5.75s"}
{"stage": "run-start", "t": "2025-09-30 14:03:57", "cycle": "2025-09-30 14:03:57", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:03:21) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:02:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:00:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 503 The service is currently unavailable.\nTraceback:\nTraceback (most recent call last):\nFile \"C:\\Users\\Windows\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 76, in error_remapped_callable", "run_meta": {"analysis_id": "2025-09-30T07:03:57Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 385}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:03:57", "broker_time": "2025-09-30T07:03:57Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3854.57, "ask": 3854.607, "last": 0.0, "time": 1759215837}, "tick_stats_5m": {"ticks_per_min": 385, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 296, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8404754834638675, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.937458439855357, "M1": 2.2171860745453427, "M15": 5.6243715533134475, "H1": 10.767284615760476}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3863.3703246951454, "ema200": 3863.8161142796434}, "M5": {"ema50": 3861.4413245401574, "ema200": 3843.000709751674}, "M15": {"ema50": 3847.748110626343, "ema200": 3808.9348418206855}, "H1": {"ema50": 3810.959551433454, "ema200": 3749.5829595634495}}}, "vwap": {"day": 3860.4870518674743, "asia": null, "london": 3855.974930783242, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 20508.000000000266}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 90573.00000000032}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 36691.000000000255}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 87650.00000000009}], "round_levels": [{"level": "5700", "price": 3854.57, "distance_pips": 0.0}, {"level": "5725", "price": 3854.573, "distance_pips": 0.25}, {"level": "5750", "price": 3854.575, "distance_pips": 0.5}, {"level": "5775", "price": 3854.578, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9396924580914786}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3857.776, "created_at_bar": 299, "lo": 3857.776, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.101, "bar_index": 292}, {"price": 3867.242, "bar_index": 286}, {"price": 3852.113, "bar_index": 279}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 115}, {"price": 3741.553, "bar_index": 111}, {"price": 3742.965, "bar_index": 130}, {"price": 3744.591, "bar_index": 108}, {"price": 3744.709, "bar_index": 105}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 284, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3857.776, "created_at_bar": 299, "lo": 3857.776, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 282, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 297, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 285}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 289}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.478, "bar_index": 286}, {"price": 3870.101, "bar_index": 280}, {"price": 3870.097, "bar_index": 278}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 111}, {"price": 3818.303, "bar_index": 101}, {"price": 3819.23, "bar_index": 105}, {"price": 3819.574, "bar_index": 107}, {"price": 3820.97, "bar_index": 125}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 254, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 298, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 251, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 295, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 297}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 296}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 291}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 246}, {"price": 3871.459, "bar_index": 273}, {"price": 3871.268, "bar_index": 279}, {"price": 3871.166, "bar_index": 271}, {"price": 3870.48, "bar_index": 268}], "swing_lows_SSL": [{"price": 3854.743, "bar_index": 296}, {"price": 3856.266, "bar_index": 291}, {"price": 3856.504, "bar_index": 289}, {"price": 3862.04, "bar_index": 134}, {"price": 3862.069, "bar_index": 131}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 69, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3858.78, "bottom": 3857.287, "created_at_bar": 294, "lo": 3857.287, "hi": 3858.78}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 282, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3853.841, "equilibrium": 3862.801, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 286}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 284}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 283}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3854.57, "spread_points": 37, "atr_m5_pips": 393.74584398553566, "ticks_per_min": 385, "pdh_pdl_distance_pips": {"PDH": 20508.000000000266, "PDL": 90573.00000000032}, "eq50_d_distance_pips": 36691.000000000255, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:03:57", "message": "Context+MT5 xong trong 0.25s"}
{"stage": "status_update", "t": "2025-09-30 14:03:59", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:03:59", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:04:38", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:04:38", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:04:38", "message": "Đã lưu thành công file: ctx_20250930_140438.json"}
{"stage": "run-end", "t": "2025-09-30 14:04:38"}
{"stage": "status_update", "t": "2025-09-30 14:04:38", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:04:38", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:05:08", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:05:08", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:05:08", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:05:08", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:06:09", "message": "Lỗi nghiêm trọng trong worker: The read operation timed out"}
{"stage": "status_update", "t": "2025-09-30 14:06:09", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:06:09", "message": "Đã lưu thành công file: ctx_20250930_140609.json"}
{"stage": "run-end", "t": "2025-09-30 14:06:09"}
{"stage": "status_update", "t": "2025-09-30 14:06:09", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:06:09", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:06:39", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:06:39", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:06:39", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:06:39", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:06:44", "message": "Upload xong 4 ảnh trong 4.43s"}
{"stage": "run-start", "t": "2025-09-30 14:06:44", "cycle": "2025-09-30 14:06:44", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: The read operation timed out", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:06:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:04:38) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:03:21) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:06:44Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 376}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:06:44", "broker_time": "2025-09-30T07:06:44Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3858.6, "ask": 3858.637, "last": 0.0, "time": 1759216004}, "tick_stats_5m": {"ticks_per_min": 376, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 312, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8778720166289294, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.946497122786036, "M1": 2.2512863723769327, "M15": 5.713585839027751, "H1": 10.85649890147478}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3862.6995581762344, "ema200": 3863.5698554458077}, "M5": {"ema50": 3861.38873038297, "ema200": 3843.2202942022986}, "M15": {"ema50": 3847.9082674890883, "ema200": 3808.9754786366057}, "H1": {"ema50": 3811.119708296199, "ema200": 3749.6235963793697}}}, "vwap": {"day": 3860.5493194040378, "asia": null, "london": 3856.3076467799287, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 24538.00000000001}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 94603.00000000006}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 40721.0}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 91679.99999999984}], "round_levels": [{"level": "6000", "price": 3858.6, "distance_pips": 0.0}, {"level": "6025", "price": 3858.602, "distance_pips": 0.25}, {"level": "6050", "price": 3858.605, "distance_pips": 0.5}, {"level": "6075", "price": 3858.608, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.937540275568267}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.025, "created_at_bar": 299, "lo": 3859.025, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.101, "bar_index": 292}, {"price": 3867.242, "bar_index": 286}, {"price": 3852.113, "bar_index": 279}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 115}, {"price": 3741.553, "bar_index": 111}, {"price": 3742.965, "bar_index": 130}, {"price": 3744.591, "bar_index": 108}, {"price": 3744.709, "bar_index": 105}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 284, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.025, "created_at_bar": 299, "lo": 3859.025, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 282, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 297, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 285}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 288}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.478, "bar_index": 285}, {"price": 3870.101, "bar_index": 279}, {"price": 3870.097, "bar_index": 277}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 110}, {"price": 3819.23, "bar_index": 104}, {"price": 3819.574, "bar_index": 106}, {"price": 3820.97, "bar_index": 124}, {"price": 3822.667, "bar_index": 167}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 253, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 297, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 250, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 294, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 296}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 295}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 290}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 243}, {"price": 3871.459, "bar_index": 270}, {"price": 3871.268, "bar_index": 276}, {"price": 3871.166, "bar_index": 268}, {"price": 3870.48, "bar_index": 265}], "swing_lows_SSL": [{"price": 3853.841, "bar_index": 296}, {"price": 3854.743, "bar_index": 293}, {"price": 3856.266, "bar_index": 288}, {"price": 3856.504, "bar_index": 286}, {"price": 3862.04, "bar_index": 131}]}, "fvgs_m1": [{"type": "Bullish", "top": 3857.749, "bottom": 3857.433, "created_at_bar": 299, "lo": 3857.433, "hi": 3857.749}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 285, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 279, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3853.841, "equilibrium": 3862.801, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 283}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 281}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 280}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3858.6, "spread_points": 37, "atr_m5_pips": 394.6497122786036, "ticks_per_min": 376, "pdh_pdl_distance_pips": {"PDH": 24538.00000000001, "PDL": 94603.00000000006}, "eq50_d_distance_pips": 40721.0, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:06:44", "message": "Context+MT5 xong trong 0.34s"}
{"stage": "status_update", "t": "2025-09-30 14:06:45", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:06:45", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:07:24", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:07:24", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:07:24", "message": "Đã lưu thành công file: ctx_20250930_140724.json"}
{"stage": "run-end", "t": "2025-09-30 14:07:24"}
{"stage": "status_update", "t": "2025-09-30 14:07:24", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:07:24", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:07:54", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:07:54", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:07:54", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:07:54", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:07:59", "message": "Upload xong 4 ảnh trong 4.49s"}
{"stage": "run-start", "t": "2025-09-30 14:07:59", "cycle": "2025-09-30 14:07:59", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:07:24) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:06:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:04:38) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:07:59Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 419}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:07:59", "broker_time": "2025-09-30T07:07:59Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3856.164, "ask": 3856.241, "last": 0.0, "time": 1759216078}, "tick_stats_5m": {"ticks_per_min": 419, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 326, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8552670650681142, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.005497122786037, "M1": 2.428653672314296, "M15": 5.740728696170616, "H1": 10.883641758617644}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3862.394180853509, "ema200": 3863.441276192639}, "M5": {"ema50": 3861.2915146966957, "ema200": 3843.195627535632}, "M15": {"ema50": 3847.811051802814, "ema200": 3808.950811969939}, "H1": {"ema50": 3811.0224926099245, "ema200": 3749.598929712703}}}, "vwap": {"day": 3860.5411317183543, "asia": null, "london": 3856.308263949843, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 22102.000000000317}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 92167.00000000036}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 38285.000000000306}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 89244.00000000015}], "round_levels": [{"level": "1600", "price": 3856.16, "distance_pips": 0.4}, {"level": "1625", "price": 3856.162, "distance_pips": 0.15}, {"level": "1650", "price": 3856.165, "distance_pips": 0.1}, {"level": "1675", "price": 3856.168, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.922358140310264}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.101, "bar_index": 292}, {"price": 3867.242, "bar_index": 286}, {"price": 3852.113, "bar_index": 279}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 115}, {"price": 3741.553, "bar_index": 111}, {"price": 3742.965, "bar_index": 130}, {"price": 3744.591, "bar_index": 108}, {"price": 3744.709, "bar_index": 105}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 284, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 282, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 297, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 285}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 288}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.478, "bar_index": 285}, {"price": 3870.101, "bar_index": 279}, {"price": 3870.097, "bar_index": 277}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 110}, {"price": 3819.23, "bar_index": 104}, {"price": 3819.574, "bar_index": 106}, {"price": 3820.97, "bar_index": 124}, {"price": 3822.667, "bar_index": 167}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 253, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 297, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 250, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 294, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 296}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 295}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 290}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 242}, {"price": 3871.459, "bar_index": 269}, {"price": 3871.268, "bar_index": 275}, {"price": 3871.166, "bar_index": 267}, {"price": 3870.48, "bar_index": 264}], "swing_lows_SSL": [{"price": 3853.841, "bar_index": 295}, {"price": 3854.743, "bar_index": 292}, {"price": 3856.266, "bar_index": 287}, {"price": 3856.504, "bar_index": 285}, {"price": 3862.04, "bar_index": 130}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 65, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 284, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 278, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3853.841, "equilibrium": 3862.801, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 282}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 280}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 279}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3856.164, "spread_points": 77, "atr_m5_pips": 400.54971227860375, "ticks_per_min": 419, "pdh_pdl_distance_pips": {"PDH": 22102.000000000317, "PDL": 92167.00000000036}, "eq50_d_distance_pips": 38285.000000000306, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:07:59", "message": "Context+MT5 xong trong 0.24s"}
{"stage": "status_update", "t": "2025-09-30 14:08:00", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:08:00", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:08:38", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:08:39", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:08:39", "message": "Đã lưu thành công file: ctx_20250930_140838.json"}
{"stage": "run-end", "t": "2025-09-30 14:08:39"}
{"stage": "status_update", "t": "2025-09-30 14:08:39", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:08:39", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:09:09", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:09:09", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:09:09", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:09:09", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:09:13", "message": "Upload xong 4 ảnh trong 4.05s"}
{"stage": "run-start", "t": "2025-09-30 14:09:13", "cycle": "2025-09-30 14:09:13", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:08:39) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:07:24) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:06:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: The read operation timed out\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 385, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:09:13Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 402}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:09:13", "broker_time": "2025-09-30T07:09:13Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3855.626, "ask": 3855.703, "last": 0.0, "time": 1759216152}, "tick_stats_5m": {"ticks_per_min": 402, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 329, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8502746742882619, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.005497122786037, "M1": 2.3111503602843007, "M15": 5.740728696170616, "H1": 10.883641758617644}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3861.914761391904, "ema200": 3863.218018647946}, "M5": {"ema50": 3861.269397049637, "ema200": 3843.1900155953335}, "M15": {"ema50": 3847.788934155755, "ema200": 3808.9452000296405}, "H1": {"ema50": 3811.000374962866, "ema200": 3749.5933177724046}}}, "vwap": {"day": 3860.6240776392374, "asia": null, "london": 3856.324381473377, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 21564.000000000306}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 91629.00000000036}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 37747.0000000003}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 88706.00000000013}], "round_levels": [{"level": "6200", "price": 3855.62, "distance_pips": 0.6}, {"level": "6225", "price": 3855.622, "distance_pips": 0.35}, {"level": "6250", "price": 3855.625, "distance_pips": 0.1}, {"level": "6275", "price": 3855.628, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.922358140310264}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.101, "bar_index": 292}, {"price": 3867.242, "bar_index": 286}, {"price": 3852.113, "bar_index": 279}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 115}, {"price": 3741.553, "bar_index": 111}, {"price": 3742.965, "bar_index": 130}, {"price": 3744.591, "bar_index": 108}, {"price": 3744.709, "bar_index": 105}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 284, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 282, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 297, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 285}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 288}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.478, "bar_index": 285}, {"price": 3870.101, "bar_index": 279}, {"price": 3870.097, "bar_index": 277}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 110}, {"price": 3819.23, "bar_index": 104}, {"price": 3819.574, "bar_index": 106}, {"price": 3820.97, "bar_index": 124}, {"price": 3822.667, "bar_index": 167}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 253, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 297, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 250, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 294, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 296}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 295}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 290}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 240}, {"price": 3871.459, "bar_index": 267}, {"price": 3871.268, "bar_index": 273}, {"price": 3871.166, "bar_index": 265}, {"price": 3870.48, "bar_index": 262}], "swing_lows_SSL": [{"price": 3853.841, "bar_index": 293}, {"price": 3854.515, "bar_index": 297}, {"price": 3854.743, "bar_index": 290}, {"price": 3856.266, "bar_index": 285}, {"price": 3856.504, "bar_index": 283}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 63, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 282, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3869.782, "bottom": 3868.675, "bar_index": 276, "lo": 3868.675, "hi": 3869.782, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3853.841, "equilibrium": 3862.801, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 280}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 278}, {"type": "Bearish", "top": 3869.51, "bottom": 3866.917, "bar_index": 277}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3855.626, "spread_points": 77, "atr_m5_pips": 400.54971227860375, "ticks_per_min": 402, "pdh_pdl_distance_pips": {"PDH": 21564.000000000306, "PDL": 91629.00000000036}, "eq50_d_distance_pips": 37747.0000000003, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:09:13", "message": "Context+MT5 xong trong 0.29s"}
{"stage": "status_update", "t": "2025-09-30 14:09:14", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:09:14", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:09:53", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:09:53", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:09:53", "message": "Đã lưu thành công file: ctx_20250930_140953.json"}
{"stage": "run-end", "t": "2025-09-30 14:09:53"}
{"stage": "status_update", "t": "2025-09-30 14:09:53", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:09:53", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:10:23", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:10:23", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:10:23", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:10:23", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:10:28", "message": "Upload xong 4 ảnh trong 4.62s"}
{"stage": "run-start", "t": "2025-09-30 14:10:28", "cycle": "2025-09-30 14:10:28", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:09:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:08:39) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:07:24) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:10:28Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 406}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:10:28", "broker_time": "2025-09-30T07:10:28Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3854.319, "ask": 3854.396, "last": 0.0, "time": 1759216228}, "tick_stats_5m": {"ticks_per_min": 406, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 334, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.838146319735719, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.0094310018537715, "M1": 2.479221252890158, "M15": 5.798014410456307, "H1": 10.940927472903336}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3861.535953539195, "ema200": 3863.08471225196}, "M5": {"ema50": 3860.9158898486407, "ema200": 3843.1930635306685}, "M15": {"ema50": 3847.7401498420295, "ema200": 3808.932821920188}, "H1": {"ema50": 3810.95159064914, "ema200": 3749.580939662952}}}, "vwap": {"day": 3860.683723322448, "asia": null, "london": 3856.084358614006, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 20257.000000000062}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 90322.00000000012}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 36440.00000000005}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 87398.99999999988}], "round_levels": [{"level": "3100", "price": 3854.31, "distance_pips": 0.9}, {"level": "3125", "price": 3854.312, "distance_pips": 0.65}, {"level": "3150", "price": 3854.315, "distance_pips": 0.4}, {"level": "3175", "price": 3854.318, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.9204720062428908}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.101, "bar_index": 292}, {"price": 3867.242, "bar_index": 286}, {"price": 3852.113, "bar_index": 279}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 115}, {"price": 3741.553, "bar_index": 111}, {"price": 3742.965, "bar_index": 130}, {"price": 3744.591, "bar_index": 108}, {"price": 3744.709, "bar_index": 105}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 284, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 282, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 297, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 285}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 287}, {"price": 3871.459, "bar_index": 292}, {"price": 3870.478, "bar_index": 284}, {"price": 3870.101, "bar_index": 278}, {"price": 3870.097, "bar_index": 276}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 109}, {"price": 3819.23, "bar_index": 103}, {"price": 3819.574, "bar_index": 105}, {"price": 3820.97, "bar_index": 123}, {"price": 3822.667, "bar_index": 166}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 252, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 296, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 249, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 293, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 295}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 294}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 289}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 239}, {"price": 3871.459, "bar_index": 266}, {"price": 3871.268, "bar_index": 272}, {"price": 3871.166, "bar_index": 264}, {"price": 3870.48, "bar_index": 261}], "swing_lows_SSL": [{"price": 3853.039, "bar_index": 298}, {"price": 3853.841, "bar_index": 292}, {"price": 3854.515, "bar_index": 296}, {"price": 3854.743, "bar_index": 289}, {"price": 3856.266, "bar_index": 284}]}, "fvgs_m1": [{"type": "Bullish", "top": 3852.605, "bottom": 3851.815, "created_at_bar": 62, "lo": 3851.815, "hi": 3852.605}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 281, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3857.246, "bottom": 3855.661, "bar_index": 297, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3853.039, "equilibrium": 3862.4, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 298}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 279}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 277}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3854.319, "spread_points": 77, "atr_m5_pips": 400.94310018537715, "ticks_per_min": 406, "pdh_pdl_distance_pips": {"PDH": 20257.000000000062, "PDL": 90322.00000000012}, "eq50_d_distance_pips": 36440.00000000005, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:10:28", "message": "Context+MT5 xong trong 0.37s"}
{"stage": "status_update", "t": "2025-09-30 14:10:29", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:10:29", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:11:08", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:11:08", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:11:08", "message": "Đã lưu thành công file: ctx_20250930_141108.json"}
{"stage": "run-end", "t": "2025-09-30 14:11:08"}
{"stage": "status_update", "t": "2025-09-30 14:11:08", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:11:08", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:11:38", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:11:38", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:11:38", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:11:38", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:11:42", "message": "Upload xong 4 ảnh trong 3.97s"}
{"stage": "run-start", "t": "2025-09-30 14:11:42", "cycle": "2025-09-30 14:11:42", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:11:08) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:09:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:08:39) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:11:42Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 403}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:11:42", "broker_time": "2025-09-30T07:11:42Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3852.022, "ask": 3852.059, "last": 0.0, "time": 1759216302}, "tick_stats_5m": {"ticks_per_min": 403, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 340, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8168312237853086, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.112216716139476, "M1": 2.434746265431088, "M15": 5.873942981884887, "H1": 11.016856044331915}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3861.1081939203837, "ema200": 3863.018043131654}, "M5": {"ema50": 3860.825811417268, "ema200": 3843.1702078092753}, "M15": {"ema50": 3847.650071410657, "ema200": 3808.909966198795}, "H1": {"ema50": 3810.8615122177675, "ema200": 3749.558083941559}}}, "vwap": {"day": 3860.6957230017174, "asia": null, "london": 3855.774837923185, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 17960.000000000036}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 88025.00000000009}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 34143.00000000003}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 85101.99999999985}], "round_levels": [{"level": "200", "price": 3852.02, "distance_pips": 0.2}, {"level": "225", "price": 3852.023, "distance_pips": 0.05}, {"level": "250", "price": 3852.025, "distance_pips": 0.3}, {"level": "275", "price": 3852.028, "distance_pips": 0.55}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8997580272227801}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.101, "bar_index": 292}, {"price": 3867.242, "bar_index": 286}, {"price": 3852.113, "bar_index": 279}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 115}, {"price": 3741.553, "bar_index": 111}, {"price": 3742.965, "bar_index": 130}, {"price": 3744.591, "bar_index": 108}, {"price": 3744.709, "bar_index": 105}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 276, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 282, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 297, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 285}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 287}, {"price": 3871.459, "bar_index": 292}, {"price": 3870.478, "bar_index": 284}, {"price": 3870.101, "bar_index": 278}, {"price": 3870.097, "bar_index": 276}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 109}, {"price": 3819.23, "bar_index": 103}, {"price": 3819.574, "bar_index": 105}, {"price": 3820.97, "bar_index": 123}, {"price": 3822.667, "bar_index": 166}]}, "fvgs_m5": [{"type": "Bullish", "top": 3849.442, "bottom": 3848.639, "created_at_bar": 251, "lo": 3848.639, "hi": 3849.442}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 296, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 249, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 293, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 295}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 294}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 289}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 238}, {"price": 3871.459, "bar_index": 265}, {"price": 3871.268, "bar_index": 271}, {"price": 3871.166, "bar_index": 263}, {"price": 3870.48, "bar_index": 260}], "swing_lows_SSL": [{"price": 3853.841, "bar_index": 291}, {"price": 3854.515, "bar_index": 295}, {"price": 3854.743, "bar_index": 288}, {"price": 3856.266, "bar_index": 283}, {"price": 3856.504, "bar_index": 281}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 60, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 280, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3857.246, "bottom": 3855.661, "bar_index": 296, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3851.976, "equilibrium": 3861.8685, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 297}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 278}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 276}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3852.022, "spread_points": 37, "atr_m5_pips": 411.2216716139476, "ticks_per_min": 403, "pdh_pdl_distance_pips": {"PDH": 17960.000000000036, "PDL": 88025.00000000009}, "eq50_d_distance_pips": 34143.00000000003, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:11:42", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "status_update", "t": "2025-09-30 14:11:43", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:11:43", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:12:22", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:12:22", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:12:22", "message": "Đã lưu thành công file: ctx_20250930_141222.json"}
{"stage": "run-end", "t": "2025-09-30 14:12:22"}
{"stage": "status_update", "t": "2025-09-30 14:12:22", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:12:22", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:12:52", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:12:52", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:12:52", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:12:52", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:12:56", "message": "Upload xong 4 ảnh trong 3.98s"}
{"stage": "run-start", "t": "2025-09-30 14:12:56", "cycle": "2025-09-30 14:12:56", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:12:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:11:08) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:09:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:12:56Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 380}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:12:56", "broker_time": "2025-09-30T07:12:56Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3853.574, "ask": 3853.611, "last": 0.0, "time": 1759216376}, "tick_stats_5m": {"ticks_per_min": 380, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 351, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.831233064845404, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.190216716139482, "M1": 2.52405010360358, "M15": 5.951942981884893, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3860.802500718348, "ema200": 3862.90197977702}, "M5": {"ema50": 3860.880360436876, "ema200": 3843.184048605295}, "M15": {"ema50": 3847.704620430265, "ema200": 3808.9238069948146}, "H1": {"ema50": 3810.9160612373753, "ema200": 3749.5719247375787}}}, "vwap": {"day": 3860.6792922319128, "asia": null, "london": 3855.436475198218, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 19512.00000000017}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 89577.00000000022}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 35695.00000000016}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 86654.0}], "round_levels": [{"level": "5700", "price": 3853.57, "distance_pips": 0.4}, {"level": "5725", "price": 3853.573, "distance_pips": 0.15}, {"level": "5750", "price": 3853.575, "distance_pips": 0.1}, {"level": "5775", "price": 3853.578, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8830092213916783}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.101, "bar_index": 292}, {"price": 3867.242, "bar_index": 286}, {"price": 3852.113, "bar_index": 279}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 115}, {"price": 3741.553, "bar_index": 111}, {"price": 3742.965, "bar_index": 130}, {"price": 3744.591, "bar_index": 108}, {"price": 3744.709, "bar_index": 105}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 284, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 282, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 297, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 285}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 287}, {"price": 3871.459, "bar_index": 292}, {"price": 3870.478, "bar_index": 284}, {"price": 3870.101, "bar_index": 278}, {"price": 3870.097, "bar_index": 276}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 109}, {"price": 3819.23, "bar_index": 103}, {"price": 3819.574, "bar_index": 105}, {"price": 3820.97, "bar_index": 123}, {"price": 3822.667, "bar_index": 166}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 252, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 296, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 249, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 293, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 295}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 294}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 289}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 237}, {"price": 3871.459, "bar_index": 264}, {"price": 3871.268, "bar_index": 270}, {"price": 3871.166, "bar_index": 262}, {"price": 3870.48, "bar_index": 259}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 298}, {"price": 3853.841, "bar_index": 290}, {"price": 3854.515, "bar_index": 294}, {"price": 3854.743, "bar_index": 287}, {"price": 3856.266, "bar_index": 282}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 59, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 279, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3857.246, "bottom": 3855.661, "bar_index": 295, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 296}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 277}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 275}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3853.574, "spread_points": 37, "atr_m5_pips": 419.02167161394823, "ticks_per_min": 380, "pdh_pdl_distance_pips": {"PDH": 19512.00000000017, "PDL": 89577.00000000022}, "eq50_d_distance_pips": 35695.00000000016, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:12:56", "message": "Context+MT5 xong trong 0.23s"}
{"stage": "status_update", "t": "2025-09-30 14:12:58", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:12:58", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:13:37", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:13:37", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:13:37", "message": "Đã lưu thành công file: ctx_20250930_141337.json"}
{"stage": "run-end", "t": "2025-09-30 14:13:37"}
{"stage": "status_update", "t": "2025-09-30 14:13:37", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:13:37", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:14:07", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:14:07", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:14:07", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:14:07", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:14:11", "message": "Upload xong 4 ảnh trong 3.79s"}
{"stage": "run-start", "t": "2025-09-30 14:14:11", "cycle": "2025-09-30 14:14:11", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:13:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:12:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:11:08) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:14:11Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 332}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:14:11", "broker_time": "2025-09-30T07:14:11Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3854.877, "ask": 3854.914, "last": 0.0, "time": 1759216411}, "tick_stats_5m": {"ticks_per_min": 332, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 348, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8433243012508816, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.190216716139482, "M1": 2.4878322390755745, "M15": 5.951942981884893, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3860.5703551159445, "ema200": 3862.829556641331}, "M5": {"ema50": 3860.937772201582, "ema200": 3843.198615769474}, "M15": {"ema50": 3847.7620321949707, "ema200": 3808.9383741589936}, "H1": {"ema50": 3810.9734730020814, "ema200": 3749.5864919017577}}}, "vwap": {"day": 3860.7164969318187, "asia": null, "london": 3855.382941709112, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 20815.000000000055}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 90880.0000000001}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 36998.000000000044}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 87956.99999999988}], "round_levels": [{"level": "8700", "price": 3854.87, "distance_pips": 0.7}, {"level": "8725", "price": 3854.872, "distance_pips": 0.45}, {"level": "8750", "price": 3854.875, "distance_pips": 0.2}, {"level": "8775", "price": 3854.878, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8830092214025309}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 295}, {"price": 3871.459, "bar_index": 297}, {"price": 3870.101, "bar_index": 292}, {"price": 3867.242, "bar_index": 286}, {"price": 3852.113, "bar_index": 279}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 115}, {"price": 3741.553, "bar_index": 111}, {"price": 3742.965, "bar_index": 130}, {"price": 3744.591, "bar_index": 108}, {"price": 3744.709, "bar_index": 105}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 284, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 282, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 297, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3734.526, "equilibrium": 3803.1435, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 285}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 270}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 287}, {"price": 3871.459, "bar_index": 292}, {"price": 3870.478, "bar_index": 284}, {"price": 3870.101, "bar_index": 278}, {"price": 3870.097, "bar_index": 276}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 109}, {"price": 3819.23, "bar_index": 103}, {"price": 3819.574, "bar_index": 105}, {"price": 3820.97, "bar_index": 123}, {"price": 3822.667, "bar_index": 166}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 252, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 296, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 249, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 293, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 295}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 294}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 289}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 236}, {"price": 3871.459, "bar_index": 263}, {"price": 3871.268, "bar_index": 269}, {"price": 3871.166, "bar_index": 261}, {"price": 3870.48, "bar_index": 258}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 297}, {"price": 3853.841, "bar_index": 289}, {"price": 3854.515, "bar_index": 293}, {"price": 3854.743, "bar_index": 286}, {"price": 3856.266, "bar_index": 281}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 58, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 278, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3853.281, "bottom": 3850.884, "bar_index": 297, "lo": 3850.884, "hi": 3853.281, "type": "bull"}, {"top": 3857.246, "bottom": 3855.661, "bar_index": 294, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3855.138, "bottom": 3853.121, "bar_index": 299}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 295}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 276}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3854.877, "spread_points": 37, "atr_m5_pips": 419.02167161394823, "ticks_per_min": 332, "pdh_pdl_distance_pips": {"PDH": 20815.000000000055, "PDL": 90880.0000000001}, "eq50_d_distance_pips": 36998.000000000044, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:14:11", "message": "Context+MT5 xong trong 0.18s"}
{"stage": "status_update", "t": "2025-09-30 14:14:12", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:14:12", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:14:51", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:14:51", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:14:51", "message": "Đã lưu thành công file: ctx_20250930_141451.json"}
{"stage": "run-end", "t": "2025-09-30 14:14:51"}
{"stage": "status_update", "t": "2025-09-30 14:14:51", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:14:51", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:15:21", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:15:21", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:15:21", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:15:21", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:15:25", "message": "Upload xong 4 ảnh trong 4.32s"}
{"stage": "run-start", "t": "2025-09-30 14:15:26", "cycle": "2025-09-30 14:15:26", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:14:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:13:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:12:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:15:26Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 345}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:15:26", "broker_time": "2025-09-30T07:15:26Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3852.898, "ask": 3852.935, "last": 0.0, "time": 1759216525}, "tick_stats_5m": {"ticks_per_min": 345, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 360, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8249600979919101, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.015701236432392, "M1": 2.448329474385301, "M15": 5.651589911666173, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3860.0397892295146, "ema200": 3862.739289704569}, "M5": {"ema50": 3860.601698990524, "ema200": 3843.3718855650577}, "M15": {"ema50": 3847.9426077178477, "ema200": 3809.071481186541}, "H1": {"ema50": 3810.895865158944, "ema200": 3749.566800359469}}}, "vwap": {"day": 3860.7361082139105, "asia": null, "london": 3855.264186205716, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 18836.00000000024}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 88901.00000000029}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 35019.00000000023}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 85978.00000000006}], "round_levels": [{"level": "8900", "price": 3852.89, "distance_pips": 0.8}, {"level": "8925", "price": 3852.892, "distance_pips": 0.55}, {"level": "8950", "price": 3852.895, "distance_pips": 0.3}, {"level": "8975", "price": 3852.898, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9213832857914134}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 283, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3854.92, "bottom": 3854.552, "created_at_bar": 299, "lo": 3854.552, "hi": 3854.92}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 281, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3854.552, "bottom": 3852.805, "bar_index": 299}, {"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 286}, {"price": 3871.459, "bar_index": 291}, {"price": 3870.478, "bar_index": 283}, {"price": 3870.101, "bar_index": 277}, {"price": 3870.097, "bar_index": 275}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 108}, {"price": 3819.23, "bar_index": 102}, {"price": 3819.574, "bar_index": 104}, {"price": 3820.97, "bar_index": 122}, {"price": 3822.667, "bar_index": 165}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 251, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 295, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 248, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 292, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3854.552, "bottom": 3852.805, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 294}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 293}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 234}, {"price": 3871.459, "bar_index": 261}, {"price": 3871.268, "bar_index": 267}, {"price": 3871.166, "bar_index": 259}, {"price": 3870.48, "bar_index": 256}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 295}, {"price": 3853.841, "bar_index": 287}, {"price": 3854.515, "bar_index": 291}, {"price": 3854.743, "bar_index": 284}, {"price": 3856.266, "bar_index": 279}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 56, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 276, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3853.281, "bottom": 3850.884, "bar_index": 295, "lo": 3850.884, "hi": 3853.281, "type": "bull"}, {"top": 3857.246, "bottom": 3855.661, "bar_index": 292, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3854.552, "bottom": 3852.805, "bar_index": 299}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 293}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 274}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3852.898, "spread_points": 37, "atr_m5_pips": 401.5701236432392, "ticks_per_min": 345, "pdh_pdl_distance_pips": {"PDH": 18836.00000000024, "PDL": 88901.00000000029}, "eq50_d_distance_pips": 35019.00000000023, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:15:26", "message": "Context+MT5 xong trong 1.04s"}
{"stage": "status_update", "t": "2025-09-30 14:15:27", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:15:27", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:16:06", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:16:06", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:16:06", "message": "Đã lưu thành công file: ctx_20250930_141606.json"}
{"stage": "run-end", "t": "2025-09-30 14:16:06"}
{"stage": "status_update", "t": "2025-09-30 14:16:06", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:16:06", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:16:36", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:16:36", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:16:36", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:16:36", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:16:39", "message": "Upload xong 4 ảnh trong 3.68s"}
{"stage": "run-start", "t": "2025-09-30 14:16:39", "cycle": "2025-09-30 14:16:39", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:16:06) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:14:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:13:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:16:39Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 308}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:16:39", "broker_time": "2025-09-30T07:16:39Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3852.892, "ask": 3852.929, "last": 0.0, "time": 1759216600}, "tick_stats_5m": {"ticks_per_min": 308, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 363, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.824904420771314, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.050915522146672, "M1": 2.3497396140062388, "M15": 5.686804197380455, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3859.743205535881, "ema200": 3862.625550460919}, "M5": {"ema50": 3860.601463696406, "ema200": 3843.3718258635654}, "M15": {"ema50": 3847.94237242373, "ema200": 3809.0714214850486}, "H1": {"ema50": 3810.8956298648263, "ema200": 3749.566740657977}}}, "vwap": {"day": 3860.735417285589, "asia": null, "london": 3855.171790231306, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 18829.999999999927}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 88894.99999999999}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 35012.99999999992}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 85971.99999999975}], "round_levels": [{"level": "8900", "price": 3852.89, "distance_pips": 0.2}, {"level": "8925", "price": 3852.892, "distance_pips": 0.05}, {"level": "8950", "price": 3852.895, "distance_pips": 0.3}, {"level": "8975", "price": 3852.898, "distance_pips": 0.55}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9133737743475527}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 283, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3854.92, "bottom": 3854.552, "created_at_bar": 299, "lo": 3854.552, "hi": 3854.92}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 281, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 286}, {"price": 3871.459, "bar_index": 291}, {"price": 3870.478, "bar_index": 283}, {"price": 3870.101, "bar_index": 277}, {"price": 3870.097, "bar_index": 275}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 108}, {"price": 3819.23, "bar_index": 102}, {"price": 3819.574, "bar_index": 104}, {"price": 3820.97, "bar_index": 122}, {"price": 3822.667, "bar_index": 165}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 251, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 295, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 248, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 292, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 294}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 293}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 288}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 233}, {"price": 3871.459, "bar_index": 260}, {"price": 3871.268, "bar_index": 266}, {"price": 3871.166, "bar_index": 258}, {"price": 3870.48, "bar_index": 255}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 294}, {"price": 3853.841, "bar_index": 286}, {"price": 3854.515, "bar_index": 290}, {"price": 3854.743, "bar_index": 283}, {"price": 3856.266, "bar_index": 278}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 55, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 275, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3853.281, "bottom": 3850.884, "bar_index": 294, "lo": 3850.884, "hi": 3853.281, "type": "bull"}, {"top": 3857.246, "bottom": 3855.661, "bar_index": 291, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3854.552, "bottom": 3852.358, "bar_index": 298}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 292}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 273}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3852.892, "spread_points": 37, "atr_m5_pips": 405.0915522146672, "ticks_per_min": 308, "pdh_pdl_distance_pips": {"PDH": 18829.999999999927, "PDL": 88894.99999999999}, "eq50_d_distance_pips": 35012.99999999992, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:16:40", "message": "Context+MT5 xong trong 0.23s"}
{"stage": "status_update", "t": "2025-09-30 14:16:41", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:16:41", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:17:19", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:17:19", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:17:19", "message": "Đã lưu thành công file: ctx_20250930_141719.json"}
{"stage": "run-end", "t": "2025-09-30 14:17:19"}
{"stage": "status_update", "t": "2025-09-30 14:17:19", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:17:19", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:17:49", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:17:49", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:17:49", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:17:49", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:17:54", "message": "Upload xong 4 ảnh trong 4.46s"}
{"stage": "run-start", "t": "2025-09-30 14:17:54", "cycle": "2025-09-30 14:17:54", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:17:19) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:16:06) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:14:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:17:54Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 258}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:17:54", "broker_time": "2025-09-30T07:17:54Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3853.654, "ask": 3853.731, "last": 0.0, "time": 1759216650}, "tick_stats_5m": {"ticks_per_min": 258, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 369, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8319754277866453, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.063486950718096, "M1": 2.336875559970878, "M15": 5.699375625951878, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3859.496650495072, "ema200": 3862.525838142192}, "M5": {"ema50": 3860.6313460493475, "ema200": 3843.3794079531176}, "M15": {"ema50": 3847.9722547766714, "ema200": 3809.079003574601}, "H1": {"ema50": 3810.925512217768, "ema200": 3749.574322747529}}}, "vwap": {"day": 3860.7290876000284, "asia": null, "london": 3855.0808873512606, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 19592.0000000001}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 89657.00000000015}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 35775.00000000009}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 86733.99999999993}], "round_levels": [{"level": "6500", "price": 3853.65, "distance_pips": 0.4}, {"level": "6525", "price": 3853.653, "distance_pips": 0.15}, {"level": "6550", "price": 3853.655, "distance_pips": 0.1}, {"level": "6575", "price": 3853.658, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.8949242592404085}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 283, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3854.92, "bottom": 3854.552, "created_at_bar": 299, "lo": 3854.552, "hi": 3854.92}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 281, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 286}, {"price": 3871.459, "bar_index": 291}, {"price": 3870.478, "bar_index": 283}, {"price": 3870.101, "bar_index": 277}, {"price": 3870.097, "bar_index": 275}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 108}, {"price": 3819.23, "bar_index": 102}, {"price": 3819.574, "bar_index": 104}, {"price": 3820.97, "bar_index": 122}, {"price": 3822.667, "bar_index": 165}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 251, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 295, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 248, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 292, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 294}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 293}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 288}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 232}, {"price": 3871.459, "bar_index": 259}, {"price": 3871.268, "bar_index": 265}, {"price": 3871.166, "bar_index": 257}, {"price": 3870.48, "bar_index": 254}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 293}, {"price": 3852.136, "bar_index": 298}, {"price": 3853.841, "bar_index": 285}, {"price": 3854.515, "bar_index": 289}, {"price": 3854.743, "bar_index": 282}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 54, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 274, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3853.281, "bottom": 3850.884, "bar_index": 293, "lo": 3850.884, "hi": 3853.281, "type": "bull"}, {"top": 3857.246, "bottom": 3855.661, "bar_index": 290, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 291}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 272}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 270}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3853.654, "spread_points": 77, "atr_m5_pips": 406.34869507180963, "ticks_per_min": 258, "pdh_pdl_distance_pips": {"PDH": 19592.0000000001, "PDL": 89657.00000000015}, "eq50_d_distance_pips": 35775.00000000009, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:17:54", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "status_update", "t": "2025-09-30 14:17:55", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:17:55", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:18:33", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:18:33", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:18:33", "message": "Đã lưu thành công file: ctx_20250930_141833.json"}
{"stage": "run-end", "t": "2025-09-30 14:18:33"}
{"stage": "status_update", "t": "2025-09-30 14:18:33", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:18:33", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:19:03", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:19:03", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:19:03", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:19:03", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:19:08", "message": "Upload xong 4 ảnh trong 4.63s"}
{"stage": "run-start", "t": "2025-09-30 14:19:12", "cycle": "2025-09-30 14:19:12", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:18:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:17:19) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:16:06) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:19:11Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 254}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:19:11", "broker_time": "2025-09-30T07:19:11Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3853.877, "ask": 3853.914, "last": 0.0, "time": 1759216747}, "tick_stats_5m": {"ticks_per_min": 254, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 368, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8340447644853569, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.071486950718102, "M1": 2.1581459821407507, "M15": 5.707375625951884, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3859.016637831587, "ema200": 3862.263602852549}, "M5": {"ema50": 3860.6400911473866, "ema200": 3843.38162685859}, "M15": {"ema50": 3847.9809998747105, "ema200": 3809.0812224800734}, "H1": {"ema50": 3810.934257315807, "ema200": 3749.5765416530016}}}, "vwap": {"day": 3860.746188485075, "asia": null, "london": 3854.9712503844817, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 19815.000000000055}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 89880.0000000001}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 35998.000000000044}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 86956.99999999988}], "round_levels": [{"level": "8700", "price": 3853.87, "distance_pips": 0.7}, {"level": "8725", "price": 3853.872, "distance_pips": 0.45}, {"level": "8750", "price": 3853.875, "distance_pips": 0.2}, {"level": "8775", "price": 3853.878, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9087588993435463}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 283, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3854.92, "bottom": 3854.552, "created_at_bar": 299, "lo": 3854.552, "hi": 3854.92}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 281, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 286}, {"price": 3871.459, "bar_index": 291}, {"price": 3870.478, "bar_index": 283}, {"price": 3870.101, "bar_index": 277}, {"price": 3870.097, "bar_index": 275}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 108}, {"price": 3819.23, "bar_index": 102}, {"price": 3819.574, "bar_index": 104}, {"price": 3820.97, "bar_index": 122}, {"price": 3822.667, "bar_index": 165}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 251, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 295, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 248, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 292, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 294}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 293}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 288}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 230}, {"price": 3871.459, "bar_index": 257}, {"price": 3871.268, "bar_index": 263}, {"price": 3871.166, "bar_index": 255}, {"price": 3870.48, "bar_index": 252}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 291}, {"price": 3852.024, "bar_index": 297}, {"price": 3853.841, "bar_index": 283}, {"price": 3854.515, "bar_index": 287}, {"price": 3854.743, "bar_index": 280}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 52, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 272, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3857.246, "bottom": 3855.661, "bar_index": 288, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3853.877, "bottom": 3853.234, "bar_index": 299}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 289}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 270}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3853.877, "spread_points": 37, "atr_m5_pips": 407.14869507181015, "ticks_per_min": 254, "pdh_pdl_distance_pips": {"PDH": 19815.000000000055, "PDL": 89880.0000000001}, "eq50_d_distance_pips": 35998.000000000044, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:19:12", "message": "Context+MT5 xong trong 3.79s"}
{"stage": "status_update", "t": "2025-09-30 14:19:13", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:19:13", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:19:52", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:19:52", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:19:52", "message": "Đã lưu thành công file: ctx_20250930_141952.json"}
{"stage": "run-end", "t": "2025-09-30 14:19:52"}
{"stage": "status_update", "t": "2025-09-30 14:19:52", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:19:52", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:20:22", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:20:22", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:20:22", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:20:22", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:20:26", "message": "Upload xong 4 ảnh trong 4.12s"}
{"stage": "run-start", "t": "2025-09-30 14:20:26", "cycle": "2025-09-30 14:20:26", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:19:52) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:18:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:17:19) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:20:26Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 225}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:20:26", "broker_time": "2025-09-30T07:20:26Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3854.273, "ask": 3854.31, "last": 0.0, "time": 1759216825}, "tick_stats_5m": {"ticks_per_min": 225, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 364, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8377194610445065, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.8425389032393746, "M1": 2.1106355547823146, "M15": 5.727804197380459, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3858.8356470399813, "ema200": 3862.0668743865854}, "M5": {"ema50": 3860.3954432614637, "ema200": 3843.435608460271}, "M15": {"ema50": 3847.9965292864754, "ema200": 3809.085162778581}, "H1": {"ema50": 3810.949786727572, "ema200": 3749.5804819515092}}}, "vwap": {"day": 3860.7479025930506, "asia": null, "london": 3854.941753897657, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 20211.00000000024}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 90276.00000000029}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 36394.00000000023}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 87353.00000000006}], "round_levels": [{"level": "2700", "price": 3854.27, "distance_pips": 0.3}, {"level": "2725", "price": 3854.273, "distance_pips": 0.05}, {"level": "2750", "price": 3854.275, "distance_pips": 0.2}, {"level": "2775", "price": 3854.278, "distance_pips": 0.45}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9629050201317438}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 283, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3854.92, "bottom": 3854.838, "created_at_bar": 299, "lo": 3854.838, "hi": 3854.92}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 281, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 285}, {"price": 3871.459, "bar_index": 290}, {"price": 3870.478, "bar_index": 282}, {"price": 3870.101, "bar_index": 276}, {"price": 3870.097, "bar_index": 274}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 107}, {"price": 3819.23, "bar_index": 101}, {"price": 3819.574, "bar_index": 103}, {"price": 3820.97, "bar_index": 121}, {"price": 3822.667, "bar_index": 164}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 250, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 294, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 247, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 291, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 293}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 292}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 287}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 229}, {"price": 3871.459, "bar_index": 256}, {"price": 3871.268, "bar_index": 262}, {"price": 3871.166, "bar_index": 254}, {"price": 3870.48, "bar_index": 251}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 290}, {"price": 3852.024, "bar_index": 296}, {"price": 3853.841, "bar_index": 282}, {"price": 3854.515, "bar_index": 286}, {"price": 3854.743, "bar_index": 279}]}, "fvgs_m1": [{"type": "Bullish", "top": 3853.995, "bottom": 3853.804, "created_at_bar": 299, "lo": 3853.804, "hi": 3853.995}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 271, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3857.246, "bottom": 3855.661, "bar_index": 287, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 288}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 269}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 267}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3854.273, "spread_points": 37, "atr_m5_pips": 384.25389032393747, "ticks_per_min": 225, "pdh_pdl_distance_pips": {"PDH": 20211.00000000024, "PDL": 90276.00000000029}, "eq50_d_distance_pips": 36394.00000000023, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:20:26", "message": "Context+MT5 xong trong 0.18s"}
{"stage": "status_update", "t": "2025-09-30 14:20:28", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:20:28", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:21:07", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:21:07", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:21:07", "message": "Đã lưu thành công file: ctx_20250930_142107.json"}
{"stage": "run-end", "t": "2025-09-30 14:21:07"}
{"stage": "status_update", "t": "2025-09-30 14:21:07", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:21:07", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:21:37", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:21:37", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:21:37", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:21:37", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:21:41", "message": "Upload xong 4 ảnh trong 4.15s"}
{"stage": "run-start", "t": "2025-09-30 14:21:41", "cycle": "2025-09-30 14:21:41", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:21:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:19:52) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:18:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:21:41Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 237}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:21:41", "broker_time": "2025-09-30T07:21:41Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3854.851, "ask": 3854.888, "last": 0.0, "time": 1759216900}, "tick_stats_5m": {"ticks_per_min": 237, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 355, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8430830332949795, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.9358960460964703, "M1": 2.1747024028865796, "M15": 5.744732768809004, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3858.6412443635923, "ema200": 3862.024534468524}, "M5": {"ema50": 3860.417678555581, "ema200": 3843.4412502513155}, "M15": {"ema50": 3848.0187645805927, "ema200": 3809.0908045696256}, "H1": {"ema50": 3810.972022021689, "ema200": 3749.586123742554}}}, "vwap": {"day": 3860.7880539850985, "asia": null, "london": 3854.897000733911, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 20789.000000000215}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 90854.00000000026}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 36972.000000000204}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 87931.00000000004}], "round_levels": [{"level": "8500", "price": 3854.85, "distance_pips": 0.1}, {"level": "8525", "price": 3854.852, "distance_pips": 0.15}, {"level": "8550", "price": 3854.855, "distance_pips": 0.4}, {"level": "8575", "price": 3854.858, "distance_pips": 0.65}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9400654785205245}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 283, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 298, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 281, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 285}, {"price": 3871.459, "bar_index": 290}, {"price": 3870.478, "bar_index": 282}, {"price": 3870.101, "bar_index": 276}, {"price": 3870.097, "bar_index": 274}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 107}, {"price": 3819.23, "bar_index": 101}, {"price": 3819.574, "bar_index": 103}, {"price": 3820.97, "bar_index": 121}, {"price": 3822.667, "bar_index": 164}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 250, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 294, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 247, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 291, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 293}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 292}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 287}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 228}, {"price": 3871.459, "bar_index": 255}, {"price": 3871.268, "bar_index": 261}, {"price": 3871.166, "bar_index": 253}, {"price": 3870.48, "bar_index": 250}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 289}, {"price": 3852.024, "bar_index": 295}, {"price": 3852.925, "bar_index": 298}, {"price": 3853.841, "bar_index": 281}, {"price": 3854.515, "bar_index": 285}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 50, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 270, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3857.246, "bottom": 3855.661, "bar_index": 286, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3855.075, "bottom": 3853.061, "bar_index": 299}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 287}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 268}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3854.851, "spread_points": 37, "atr_m5_pips": 393.58960460964704, "ticks_per_min": 237, "pdh_pdl_distance_pips": {"PDH": 20789.000000000215, "PDL": 90854.00000000026}, "eq50_d_distance_pips": 36972.000000000204, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:21:41", "message": "Context+MT5 xong trong 0.21s"}
{"stage": "status_update", "t": "2025-09-30 14:21:42", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:21:43", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:22:22", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:22:22", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:22:22", "message": "Đã lưu thành công file: ctx_20250930_142222.json"}
{"stage": "run-end", "t": "2025-09-30 14:22:22"}
{"stage": "status_update", "t": "2025-09-30 14:22:22", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:22:22", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:22:52", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:22:52", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:22:52", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:22:52", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:22:56", "message": "Upload xong 4 ảnh trong 4.44s"}
{"stage": "run-start", "t": "2025-09-30 14:22:56", "cycle": "2025-09-30 14:22:56", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:22:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:21:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:19:52) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:22:56Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 205}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:22:56", "broker_time": "2025-09-30T07:22:56Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3854.716, "ask": 3854.753, "last": 0.0, "time": 1759216976}, "tick_stats_5m": {"ticks_per_min": 205, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 347, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8418302958316316, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.9721103318107605, "M1": 2.1113665169845497, "M15": 5.780947054523295, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3858.4668881734565, "ema200": 3861.916751222989}, "M5": {"ema50": 3860.412815810483, "ema200": 3843.44001642047}, "M15": {"ema50": 3848.013901835495, "ema200": 3809.08957073878}, "H1": {"ema50": 3810.9671592765912, "ema200": 3749.584889911708}}}, "vwap": {"day": 3860.8398748203153, "asia": null, "london": 3854.887347971169, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 20653.999999999996}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 90719.00000000004}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 36836.999999999985}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 87795.99999999983}], "round_levels": [{"level": "7100", "price": 3854.71, "distance_pips": 0.6}, {"level": "7125", "price": 3854.713, "distance_pips": 0.35}, {"level": "7150", "price": 3854.715, "distance_pips": 0.1}, {"level": "7175", "price": 3854.718, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9314947700205195}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 283, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 298, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 281, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 285}, {"price": 3871.459, "bar_index": 290}, {"price": 3870.478, "bar_index": 282}, {"price": 3870.101, "bar_index": 276}, {"price": 3870.097, "bar_index": 274}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 107}, {"price": 3819.23, "bar_index": 101}, {"price": 3819.574, "bar_index": 103}, {"price": 3820.97, "bar_index": 121}, {"price": 3822.667, "bar_index": 164}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 250, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 294, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 247, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 291, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 293}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 292}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 287}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 227}, {"price": 3871.459, "bar_index": 254}, {"price": 3871.268, "bar_index": 260}, {"price": 3871.166, "bar_index": 252}, {"price": 3870.48, "bar_index": 249}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 288}, {"price": 3852.024, "bar_index": 294}, {"price": 3852.925, "bar_index": 297}, {"price": 3853.841, "bar_index": 280}, {"price": 3854.515, "bar_index": 284}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 49, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 269, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3857.246, "bottom": 3855.661, "bar_index": 285, "lo": 3855.661, "hi": 3857.246, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 286}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 267}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 265}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3854.716, "spread_points": 37, "atr_m5_pips": 397.21103318107606, "ticks_per_min": 205, "pdh_pdl_distance_pips": {"PDH": 20653.999999999996, "PDL": 90719.00000000004}, "eq50_d_distance_pips": 36836.999999999985, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:22:56", "message": "Context+MT5 xong trong 0.18s"}
{"stage": "status_update", "t": "2025-09-30 14:22:57", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:22:57", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:23:36", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:23:36", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:23:36", "message": "Đã lưu thành công file: ctx_20250930_142336.json"}
{"stage": "run-end", "t": "2025-09-30 14:23:36"}
{"stage": "status_update", "t": "2025-09-30 14:23:36", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:23:36", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:24:06", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:24:06", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:24:06", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:24:06", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:24:10", "message": "Upload xong 4 ảnh trong 4.17s"}
{"stage": "run-start", "t": "2025-09-30 14:24:10", "cycle": "2025-09-30 14:24:10", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:23:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:22:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:21:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:24:10Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 206}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:24:10", "broker_time": "2025-09-30T07:24:10Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3853.432, "ask": 3853.469, "last": 0.0, "time": 1759217050}, "tick_stats_5m": {"ticks_per_min": 206, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 335, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.829915370624697, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.002967474667921, "M1": 2.0118160274148336, "M15": 5.780947054523295, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3858.09093849412, "ema200": 3861.7439716586728}, "M5": {"ema50": 3860.3624628693065, "ema200": 3843.427240301067}, "M15": {"ema50": 3847.963548894318, "ema200": 3809.076794619377}, "H1": {"ema50": 3810.9168063354145, "ema200": 3749.572113792305}}}, "vwap": {"day": 3860.9131448452717, "asia": null, "london": 3854.847385501268, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 19369.99999999989}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 89434.99999999994}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 35552.99999999988}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 86511.99999999971}], "round_levels": [{"level": "4300", "price": 3853.43, "distance_pips": 0.2}, {"level": "4325", "price": 3853.433, "distance_pips": 0.05}, {"level": "4350", "price": 3853.435, "distance_pips": 0.3}, {"level": "4375", "price": 3853.438, "distance_pips": 0.55}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.924314280203623}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 283, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 298, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 281, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 285}, {"price": 3871.459, "bar_index": 290}, {"price": 3870.478, "bar_index": 282}, {"price": 3870.101, "bar_index": 276}, {"price": 3870.097, "bar_index": 274}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 107}, {"price": 3819.23, "bar_index": 101}, {"price": 3819.574, "bar_index": 103}, {"price": 3820.97, "bar_index": 121}, {"price": 3822.667, "bar_index": 164}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 250, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 294, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 247, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 291, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 293}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 292}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 287}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 225}, {"price": 3871.459, "bar_index": 252}, {"price": 3871.268, "bar_index": 258}, {"price": 3871.166, "bar_index": 250}, {"price": 3870.48, "bar_index": 247}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 286}, {"price": 3852.024, "bar_index": 292}, {"price": 3852.493, "bar_index": 298}, {"price": 3852.925, "bar_index": 295}, {"price": 3853.841, "bar_index": 278}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 47, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3854.294, "bottom": 3853.654, "created_at_bar": 299, "lo": 3853.654, "hi": 3854.294}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 297, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 284}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 265}, {"type": "Bearish", "top": 3867.295, "bottom": 3864.72, "bar_index": 263}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3853.432, "spread_points": 37, "atr_m5_pips": 400.29674746679206, "ticks_per_min": 206, "pdh_pdl_distance_pips": {"PDH": 19369.99999999989, "PDL": 89434.99999999994}, "eq50_d_distance_pips": 35552.99999999988, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:24:11", "message": "Context+MT5 xong trong 0.69s"}
{"stage": "status_update", "t": "2025-09-30 14:24:11", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:24:11", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:24:50", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:24:50", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:24:50", "message": "Đã lưu thành công file: ctx_20250930_142450.json"}
{"stage": "run-end", "t": "2025-09-30 14:24:50"}
{"stage": "status_update", "t": "2025-09-30 14:24:50", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:24:50", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:25:20", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:25:20", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:25:20", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:25:20", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:25:24", "message": "Upload xong 4 ảnh trong 4.04s"}
{"stage": "run-start", "t": "2025-09-30 14:25:24", "cycle": "2025-09-30 14:25:24", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:24:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:23:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:22:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:25:24Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 219}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:25:24", "broker_time": "2025-09-30T07:25:24Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3852.669, "ask": 3852.706, "last": 0.0, "time": 1759217124}, "tick_stats_5m": {"ticks_per_min": 219, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 328, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8228350840726024, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.88238306318183, "M1": 2.0856556988959314, "M15": 5.83587562595185, "H1": 11.094856044331921}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3857.8227315419113, "ema200": 3861.5812419393387}, "M5": {"ema50": 3860.0051785296473, "ema200": 3843.4629967936644}, "M15": {"ema50": 3847.933627325691, "ema200": 3809.069202579576}, "H1": {"ema50": 3810.8868847667873, "ema200": 3749.5645217525043}}}, "vwap": {"day": 3860.9580419342637, "asia": null, "london": 3854.7464534523374, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 18606.99999999997}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 88672.00000000003}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 34789.99999999996}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 85748.9999999998}], "round_levels": [{"level": "6600", "price": 3852.66, "distance_pips": 0.9}, {"level": "6625", "price": 3852.662, "distance_pips": 0.65}, {"level": "6650", "price": 3852.665, "distance_pips": 0.4}, {"level": "6675", "price": 3852.668, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9530229088197796}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3852.421, "bottom": 3850.0, "created_at_bar": 283, "lo": 3850.0, "hi": 3852.421}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 298, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3850.0, "bottom": 3847.279, "bar_index": 281, "lo": 3847.279, "hi": 3850.0, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 284}, {"price": 3871.459, "bar_index": 289}, {"price": 3870.478, "bar_index": 281}, {"price": 3870.101, "bar_index": 275}, {"price": 3870.097, "bar_index": 273}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 106}, {"price": 3819.574, "bar_index": 102}, {"price": 3820.97, "bar_index": 120}, {"price": 3822.667, "bar_index": 163}, {"price": 3822.809, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3852.421, "bottom": 3849.845, "created_at_bar": 249, "lo": 3849.845, "hi": 3852.421}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 293, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 246, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 290, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 292}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 291}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 286}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 224}, {"price": 3871.459, "bar_index": 251}, {"price": 3871.268, "bar_index": 257}, {"price": 3871.166, "bar_index": 249}, {"price": 3870.48, "bar_index": 246}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 285}, {"price": 3852.024, "bar_index": 291}, {"price": 3852.925, "bar_index": 294}, {"price": 3853.841, "bar_index": 277}, {"price": 3854.515, "bar_index": 281}]}, "fvgs_m1": [{"type": "Bullish", "top": 3851.254, "bottom": 3850.533, "created_at_bar": 46, "lo": 3850.533, "hi": 3851.254}, {"type": "Bearish", "top": 3854.294, "bottom": 3853.66, "created_at_bar": 298, "lo": 3853.66, "hi": 3854.294}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 296, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3850.884, "equilibrium": 3861.3225, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 298}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 283}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 264}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3852.669, "spread_points": 37, "atr_m5_pips": 388.238306318183, "ticks_per_min": 219, "pdh_pdl_distance_pips": {"PDH": 18606.99999999997, "PDL": 88672.00000000003}, "eq50_d_distance_pips": 34789.99999999996, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:25:24", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "status_update", "t": "2025-09-30 14:25:25", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:25:25", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:26:04", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:26:04", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:26:04", "message": "Đã lưu thành công file: ctx_20250930_142604.json"}
{"stage": "run-end", "t": "2025-09-30 14:26:04"}
{"stage": "status_update", "t": "2025-09-30 14:26:04", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:26:04", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:26:34", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:26:34", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:26:34", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:26:34", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:26:38", "message": "Upload xong 4 ảnh trong 4.34s"}
{"stage": "run-start", "t": "2025-09-30 14:26:38", "cycle": "2025-09-30 14:26:38", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:26:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:24:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:23:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:26:38Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 258}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:26:38", "broker_time": "2025-09-30T07:26:38Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3849.085, "ask": 3849.122, "last": 0.0, "time": 1759217199}, "tick_stats_5m": {"ticks_per_min": 258, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 330, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7895772243049636, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.110811634610425, "M1": 2.2374098836454905, "M15": 6.03751848309473, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3857.414125020483, "ema200": 3861.5304461370506}, "M5": {"ema50": 3859.8476491178826, "ema200": 3843.4230266444106}, "M15": {"ema50": 3847.776097913926, "ema200": 3809.0292324303223}, "H1": {"ema50": 3810.7293553550226, "ema200": 3749.5245516032505}}}, "vwap": {"day": 3860.944952989362, "asia": null, "london": 3854.5323346624455, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 15023.000000000138}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 85088.00000000019}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 31206.00000000013}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 82164.99999999996}], "round_levels": [{"level": "800", "price": 3849.08, "distance_pips": 0.5}, {"level": "825", "price": 3849.082, "distance_pips": 0.25}, {"level": "850", "price": 3849.085, "distance_pips": 0.0}, {"level": "875", "price": 3849.088, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9000655658432675}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 275, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 298, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 273, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3855.582, "bottom": 3848.432, "bar_index": 299}, {"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 284}, {"price": 3871.459, "bar_index": 289}, {"price": 3870.478, "bar_index": 281}, {"price": 3870.101, "bar_index": 275}, {"price": 3870.097, "bar_index": 273}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 106}, {"price": 3819.574, "bar_index": 102}, {"price": 3820.97, "bar_index": 120}, {"price": 3822.667, "bar_index": 163}, {"price": 3822.809, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 208, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 293, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 246, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 290, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3853.071, "bottom": 3848.432, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 292}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 291}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 223}, {"price": 3871.459, "bar_index": 250}, {"price": 3871.268, "bar_index": 256}, {"price": 3871.166, "bar_index": 248}, {"price": 3870.48, "bar_index": 245}], "swing_lows_SSL": [{"price": 3850.884, "bar_index": 284}, {"price": 3852.024, "bar_index": 290}, {"price": 3852.925, "bar_index": 293}, {"price": 3853.841, "bar_index": 276}, {"price": 3854.515, "bar_index": 280}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 39, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3854.294, "bottom": 3853.66, "created_at_bar": 297, "lo": 3853.66, "hi": 3854.294}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 295, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 297}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 282}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 263}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3849.085, "spread_points": 37, "atr_m5_pips": 411.0811634610425, "ticks_per_min": 258, "pdh_pdl_distance_pips": {"PDH": 15023.000000000138, "PDL": 85088.00000000019}, "eq50_d_distance_pips": 31206.00000000013, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:26:39", "message": "Context+MT5 xong trong 0.43s"}
{"stage": "status_update", "t": "2025-09-30 14:26:40", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:26:40", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:27:18", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:27:18", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:27:18", "message": "Đã lưu thành công file: ctx_20250930_142718.json"}
{"stage": "run-end", "t": "2025-09-30 14:27:19"}
{"stage": "status_update", "t": "2025-09-30 14:27:19", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:27:19", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:27:49", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:27:49", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:27:49", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:27:49", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:27:53", "message": "Upload xong 4 ảnh trong 4.34s"}
{"stage": "run-start", "t": "2025-09-30 14:27:54", "cycle": "2025-09-30 14:27:54", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:27:18) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:26:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:24:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:27:54Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 303}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:27:54", "broker_time": "2025-09-30T07:27:54Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3851.072, "ask": 3851.109, "last": 0.0, "time": 1759217273}, "tick_stats_5m": {"ticks_per_min": 303, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 328, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8080156638580618, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.110811634610425, "M1": 2.2744520348307082, "M15": 6.03751848309473, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3857.2255522750556, "ema200": 3861.4765563674982}, "M5": {"ema50": 3859.942551078667, "ema200": 3843.4471062464004}, "M15": {"ema50": 3847.8709998747104, "ema200": 3809.053312032312}, "H1": {"ema50": 3810.824257315807, "ema200": 3749.5486312052403}}}, "vwap": {"day": 3860.9274640484437, "asia": null, "london": 3854.364605315837, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 17010.00000000022}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 87075.00000000028}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 33193.00000000021}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 84152.00000000004}], "round_levels": [{"level": "700", "price": 3851.07, "distance_pips": 0.2}, {"level": "725", "price": 3851.073, "distance_pips": 0.05}, {"level": "750", "price": 3851.075, "distance_pips": 0.3}, {"level": "775", "price": 3851.078, "distance_pips": 0.55}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9000655658432675}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 275, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 298, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 273, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 284}, {"price": 3871.459, "bar_index": 289}, {"price": 3870.478, "bar_index": 281}, {"price": 3870.101, "bar_index": 275}, {"price": 3870.097, "bar_index": 273}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 106}, {"price": 3819.574, "bar_index": 102}, {"price": 3820.97, "bar_index": 120}, {"price": 3822.667, "bar_index": 163}, {"price": 3822.809, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 208, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 293, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 246, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 290, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 292}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 291}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 286}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 222}, {"price": 3871.459, "bar_index": 249}, {"price": 3871.268, "bar_index": 255}, {"price": 3871.166, "bar_index": 247}, {"price": 3870.48, "bar_index": 244}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 298}, {"price": 3850.884, "bar_index": 283}, {"price": 3852.024, "bar_index": 289}, {"price": 3852.925, "bar_index": 292}, {"price": 3853.841, "bar_index": 275}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 38, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3854.294, "bottom": 3853.66, "created_at_bar": 296, "lo": 3853.66, "hi": 3854.294}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 294, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 296}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 281}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 262}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3851.072, "spread_points": 37, "atr_m5_pips": 411.0811634610425, "ticks_per_min": 303, "pdh_pdl_distance_pips": {"PDH": 17010.00000000022, "PDL": 87075.00000000028}, "eq50_d_distance_pips": 33193.00000000021, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:27:54", "message": "Context+MT5 xong trong 0.81s"}
{"stage": "status_update", "t": "2025-09-30 14:27:55", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:27:55", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:28:34", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:28:34", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:28:34", "message": "Đã lưu thành công file: ctx_20250930_142834.json"}
{"stage": "run-end", "t": "2025-09-30 14:28:34"}
{"stage": "status_update", "t": "2025-09-30 14:28:34", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:28:34", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:29:04", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:29:04", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:29:04", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:29:04", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:29:08", "message": "Upload xong 4 ảnh trong 4.35s"}
{"stage": "run-start", "t": "2025-09-30 14:29:08", "cycle": "2025-09-30 14:29:08", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:28:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:27:18) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:26:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:29:08Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 312}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:29:08", "broker_time": "2025-09-30T07:29:08Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3851.73, "ask": 3851.767, "last": 0.0, "time": 1759217349}, "tick_stats_5m": {"ticks_per_min": 312, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 321, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8141215990497761, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.119525920324731, "M1": 2.1732877238675847, "M15": 6.03751848309473, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3856.8154131941574, "ema200": 3861.245552190222}, "M5": {"ema50": 3859.9569432355297, "ema200": 3843.450757987694}, "M15": {"ema50": 3847.8853920315732, "ema200": 3809.0569637736057}, "H1": {"ema50": 3810.8386494726697, "ema200": 3749.552282946534}}}, "vwap": {"day": 3860.9727685382927, "asia": null, "london": 3854.288694665235, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 17668.00000000012}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 87733.00000000017}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 33851.00000000011}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 84809.99999999994}], "round_levels": [{"level": "7300", "price": 3851.73, "distance_pips": 0.0}, {"level": "7325", "price": 3851.733, "distance_pips": 0.25}, {"level": "7350", "price": 3851.735, "distance_pips": 0.5}, {"level": "7375", "price": 3851.738, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8981616019760491}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 294}, {"price": 3871.459, "bar_index": 296}, {"price": 3870.101, "bar_index": 291}, {"price": 3867.242, "bar_index": 285}, {"price": 3852.113, "bar_index": 278}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 114}, {"price": 3741.553, "bar_index": 110}, {"price": 3742.965, "bar_index": 129}, {"price": 3744.591, "bar_index": 107}, {"price": 3744.709, "bar_index": 104}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 275, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 298, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 273, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 296, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 284}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 269}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 284}, {"price": 3871.459, "bar_index": 289}, {"price": 3870.478, "bar_index": 281}, {"price": 3870.101, "bar_index": 275}, {"price": 3870.097, "bar_index": 273}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 106}, {"price": 3819.574, "bar_index": 102}, {"price": 3820.97, "bar_index": 120}, {"price": 3822.667, "bar_index": 163}, {"price": 3822.809, "bar_index": 117}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 208, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 293, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 246, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 290, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 292}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 291}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 286}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 220}, {"price": 3871.459, "bar_index": 247}, {"price": 3871.268, "bar_index": 253}, {"price": 3871.166, "bar_index": 245}, {"price": 3870.48, "bar_index": 242}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 296}, {"price": 3850.884, "bar_index": 281}, {"price": 3852.024, "bar_index": 287}, {"price": 3852.925, "bar_index": 290}, {"price": 3853.841, "bar_index": 273}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 36, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3854.294, "bottom": 3853.66, "created_at_bar": 294, "lo": 3853.66, "hi": 3854.294}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 292, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3852.487, "bottom": 3851.439, "bar_index": 299}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 294}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 279}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3851.73, "spread_points": 37, "atr_m5_pips": 411.95259203247315, "ticks_per_min": 312, "pdh_pdl_distance_pips": {"PDH": 17668.00000000012, "PDL": 87733.00000000017}, "eq50_d_distance_pips": 33851.00000000011, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:29:09", "message": "Context+MT5 xong trong 0.76s"}
{"stage": "status_update", "t": "2025-09-30 14:29:10", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:29:10", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:29:49", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:29:49", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:29:49", "message": "Đã lưu thành công file: ctx_20250930_142949.json"}
{"stage": "run-end", "t": "2025-09-30 14:29:49"}
{"stage": "status_update", "t": "2025-09-30 14:29:49", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:29:49", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:30:19", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:30:19", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:30:19", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:30:19", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:30:24", "message": "Upload xong 4 ảnh trong 4.85s"}
{"stage": "run-start", "t": "2025-09-30 14:30:24", "cycle": "2025-09-30 14:30:24", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:29:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:28:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:27:18) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:30:24Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 309}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:30:24", "broker_time": "2025-09-30T07:30:24Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3853.395, "ask": 3853.432, "last": 0.0, "time": 1759217424}, "tick_stats_5m": {"ticks_per_min": 309, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 315, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8295720277643743, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.918457742409344, "M1": 2.1614457435628833, "M15": 5.664695734147645, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3856.742175767184, "ema200": 3861.256990082241}, "M5": {"ema50": 3859.760505300806, "ema200": 3843.612872022039}, "M15": {"ema50": 3848.162329005869, "ema200": 3809.4050269154923}, "H1": {"ema50": 3810.9153553550227, "ema200": 3749.5717456331013}}}, "vwap": {"day": 3861.047140738993, "asia": null, "london": 3854.249070564167, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 19333.000000000084}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 89398.00000000013}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 35516.00000000007}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 86474.99999999991}], "round_levels": [{"level": "3900", "price": 3853.39, "distance_pips": 0.5}, {"level": "3925", "price": 3853.392, "distance_pips": 0.25}, {"level": "3950", "price": 3853.395, "distance_pips": 0.0}, {"level": "3975", "price": 3853.398, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9442490498074628}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 283}, {"price": 3871.459, "bar_index": 288}, {"price": 3870.478, "bar_index": 280}, {"price": 3870.101, "bar_index": 274}, {"price": 3870.097, "bar_index": 272}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 105}, {"price": 3819.574, "bar_index": 101}, {"price": 3820.97, "bar_index": 119}, {"price": 3822.667, "bar_index": 162}, {"price": 3822.809, "bar_index": 116}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 207, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 292, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 245, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 289, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 291}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 290}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 285}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 219}, {"price": 3871.459, "bar_index": 246}, {"price": 3871.268, "bar_index": 252}, {"price": 3871.166, "bar_index": 244}, {"price": 3870.48, "bar_index": 241}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 295}, {"price": 3850.884, "bar_index": 280}, {"price": 3852.024, "bar_index": 286}, {"price": 3852.925, "bar_index": 289}, {"price": 3853.841, "bar_index": 272}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 35, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3854.294, "bottom": 3853.66, "created_at_bar": 293, "lo": 3853.66, "hi": 3854.294}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 291, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 293}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 278}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 259}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3853.395, "spread_points": 37, "atr_m5_pips": 391.84577424093436, "ticks_per_min": 309, "pdh_pdl_distance_pips": {"PDH": 19333.000000000084, "PDL": 89398.00000000013}, "eq50_d_distance_pips": 35516.00000000007, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:30:24", "message": "Context+MT5 xong trong 0.23s"}
{"stage": "status_update", "t": "2025-09-30 14:30:25", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:30:25", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:31:03", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:31:03", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:31:03", "message": "Đã lưu thành công file: ctx_20250930_143103.json"}
{"stage": "run-end", "t": "2025-09-30 14:31:04"}
{"stage": "status_update", "t": "2025-09-30 14:31:04", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:31:04", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:31:34", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:31:34", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:31:34", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:31:34", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:31:41", "message": "Upload xong 4 ảnh trong 7.38s"}
{"stage": "run-start", "t": "2025-09-30 14:31:41", "cycle": "2025-09-30 14:31:41", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:31:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:29:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:28:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:31:41Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 241}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:31:41", "broker_time": "2025-09-30T07:31:41Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3854.046, "ask": 3854.083, "last": 0.0, "time": 1759217486}, "tick_stats_5m": {"ticks_per_min": 241, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 305, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8356130061987294, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.9650291709807433, "M1": 2.096924108821345, "M15": 5.711267162719044, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3856.658219935058, "ema200": 3861.1809757898827}, "M5": {"ema50": 3859.7860347125707, "ema200": 3843.6193496339793}, "M15": {"ema50": 3848.187858417634, "ema200": 3809.4115045274325}, "H1": {"ema50": 3810.9408847667873, "ema200": 3749.5782232450415}}}, "vwap": {"day": 3861.12022452694, "asia": null, "london": 3854.2452441693945, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 19983.999999999924}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 90048.99999999997}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 36166.99999999991}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 87125.99999999975}], "round_levels": [{"level": "400", "price": 3854.04, "distance_pips": 0.6}, {"level": "425", "price": 3854.043, "distance_pips": 0.35}, {"level": "450", "price": 3854.045, "distance_pips": 0.1}, {"level": "475", "price": 3854.048, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9331583301090833}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3854.173, "bottom": 3852.703, "bar_index": 299}, {"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 283}, {"price": 3871.459, "bar_index": 288}, {"price": 3870.478, "bar_index": 280}, {"price": 3870.101, "bar_index": 274}, {"price": 3870.097, "bar_index": 272}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 105}, {"price": 3819.574, "bar_index": 101}, {"price": 3820.97, "bar_index": 119}, {"price": 3822.667, "bar_index": 162}, {"price": 3822.809, "bar_index": 116}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 207, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 292, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 245, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 289, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3854.173, "bottom": 3852.703, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 291}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 290}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 218}, {"price": 3871.459, "bar_index": 245}, {"price": 3871.268, "bar_index": 251}, {"price": 3871.166, "bar_index": 243}, {"price": 3870.48, "bar_index": 240}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 294}, {"price": 3850.884, "bar_index": 279}, {"price": 3852.024, "bar_index": 285}, {"price": 3852.925, "bar_index": 288}, {"price": 3853.841, "bar_index": 271}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 34, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 260, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 290, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 292}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 277}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 258}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3854.046, "spread_points": 37, "atr_m5_pips": 396.5029170980743, "ticks_per_min": 241, "pdh_pdl_distance_pips": {"PDH": 19983.999999999924, "PDL": 90048.99999999997}, "eq50_d_distance_pips": 36166.99999999991, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:31:41", "message": "Context+MT5 xong trong 0.18s"}
{"stage": "status_update", "t": "2025-09-30 14:31:42", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:31:42", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:32:21", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:32:21", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:32:21", "message": "Đã lưu thành công file: ctx_20250930_143221.json"}
{"stage": "run-end", "t": "2025-09-30 14:32:21"}
{"stage": "status_update", "t": "2025-09-30 14:32:21", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:32:21", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:32:51", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:32:51", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:32:51", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:32:51", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:32:56", "message": "Upload xong 4 ảnh trong 5.04s"}
{"stage": "run-start", "t": "2025-09-30 14:32:57", "cycle": "2025-09-30 14:32:57", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:32:21) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:31:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:29:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:32:57Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 220}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:32:57", "broker_time": "2025-09-30T07:32:57Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3853.521, "ask": 3853.558, "last": 0.0, "time": 1759217576}, "tick_stats_5m": {"ticks_per_min": 220, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 300, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8307412493968324, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.010743456695052, "M1": 2.0772611622527597, "M15": 5.756981448433353, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3856.5216266088178, "ema200": 3861.0924483734675}, "M5": {"ema50": 3859.7654464772763, "ema200": 3843.6141257533823}, "M15": {"ema50": 3848.1672701823395, "ema200": 3809.4062806468355}, "H1": {"ema50": 3810.920296531493, "ema200": 3749.5729993644445}}}, "vwap": {"day": 3861.145643850731, "asia": null, "london": 3854.2210399590845, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 19459.000000000287}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 89524.00000000033}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 35642.00000000028}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 86601.00000000012}], "round_levels": [{"level": "5200", "price": 3853.52, "distance_pips": 0.1}, {"level": "5225", "price": 3853.523, "distance_pips": 0.15}, {"level": "5250", "price": 3853.525, "distance_pips": 0.4}, {"level": "5275", "price": 3853.528, "distance_pips": 0.65}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9225222305865474}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 283}, {"price": 3871.459, "bar_index": 288}, {"price": 3870.478, "bar_index": 280}, {"price": 3870.101, "bar_index": 274}, {"price": 3870.097, "bar_index": 272}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 105}, {"price": 3819.574, "bar_index": 101}, {"price": 3820.97, "bar_index": 119}, {"price": 3822.667, "bar_index": 162}, {"price": 3822.809, "bar_index": 116}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 207, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 292, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 245, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 289, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 291}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 290}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 285}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 217}, {"price": 3871.459, "bar_index": 244}, {"price": 3871.268, "bar_index": 250}, {"price": 3871.166, "bar_index": 242}, {"price": 3870.48, "bar_index": 239}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 293}, {"price": 3850.884, "bar_index": 278}, {"price": 3852.024, "bar_index": 284}, {"price": 3852.925, "bar_index": 287}, {"price": 3853.841, "bar_index": 270}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 33, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 259, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 289, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 291}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 276}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 257}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3853.521, "spread_points": 37, "atr_m5_pips": 401.0743456695052, "ticks_per_min": 220, "pdh_pdl_distance_pips": {"PDH": 19459.000000000287, "PDL": 89524.00000000033}, "eq50_d_distance_pips": 35642.00000000028, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:32:57", "message": "Context+MT5 xong trong 1.07s"}
{"stage": "status_update", "t": "2025-09-30 14:32:58", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:32:58", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:33:36", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:33:36", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:33:36", "message": "Đã lưu thành công file: ctx_20250930_143336.json"}
{"stage": "run-end", "t": "2025-09-30 14:33:36"}
{"stage": "status_update", "t": "2025-09-30 14:33:36", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:33:36", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:34:06", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:34:06", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:34:06", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:34:06", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:34:10", "message": "Upload xong 4 ảnh trong 4.12s"}
{"stage": "run-start", "t": "2025-09-30 14:34:11", "cycle": "2025-09-30 14:34:11", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:33:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:32:21) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:31:03) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:34:11Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 212}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:34:11", "broker_time": "2025-09-30T07:34:11Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3851.218, "ask": 3851.255, "last": 0.0, "time": 1759217651}, "tick_stats_5m": {"ticks_per_min": 212, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 291, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8093704762258259, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.07067202812362, "M1": 1.963317022555407, "M15": 5.816910019861921, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3856.197039213205, "ema200": 3860.8703416390176}, "M5": {"ema50": 3859.708505300806, "ema200": 3843.599677992188}, "M15": {"ema50": 3848.110329005869, "ema200": 3809.391832885641}, "H1": {"ema50": 3810.8633553550226, "ema200": 3749.55855160325}}}, "vwap": {"day": 3861.22303261741, "asia": null, "london": 3854.1812103690863, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 17155.99999999995}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 87221.0}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 33338.99999999994}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 84297.99999999977}], "round_levels": [{"level": "2100", "price": 3851.21, "distance_pips": 0.8}, {"level": "2125", "price": 3851.213, "distance_pips": 0.55}, {"level": "2150", "price": 3851.215, "distance_pips": 0.3}, {"level": "2175", "price": 3851.218, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.90894082708297}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 283}, {"price": 3871.459, "bar_index": 288}, {"price": 3870.478, "bar_index": 280}, {"price": 3870.101, "bar_index": 274}, {"price": 3870.097, "bar_index": 272}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 105}, {"price": 3819.574, "bar_index": 101}, {"price": 3820.97, "bar_index": 119}, {"price": 3822.667, "bar_index": 162}, {"price": 3822.809, "bar_index": 116}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 207, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 292, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 245, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 289, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 291}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 290}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 285}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 215}, {"price": 3871.459, "bar_index": 242}, {"price": 3871.268, "bar_index": 248}, {"price": 3871.166, "bar_index": 240}, {"price": 3870.48, "bar_index": 237}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 291}, {"price": 3850.884, "bar_index": 276}, {"price": 3852.024, "bar_index": 282}, {"price": 3852.925, "bar_index": 285}, {"price": 3853.841, "bar_index": 268}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 31, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3852.502, "bottom": 3852.435, "created_at_bar": 299, "lo": 3852.435, "hi": 3852.502}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 287, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 289}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 274}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 255}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3851.218, "spread_points": 37, "atr_m5_pips": 407.067202812362, "ticks_per_min": 212, "pdh_pdl_distance_pips": {"PDH": 17155.99999999995, "PDL": 87221.0}, "eq50_d_distance_pips": 33338.99999999994, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:34:11", "message": "Context+MT5 xong trong 0.66s"}
{"stage": "no-trade", "t": "2025-09-30 14:34:13", "reasons": ["Spread cao (cur=77, p90=37, factor=1.2)"]}
{"stage": "status_update", "t": "2025-09-30 14:34:13", "message": "Lỗi nghiêm trọng trong worker: 'TradingToolApp' object has no attribute '_auto_save_report'"}
{"stage": "status_update", "t": "2025-09-30 14:34:13", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:34:13", "message": "Đã lưu thành công file: ctx_20250930_143413.json"}
{"stage": "run-end", "t": "2025-09-30 14:34:13"}
{"stage": "status_update", "t": "2025-09-30 14:34:13", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:34:13", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:34:43", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:34:43", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:34:43", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:34:43", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:34:48", "message": "Upload xong 4 ảnh trong 4.70s"}
{"stage": "run-start", "t": "2025-09-30 14:34:48", "cycle": "2025-09-30 14:34:48", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:34:13) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:33:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:32:21) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:34:48Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 202}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:34:48", "broker_time": "2025-09-30T07:34:48Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3852.099, "ask": 3852.136, "last": 0.0, "time": 1759217669}, "tick_stats_5m": {"ticks_per_min": 202, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 287, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.817545748116256, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.131672028123607, "M1": 2.024317022555394, "M15": 5.877910019861908, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3856.198215683793, "ema200": 3860.8706401464806}, "M5": {"ema50": 3859.709681771394, "ema200": 3843.599976499651}, "M15": {"ema50": 3848.1115054764573, "ema200": 3809.392131393104}, "H1": {"ema50": 3810.864531825611, "ema200": 3749.558850110713}}}, "vwap": {"day": 3861.2065387498587, "asia": null, "london": 3854.1566678118143, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 18037.000000000262}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 88102.00000000032}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 34220.000000000255}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 85179.00000000009}], "round_levels": [{"level": "900", "price": 3852.09, "distance_pips": 0.9}, {"level": "925", "price": 3852.093, "distance_pips": 0.65}, {"level": "950", "price": 3852.095, "distance_pips": 0.4}, {"level": "975", "price": 3852.098, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8955212259819831}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 283}, {"price": 3871.459, "bar_index": 288}, {"price": 3870.478, "bar_index": 280}, {"price": 3870.101, "bar_index": 274}, {"price": 3870.097, "bar_index": 272}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 105}, {"price": 3819.574, "bar_index": 101}, {"price": 3820.97, "bar_index": 119}, {"price": 3822.667, "bar_index": 162}, {"price": 3822.809, "bar_index": 116}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 207, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 292, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 245, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 289, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 291}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 290}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 285}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 215}, {"price": 3871.459, "bar_index": 242}, {"price": 3871.268, "bar_index": 248}, {"price": 3871.166, "bar_index": 240}, {"price": 3870.48, "bar_index": 237}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 291}, {"price": 3850.884, "bar_index": 276}, {"price": 3852.024, "bar_index": 282}, {"price": 3852.925, "bar_index": 285}, {"price": 3853.841, "bar_index": 268}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 31, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3852.502, "bottom": 3852.435, "created_at_bar": 299, "lo": 3852.435, "hi": 3852.502}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 287, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 289}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 274}, {"type": "Bearish", "top": 3865.035, "bottom": 3861.619, "bar_index": 255}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3852.099, "spread_points": 37, "atr_m5_pips": 413.16720281236064, "ticks_per_min": 202, "pdh_pdl_distance_pips": {"PDH": 18037.000000000262, "PDL": 88102.00000000032}, "eq50_d_distance_pips": 34220.000000000255, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:34:48", "message": "Context+MT5 xong trong 0.16s"}
{"stage": "status_update", "t": "2025-09-30 14:34:49", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:34:49", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:35:28", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:35:28", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:35:28", "message": "Đã lưu thành công file: ctx_20250930_143528.json"}
{"stage": "run-end", "t": "2025-09-30 14:35:28"}
{"stage": "status_update", "t": "2025-09-30 14:35:28", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:35:28", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:35:58", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:35:58", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:35:58", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:35:58", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:36:02", "message": "Upload xong 4 ảnh trong 4.25s"}
{"stage": "run-start", "t": "2025-09-30 14:36:03", "cycle": "2025-09-30 14:36:03", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:35:28) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:34:13) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:33:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:36:03Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 232}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:36:03", "broker_time": "2025-09-30T07:36:03Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3852.348, "ask": 3852.385, "last": 0.0, "time": 1759217763}, "tick_stats_5m": {"ticks_per_min": 232, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 286, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8198563527708698, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.975124026083392, "M1": 1.8819876367465889, "M15": 5.877910019861908, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3855.889427909417, "ema200": 3860.7958555352266}, "M5": {"ema50": 3859.404852718144, "ema200": 3843.6053384366683}, "M15": {"ema50": 3848.1212701823397, "ema200": 3809.3946090050445}, "H1": {"ema50": 3810.874296531493, "ema200": 3749.5613277226535}}}, "vwap": {"day": 3861.254017658962, "asia": null, "london": 3854.0777386990085, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 18286.00000000006}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 88351.00000000012}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 34469.00000000005}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 85427.99999999988}], "round_levels": [{"level": "3400", "price": 3852.34, "distance_pips": 0.8}, {"level": "3425", "price": 3852.343, "distance_pips": 0.55}, {"level": "3450", "price": 3852.345, "distance_pips": 0.3}, {"level": "3475", "price": 3852.348, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9307885680416687}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 282}, {"price": 3871.459, "bar_index": 287}, {"price": 3870.478, "bar_index": 279}, {"price": 3870.101, "bar_index": 273}, {"price": 3870.097, "bar_index": 271}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 104}, {"price": 3820.97, "bar_index": 118}, {"price": 3822.667, "bar_index": 161}, {"price": 3822.809, "bar_index": 115}, {"price": 3823.219, "bar_index": 109}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 206, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 291, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 244, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 288, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 290}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 289}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 284}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 213}, {"price": 3871.459, "bar_index": 240}, {"price": 3871.268, "bar_index": 246}, {"price": 3871.166, "bar_index": 238}, {"price": 3870.48, "bar_index": 235}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 289}, {"price": 3850.809, "bar_index": 297}, {"price": 3850.884, "bar_index": 274}, {"price": 3852.024, "bar_index": 280}, {"price": 3852.925, "bar_index": 283}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 29, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 255, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 285, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3852.458, "bottom": 3852.348, "bar_index": 299}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 287}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 272}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3852.348, "spread_points": 37, "atr_m5_pips": 397.5124026083392, "ticks_per_min": 232, "pdh_pdl_distance_pips": {"PDH": 18286.00000000006, "PDL": 88351.00000000012}, "eq50_d_distance_pips": 34469.00000000005, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:36:04", "message": "Context+MT5 xong trong 1.19s"}
{"stage": "status_update", "t": "2025-09-30 14:36:05", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:36:05", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:36:44", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:36:45", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:36:45", "message": "Đã lưu thành công file: ctx_20250930_143644.json"}
{"stage": "run-end", "t": "2025-09-30 14:36:45"}
{"stage": "status_update", "t": "2025-09-30 14:36:45", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:36:45", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:37:15", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:37:15", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:37:15", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:37:15", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:37:19", "message": "Upload xong 4 ảnh trong 4.23s"}
{"stage": "run-start", "t": "2025-09-30 14:37:19", "cycle": "2025-09-30 14:37:19", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:36:45) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:35:28) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:34:13) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:37:19Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 246}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:37:19", "broker_time": "2025-09-30T07:37:19Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3852.204, "ask": 3852.241, "last": 0.0, "time": 1759217838}, "tick_stats_5m": {"ticks_per_min": 246, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 276, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8185200994766363, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.983838311797667, "M1": 1.9160446422798818, "M15": 5.877910019861908, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3855.707277759646, "ema200": 3860.6790093815102}, "M5": {"ema50": 3859.4006566397125, "ema200": 3843.6042737600515}, "M15": {"ema50": 3848.117074103908, "ema200": 3809.3935443284277}, "H1": {"ema50": 3810.8701004530617, "ema200": 3749.5602630460367}}}, "vwap": {"day": 3861.2688032502456, "asia": null, "london": 3854.022734924624, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 18142.00000000028}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 88207.00000000033}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 34325.00000000027}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 85284.0000000001}], "round_levels": [{"level": "2000", "price": 3852.2, "distance_pips": 0.4}, {"level": "2025", "price": 3852.203, "distance_pips": 0.15}, {"level": "2050", "price": 3852.205, "distance_pips": 0.1}, {"level": "2075", "price": 3852.208, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9287525522869754}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 282}, {"price": 3871.459, "bar_index": 287}, {"price": 3870.478, "bar_index": 279}, {"price": 3870.101, "bar_index": 273}, {"price": 3870.097, "bar_index": 271}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 104}, {"price": 3820.97, "bar_index": 118}, {"price": 3822.667, "bar_index": 161}, {"price": 3822.809, "bar_index": 115}, {"price": 3823.219, "bar_index": 109}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 206, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 291, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 244, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 288, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 290}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 289}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 284}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 212}, {"price": 3871.459, "bar_index": 239}, {"price": 3871.268, "bar_index": 245}, {"price": 3871.166, "bar_index": 237}, {"price": 3870.48, "bar_index": 234}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 288}, {"price": 3850.809, "bar_index": 296}, {"price": 3850.884, "bar_index": 273}, {"price": 3851.099, "bar_index": 298}, {"price": 3852.024, "bar_index": 279}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 28, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 254, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 284, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3852.51, "bottom": 3851.367, "bar_index": 299}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 286}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 271}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3852.204, "spread_points": 37, "atr_m5_pips": 398.3838311797667, "ticks_per_min": 246, "pdh_pdl_distance_pips": {"PDH": 18142.00000000028, "PDL": 88207.00000000033}, "eq50_d_distance_pips": 34325.00000000027, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:37:19", "message": "Context+MT5 xong trong 0.34s"}
{"stage": "status_update", "t": "2025-09-30 14:37:20", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:37:20", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:37:59", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:37:59", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:37:59", "message": "Đã lưu thành công file: ctx_20250930_143759.json"}
{"stage": "run-end", "t": "2025-09-30 14:37:59"}
{"stage": "status_update", "t": "2025-09-30 14:37:59", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:37:59", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:38:29", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:38:29", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:38:29", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:38:29", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:38:34", "message": "Upload xong 4 ảnh trong 4.61s"}
{"stage": "run-start", "t": "2025-09-30 14:38:34", "cycle": "2025-09-30 14:38:34", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:37:59) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:36:45) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:35:28) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:38:34Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 236}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:38:34", "broker_time": "2025-09-30T07:38:34Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3851.197, "ask": 3851.234, "last": 0.0, "time": 1759217913}, "tick_stats_5m": {"ticks_per_min": 236, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 266, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8091756059537524, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.983838311797667, "M1": 1.90366390251393, "M15": 5.877910019861908, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3855.5415598902864, "ema200": 3860.613017552789}, "M5": {"ema50": 3859.359715463242, "ema200": 3843.59388570035}, "M15": {"ema50": 3848.076132927438, "ema200": 3809.383156268726}, "H1": {"ema50": 3810.8291592765913, "ema200": 3749.549874986335}}}, "vwap": {"day": 3861.268182005779, "asia": null, "london": 3853.974348041792, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 17135.00000000022}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 87200.00000000028}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 33318.00000000021}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 84277.00000000004}], "round_levels": [{"level": "1900", "price": 3851.19, "distance_pips": 0.7}, {"level": "1925", "price": 3851.193, "distance_pips": 0.45}, {"level": "1950", "price": 3851.195, "distance_pips": 0.2}, {"level": "1975", "price": 3851.198, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9287525522869754}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 282}, {"price": 3871.459, "bar_index": 287}, {"price": 3870.478, "bar_index": 279}, {"price": 3870.101, "bar_index": 273}, {"price": 3870.097, "bar_index": 271}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 104}, {"price": 3820.97, "bar_index": 118}, {"price": 3822.667, "bar_index": 161}, {"price": 3822.809, "bar_index": 115}, {"price": 3823.219, "bar_index": 109}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 206, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 291, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 244, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 288, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 290}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 289}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 284}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 211}, {"price": 3871.459, "bar_index": 238}, {"price": 3871.268, "bar_index": 244}, {"price": 3871.166, "bar_index": 236}, {"price": 3870.48, "bar_index": 233}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 287}, {"price": 3850.809, "bar_index": 295}, {"price": 3850.884, "bar_index": 272}, {"price": 3851.099, "bar_index": 297}, {"price": 3852.024, "bar_index": 278}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 27, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 253, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 283, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3852.858, "bottom": 3851.197, "bar_index": 299}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 285}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 270}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3851.197, "spread_points": 37, "atr_m5_pips": 398.3838311797667, "ticks_per_min": 236, "pdh_pdl_distance_pips": {"PDH": 17135.00000000022, "PDL": 87200.00000000028}, "eq50_d_distance_pips": 33318.00000000021, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:38:34", "message": "Context+MT5 xong trong 0.17s"}
{"stage": "status_update", "t": "2025-09-30 14:38:35", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:38:35", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:39:33", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:39:33", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:39:33", "message": "Đã lưu thành công file: ctx_20250930_143933.json"}
{"stage": "run-end", "t": "2025-09-30 14:39:33"}
{"stage": "status_update", "t": "2025-09-30 14:39:33", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:39:33", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:40:03", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:40:03", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:40:03", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:40:03", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:40:08", "message": "Upload xong 4 ảnh trong 4.11s"}
{"stage": "run-start", "t": "2025-09-30 14:40:10", "cycle": "2025-09-30 14:40:10", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:39:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:37:59) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:36:45) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:40:10Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 212}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:40:10", "broker_time": "2025-09-30T07:40:10Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3851.879, "ask": 3851.916, "last": 0.0, "time": 1759218008}, "tick_stats_5m": {"ticks_per_min": 212, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 256, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.8155042500278382, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.733635575266783, "M1": 1.7450596914305054, "M15": 5.877910019861908, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3855.252753304575, "ema200": 3860.4690498184036}, "M5": {"ema50": 3859.085205881255, "ema200": 3843.785949856474}, "M15": {"ema50": 3848.102878025477, "ema200": 3809.3899423383778}, "H1": {"ema50": 3810.8559043746304, "ema200": 3749.5566610559868}}}, "vwap": {"day": 3861.290798443596, "asia": null, "london": 3853.9196077661077, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 17817.000000000007}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 87882.00000000006}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 34000.0}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 84958.99999999983}], "round_levels": [{"level": "8700", "price": 3851.87, "distance_pips": 0.9}, {"level": "8725", "price": 3851.872, "distance_pips": 0.65}, {"level": "8750", "price": 3851.875, "distance_pips": 0.4}, {"level": "8775", "price": 3851.878, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9909912002490532}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 281}, {"price": 3871.459, "bar_index": 286}, {"price": 3870.478, "bar_index": 278}, {"price": 3870.101, "bar_index": 272}, {"price": 3870.097, "bar_index": 270}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 103}, {"price": 3820.97, "bar_index": 117}, {"price": 3822.667, "bar_index": 160}, {"price": 3822.809, "bar_index": 114}, {"price": 3823.219, "bar_index": 108}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 205, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 290, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 243, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 287, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 289}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 288}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 209}, {"price": 3871.459, "bar_index": 236}, {"price": 3871.268, "bar_index": 242}, {"price": 3871.166, "bar_index": 234}, {"price": 3870.48, "bar_index": 231}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 285}, {"price": 3850.809, "bar_index": 293}, {"price": 3850.884, "bar_index": 270}, {"price": 3851.099, "bar_index": 295}, {"price": 3851.176, "bar_index": 297}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 25, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 251, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 281, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 297}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 283}, {"type": "Bearish", "top": 3856.732, "bottom": 3853.039, "bar_index": 268}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3851.879, "spread_points": 37, "atr_m5_pips": 373.3635575266783, "ticks_per_min": 212, "pdh_pdl_distance_pips": {"PDH": 17817.000000000007, "PDL": 87882.00000000006}, "eq50_d_distance_pips": 34000.0, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:40:10", "message": "Context+MT5 xong trong 2.52s"}
{"stage": "status_update", "t": "2025-09-30 14:40:11", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:40:11", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:40:51", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:40:51", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:40:51", "message": "Đã lưu thành công file: ctx_20250930_144051.json"}
{"stage": "run-end", "t": "2025-09-30 14:40:51"}
{"stage": "status_update", "t": "2025-09-30 14:40:51", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:40:51", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:41:21", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:41:21", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:41:21", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:41:21", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:41:25", "message": "Upload xong 4 ảnh trong 4.35s"}
{"stage": "run-start", "t": "2025-09-30 14:41:25", "cycle": "2025-09-30 14:41:25", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:40:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:39:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:37:59) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:41:25Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 219}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:41:25", "broker_time": "2025-09-30T07:41:25Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3849.596, "ask": 3849.633, "last": 0.0, "time": 1759218085}, "tick_stats_5m": {"ticks_per_min": 219, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 254, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7943190675921463, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.844278432409639, "M1": 1.795652366522172, "M15": 5.9287671627190495, "H1": 11.269998901474795}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3855.029830927231, "ema200": 3860.3720686764923}, "M5": {"ema50": 3859.015911763608, "ema200": 3843.7683677669215}, "M15": {"ema50": 3848.03358390783, "ema200": 3809.3723602488253}, "H1": {"ema50": 3810.7866102569833, "ema200": 3749.5390789664343}}}, "vwap": {"day": 3861.260527520545, "asia": null, "london": 3853.8358595356567, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 15534.000000000106}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 85599.00000000016}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 31717.0000000001}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 82675.99999999993}], "round_levels": [{"level": "5900", "price": 3849.59, "distance_pips": 0.6}, {"level": "5925", "price": 3849.593, "distance_pips": 0.35}, {"level": "5950", "price": 3849.595, "distance_pips": 0.1}, {"level": "5975", "price": 3849.598, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9624693073184908}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 281}, {"price": 3871.459, "bar_index": 286}, {"price": 3870.478, "bar_index": 278}, {"price": 3870.101, "bar_index": 272}, {"price": 3870.097, "bar_index": 270}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 103}, {"price": 3820.97, "bar_index": 117}, {"price": 3822.667, "bar_index": 160}, {"price": 3822.809, "bar_index": 114}, {"price": 3823.219, "bar_index": 108}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 205, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 290, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3848.639, "bottom": 3845.851, "bar_index": 243, "lo": 3845.851, "hi": 3848.639, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 287, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3852.127, "bottom": 3850.097, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 289}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 288}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 208}, {"price": 3871.459, "bar_index": 235}, {"price": 3871.268, "bar_index": 241}, {"price": 3871.166, "bar_index": 233}, {"price": 3870.48, "bar_index": 230}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 284}, {"price": 3850.809, "bar_index": 292}, {"price": 3850.884, "bar_index": 269}, {"price": 3851.099, "bar_index": 294}, {"price": 3851.176, "bar_index": 296}]}, "fvgs_m1": [{"type": "Bullish", "top": 3847.372, "bottom": 3847.251, "created_at_bar": 24, "lo": 3847.251, "hi": 3847.372}, {"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 250, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 280, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3848.432, "equilibrium": 3860.0964999999997, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3850.097, "bar_index": 299}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 296}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 282}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3849.596, "spread_points": 37, "atr_m5_pips": 384.42784324096385, "ticks_per_min": 219, "pdh_pdl_distance_pips": {"PDH": 15534.000000000106, "PDL": 85599.00000000016}, "eq50_d_distance_pips": 31717.0000000001, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:41:25", "message": "Context+MT5 xong trong 0.19s"}
{"stage": "status_update", "t": "2025-09-30 14:41:27", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:41:27", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:42:05", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:42:05", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:42:05", "message": "Đã lưu thành công file: ctx_20250930_144205.json"}
{"stage": "run-end", "t": "2025-09-30 14:42:05"}
{"stage": "status_update", "t": "2025-09-30 14:42:05", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:42:05", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:42:35", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:42:35", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:42:35", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:42:35", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:42:40", "message": "Upload xong 4 ảnh trong 4.34s"}
{"stage": "run-start", "t": "2025-09-30 14:42:40", "cycle": "2025-09-30 14:42:40", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:42:05) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:40:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:39:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:42:40Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 333}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:42:40", "broker_time": "2025-09-30T07:42:40Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3847.245, "ask": 3847.282, "last": 0.0, "time": 1759218160}, "tick_stats_5m": {"ticks_per_min": 333, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 263, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7725028766563968, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.11734986098109, "M1": 2.0301618913827437, "M15": 6.2018385912905005, "H1": 11.424141758617646}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3854.6189232017755, "ema200": 3860.2131055180585}, "M5": {"ema50": 3858.901323528314, "ema200": 3843.739293140056}, "M15": {"ema50": 3847.918995672536, "ema200": 3809.3432856219597}, "H1": {"ema50": 3810.6720220216894, "ema200": 3749.5100043395687}}}, "vwap": {"day": 3861.149306554862, "asia": null, "london": 3853.524364087616, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 13182.999999999993}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 83248.00000000004}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 29365.999999999985}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 80324.99999999981}], "round_levels": [{"level": "2400", "price": 3847.24, "distance_pips": 0.5}, {"level": "2425", "price": 3847.243, "distance_pips": 0.25}, {"level": "2450", "price": 3847.245, "distance_pips": 0.0}, {"level": "2475", "price": 3847.248, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.898636289106739}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 281}, {"price": 3871.459, "bar_index": 286}, {"price": 3870.478, "bar_index": 278}, {"price": 3870.101, "bar_index": 272}, {"price": 3870.097, "bar_index": 270}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 103}, {"price": 3820.97, "bar_index": 117}, {"price": 3822.667, "bar_index": 160}, {"price": 3822.809, "bar_index": 114}, {"price": 3823.219, "bar_index": 108}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 205, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 290, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3829.043, "bottom": 3828.102, "bar_index": 202, "lo": 3828.102, "hi": 3829.043, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 287, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3852.127, "bottom": 3846.274, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 289}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 288}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 207}, {"price": 3871.459, "bar_index": 234}, {"price": 3871.268, "bar_index": 240}, {"price": 3871.166, "bar_index": 232}, {"price": 3870.48, "bar_index": 229}], "swing_lows_SSL": [{"price": 3848.432, "bar_index": 283}, {"price": 3850.809, "bar_index": 291}, {"price": 3850.884, "bar_index": 268}, {"price": 3851.099, "bar_index": 293}, {"price": 3851.176, "bar_index": 295}]}, "fvgs_m1": [{"type": "Bearish", "top": 3850.573, "bottom": 3847.814, "created_at_bar": 299, "lo": 3847.814, "hi": 3850.573}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 279, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3846.274, "equilibrium": 3859.0175, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 298}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 295}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 281}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3847.245, "spread_points": 37, "atr_m5_pips": 411.734986098109, "ticks_per_min": 333, "pdh_pdl_distance_pips": {"PDH": 13182.999999999993, "PDL": 83248.00000000004}, "eq50_d_distance_pips": 29365.999999999985, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:42:40", "message": "Context+MT5 xong trong 0.22s"}
{"stage": "status_update", "t": "2025-09-30 14:42:41", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:42:41", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:43:19", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:43:20", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:43:20", "message": "Đã lưu thành công file: ctx_20250930_144319.json"}
{"stage": "run-end", "t": "2025-09-30 14:43:20"}
{"stage": "status_update", "t": "2025-09-30 14:43:20", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:43:20", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:43:50", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:43:50", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:43:50", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:43:50", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:43:54", "message": "Upload xong 4 ảnh trong 4.72s"}
{"stage": "run-start", "t": "2025-09-30 14:43:55", "cycle": "2025-09-30 14:43:55", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:43:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:42:05) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:40:51) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:43:55Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 410}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:43:55", "broker_time": "2025-09-30T07:43:55Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3849.253, "ask": 3849.29, "last": 0.0, "time": 1759218234}, "tick_stats_5m": {"ticks_per_min": 410, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 270, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7911361864815728, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.11734986098109, "M1": 2.062573797106654, "M15": 6.2018385912905005, "H1": 11.424141758617646}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3854.386110847342, "ema200": 3860.1334992982615}, "M5": {"ema50": 3858.949362744, "ema200": 3843.7514821947825}, "M15": {"ema50": 3847.967034888222, "ema200": 3809.3554746766863}, "H1": {"ema50": 3810.7200612373754, "ema200": 3749.5221933942953}}}, "vwap": {"day": 3861.0279980782134, "asia": null, "london": 3853.2347015390774, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 15191.000000000258}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 85256.0000000003}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 31374.00000000025}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 82333.00000000009}], "round_levels": [{"level": "2500", "price": 3849.25, "distance_pips": 0.3}, {"level": "2525", "price": 3849.253, "distance_pips": 0.05}, {"level": "2550", "price": 3849.255, "distance_pips": 0.2}, {"level": "2575", "price": 3849.258, "distance_pips": 0.45}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8986362890956942}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3871.459, "bar_index": 295}, {"price": 3870.101, "bar_index": 290}, {"price": 3867.242, "bar_index": 284}, {"price": 3852.113, "bar_index": 277}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 113}, {"price": 3741.553, "bar_index": 109}, {"price": 3742.965, "bar_index": 128}, {"price": 3744.591, "bar_index": 106}, {"price": 3744.709, "bar_index": 103}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 274, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 297, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 272, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 295, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 296}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 283}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 268}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 281}, {"price": 3871.459, "bar_index": 286}, {"price": 3870.478, "bar_index": 278}, {"price": 3870.101, "bar_index": 272}, {"price": 3870.097, "bar_index": 270}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 103}, {"price": 3820.97, "bar_index": 117}, {"price": 3822.667, "bar_index": 160}, {"price": 3822.809, "bar_index": 114}, {"price": 3823.219, "bar_index": 108}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 205, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 290, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3829.043, "bottom": 3828.102, "bar_index": 202, "lo": 3828.102, "hi": 3829.043, "type": "bull"}, {"top": 3871.268, "bottom": 3868.401, "bar_index": 287, "lo": 3868.401, "hi": 3871.268, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 289}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 288}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 206}, {"price": 3871.459, "bar_index": 233}, {"price": 3871.268, "bar_index": 239}, {"price": 3871.166, "bar_index": 231}, {"price": 3870.48, "bar_index": 228}], "swing_lows_SSL": [{"price": 3846.274, "bar_index": 298}, {"price": 3848.432, "bar_index": 282}, {"price": 3850.809, "bar_index": 290}, {"price": 3850.884, "bar_index": 267}, {"price": 3851.099, "bar_index": 292}]}, "fvgs_m1": [{"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 248, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 278, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3846.274, "equilibrium": 3859.0175, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 297}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 294}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 280}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3849.253, "spread_points": 37, "atr_m5_pips": 411.734986098109, "ticks_per_min": 410, "pdh_pdl_distance_pips": {"PDH": 15191.000000000258, "PDL": 85256.0000000003}, "eq50_d_distance_pips": 31374.00000000025, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:43:55", "message": "Context+MT5 xong trong 0.21s"}
{"stage": "status_update", "t": "2025-09-30 14:43:56", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:43:56", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:44:34", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:44:34", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:44:34", "message": "Đã lưu thành công file: ctx_20250930_144434.json"}
{"stage": "run-end", "t": "2025-09-30 14:44:35"}
{"stage": "status_update", "t": "2025-09-30 14:44:35", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:44:35", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:45:05", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:45:05", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:45:05", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:45:05", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:45:09", "message": "Upload xong 4 ảnh trong 4.52s"}
{"stage": "run-start", "t": "2025-09-30 14:45:10", "cycle": "2025-09-30 14:45:09", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:44:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:43:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:42:05) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:45:09Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 450}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:45:09", "broker_time": "2025-09-30T07:45:09Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3849.084, "ask": 3849.121, "last": 0.0, "time": 1759218310}, "tick_stats_5m": {"ticks_per_min": 450, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 273, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7895679447681961, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.9250391565109557, "M1": 2.0374091122093683, "M15": 5.860635834661728, "H1": 11.424141758617646}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3853.9543651568365, "ema200": 3859.885925482906}, "M5": {"ema50": 3858.5299043199557, "ema200": 3844.057018878552}, "M15": {"ema50": 3847.9782030174993, "ema200": 3809.5733596039386}, "H1": {"ema50": 3810.742845551101, "ema200": 3749.5279744888226}}}, "vwap": {"day": 3860.9596634307914, "asia": null, "london": 3853.034857712514, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 15021.999999999935}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 85086.99999999999}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 31204.999999999927}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 82163.99999999975}], "round_levels": [{"level": "800", "price": 3849.08, "distance_pips": 0.4}, {"level": "825", "price": 3849.082, "distance_pips": 0.15}, {"level": "850", "price": 3849.085, "distance_pips": 0.1}, {"level": "875", "price": 3849.088, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9426657550380201}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 273, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3849.066, "bottom": 3847.7, "bar_index": 299}, {"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 280}, {"price": 3871.459, "bar_index": 285}, {"price": 3870.478, "bar_index": 277}, {"price": 3870.101, "bar_index": 271}, {"price": 3870.097, "bar_index": 269}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 102}, {"price": 3820.97, "bar_index": 116}, {"price": 3822.667, "bar_index": 159}, {"price": 3822.809, "bar_index": 113}, {"price": 3823.219, "bar_index": 107}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 204, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3863.677, "bottom": 3860.319, "created_at_bar": 289, "lo": 3860.319, "hi": 3863.677}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 297, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3849.066, "bottom": 3847.7, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 288}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 287}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 204}, {"price": 3871.459, "bar_index": 231}, {"price": 3871.268, "bar_index": 237}, {"price": 3871.166, "bar_index": 229}, {"price": 3870.48, "bar_index": 226}], "swing_lows_SSL": [{"price": 3846.274, "bar_index": 296}, {"price": 3848.432, "bar_index": 280}, {"price": 3850.809, "bar_index": 288}, {"price": 3850.884, "bar_index": 265}, {"price": 3851.099, "bar_index": 290}]}, "fvgs_m1": [{"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 246, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 276, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3846.274, "equilibrium": 3859.0175, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3849.066, "bottom": 3847.7, "bar_index": 299}, {"type": "Bearish", "top": 3849.445, "bottom": 3847.533, "bar_index": 298}, {"type": "Bullish", "top": 3849.348, "bottom": 3846.905, "bar_index": 297}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3849.084, "spread_points": 37, "atr_m5_pips": 392.50391565109555, "ticks_per_min": 450, "pdh_pdl_distance_pips": {"PDH": 15021.999999999935, "PDL": 85086.99999999999}, "eq50_d_distance_pips": 31204.999999999927, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:45:10", "message": "Context+MT5 xong trong 0.95s"}
{"stage": "status_update", "t": "2025-09-30 14:45:11", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:45:11", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:45:50", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:45:50", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:45:50", "message": "Đã lưu thành công file: ctx_20250930_144550.json"}
{"stage": "run-end", "t": "2025-09-30 14:45:50"}
{"stage": "status_update", "t": "2025-09-30 14:45:50", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:45:50", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:46:20", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:46:20", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:46:20", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:46:20", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:46:24", "message": "Upload xong 4 ảnh trong 4.32s"}
{"stage": "run-start", "t": "2025-09-30 14:46:24", "cycle": "2025-09-30 14:46:24", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:45:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:44:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:43:20) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:46:24Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 452}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:46:24", "broker_time": "2025-09-30T07:46:24Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3848.94, "ask": 3848.977, "last": 0.0, "time": 1759218384}, "tick_stats_5m": {"ticks_per_min": 452, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 276, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7882316914739627, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.025253442225259, "M1": 2.0641502980557074, "M15": 5.960850120376032, "H1": 11.424141758617646}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3853.8120141060745, "ema200": 3859.841579481087}, "M5": {"ema50": 3858.5351592219163, "ema200": 3844.058352211885}, "M15": {"ema50": 3847.9834579194603, "ema200": 3809.5746929372717}, "H1": {"ema50": 3810.745237707964, "ema200": 3749.5285814539966}}}, "vwap": {"day": 3860.9197004456205, "asia": null, "london": 3852.951434404847, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 14878.000000000156}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 84943.0000000002}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 31061.00000000015}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 82019.99999999999}], "round_levels": [{"level": "9400", "price": 3848.94, "distance_pips": 0.0}, {"level": "9425", "price": 3848.943, "distance_pips": 0.25}, {"level": "9450", "price": 3848.945, "distance_pips": 0.5}, {"level": "9475", "price": 3848.948, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9191967793052225}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 273, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 280}, {"price": 3871.459, "bar_index": 285}, {"price": 3870.478, "bar_index": 277}, {"price": 3870.101, "bar_index": 271}, {"price": 3870.097, "bar_index": 269}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 102}, {"price": 3820.97, "bar_index": 116}, {"price": 3822.667, "bar_index": 159}, {"price": 3822.809, "bar_index": 113}, {"price": 3823.219, "bar_index": 107}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 204, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 299, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 297, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 288}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 287}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 282}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 203}, {"price": 3871.459, "bar_index": 230}, {"price": 3871.268, "bar_index": 236}, {"price": 3871.166, "bar_index": 228}, {"price": 3870.48, "bar_index": 225}], "swing_lows_SSL": [{"price": 3846.274, "bar_index": 295}, {"price": 3848.432, "bar_index": 279}, {"price": 3850.809, "bar_index": 287}, {"price": 3850.884, "bar_index": 264}, {"price": 3851.099, "bar_index": 289}]}, "fvgs_m1": [{"type": "Bearish", "top": 3861.619, "bottom": 3861.506, "created_at_bar": 245, "lo": 3861.506, "hi": 3861.619}], "order_blocks_m1": [{"top": 3849.445, "bottom": 3847.533, "bar_index": 297, "lo": 3847.533, "hi": 3849.445, "type": "bull"}, {"top": 3855.582, "bottom": 3854.294, "bar_index": 275, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3846.274, "equilibrium": 3859.0175, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3850.217, "bottom": 3849.13, "bar_index": 299}, {"type": "Bullish", "top": 3850.469, "bottom": 3847.7, "bar_index": 298}, {"type": "Bullish", "top": 3849.348, "bottom": 3846.905, "bar_index": 296}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3848.94, "spread_points": 37, "atr_m5_pips": 402.5253442225259, "ticks_per_min": 452, "pdh_pdl_distance_pips": {"PDH": 14878.000000000156, "PDL": 84943.0000000002}, "eq50_d_distance_pips": 31061.00000000015, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:46:25", "message": "Context+MT5 xong trong 0.55s"}
{"stage": "status_update", "t": "2025-09-30 14:46:26", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:46:26", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:47:04", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:47:04", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:47:04", "message": "Đã lưu thành công file: ctx_20250930_144704.json"}
{"stage": "run-end", "t": "2025-09-30 14:47:05"}
{"stage": "status_update", "t": "2025-09-30 14:47:05", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:47:05", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:47:35", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:47:35", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:47:35", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:47:35", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:47:39", "message": "Upload xong 4 ảnh trong 4.43s"}
{"stage": "run-start", "t": "2025-09-30 14:47:39", "cycle": "2025-09-30 14:47:39", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:47:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:45:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:44:34) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:47:39Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 385}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": true, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:47:39", "broker_time": "2025-09-30T07:47:39Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3847.401, "ask": 3847.478, "last": 0.0, "time": 1759218460}, "tick_stats_5m": {"ticks_per_min": 385, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 280, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7739504843918182, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.0354677279395474, "M1": 2.10674160331383, "M15": 5.97106440609032, "H1": 11.424141758617646}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3853.575836773589, "ema200": 3859.7158505927027}, "M5": {"ema50": 3858.506139614073, "ema200": 3844.0509890278054}, "M15": {"ema50": 3847.954438311617, "ema200": 3809.567329753192}, "H1": {"ema50": 3810.7190808452187, "ema200": 3749.521944638076}}}, "vwap": {"day": 3860.8437830223947, "asia": null, "london": 3852.8044399864702, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 13338.999999999942}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 83404.0}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 29521.999999999935}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 80480.99999999977}], "round_levels": [{"level": "4000", "price": 3847.4, "distance_pips": 0.1}, {"level": "4025", "price": 3847.403, "distance_pips": 0.15}, {"level": "4050", "price": 3847.405, "distance_pips": 0.4}, {"level": "4075", "price": 3847.408, "distance_pips": 0.65}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.9080811740140136}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 273, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 280}, {"price": 3871.459, "bar_index": 285}, {"price": 3870.478, "bar_index": 277}, {"price": 3870.101, "bar_index": 271}, {"price": 3870.097, "bar_index": 269}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 102}, {"price": 3820.97, "bar_index": 116}, {"price": 3822.667, "bar_index": 159}, {"price": 3822.809, "bar_index": 113}, {"price": 3823.219, "bar_index": 107}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 204, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 299, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 297, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 288}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 287}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 282}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 202}, {"price": 3871.459, "bar_index": 229}, {"price": 3871.268, "bar_index": 235}, {"price": 3871.166, "bar_index": 227}, {"price": 3870.48, "bar_index": 224}], "swing_lows_SSL": [{"price": 3846.274, "bar_index": 294}, {"price": 3847.498, "bar_index": 298}, {"price": 3848.432, "bar_index": 278}, {"price": 3850.809, "bar_index": 286}, {"price": 3850.884, "bar_index": 263}]}, "fvgs_m1": [{"type": "Bearish", "top": 3850.573, "bottom": 3848.389, "created_at_bar": 294, "lo": 3848.389, "hi": 3850.573}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 274, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3846.274, "equilibrium": 3859.0175, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 293}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 290}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 276}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3847.401, "spread_points": 77, "atr_m5_pips": 403.54677279395474, "ticks_per_min": 385, "pdh_pdl_distance_pips": {"PDH": 13338.999999999942, "PDL": 83404.0}, "eq50_d_distance_pips": 29521.999999999935, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:47:40", "message": "Context+MT5 xong trong 0.22s"}
{"stage": "no-trade", "t": "2025-09-30 14:47:40", "reasons": ["Spread cao (cur=77, p90=37, factor=1.2)"]}
{"stage": "status_update", "t": "2025-09-30 14:47:40", "message": "Lỗi nghiêm trọng trong worker: 'TradingToolApp' object has no attribute '_auto_save_report'"}
{"stage": "status_update", "t": "2025-09-30 14:47:40", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:47:40", "message": "Đã lưu thành công file: ctx_20250930_144740.json"}
{"stage": "run-end", "t": "2025-09-30 14:47:41"}
{"stage": "status_update", "t": "2025-09-30 14:47:41", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:47:41", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:48:11", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:48:11", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:48:11", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:48:11", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:48:15", "message": "Upload xong 4 ảnh trong 4.47s"}
{"stage": "run-start", "t": "2025-09-30 14:48:15", "cycle": "2025-09-30 14:48:15", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:47:40) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:47:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:45:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:48:15Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 347}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:48:15", "broker_time": "2025-09-30T07:48:15Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3847.784, "ask": 3847.821, "last": 0.0, "time": 1759218495}, "tick_stats_5m": {"ticks_per_min": 347, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 281, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7775045469730166, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.042539156510987, "M1": 2.0114794479862512, "M15": 5.978135834661759, "H1": 11.424141758617646}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3853.3277999283696, "ema200": 3859.5776763268987}, "M5": {"ema50": 3858.481590594465, "ema200": 3844.0447601720844}, "M15": {"ema50": 3847.929889292009, "ema200": 3809.561100897471}, "H1": {"ema50": 3810.6945318256107, "ema200": 3749.515715782355}}}, "vwap": {"day": 3860.821405402624, "asia": null, "london": 3852.733551270934, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 13722.000000000207}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 83787.00000000026}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 29905.0000000002}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 80864.00000000003}], "round_levels": [{"level": "7800", "price": 3847.78, "distance_pips": 0.4}, {"level": "7825", "price": 3847.783, "distance_pips": 0.15}, {"level": "7850", "price": 3847.785, "distance_pips": 0.1}, {"level": "7875", "price": 3847.788, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9152663355211863}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 273, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 280}, {"price": 3871.459, "bar_index": 285}, {"price": 3870.478, "bar_index": 277}, {"price": 3870.101, "bar_index": 271}, {"price": 3870.097, "bar_index": 269}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 102}, {"price": 3820.97, "bar_index": 116}, {"price": 3822.667, "bar_index": 159}, {"price": 3822.809, "bar_index": 113}, {"price": 3823.219, "bar_index": 107}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 204, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 299, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 297, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 288}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 287}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 282}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 201}, {"price": 3871.459, "bar_index": 228}, {"price": 3871.268, "bar_index": 234}, {"price": 3871.166, "bar_index": 226}, {"price": 3870.48, "bar_index": 223}], "swing_lows_SSL": [{"price": 3846.274, "bar_index": 293}, {"price": 3847.399, "bar_index": 298}, {"price": 3848.432, "bar_index": 277}, {"price": 3850.809, "bar_index": 285}, {"price": 3850.884, "bar_index": 262}]}, "fvgs_m1": [{"type": "Bearish", "top": 3850.573, "bottom": 3848.389, "created_at_bar": 293, "lo": 3848.389, "hi": 3850.573}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 273, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3846.274, "equilibrium": 3859.0175, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 292}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 289}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 275}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3847.784, "spread_points": 37, "atr_m5_pips": 404.2539156510987, "ticks_per_min": 347, "pdh_pdl_distance_pips": {"PDH": 13722.000000000207, "PDL": 83787.00000000026}, "eq50_d_distance_pips": 29905.0000000002, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:48:15", "message": "Context+MT5 xong trong 0.30s"}
{"stage": "status_update", "t": "2025-09-30 14:48:16", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:48:17", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:48:55", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:48:55", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:48:55", "message": "Đã lưu thành công file: ctx_20250930_144855.json"}
{"stage": "run-end", "t": "2025-09-30 14:48:55"}
{"stage": "status_update", "t": "2025-09-30 14:48:55", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:48:55", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:49:25", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:49:25", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:49:25", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:49:25", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:49:30", "message": "Upload xong 4 ảnh trong 4.04s"}
{"stage": "run-start", "t": "2025-09-30 14:49:30", "cycle": "2025-09-30 14:49:30", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:48:55) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:47:40) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:47:04) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:49:30Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 344}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:49:30", "broker_time": "2025-09-30T07:49:30Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3845.864, "ask": 3845.901, "last": 0.0, "time": 1759218570}, "tick_stats_5m": {"ticks_per_min": 344, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 288, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7596878363832086, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.176824870796709, "M1": 2.0632003037558104, "M15": 6.112421548947482, "H1": 11.478070330046224}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3852.9745884028616, "ema200": 3859.4266355714763}, "M5": {"ema50": 3858.4146886336807, "ema200": 3844.027785047706}, "M15": {"ema50": 3847.8629873312248, "ema200": 3809.5441257730927}, "H1": {"ema50": 3810.6276298648263, "ema200": 3749.4987406579767}}}, "vwap": {"day": 3860.7463850029344, "asia": null, "london": 3852.5392446588135, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 11802.000000000135}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 81867.00000000019}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 27985.000000000127}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 78943.99999999996}], "round_levels": [{"level": "8600", "price": 3845.86, "distance_pips": 0.4}, {"level": "8625", "price": 3845.863, "distance_pips": 0.15}, {"level": "8650", "price": 3845.865, "distance_pips": 0.1}, {"level": "8675", "price": 3845.868, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8858403486940934}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3859.405, "bottom": 3845.519, "bar_index": 299}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 273, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 280}, {"price": 3871.459, "bar_index": 285}, {"price": 3870.478, "bar_index": 277}, {"price": 3870.101, "bar_index": 271}, {"price": 3870.097, "bar_index": 269}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 102}, {"price": 3820.97, "bar_index": 116}, {"price": 3822.667, "bar_index": 159}, {"price": 3822.809, "bar_index": 113}, {"price": 3823.219, "bar_index": 107}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 204, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 299, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 297, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 288}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 287}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 282}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 200}, {"price": 3871.459, "bar_index": 227}, {"price": 3871.268, "bar_index": 233}, {"price": 3871.166, "bar_index": 225}, {"price": 3870.48, "bar_index": 222}], "swing_lows_SSL": [{"price": 3845.519, "bar_index": 298}, {"price": 3846.274, "bar_index": 292}, {"price": 3848.432, "bar_index": 276}, {"price": 3850.809, "bar_index": 284}, {"price": 3850.884, "bar_index": 261}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3846.551, "created_at_bar": 299, "lo": 3846.551, "hi": 3847.399}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 272, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3845.519, "equilibrium": 3858.64, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 291}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 288}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 274}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3845.864, "spread_points": 37, "atr_m5_pips": 417.6824870796709, "ticks_per_min": 344, "pdh_pdl_distance_pips": {"PDH": 11802.000000000135, "PDL": 81867.00000000019}, "eq50_d_distance_pips": 27985.000000000127, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:49:30", "message": "Context+MT5 xong trong 0.25s"}
{"stage": "status_update", "t": "2025-09-30 14:49:50", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:49:50", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:50:28", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:50:28", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:50:28", "message": "Đã lưu thành công file: ctx_20250930_145028.json"}
{"stage": "run-end", "t": "2025-09-30 14:50:28"}
{"stage": "status_update", "t": "2025-09-30 14:50:29", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:50:29", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:50:59", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:50:59", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:50:59", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:50:59", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:51:03", "message": "Upload xong 4 ảnh trong 4.30s"}
{"stage": "run-start", "t": "2025-09-30 14:51:03", "cycle": "2025-09-30 14:51:03", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:50:28) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:48:55) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:47:40) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:51:03Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 381}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:51:03", "broker_time": "2025-09-30T07:51:03Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3845.763, "ask": 3845.8, "last": 0.0, "time": 1759218663}, "tick_stats_5m": {"ticks_per_min": 381, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 300, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7587506031698896, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.060342482014211, "M1": 2.0356989499890847, "M15": 6.2208501203760225, "H1": 11.586498901474766}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3852.37245841126, "ema200": 3859.1452914785664}, "M5": {"ema50": 3857.8887842533804, "ema200": 3844.1587207334856}, "M15": {"ema50": 3847.8607912527937, "ema200": 3809.5435685591624}, "H1": {"ema50": 3810.625433786395, "ema200": 3749.4981834440464}}}, "vwap": {"day": 3860.631218601437, "asia": null, "london": 3852.2387912706818, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 11701.000000000022}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 81766.00000000007}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 27884.000000000015}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 78842.99999999984}], "round_levels": [{"level": "7600", "price": 3845.76, "distance_pips": 0.3}, {"level": "7625", "price": 3845.763, "distance_pips": 0.05}, {"level": "7650", "price": 3845.765, "distance_pips": 0.2}, {"level": "7675", "price": 3845.768, "distance_pips": 0.45}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9112531803452052}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 273, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 279}, {"price": 3871.459, "bar_index": 284}, {"price": 3870.478, "bar_index": 276}, {"price": 3870.101, "bar_index": 270}, {"price": 3870.097, "bar_index": 268}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 101}, {"price": 3820.97, "bar_index": 115}, {"price": 3822.667, "bar_index": 158}, {"price": 3822.809, "bar_index": 112}, {"price": 3823.219, "bar_index": 106}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 203, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3846.274, "bottom": 3846.002, "created_at_bar": 299, "lo": 3846.002, "hi": 3846.274}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 296, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 287}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 286}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 281}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 198}, {"price": 3871.459, "bar_index": 225}, {"price": 3871.268, "bar_index": 231}, {"price": 3871.166, "bar_index": 223}, {"price": 3870.48, "bar_index": 220}], "swing_lows_SSL": [{"price": 3844.001, "bar_index": 298}, {"price": 3846.274, "bar_index": 290}, {"price": 3848.432, "bar_index": 274}, {"price": 3850.809, "bar_index": 282}, {"price": 3850.884, "bar_index": 259}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 297, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 270, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3844.001, "equilibrium": 3857.8810000000003, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3846.002, "bottom": 3845.149, "bar_index": 299}, {"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 289}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 286}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3845.763, "spread_points": 37, "atr_m5_pips": 406.0342482014211, "ticks_per_min": 381, "pdh_pdl_distance_pips": {"PDH": 11701.000000000022, "PDL": 81766.00000000007}, "eq50_d_distance_pips": 27884.000000000015, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:51:03", "message": "Context+MT5 xong trong 0.22s"}
{"stage": "status_update", "t": "2025-09-30 14:51:04", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:51:04", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:51:43", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:51:43", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:51:43", "message": "Đã lưu thành công file: ctx_20250930_145143.json"}
{"stage": "run-end", "t": "2025-09-30 14:51:43"}
{"stage": "status_update", "t": "2025-09-30 14:51:43", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:51:43", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:52:13", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:52:13", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:52:13", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:52:13", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:52:17", "message": "Upload xong 4 ảnh trong 4.05s"}
{"stage": "run-start", "t": "2025-09-30 14:52:17", "cycle": "2025-09-30 14:52:17", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:51:43) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:50:28) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:48:55) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:52:17Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 358}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:52:17", "broker_time": "2025-09-30T07:52:17Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3844.606, "ask": 3844.643, "last": 0.0, "time": 1759218737}, "tick_stats_5m": {"ticks_per_min": 358, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 303, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7480141791321804, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.109199624871367, "M1": 2.080730657670248, "M15": 6.2208501203760225, "H1": 11.586498901474766}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3852.0715474756735, "ema200": 3859.0122316482925}, "M5": {"ema50": 3857.834039155341, "ema200": 3844.144830186222}, "M15": {"ema50": 3847.8060461547543, "ema200": 3809.529678011899}, "H1": {"ema50": 3810.570688688356, "ema200": 3749.484292896783}}}, "vwap": {"day": 3860.5653369218608, "asia": null, "london": 3852.0905188467395, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 10544.000000000324}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 80609.00000000038}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 26727.000000000317}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 77686.00000000015}], "round_levels": [{"level": "6000", "price": 3844.6, "distance_pips": 0.6}, {"level": "6025", "price": 3844.602, "distance_pips": 0.35}, {"level": "6050", "price": 3844.605, "distance_pips": 0.1}, {"level": "6075", "price": 3844.608, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9004186551527152}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3859.405, "bottom": 3844.001, "bar_index": 299}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 273, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 279}, {"price": 3871.459, "bar_index": 284}, {"price": 3870.478, "bar_index": 276}, {"price": 3870.101, "bar_index": 270}, {"price": 3870.097, "bar_index": 268}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 101}, {"price": 3820.97, "bar_index": 115}, {"price": 3822.667, "bar_index": 158}, {"price": 3822.809, "bar_index": 112}, {"price": 3823.219, "bar_index": 106}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 203, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 298, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 296, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 287}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 286}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 281}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 197}, {"price": 3871.459, "bar_index": 224}, {"price": 3871.268, "bar_index": 230}, {"price": 3871.166, "bar_index": 222}, {"price": 3870.48, "bar_index": 219}], "swing_lows_SSL": [{"price": 3844.001, "bar_index": 297}, {"price": 3846.274, "bar_index": 289}, {"price": 3848.432, "bar_index": 273}, {"price": 3850.809, "bar_index": 281}, {"price": 3850.884, "bar_index": 258}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 296, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 269, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3844.001, "equilibrium": 3857.8810000000003, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3846.348, "bottom": 3844.512, "bar_index": 299}, {"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 288}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 285}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3844.606, "spread_points": 37, "atr_m5_pips": 410.91996248713673, "ticks_per_min": 358, "pdh_pdl_distance_pips": {"PDH": 10544.000000000324, "PDL": 80609.00000000038}, "eq50_d_distance_pips": 26727.000000000317, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:52:18", "message": "Context+MT5 xong trong 0.40s"}
{"stage": "status_update", "t": "2025-09-30 14:52:18", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:52:18", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:52:57", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:52:57", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:52:57", "message": "Đã lưu thành công file: ctx_20250930_145257.json"}
{"stage": "run-end", "t": "2025-09-30 14:52:57"}
{"stage": "status_update", "t": "2025-09-30 14:52:57", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:52:57", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:53:27", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:53:27", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:53:27", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:53:27", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:53:31", "message": "Upload xong 4 ảnh trong 4.40s"}
{"stage": "run-start", "t": "2025-09-30 14:53:32", "cycle": "2025-09-30 14:53:32", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:52:57) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:51:43) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:50:28) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:53:32Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 345}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:53:32", "broker_time": "2025-09-30T07:53:32Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3845.541, "ask": 3845.618, "last": 0.0, "time": 1759218811}, "tick_stats_5m": {"ticks_per_min": 345, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 305, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7566905460079454, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.125413910585676, "M1": 2.0669845902945, "M15": 6.23706440609033, "H1": 11.602713187189073}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3851.829501651628, "ema200": 3858.883905274116}, "M5": {"ema50": 3857.869607782792, "ema200": 3844.153855061844}, "M15": {"ema50": 3847.8416147822054, "ema200": 3809.5387028875207}, "H1": {"ema50": 3810.606257315807, "ema200": 3749.4933177724047}}}, "vwap": {"day": 3860.5112265884136, "asia": null, "london": 3851.961974242878, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 11479.00000000027}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 81544.00000000032}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 27662.000000000262}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 78621.00000000009}], "round_levels": [{"level": "5400", "price": 3845.54, "distance_pips": 0.1}, {"level": "5425", "price": 3845.543, "distance_pips": 0.15}, {"level": "5450", "price": 3845.545, "distance_pips": 0.4}, {"level": "5475", "price": 3845.548, "distance_pips": 0.65}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.8664793804614697}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 273, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 279}, {"price": 3871.459, "bar_index": 284}, {"price": 3870.478, "bar_index": 276}, {"price": 3870.101, "bar_index": 270}, {"price": 3870.097, "bar_index": 268}], "swing_lows_SSL": [{"price": 3816.725, "bar_index": 101}, {"price": 3820.97, "bar_index": 115}, {"price": 3822.667, "bar_index": 158}, {"price": 3822.809, "bar_index": 112}, {"price": 3823.219, "bar_index": 106}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 203, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 298, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 296, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Premium"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 287}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 286}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 281}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 196}, {"price": 3871.459, "bar_index": 223}, {"price": 3871.268, "bar_index": 229}, {"price": 3871.166, "bar_index": 221}, {"price": 3870.48, "bar_index": 218}], "swing_lows_SSL": [{"price": 3843.774, "bar_index": 298}, {"price": 3844.001, "bar_index": 296}, {"price": 3846.274, "bar_index": 288}, {"price": 3848.432, "bar_index": 272}, {"price": 3850.809, "bar_index": 280}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 295, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 268, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3843.774, "equilibrium": 3857.7675, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 287}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 284}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 270}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3845.541, "spread_points": 77, "atr_m5_pips": 412.5413910585676, "ticks_per_min": 345, "pdh_pdl_distance_pips": {"PDH": 11479.00000000027, "PDL": 81544.00000000032}, "eq50_d_distance_pips": 27662.000000000262, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:53:32", "message": "Context+MT5 xong trong 0.77s"}
{"stage": "status_update", "t": "2025-09-30 14:53:33", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:53:33", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:54:32", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:54:32", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:54:32", "message": "Đã lưu thành công file: ctx_20250930_145432.json"}
{"stage": "run-end", "t": "2025-09-30 14:54:32"}
{"stage": "status_update", "t": "2025-09-30 14:54:32", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:54:32", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:55:02", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:55:02", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:55:02", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:55:02", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:55:06", "message": "Upload xong 4 ảnh trong 4.25s"}
{"stage": "run-start", "t": "2025-09-30 14:55:07", "cycle": "2025-09-30 14:55:07", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:54:32) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:52:57) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:51:43) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:55:07Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 293}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:55:07", "broker_time": "2025-09-30T07:55:07Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3844.139, "ask": 3844.176, "last": 0.0, "time": 1759218907}, "tick_stats_5m": {"ticks_per_min": 293, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 307, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7436806354626795, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.8998129169937386, "M1": 1.9822469171671848, "M15": 6.23706440609033, "H1": 11.602713187189073}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3851.266996155207, "ema200": 3858.588969103272}, "M5": {"ema50": 3857.311628748839, "ema200": 3844.1502245172596}, "M15": {"ema50": 3847.790438311617, "ema200": 3809.5257178128936}, "H1": {"ema50": 3810.5550808452185, "ema200": 3749.4803326977776}}}, "vwap": {"day": 3860.4559240915146, "asia": null, "london": 3851.7916185882564, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 10077.000000000226}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 80142.00000000028}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 26260.00000000022}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 77219.00000000004}], "round_levels": [{"level": "1300", "price": 3844.13, "distance_pips": 0.9}, {"level": "1325", "price": 3844.133, "distance_pips": 0.65}, {"level": "1350", "price": 3844.135, "distance_pips": 0.4}, {"level": "1375", "price": 3844.138, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9487634608977474}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3842.651, "bottom": 3840.666, "created_at_bar": 294, "lo": 3840.666, "hi": 3842.651}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3859.405, "bottom": 3843.774, "bar_index": 299}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 273, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 278}, {"price": 3871.459, "bar_index": 283}, {"price": 3870.478, "bar_index": 275}, {"price": 3870.101, "bar_index": 269}, {"price": 3870.097, "bar_index": 267}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 114}, {"price": 3822.667, "bar_index": 157}, {"price": 3822.809, "bar_index": 111}, {"price": 3823.219, "bar_index": 105}, {"price": 3823.404, "bar_index": 145}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 202, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 297, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 295, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3845.128, "bottom": 3844.161, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 286}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 285}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 194}, {"price": 3871.459, "bar_index": 221}, {"price": 3871.268, "bar_index": 227}, {"price": 3871.166, "bar_index": 219}, {"price": 3870.48, "bar_index": 216}], "swing_lows_SSL": [{"price": 3843.774, "bar_index": 296}, {"price": 3844.001, "bar_index": 294}, {"price": 3844.058, "bar_index": 298}, {"price": 3846.274, "bar_index": 286}, {"price": 3848.432, "bar_index": 270}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 293, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 266, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3843.774, "equilibrium": 3857.7675, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3845.128, "bottom": 3844.161, "bar_index": 299}, {"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 285}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 282}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3844.139, "spread_points": 37, "atr_m5_pips": 389.98129169937386, "ticks_per_min": 293, "pdh_pdl_distance_pips": {"PDH": 10077.000000000226, "PDL": 80142.00000000028}, "eq50_d_distance_pips": 26260.00000000022, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:55:08", "message": "Context+MT5 xong trong 1.89s"}
{"stage": "status_update", "t": "2025-09-30 14:55:08", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:55:08", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:55:47", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:55:47", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:55:47", "message": "Đã lưu thành công file: ctx_20250930_145547.json"}
{"stage": "run-end", "t": "2025-09-30 14:55:47"}
{"stage": "status_update", "t": "2025-09-30 14:55:47", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:55:47", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:56:17", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:56:17", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:56:17", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:56:17", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:56:22", "message": "Upload xong 4 ảnh trong 4.49s"}
{"stage": "run-start", "t": "2025-09-30 14:56:22", "cycle": "2025-09-30 14:56:22", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:55:47) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:54:32) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:52:57) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:56:22Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 281}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:56:22", "broker_time": "2025-09-30T07:56:22Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3841.398, "ask": 3841.435, "last": 0.0, "time": 1759218982}, "tick_stats_5m": {"ticks_per_min": 281, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 306, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7182454251883765, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.0831700598508816, "M1": 2.0805200965412833, "M15": 6.392778691804605, "H1": 11.758427472903348}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3850.848474215918, "ema200": 3858.37855328815}, "M5": {"ema50": 3857.209118944918, "ema200": 3844.124214567011}, "M15": {"ema50": 3847.6879285076957, "ema200": 3809.499707862645}, "H1": {"ema50": 3810.4525710412972, "ema200": 3749.454322747529}}}, "vwap": {"day": 3860.366574633248, "asia": null, "london": 3851.5829117680464, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 7336.00000000024}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 77401.00000000029}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 23519.000000000233}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 74478.00000000006}], "round_levels": [{"level": "3900", "price": 3841.39, "distance_pips": 0.8}, {"level": "3925", "price": 3841.392, "distance_pips": 0.55}, {"level": "3950", "price": 3841.395, "distance_pips": 0.3}, {"level": "3975", "price": 3841.398, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9061586820402586}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3838.031, "bottom": 3833.437, "created_at_bar": 293, "lo": 3833.437, "hi": 3838.031}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3859.405, "bottom": 3841.594, "bar_index": 299}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3841.084, "bottom": 3839.986, "created_at_bar": 273, "lo": 3839.986, "hi": 3841.084}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 278}, {"price": 3871.459, "bar_index": 283}, {"price": 3870.478, "bar_index": 275}, {"price": 3870.101, "bar_index": 269}, {"price": 3870.097, "bar_index": 267}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 114}, {"price": 3822.667, "bar_index": 157}, {"price": 3822.809, "bar_index": 111}, {"price": 3823.219, "bar_index": 105}, {"price": 3823.404, "bar_index": 145}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 202, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 297, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 295, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3845.128, "bottom": 3841.594, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 286}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 285}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 193}, {"price": 3871.459, "bar_index": 220}, {"price": 3871.268, "bar_index": 226}, {"price": 3871.166, "bar_index": 218}, {"price": 3870.48, "bar_index": 215}], "swing_lows_SSL": [{"price": 3843.774, "bar_index": 295}, {"price": 3844.001, "bar_index": 293}, {"price": 3846.274, "bar_index": 285}, {"price": 3848.432, "bar_index": 269}, {"price": 3850.809, "bar_index": 277}]}, "fvgs_m1": [{"type": "Bearish", "top": 3844.058, "bottom": 3843.198, "created_at_bar": 299, "lo": 3843.198, "hi": 3844.058}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 265, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3841.594, "equilibrium": 3856.6775, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3843.198, "bottom": 3841.594, "bar_index": 299}, {"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 284}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 281}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3841.398, "spread_points": 37, "atr_m5_pips": 408.31700598508814, "ticks_per_min": 281, "pdh_pdl_distance_pips": {"PDH": 7336.00000000024, "PDL": 77401.00000000029}, "eq50_d_distance_pips": 23519.000000000233, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:56:22", "message": "Context+MT5 xong trong 0.22s"}
{"stage": "status_update", "t": "2025-09-30 14:56:23", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:56:23", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:57:02", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:57:02", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:57:02", "message": "Đã lưu thành công file: ctx_20250930_145702.json"}
{"stage": "run-end", "t": "2025-09-30 14:57:02"}
{"stage": "status_update", "t": "2025-09-30 14:57:02", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:57:02", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:57:32", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:57:32", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:57:32", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:57:32", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:57:37", "message": "Upload xong 4 ảnh trong 4.51s"}
{"stage": "run-start", "t": "2025-09-30 14:57:37", "cycle": "2025-09-30 14:57:37", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:57:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:55:47) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:54:32) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:57:37Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 329}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:57:37", "broker_time": "2025-09-30T07:57:37Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3842.01, "ask": 3842.047, "last": 0.0, "time": 1759219057}, "tick_stats_5m": {"ticks_per_min": 329, "median_spread": 37, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 310, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7239245016888783, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.229027202708019, "M1": 2.1474931508661483, "M15": 6.538635834661742, "H1": 11.904284615760485}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3850.4953854745036, "ema200": 3858.2032339597354}, "M5": {"ema50": 3857.225432670408, "ema200": 3844.128353870494}, "M15": {"ema50": 3847.7042422331856, "ema200": 3809.503847166128}, "H1": {"ema50": 3810.468884766787, "ema200": 3749.458462051012}}}, "vwap": {"day": 3860.2227923657215, "asia": null, "london": 3851.2524395702967, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 7948.00000000032}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 78013.00000000038}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 24131.000000000313}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 75090.00000000015}], "round_levels": [{"level": "100", "price": 3842.01, "distance_pips": 0.0}, {"level": "125", "price": 3842.013, "distance_pips": 0.25}, {"level": "150", "price": 3842.015, "distance_pips": 0.5}, {"level": "175", "price": 3842.018, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8749056987884727}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3838.031, "bottom": 3833.437, "created_at_bar": 293, "lo": 3833.437, "hi": 3838.031}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 269, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 278}, {"price": 3871.459, "bar_index": 283}, {"price": 3870.478, "bar_index": 275}, {"price": 3870.101, "bar_index": 269}, {"price": 3870.097, "bar_index": 267}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 114}, {"price": 3822.667, "bar_index": 157}, {"price": 3822.809, "bar_index": 111}, {"price": 3823.219, "bar_index": 105}, {"price": 3823.404, "bar_index": 145}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 202, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 297, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 295, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 286}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 285}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 280}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 192}, {"price": 3871.459, "bar_index": 219}, {"price": 3871.268, "bar_index": 225}, {"price": 3871.166, "bar_index": 217}, {"price": 3870.48, "bar_index": 214}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 298}, {"price": 3843.774, "bar_index": 294}, {"price": 3844.001, "bar_index": 292}, {"price": 3846.274, "bar_index": 284}, {"price": 3848.432, "bar_index": 268}]}, "fvgs_m1": [{"type": "Bearish", "top": 3842.272, "bottom": 3842.182, "created_at_bar": 299, "lo": 3842.182, "hi": 3842.272}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 264, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3839.552, "equilibrium": 3855.6565, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 283}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 280}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 266}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3842.01, "spread_points": 37, "atr_m5_pips": 422.90272027080186, "ticks_per_min": 329, "pdh_pdl_distance_pips": {"PDH": 7948.00000000032, "PDL": 78013.00000000038}, "eq50_d_distance_pips": 24131.000000000313, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:57:37", "message": "Context+MT5 xong trong 0.47s"}
{"stage": "status_update", "t": "2025-09-30 14:57:39", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:57:39", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:58:17", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:58:17", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:58:17", "message": "Đã lưu thành công file: ctx_20250930_145817.json"}
{"stage": "run-end", "t": "2025-09-30 14:58:17"}
{"stage": "status_update", "t": "2025-09-30 14:58:17", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:58:17", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 14:58:47", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 14:58:47", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 14:58:47", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 14:58:47", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 14:58:52", "message": "Upload xong 4 ảnh trong 4.27s"}
{"stage": "run-start", "t": "2025-09-30 14:58:52", "cycle": "2025-09-30 14:58:52", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:58:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:57:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:55:47) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T07:58:52Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 346}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 14:58:52", "broker_time": "2025-09-30T07:58:52Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3842.711, "ask": 3842.748, "last": 0.0, "time": 1759219133}, "tick_stats_5m": {"ticks_per_min": 346, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 312, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7304294569615071, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.229027202708019, "M1": 2.1626926197120597, "M15": 6.538635834661742, "H1": 11.904284615760485}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3850.1820399018266, "ema200": 3858.051789091413}, "M5": {"ema50": 3857.22856992531, "ema200": 3844.1291498903943}, "M15": {"ema50": 3847.7073794880876, "ema200": 3809.5046431860283}, "H1": {"ema50": 3810.472022021689, "ema200": 3749.4592580709123}}}, "vwap": {"day": 3860.1525589450644, "asia": null, "london": 3851.068970161018, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 8648.999999999887}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 78713.99999999994}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 24831.99999999988}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 75790.99999999971}], "round_levels": [{"level": "7100", "price": 3842.71, "distance_pips": 0.1}, {"level": "7125", "price": 3842.713, "distance_pips": 0.15}, {"level": "7150", "price": 3842.715, "distance_pips": 0.4}, {"level": "7175", "price": 3842.718, "distance_pips": 0.65}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8749056987992258}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 298}, {"price": 3867.242, "bar_index": 295}, {"price": 3834.062, "bar_index": 289}, {"price": 3833.647, "bar_index": 285}, {"price": 3831.428, "bar_index": 280}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 121}, {"price": 3632.264, "bar_index": 132}, {"price": 3633.892, "bar_index": 114}, {"price": 3640.568, "bar_index": 126}, {"price": 3643.331, "bar_index": 137}]}, "fvgs_h1": [{"type": "Bullish", "top": 3838.031, "bottom": 3833.437, "created_at_bar": 293, "lo": 3833.437, "hi": 3838.031}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 299, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 270, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 297, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 298}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 295}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 293}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3871.459, "bar_index": 294}, {"price": 3870.101, "bar_index": 289}, {"price": 3867.242, "bar_index": 283}, {"price": 3852.113, "bar_index": 276}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 112}, {"price": 3741.553, "bar_index": 108}, {"price": 3742.965, "bar_index": 127}, {"price": 3744.591, "bar_index": 105}, {"price": 3744.709, "bar_index": 102}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 269, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 296, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 271, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 294, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 295}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 282}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 267}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 278}, {"price": 3871.459, "bar_index": 283}, {"price": 3870.478, "bar_index": 275}, {"price": 3870.101, "bar_index": 269}, {"price": 3870.097, "bar_index": 267}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 114}, {"price": 3822.667, "bar_index": 157}, {"price": 3822.809, "bar_index": 111}, {"price": 3823.219, "bar_index": 105}, {"price": 3823.404, "bar_index": 145}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 202, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 297, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 295, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3816.725, "equilibrium": 3844.243, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 286}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 285}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 280}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 191}, {"price": 3871.459, "bar_index": 218}, {"price": 3871.268, "bar_index": 224}, {"price": 3871.166, "bar_index": 216}, {"price": 3870.48, "bar_index": 213}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 297}, {"price": 3843.774, "bar_index": 293}, {"price": 3844.001, "bar_index": 291}, {"price": 3846.274, "bar_index": 283}, {"price": 3848.432, "bar_index": 267}]}, "fvgs_m1": [{"type": "Bearish", "top": 3844.058, "bottom": 3843.198, "created_at_bar": 297, "lo": 3843.198, "hi": 3844.058}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 263, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3839.552, "equilibrium": 3855.6565, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 282}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 279}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 265}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3842.711, "spread_points": 37, "atr_m5_pips": 422.90272027080186, "ticks_per_min": 346, "pdh_pdl_distance_pips": {"PDH": 8648.999999999887, "PDL": 78713.99999999994}, "eq50_d_distance_pips": 24831.99999999988, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 14:58:53", "message": "Context+MT5 xong trong 0.75s"}
{"stage": "status_update", "t": "2025-09-30 14:58:55", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 14:58:55", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 14:59:33", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 14:59:33", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 14:59:33", "message": "Đã lưu thành công file: ctx_20250930_145933.json"}
{"stage": "run-end", "t": "2025-09-30 14:59:33"}
{"stage": "status_update", "t": "2025-09-30 14:59:33", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 14:59:33", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:00:03", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:00:03", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:00:03", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:00:03", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:00:08", "message": "Upload xong 4 ảnh trong 4.37s"}
{"stage": "run-start", "t": "2025-09-30 15:00:08", "cycle": "2025-09-30 15:00:08", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 14:59:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 14:58:17) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:57:02) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:00:08Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 371}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:00:08", "broker_time": "2025-09-30T08:00:08Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3844.406, "ask": 3844.443, "last": 0.0, "time": 1759219208}, "tick_stats_5m": {"ticks_per_min": 371, "median_spread": 37.0, "p90_spread": 77}, "tick_stats_30m": {"ticks_per_min": 316, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7461582717790729, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.069668116870839, "M1": 2.1214339425254245, "M15": 6.214304703640406, "H1": 11.196692857658581}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3849.7439969369143, "ema200": 3857.750624290217}, "M5": {"ema50": 3856.7948983209153, "ema200": 3844.0947146785043}, "M15": {"ema50": 3847.6471124874615, "ema200": 3810.0142720102467}, "H1": {"ema50": 3811.8719256061977, "ema200": 3750.2456829233156}}}, "vwap": {"day": 3860.083845653997, "asia": null, "london": 3850.8884640029387, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 10344.000000000051}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 80409.0000000001}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 26527.000000000044}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 77485.99999999987}], "round_levels": [{"level": "4000", "price": 3844.4, "distance_pips": 0.6}, {"level": "4025", "price": 3844.403, "distance_pips": 0.35}, {"level": "4050", "price": 3844.405, "distance_pips": 0.1}, {"level": "4075", "price": 3844.408, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9091650458394422}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3838.031, "bottom": 3833.437, "created_at_bar": 292, "lo": 3833.437, "hi": 3838.031}, {"type": "Bearish", "top": 3854.92, "bottom": 3844.458, "created_at_bar": 299, "lo": 3844.458, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 268, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3846.274, "bottom": 3844.458, "created_at_bar": 299, "lo": 3844.458, "hi": 3846.274}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 270, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 277}, {"price": 3871.459, "bar_index": 282}, {"price": 3870.478, "bar_index": 274}, {"price": 3870.101, "bar_index": 268}, {"price": 3870.097, "bar_index": 266}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 113}, {"price": 3822.667, "bar_index": 156}, {"price": 3822.809, "bar_index": 110}, {"price": 3823.219, "bar_index": 104}, {"price": 3823.404, "bar_index": 144}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 201, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 296, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 294, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 285}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 284}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 279}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 189}, {"price": 3871.459, "bar_index": 216}, {"price": 3871.268, "bar_index": 222}, {"price": 3871.166, "bar_index": 214}, {"price": 3870.48, "bar_index": 211}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 295}, {"price": 3843.774, "bar_index": 291}, {"price": 3844.001, "bar_index": 289}, {"price": 3846.274, "bar_index": 281}, {"price": 3848.432, "bar_index": 265}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 288, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 261, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3839.552, "equilibrium": 3855.6565, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 280}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 277}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 263}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3844.406, "spread_points": 37, "atr_m5_pips": 406.9668116870839, "ticks_per_min": 371, "pdh_pdl_distance_pips": {"PDH": 10344.000000000051, "PDL": 80409.0000000001}, "eq50_d_distance_pips": 26527.000000000044, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:00:08", "message": "Context+MT5 xong trong 0.66s"}
{"stage": "status_update", "t": "2025-09-30 15:00:09", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:00:09", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:00:48", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:00:48", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:00:48", "message": "Đã lưu thành công file: ctx_20250930_150048.json"}
{"stage": "run-end", "t": "2025-09-30 15:00:48"}
{"stage": "status_update", "t": "2025-09-30 15:00:48", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:00:48", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:01:18", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:01:18", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:01:18", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:01:18", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:01:22", "message": "Lỗi nghiêm trọng trong worker: 503 The service is currently unavailable."}
{"stage": "status_update", "t": "2025-09-30 15:01:22", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:01:22", "message": "Đã lưu thành công file: ctx_20250930_150122.json"}
{"stage": "run-end", "t": "2025-09-30 15:01:22"}
{"stage": "status_update", "t": "2025-09-30 15:01:22", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:01:22", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:01:52", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:01:52", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:01:52", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:01:52", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:01:57", "message": "Upload xong 4 ảnh trong 4.47s"}
{"stage": "run-start", "t": "2025-09-30 15:01:57", "cycle": "2025-09-30 15:01:57", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 503 The service is currently unavailable.", "Traceback:", "Traceback (most recent call last):", "File \"C:\\Users\\Windows\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 76, in error_remapped_callable"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:01:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 503 The service is currently unavailable.\nTraceback:\nTraceback (most recent call last):\nFile \"C:\\Users\\Windows\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 76, in error_remapped_callable\n\n--- Context T-1 (2025-09-30 15:00:48) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 14:59:33) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:01:57Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 295}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:01:57", "broker_time": "2025-09-30T08:01:57Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3845.448, "ask": 3845.485, "last": 0.0, "time": 1759219317}, "tick_stats_5m": {"ticks_per_min": 295, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 317, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7558275490887488, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.069668116870839, "M1": 2.1214339425254245, "M15": 6.214304703640406, "H1": 11.196692857658581}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3849.7439969369143, "ema200": 3857.750624290217}, "M5": {"ema50": 3856.7948983209153, "ema200": 3844.0947146785043}, "M15": {"ema50": 3847.6471124874615, "ema200": 3810.0142720102467}, "H1": {"ema50": 3811.8719256061977, "ema200": 3750.2456829233156}}}, "vwap": {"day": 3860.083845653997, "asia": null, "london": 3850.8884640029387, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 11385.999999999967}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 81451.00000000001}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 27568.99999999996}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 78527.9999999998}], "round_levels": [{"level": "4400", "price": 3845.44, "distance_pips": 0.8}, {"level": "4425", "price": 3845.443, "distance_pips": 0.55}, {"level": "4450", "price": 3845.445, "distance_pips": 0.3}, {"level": "4475", "price": 3845.448, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9091650458394422}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3838.031, "bottom": 3833.437, "created_at_bar": 292, "lo": 3833.437, "hi": 3838.031}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 298, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 268, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 270, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 277}, {"price": 3871.459, "bar_index": 282}, {"price": 3870.478, "bar_index": 274}, {"price": 3870.101, "bar_index": 268}, {"price": 3870.097, "bar_index": 266}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 113}, {"price": 3822.667, "bar_index": 156}, {"price": 3822.809, "bar_index": 110}, {"price": 3823.219, "bar_index": 104}, {"price": 3823.404, "bar_index": 144}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 201, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 296, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 294, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 285}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 284}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 279}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 189}, {"price": 3871.459, "bar_index": 216}, {"price": 3871.268, "bar_index": 222}, {"price": 3871.166, "bar_index": 214}, {"price": 3870.48, "bar_index": 211}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 295}, {"price": 3843.774, "bar_index": 291}, {"price": 3844.001, "bar_index": 289}, {"price": 3846.274, "bar_index": 281}, {"price": 3848.432, "bar_index": 265}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 288, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 261, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3839.552, "equilibrium": 3855.6565, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 280}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 277}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 263}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3845.448, "spread_points": 37, "atr_m5_pips": 406.9668116870839, "ticks_per_min": 295, "pdh_pdl_distance_pips": {"PDH": 11385.999999999967, "PDL": 81451.00000000001}, "eq50_d_distance_pips": 27568.99999999996, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:01:57", "message": "Context+MT5 xong trong 0.29s"}
{"stage": "status_update", "t": "2025-09-30 15:01:58", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:01:58", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:02:36", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:02:36", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:02:36", "message": "Đã lưu thành công file: ctx_20250930_150236.json"}
{"stage": "run-end", "t": "2025-09-30 15:02:36"}
{"stage": "status_update", "t": "2025-09-30 15:02:36", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:02:36", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:03:06", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:03:06", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:03:06", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:03:06", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:03:11", "message": "Upload xong 4 ảnh trong 4.12s"}
{"stage": "run-start", "t": "2025-09-30 15:03:11", "cycle": "2025-09-30 15:03:11", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:02:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:01:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 503 The service is currently unavailable.\nTraceback:\nTraceback (most recent call last):\nFile \"C:\\Users\\Windows\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 76, in error_remapped_callable\n\n--- Context T-2 (2025-09-30 15:00:48) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:03:11Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 246}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:03:11", "broker_time": "2025-09-30T08:03:11Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3844.758, "ask": 3844.795, "last": 0.0, "time": 1759219391}, "tick_stats_5m": {"ticks_per_min": 246, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 315, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7494246687205363, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.069668116870839, "M1": 2.1214339425254245, "M15": 6.214304703640406, "H1": 11.196692857658581}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3849.7439969369143, "ema200": 3857.750624290217}, "M5": {"ema50": 3856.7948983209153, "ema200": 3844.0947146785043}, "M15": {"ema50": 3847.6471124874615, "ema200": 3810.0142720102467}, "H1": {"ema50": 3811.8719256061977, "ema200": 3750.2456829233156}}}, "vwap": {"day": 3860.083845653997, "asia": null, "london": 3850.8884640029387, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 10695.999999999913}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 80760.99999999997}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 26878.999999999905}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 77837.99999999974}], "round_levels": [{"level": "7500", "price": 3844.75, "distance_pips": 0.8}, {"level": "7525", "price": 3844.753, "distance_pips": 0.55}, {"level": "7550", "price": 3844.755, "distance_pips": 0.3}, {"level": "7575", "price": 3844.758, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9091650458394422}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3838.031, "bottom": 3833.437, "created_at_bar": 292, "lo": 3833.437, "hi": 3838.031}, {"type": "Bearish", "top": 3862.623, "bottom": 3859.405, "created_at_bar": 298, "lo": 3859.405, "hi": 3862.623}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 268, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 270, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 277}, {"price": 3871.459, "bar_index": 282}, {"price": 3870.478, "bar_index": 274}, {"price": 3870.101, "bar_index": 268}, {"price": 3870.097, "bar_index": 266}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 113}, {"price": 3822.667, "bar_index": 156}, {"price": 3822.809, "bar_index": 110}, {"price": 3823.219, "bar_index": 104}, {"price": 3823.404, "bar_index": 144}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 201, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 296, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 294, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 285}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 284}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 279}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 189}, {"price": 3871.459, "bar_index": 216}, {"price": 3871.268, "bar_index": 222}, {"price": 3871.166, "bar_index": 214}, {"price": 3870.48, "bar_index": 211}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 295}, {"price": 3843.774, "bar_index": 291}, {"price": 3844.001, "bar_index": 289}, {"price": 3846.274, "bar_index": 281}, {"price": 3848.432, "bar_index": 265}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 288, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 261, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3839.552, "equilibrium": 3855.6565, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 280}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 277}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 263}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3844.758, "spread_points": 37, "atr_m5_pips": 406.9668116870839, "ticks_per_min": 246, "pdh_pdl_distance_pips": {"PDH": 10695.999999999913, "PDL": 80760.99999999997}, "eq50_d_distance_pips": 26878.999999999905, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:03:11", "message": "Context+MT5 xong trong 0.18s"}
{"stage": "status_update", "t": "2025-09-30 15:03:12", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:03:12", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:03:50", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:03:50", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:03:51", "message": "Đã lưu thành công file: ctx_20250930_150350.json"}
{"stage": "run-end", "t": "2025-09-30 15:03:51"}
{"stage": "status_update", "t": "2025-09-30 15:03:51", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:03:51", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:04:21", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:04:21", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:04:21", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:04:21", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:04:25", "message": "Upload xong 4 ảnh trong 4.26s"}
{"stage": "run-start", "t": "2025-09-30 15:04:25", "cycle": "2025-09-30 15:04:25", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:03:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:02:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:01:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 503 The service is currently unavailable.\nTraceback:\nTraceback (most recent call last):\nFile \"C:\\Users\\Windows\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 76, in error_remapped_callable", "run_meta": {"analysis_id": "2025-09-30T08:04:25Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 248}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:04:25", "broker_time": "2025-09-30T08:04:25Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3843.951, "ask": 3843.988, "last": 0.0, "time": 1759219465}, "tick_stats_5m": {"ticks_per_min": 248, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 320, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7419360825507598, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.115382402585116, "M1": 2.167148228239701, "M15": 6.260018989354682, "H1": 11.242407143372857}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3849.7658792898555, "ema200": 3857.7561765290225}, "M5": {"ema50": 3856.8167806738566, "ema200": 3844.10026691731}, "M15": {"ema50": 3847.668994840403, "ema200": 3810.0198242490524}, "H1": {"ema50": 3811.893807959139, "ema200": 3750.2512351621212}}}, "vwap": {"day": 3860.0650539113017, "asia": null, "london": 3850.862638099717, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 9889.000000000124}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 79954.00000000017}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 26072.000000000116}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 77030.99999999994}], "round_levels": [{"level": "9500", "price": 3843.95, "distance_pips": 0.1}, {"level": "9525", "price": 3843.953, "distance_pips": 0.15}, {"level": "9550", "price": 3843.955, "distance_pips": 0.4}, {"level": "9575", "price": 3843.958, "distance_pips": 0.65}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8990659039744472}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3838.031, "bottom": 3833.437, "created_at_bar": 292, "lo": 3833.437, "hi": 3838.031}, {"type": "Bearish", "top": 3854.92, "bottom": 3845.098, "created_at_bar": 299, "lo": 3845.098, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 268, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3846.274, "bottom": 3845.098, "created_at_bar": 299, "lo": 3845.098, "hi": 3846.274}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 270, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 277}, {"price": 3871.459, "bar_index": 282}, {"price": 3870.478, "bar_index": 274}, {"price": 3870.101, "bar_index": 268}, {"price": 3870.097, "bar_index": 266}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 113}, {"price": 3822.667, "bar_index": 156}, {"price": 3822.809, "bar_index": 110}, {"price": 3823.219, "bar_index": 104}, {"price": 3823.404, "bar_index": 144}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 201, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 296, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 294, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 285}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 284}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 279}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 189}, {"price": 3871.459, "bar_index": 216}, {"price": 3871.268, "bar_index": 222}, {"price": 3871.166, "bar_index": 214}, {"price": 3870.48, "bar_index": 211}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 295}, {"price": 3843.774, "bar_index": 291}, {"price": 3844.001, "bar_index": 289}, {"price": 3846.274, "bar_index": 281}, {"price": 3848.432, "bar_index": 265}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 288, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 261, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3839.552, "equilibrium": 3855.6565, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 280}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 277}, {"type": "Bearish", "top": 3853.66, "bottom": 3851.552, "bar_index": 263}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3843.951, "spread_points": 37, "atr_m5_pips": 411.53824025851156, "ticks_per_min": 248, "pdh_pdl_distance_pips": {"PDH": 9889.000000000124, "PDL": 79954.00000000017}, "eq50_d_distance_pips": 26072.000000000116, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:04:26", "message": "Context+MT5 xong trong 0.67s"}
{"stage": "status_update", "t": "2025-09-30 15:04:27", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:04:27", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:05:05", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:05:05", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:05:05", "message": "Đã lưu thành công file: ctx_20250930_150505.json"}
{"stage": "run-end", "t": "2025-09-30 15:05:05"}
{"stage": "status_update", "t": "2025-09-30 15:05:05", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:05:05", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:05:36", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:05:36", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:05:36", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:05:36", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:05:40", "message": "Upload xong 4 ảnh trong 4.90s"}
{"stage": "run-start", "t": "2025-09-30 15:05:41", "cycle": "2025-09-30 15:05:41", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:05:05) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:03:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:02:36) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:05:41Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 260}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": true, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:05:41", "broker_time": "2025-09-30T08:05:41Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 77, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3843.122, "ask": 3843.199, "last": 0.0, "time": 1759219541}, "tick_stats_5m": {"ticks_per_min": 260, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 322, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7342433465721383, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.267882402585132, "M1": 2.261604206701027, "M15": 6.412518989354698, "H1": 11.394907143372873}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3849.2910524651243, "ema200": 3857.369066090704}, "M5": {"ema50": 3856.7720747915037, "ema200": 3844.088923633728}, "M15": {"ema50": 3847.62428895805, "ema200": 3810.0084809654704}, "H1": {"ema50": 3811.849102076786, "ema200": 3750.2398918785393}}}, "vwap": {"day": 3859.997870192754, "asia": null, "london": 3850.672998503878, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 9059.999999999945}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 79125.0}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 25242.999999999938}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 76201.99999999977}], "round_levels": [{"level": "1200", "price": 3843.12, "distance_pips": 0.2}, {"level": "1225", "price": 3843.122, "distance_pips": 0.05}, {"level": "1250", "price": 3843.125, "distance_pips": 0.3}, {"level": "1275", "price": 3843.128, "distance_pips": 0.55}], "atr_norm": {"spread_as_pct_of_atr_m5": 1.8041734222476538}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3838.031, "bottom": 3833.437, "created_at_bar": 292, "lo": 3833.437, "hi": 3838.031}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 268, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 270, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 277}, {"price": 3871.459, "bar_index": 282}, {"price": 3870.478, "bar_index": 274}, {"price": 3870.101, "bar_index": 268}, {"price": 3870.097, "bar_index": 266}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 113}, {"price": 3822.667, "bar_index": 156}, {"price": 3822.809, "bar_index": 110}, {"price": 3823.219, "bar_index": 104}, {"price": 3823.404, "bar_index": 144}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 201, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 296, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 294, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 285}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 284}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 279}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 186}, {"price": 3871.459, "bar_index": 213}, {"price": 3871.268, "bar_index": 219}, {"price": 3871.166, "bar_index": 211}, {"price": 3870.48, "bar_index": 208}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 292}, {"price": 3842.46, "bar_index": 296}, {"price": 3843.774, "bar_index": 288}, {"price": 3844.001, "bar_index": 286}, {"price": 3846.274, "bar_index": 278}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 285, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3855.582, "bottom": 3854.294, "bar_index": 258, "lo": 3854.294, "hi": 3855.582, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3839.552, "equilibrium": 3855.6565, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3846.181, "bottom": 3843.516, "bar_index": 299}, {"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 277}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 274}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3843.122, "spread_points": 77, "atr_m5_pips": 426.78824025851316, "ticks_per_min": 260, "pdh_pdl_distance_pips": {"PDH": 9059.999999999945, "PDL": 79125.0}, "eq50_d_distance_pips": 25242.999999999938, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:05:41", "message": "Context+MT5 xong trong 0.23s"}
{"stage": "no-trade", "t": "2025-09-30 15:05:42", "reasons": ["Spread cao (cur=77, p90=37, factor=1.2)"]}
{"stage": "status_update", "t": "2025-09-30 15:05:42", "message": "Lỗi nghiêm trọng trong worker: 'TradingToolApp' object has no attribute '_auto_save_report'"}
{"stage": "status_update", "t": "2025-09-30 15:05:42", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:05:42", "message": "Đã lưu thành công file: ctx_20250930_150542.json"}
{"stage": "run-end", "t": "2025-09-30 15:05:42"}
{"stage": "status_update", "t": "2025-09-30 15:05:42", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:05:42", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:06:12", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:06:12", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:06:12", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:06:12", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:06:16", "message": "Upload xong 4 ảnh trong 4.14s"}
{"stage": "run-start", "t": "2025-09-30 15:06:16", "cycle": "2025-09-30 15:06:16", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:05:42) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:05:05) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:03:50) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:06:16Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 266}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:06:16", "broker_time": "2025-09-30T08:06:16Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3843.265, "ask": 3843.302, "last": 0.0, "time": 1759219576}, "tick_stats_5m": {"ticks_per_min": 266, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 323, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.7355703203296086, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.267882402585132, "M1": 2.268214110311211, "M15": 6.412518989354698, "H1": 11.394907143372873}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3849.044344986705, "ema200": 3857.2796402216727}, "M5": {"ema50": 3856.7529375366016, "ema200": 3844.084067912335}, "M15": {"ema50": 3847.605151703148, "ema200": 3810.0036252440773}, "H1": {"ema50": 3811.829964821884, "ema200": 3750.235036157146}}}, "vwap": {"day": 3859.9476657400764, "asia": null, "london": 3850.5600182134017, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 9202.999999999975}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 79268.00000000003}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 25385.999999999967}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 76344.9999999998}], "round_levels": [{"level": "2600", "price": 3843.26, "distance_pips": 0.5}, {"level": "2625", "price": 3843.263, "distance_pips": 0.25}, {"level": "2650", "price": 3843.265, "distance_pips": 0.0}, {"level": "2675", "price": 3843.268, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8669404756290936}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3838.031, "bottom": 3833.437, "created_at_bar": 292, "lo": 3833.437, "hi": 3838.031}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 268, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 270, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 277}, {"price": 3871.459, "bar_index": 282}, {"price": 3870.478, "bar_index": 274}, {"price": 3870.101, "bar_index": 268}, {"price": 3870.097, "bar_index": 266}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 113}, {"price": 3822.667, "bar_index": 156}, {"price": 3822.809, "bar_index": 110}, {"price": 3823.219, "bar_index": 104}, {"price": 3823.404, "bar_index": 144}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 201, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 296, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 294, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 285}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 284}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 279}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 185}, {"price": 3871.459, "bar_index": 212}, {"price": 3871.268, "bar_index": 218}, {"price": 3871.166, "bar_index": 210}, {"price": 3870.48, "bar_index": 207}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 291}, {"price": 3842.46, "bar_index": 295}, {"price": 3843.774, "bar_index": 287}, {"price": 3844.001, "bar_index": 285}, {"price": 3846.274, "bar_index": 277}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 284, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3847.233, "bottom": 3844.459, "bar_index": 297, "lo": 3844.459, "hi": 3847.233, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3839.552, "equilibrium": 3855.6565, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3846.181, "bottom": 3842.986, "bar_index": 298}, {"type": "Bearish", "top": 3851.554, "bottom": 3846.286, "bar_index": 276}, {"type": "Bearish", "top": 3852.858, "bottom": 3851.176, "bar_index": 273}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3843.265, "spread_points": 37, "atr_m5_pips": 426.78824025851316, "ticks_per_min": 266, "pdh_pdl_distance_pips": {"PDH": 9202.999999999975, "PDL": 79268.00000000003}, "eq50_d_distance_pips": 25385.999999999967, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:06:17", "message": "Context+MT5 xong trong 0.34s"}
{"stage": "status_update", "t": "2025-09-30 15:06:17", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:06:17", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:06:56", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:06:56", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:06:56", "message": "Đã lưu thành công file: ctx_20250930_150656.json"}
{"stage": "run-end", "t": "2025-09-30 15:06:56"}
{"stage": "status_update", "t": "2025-09-30 15:06:56", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:06:56", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:07:26", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:07:26", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:07:26", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:07:26", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:07:30", "message": "Upload xong 4 ảnh trong 3.96s"}
{"stage": "run-start", "t": "2025-09-30 15:07:30", "cycle": "2025-09-30 15:07:30", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:06:56) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:05:42) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:05:05) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:07:30Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 357}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:07:30", "broker_time": "2025-09-30T08:07:30Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3837.005, "ask": 3837.042, "last": 0.0, "time": 1759219650}, "tick_stats_5m": {"ticks_per_min": 357, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 336, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.6774804201774264, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.2594622308910175, "M1": 2.296378493118865, "M15": 6.542376132211856, "H1": 11.524764286230031}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3848.514109505503, "ema200": 3856.999971910338}, "M5": {"ema50": 3856.1570023567306, "ema200": 3844.272064311924}, "M15": {"ema50": 3847.498641899226, "ema200": 3809.9766003684554}, "H1": {"ema50": 3811.7234550179624, "ema200": 3750.2080112815243}}}, "vwap": {"day": 3859.824242493951, "asia": null, "london": 3850.302114736794, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 2943.000000000211}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 73008.00000000026}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 19126.000000000204}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 70085.00000000003}], "round_levels": [{"level": "00", "price": 3837.0, "distance_pips": 0.5}, {"level": "25", "price": 3837.003, "distance_pips": 0.25}, {"level": "50", "price": 3837.005, "distance_pips": 0.0}, {"level": "75", "price": 3837.008, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8686542571376981}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3801.368, "bottom": 3799.497, "created_at_bar": 273, "lo": 3799.497, "hi": 3801.368}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 268, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3839.986, "bottom": 3834.669, "bar_index": 270, "lo": 3834.669, "hi": 3839.986, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 276}, {"price": 3871.459, "bar_index": 281}, {"price": 3870.478, "bar_index": 273}, {"price": 3870.101, "bar_index": 267}, {"price": 3870.097, "bar_index": 265}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 112}, {"price": 3822.667, "bar_index": 155}, {"price": 3822.809, "bar_index": 109}, {"price": 3823.219, "bar_index": 103}, {"price": 3823.404, "bar_index": 143}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 200, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 295, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 293, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3844.792, "bottom": 3840.642, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 284}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 183}, {"price": 3871.459, "bar_index": 210}, {"price": 3871.268, "bar_index": 216}, {"price": 3871.166, "bar_index": 208}, {"price": 3870.48, "bar_index": 205}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 289}, {"price": 3842.46, "bar_index": 293}, {"price": 3843.774, "bar_index": 285}, {"price": 3844.001, "bar_index": 283}, {"price": 3846.274, "bar_index": 275}]}, "fvgs_m1": [{"type": "Bearish", "top": 3847.399, "bottom": 3847.045, "created_at_bar": 282, "lo": 3847.045, "hi": 3847.399}], "order_blocks_m1": [{"top": 3844.628, "bottom": 3842.766, "bar_index": 297, "lo": 3842.766, "hi": 3844.628, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3839.552, "equilibrium": 3855.6565, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3843.405, "bottom": 3840.642, "bar_index": 299}, {"type": "Bearish", "top": 3844.792, "bottom": 3842.632, "bar_index": 298}, {"type": "Bearish", "top": 3846.181, "bottom": 3842.986, "bar_index": 296}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3837.005, "spread_points": 37, "atr_m5_pips": 425.94622308910175, "ticks_per_min": 357, "pdh_pdl_distance_pips": {"PDH": 2943.000000000211, "PDL": 73008.00000000026}, "eq50_d_distance_pips": 19126.000000000204, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:07:31", "message": "Context+MT5 xong trong 0.55s"}
{"stage": "status_update", "t": "2025-09-30 15:07:32", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:07:32", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:08:10", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:08:10", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:08:10", "message": "Đã lưu thành công file: ctx_20250930_150810.json"}
{"stage": "run-end", "t": "2025-09-30 15:08:10"}
{"stage": "status_update", "t": "2025-09-30 15:08:10", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:08:10", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:08:41", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:08:41", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:08:41", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:08:41", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:08:45", "message": "Upload xong 4 ảnh trong 4.08s"}
{"stage": "run-start", "t": "2025-09-30 15:08:45", "cycle": "2025-09-30 15:08:45", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:08:10) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:06:56) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:05:42) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 'TradingToolApp' object has no attribute '_auto_save_report'\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 427, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:08:45Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 468}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:08:45", "broker_time": "2025-09-30T08:08:45Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3837.185, "ask": 3837.222, "last": 0.0, "time": 1759219725}, "tick_stats_5m": {"ticks_per_min": 468, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 358, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.6791507367952193, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.621605088033855, "M1": 2.5258157435969206, "M15": 6.904518989354692, "H1": 11.886907143372868}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3848.0056714018906, "ema200": 3856.86019024989}, "M5": {"ema50": 3855.978884709672, "ema200": 3844.2268702820734}, "M15": {"ema50": 3847.3205242521676, "ema200": 3809.9314063386046}, "H1": {"ema50": 3811.545337370904, "ema200": 3750.1628172516735}}}, "vwap": {"day": 3859.6104350681126, "asia": null, "london": 3849.887477866521, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 3123.0000000000473}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 73188.0000000001}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 19306.00000000004}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 70264.99999999987}], "round_levels": [{"level": "1800", "price": 3837.18, "distance_pips": 0.5}, {"level": "1825", "price": 3837.183, "distance_pips": 0.25}, {"level": "1850", "price": 3837.185, "distance_pips": 0.0}, {"level": "1875", "price": 3837.188, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8005876593839967}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3801.368, "bottom": 3799.497, "created_at_bar": 273, "lo": 3799.497, "hi": 3801.368}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 268, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3829.99, "bottom": 3828.102, "bar_index": 265, "lo": 3828.102, "hi": 3829.99, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 276}, {"price": 3871.459, "bar_index": 281}, {"price": 3870.478, "bar_index": 273}, {"price": 3870.101, "bar_index": 267}, {"price": 3870.097, "bar_index": 265}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 112}, {"price": 3822.667, "bar_index": 155}, {"price": 3822.809, "bar_index": 109}, {"price": 3823.219, "bar_index": 103}, {"price": 3823.404, "bar_index": 143}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 200, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 295, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 293, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3844.792, "bottom": 3835.572, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 284}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 182}, {"price": 3871.459, "bar_index": 209}, {"price": 3871.268, "bar_index": 215}, {"price": 3871.166, "bar_index": 207}, {"price": 3870.48, "bar_index": 204}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 288}, {"price": 3842.46, "bar_index": 292}, {"price": 3843.774, "bar_index": 284}, {"price": 3844.001, "bar_index": 282}, {"price": 3846.274, "bar_index": 274}]}, "fvgs_m1": [{"type": "Bearish", "top": 3842.632, "bottom": 3840.359, "created_at_bar": 299, "lo": 3840.359, "hi": 3842.632}], "order_blocks_m1": [{"top": 3844.628, "bottom": 3842.766, "bar_index": 296, "lo": 3842.766, "hi": 3844.628, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3835.572, "equilibrium": 3853.6665000000003, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3840.359, "bottom": 3835.572, "bar_index": 299}, {"type": "Bearish", "top": 3843.405, "bottom": 3839.865, "bar_index": 298}, {"type": "Bearish", "top": 3844.792, "bottom": 3842.632, "bar_index": 297}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3837.185, "spread_points": 37, "atr_m5_pips": 462.1605088033854, "ticks_per_min": 468, "pdh_pdl_distance_pips": {"PDH": 3123.0000000000473, "PDL": 73188.0000000001}, "eq50_d_distance_pips": 19306.00000000004, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:08:45", "message": "Context+MT5 xong trong 0.27s"}
{"stage": "status_update", "t": "2025-09-30 15:08:46", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:08:46", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:09:25", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:09:25", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:09:25", "message": "Đã lưu thành công file: ctx_20250930_150925.json"}
{"stage": "run-end", "t": "2025-09-30 15:09:25"}
{"stage": "status_update", "t": "2025-09-30 15:09:25", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:09:25", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:09:55", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:09:55", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:09:55", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:09:55", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:09:59", "message": "Upload xong 4 ảnh trong 4.13s"}
{"stage": "run-start", "t": "2025-09-30 15:09:59", "cycle": "2025-09-30 15:09:59", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:09:25) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:08:10) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:06:56) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:09:59Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 569}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:09:59", "broker_time": "2025-09-30T08:09:59Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3835.763, "ask": 3835.8, "last": 0.0, "time": 1759219800}, "tick_stats_5m": {"ticks_per_min": 569, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 381, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.6659552355146431, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.662890802319566, "M1": 2.563828904790135, "M15": 6.9458047036404045, "H1": 11.92819285765858}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3847.6348956165393, "ema200": 3856.6679453929178}, "M5": {"ema50": 3856.0295513763385, "ema200": 3844.239726003467}, "M15": {"ema50": 3847.371190918834, "ema200": 3809.944262059998}, "H1": {"ema50": 3811.5960040375703, "ema200": 3750.175672973067}}}, "vwap": {"day": 3859.4061749726648, "asia": null, "london": 3849.5076081892435, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 1701.0000000000218}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 71766.00000000007}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 17884.000000000015}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 68842.99999999984}], "round_levels": [{"level": "7600", "price": 3835.76, "distance_pips": 0.3}, {"level": "7625", "price": 3835.763, "distance_pips": 0.05}, {"level": "7650", "price": 3835.765, "distance_pips": 0.2}, {"level": "7675", "price": 3835.768, "distance_pips": 0.45}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.7934991739857215}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3801.368, "bottom": 3799.497, "created_at_bar": 273, "lo": 3799.497, "hi": 3801.368}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3835.574, "bottom": 3833.437, "created_at_bar": 268, "lo": 3833.437, "hi": 3835.574}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3829.99, "bottom": 3828.102, "bar_index": 265, "lo": 3828.102, "hi": 3829.99, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 276}, {"price": 3871.459, "bar_index": 281}, {"price": 3870.478, "bar_index": 273}, {"price": 3870.101, "bar_index": 267}, {"price": 3870.097, "bar_index": 265}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 112}, {"price": 3822.667, "bar_index": 155}, {"price": 3822.809, "bar_index": 109}, {"price": 3823.219, "bar_index": 103}, {"price": 3823.404, "bar_index": 143}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 200, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 295, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 293, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3844.792, "bottom": 3834.994, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 284}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 181}, {"price": 3871.459, "bar_index": 208}, {"price": 3871.268, "bar_index": 214}, {"price": 3871.166, "bar_index": 206}, {"price": 3870.48, "bar_index": 203}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 287}, {"price": 3842.46, "bar_index": 291}, {"price": 3843.774, "bar_index": 283}, {"price": 3844.001, "bar_index": 281}, {"price": 3846.274, "bar_index": 273}]}, "fvgs_m1": [{"type": "Bearish", "top": 3839.865, "bottom": 3838.052, "created_at_bar": 299, "lo": 3838.052, "hi": 3839.865}], "order_blocks_m1": [{"top": 3844.628, "bottom": 3842.766, "bar_index": 295, "lo": 3842.766, "hi": 3844.628, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3834.994, "equilibrium": 3853.3775, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3843.405, "bottom": 3839.865, "bar_index": 297}, {"type": "Bearish", "top": 3844.792, "bottom": 3842.632, "bar_index": 296}, {"type": "Bearish", "top": 3846.181, "bottom": 3842.986, "bar_index": 294}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3835.763, "spread_points": 37, "atr_m5_pips": 466.28908023195663, "ticks_per_min": 569, "pdh_pdl_distance_pips": {"PDH": 1701.0000000000218, "PDL": 71766.00000000007}, "eq50_d_distance_pips": 17884.000000000015, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:09:59", "message": "Context+MT5 xong trong 0.23s"}
{"stage": "status_update", "t": "2025-09-30 15:10:00", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:10:00", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:10:39", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:10:39", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:10:39", "message": "Đã lưu thành công file: ctx_20250930_151039.json"}
{"stage": "run-end", "t": "2025-09-30 15:10:40"}
{"stage": "status_update", "t": "2025-09-30 15:10:40", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:10:40", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:11:10", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:11:10", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:11:10", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:11:10", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:11:14", "message": "Upload xong 4 ảnh trong 4.68s"}
{"stage": "run-start", "t": "2025-09-30 15:11:14", "cycle": "2025-09-30 15:11:14", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:10:39) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:09:25) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:08:10) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:11:14Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 611}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:11:14", "broker_time": "2025-09-30T08:11:14Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3837.706, "ask": 3837.743, "last": 0.0, "time": 1759219874}, "tick_stats_5m": {"ticks_per_min": 611, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 389, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.6839853754500594, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.847033659462422, "M1": 2.7043411258917205, "M15": 7.129947560783259, "H1": 12.112335714801436}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3847.106410634248, "ema200": 3856.4684899560525}, "M5": {"ema50": 3855.9241003959464, "ema200": 3844.212969784561}, "M15": {"ema50": 3847.265739938442, "ema200": 3809.9175058410924}, "H1": {"ema50": 3811.490553057178, "ema200": 3750.1489167541613}}}, "vwap": {"day": 3859.175457637411, "asia": null, "london": 3849.072656792931, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 3644.000000000233}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 73709.00000000029}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 19827.000000000226}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 70786.00000000006}], "round_levels": [{"level": "7000", "price": 3837.7, "distance_pips": 0.6}, {"level": "7025", "price": 3837.703, "distance_pips": 0.35}, {"level": "7050", "price": 3837.705, "distance_pips": 0.1}, {"level": "7075", "price": 3837.708, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.7633534775970755}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3801.368, "bottom": 3799.497, "created_at_bar": 273, "lo": 3799.497, "hi": 3801.368}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3831.154, "bottom": 3829.99, "created_at_bar": 267, "lo": 3829.99, "hi": 3831.154}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3829.99, "bottom": 3828.102, "bar_index": 265, "lo": 3828.102, "hi": 3829.99, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 276}, {"price": 3871.459, "bar_index": 281}, {"price": 3870.478, "bar_index": 273}, {"price": 3870.101, "bar_index": 267}, {"price": 3870.097, "bar_index": 265}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 112}, {"price": 3822.667, "bar_index": 155}, {"price": 3822.809, "bar_index": 109}, {"price": 3823.219, "bar_index": 103}, {"price": 3823.404, "bar_index": 143}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 200, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3851.099, "bottom": 3850.469, "created_at_bar": 295, "lo": 3850.469, "hi": 3851.099}], "order_blocks_m5": [{"top": 3853.161, "bottom": 3851.099, "bar_index": 293, "lo": 3851.099, "hi": 3853.161, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3844.792, "bottom": 3832.416, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 284}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 180}, {"price": 3871.459, "bar_index": 207}, {"price": 3871.268, "bar_index": 213}, {"price": 3871.166, "bar_index": 205}, {"price": 3870.48, "bar_index": 202}], "swing_lows_SSL": [{"price": 3839.552, "bar_index": 286}, {"price": 3842.46, "bar_index": 290}, {"price": 3843.774, "bar_index": 282}, {"price": 3844.001, "bar_index": 280}, {"price": 3846.274, "bar_index": 272}]}, "fvgs_m1": [{"type": "Bearish", "top": 3839.865, "bottom": 3838.052, "created_at_bar": 298, "lo": 3838.052, "hi": 3839.865}], "order_blocks_m1": [{"top": 3844.628, "bottom": 3842.766, "bar_index": 294, "lo": 3842.766, "hi": 3844.628, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3832.416, "equilibrium": 3852.0885, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3843.405, "bottom": 3839.865, "bar_index": 296}, {"type": "Bearish", "top": 3844.792, "bottom": 3842.632, "bar_index": 295}, {"type": "Bearish", "top": 3846.181, "bottom": 3842.986, "bar_index": 293}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3837.706, "spread_points": 37, "atr_m5_pips": 484.70336594624223, "ticks_per_min": 611, "pdh_pdl_distance_pips": {"PDH": 3644.000000000233, "PDL": 73709.00000000029}, "eq50_d_distance_pips": 19827.000000000226, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:11:15", "message": "Context+MT5 xong trong 0.24s"}
{"stage": "status_update", "t": "2025-09-30 15:11:16", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:11:16", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:11:55", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:11:55", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:11:55", "message": "Đã lưu thành công file: ctx_20250930_151155.json"}
{"stage": "run-end", "t": "2025-09-30 15:11:55"}
{"stage": "status_update", "t": "2025-09-30 15:11:55", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:11:55", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:12:25", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:12:25", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:12:25", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:12:25", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:12:29", "message": "Upload xong 4 ảnh trong 4.13s"}
{"stage": "run-start", "t": "2025-09-30 15:12:29", "cycle": "2025-09-30 15:12:29", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:11:55) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:10:39) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:09:25) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:12:29Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 570}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:12:29", "broker_time": "2025-09-30T08:12:29Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3837.498, "ask": 3837.535, "last": 0.0, "time": 1759219950}, "tick_stats_5m": {"ticks_per_min": 570, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 377, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.6820552318028296, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.629316969469334, "M1": 2.6396739025955855, "M15": 7.129947560783259, "H1": 12.112335714801436}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3846.758644022722, "ema200": 3856.358924217999}, "M5": {"ema50": 3855.2305184914176, "ema200": 3844.0343213153596}, "M15": {"ema50": 3847.365857585501, "ema200": 3809.942908826167}, "H1": {"ema50": 3811.5906707042373, "ema200": 3750.1743197392357}}}, "vwap": {"day": 3858.966764081032, "asia": null, "london": 3848.714613837014, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 3436.000000000149}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 73501.0000000002}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 19619.000000000142}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 70577.99999999997}], "round_levels": [{"level": "4900", "price": 3837.49, "distance_pips": 0.8}, {"level": "4925", "price": 3837.493, "distance_pips": 0.55}, {"level": "4950", "price": 3837.495, "distance_pips": 0.3}, {"level": "4975", "price": 3837.498, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.7992539772891929}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3801.368, "bottom": 3799.497, "created_at_bar": 273, "lo": 3799.497, "hi": 3801.368}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3831.154, "bottom": 3829.99, "created_at_bar": 267, "lo": 3829.99, "hi": 3831.154}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3829.99, "bottom": 3828.102, "bar_index": 265, "lo": 3828.102, "hi": 3829.99, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 275}, {"price": 3871.459, "bar_index": 280}, {"price": 3870.478, "bar_index": 272}, {"price": 3870.101, "bar_index": 266}, {"price": 3870.097, "bar_index": 264}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 111}, {"price": 3822.667, "bar_index": 154}, {"price": 3822.809, "bar_index": 108}, {"price": 3823.219, "bar_index": 102}, {"price": 3823.404, "bar_index": 142}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 199, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3842.46, "bottom": 3837.523, "created_at_bar": 299, "lo": 3837.523, "hi": 3842.46}], "order_blocks_m5": [{"top": 3847.233, "bottom": 3842.46, "bar_index": 297, "lo": 3842.46, "hi": 3847.233, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3837.523, "bottom": 3835.763, "bar_index": 299}, {"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 283}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 282}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 179}, {"price": 3871.459, "bar_index": 206}, {"price": 3871.268, "bar_index": 212}, {"price": 3871.166, "bar_index": 204}, {"price": 3870.48, "bar_index": 201}], "swing_lows_SSL": [{"price": 3832.416, "bar_index": 298}, {"price": 3839.552, "bar_index": 285}, {"price": 3842.46, "bar_index": 289}, {"price": 3843.774, "bar_index": 281}, {"price": 3844.001, "bar_index": 279}]}, "fvgs_m1": [{"type": "Bearish", "top": 3839.865, "bottom": 3838.052, "created_at_bar": 297, "lo": 3838.052, "hi": 3839.865}], "order_blocks_m1": [{"top": 3844.628, "bottom": 3842.766, "bar_index": 293, "lo": 3842.766, "hi": 3844.628, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3832.416, "equilibrium": 3852.0885, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3837.523, "bottom": 3835.763, "bar_index": 299}, {"type": "Bearish", "top": 3843.405, "bottom": 3839.865, "bar_index": 295}, {"type": "Bearish", "top": 3844.792, "bottom": 3842.632, "bar_index": 294}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3837.498, "spread_points": 37, "atr_m5_pips": 462.9316969469334, "ticks_per_min": 570, "pdh_pdl_distance_pips": {"PDH": 3436.000000000149, "PDL": 73501.0000000002}, "eq50_d_distance_pips": 19619.000000000142, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:12:29", "message": "Context+MT5 xong trong 0.36s"}
{"stage": "status_update", "t": "2025-09-30 15:12:30", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:12:30", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:13:09", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:13:09", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:13:10", "message": "Đã lưu thành công file: ctx_20250930_151309.json"}
{"stage": "run-end", "t": "2025-09-30 15:13:10"}
{"stage": "status_update", "t": "2025-09-30 15:13:10", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:13:10", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:13:40", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:13:40", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:13:40", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:13:40", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:13:44", "message": "Upload xong 4 ảnh trong 4.14s"}
{"stage": "run-start", "t": "2025-09-30 15:13:44", "cycle": "2025-09-30 15:13:44", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:13:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:11:55) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:10:39) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:13:44Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 521}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:13:44", "broker_time": "2025-09-30T08:13:44Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3836.547, "ask": 3836.584, "last": 0.0, "time": 1759220024}, "tick_stats_5m": {"ticks_per_min": 521, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 377, "median_spread": 37.0, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.6732303923388153, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.747888398040753, "M1": 2.6246780077967955, "M15": 7.129947560783259, "H1": 12.112335714801436}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3846.0788966074006, "ema200": 3856.124676268679}, "M5": {"ema50": 3855.2195380992607, "ema200": 3844.0315352457083}, "M15": {"ema50": 3847.354877193344, "ema200": 3809.9401227565154}, "H1": {"ema50": 3811.57969031208, "ema200": 3750.1715336695843}}}, "vwap": {"day": 3858.793428052896, "asia": null, "london": 3848.4061103686313, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 2485.0000000001273}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 72550.00000000017}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 18668.00000000012}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 69626.99999999996}], "round_levels": [{"level": "5400", "price": 3836.54, "distance_pips": 0.7}, {"level": "5425", "price": 3836.543, "distance_pips": 0.45}, {"level": "5450", "price": 3836.545, "distance_pips": 0.2}, {"level": "5475", "price": 3836.548, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.7792938017472247}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3801.368, "bottom": 3799.497, "created_at_bar": 273, "lo": 3799.497, "hi": 3801.368}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3831.154, "bottom": 3829.99, "created_at_bar": 267, "lo": 3829.99, "hi": 3831.154}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3829.99, "bottom": 3828.102, "bar_index": 265, "lo": 3828.102, "hi": 3829.99, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 275}, {"price": 3871.459, "bar_index": 280}, {"price": 3870.478, "bar_index": 272}, {"price": 3870.101, "bar_index": 266}, {"price": 3870.097, "bar_index": 264}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 111}, {"price": 3822.667, "bar_index": 154}, {"price": 3822.809, "bar_index": 108}, {"price": 3823.219, "bar_index": 102}, {"price": 3823.404, "bar_index": 142}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 199, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3842.46, "bottom": 3839.183, "created_at_bar": 299, "lo": 3839.183, "hi": 3842.46}], "order_blocks_m5": [{"top": 3847.233, "bottom": 3842.46, "bar_index": 297, "lo": 3842.46, "hi": 3847.233, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 283}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 282}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 277}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 177}, {"price": 3871.459, "bar_index": 204}, {"price": 3871.268, "bar_index": 210}, {"price": 3871.166, "bar_index": 202}, {"price": 3870.48, "bar_index": 199}], "swing_lows_SSL": [{"price": 3832.416, "bar_index": 296}, {"price": 3839.552, "bar_index": 283}, {"price": 3842.46, "bar_index": 287}, {"price": 3843.774, "bar_index": 279}, {"price": 3844.001, "bar_index": 277}]}, "fvgs_m1": [{"type": "Bearish", "top": 3839.865, "bottom": 3838.052, "created_at_bar": 295, "lo": 3838.052, "hi": 3839.865}], "order_blocks_m1": [{"top": 3836.947, "bottom": 3832.416, "bar_index": 296, "lo": 3832.416, "hi": 3836.947, "type": "bull"}, {"top": 3844.628, "bottom": 3842.766, "bar_index": 291, "lo": 3842.766, "hi": 3844.628, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3832.416, "equilibrium": 3852.0885, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3839.133, "bottom": 3836.438, "bar_index": 299}, {"type": "Bearish", "top": 3843.405, "bottom": 3839.865, "bar_index": 293}, {"type": "Bearish", "top": 3844.792, "bottom": 3842.632, "bar_index": 292}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3836.547, "spread_points": 37, "atr_m5_pips": 474.7888398040753, "ticks_per_min": 521, "pdh_pdl_distance_pips": {"PDH": 2485.0000000001273, "PDL": 72550.00000000017}, "eq50_d_distance_pips": 18668.00000000012, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:13:44", "message": "Context+MT5 xong trong 0.41s"}
{"stage": "status_update", "t": "2025-09-30 15:13:45", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:13:45", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:14:24", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:14:24", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:14:24", "message": "Đã lưu thành công file: ctx_20250930_151424.json"}
{"stage": "run-end", "t": "2025-09-30 15:14:24"}
{"stage": "status_update", "t": "2025-09-30 15:14:24", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:14:24", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:14:54", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:14:54", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:14:54", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:14:54", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:14:58", "message": "Upload xong 4 ảnh trong 4.13s"}
{"stage": "run-start", "t": "2025-09-30 15:14:58", "cycle": "2025-09-30 15:14:58", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:14:24) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:13:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:11:55) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:14:58Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 435}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:14:58", "broker_time": "2025-09-30T08:14:58Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3837.858, "ask": 3837.895, "last": 0.0, "time": 1759220098}, "tick_stats_5m": {"ticks_per_min": 435, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 379, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.6853958650384195, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.817531255183636, "M1": 2.5703072763675685, "M15": 7.129947560783259, "H1": 12.112335714801436}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3845.3864839415864, "ema200": 3855.6826066917265}, "M5": {"ema50": 3855.2591067267113, "ema200": 3844.041575046703}, "M15": {"ema50": 3847.394445820795, "ema200": 3809.9501625575103}, "H1": {"ema50": 3811.6192589395314, "ema200": 3750.181573470579}}}, "vwap": {"day": 3858.6104100630027, "asia": null, "london": 3848.081125754354, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 3796.0000000002765}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 73861.00000000033}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 19979.00000000027}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 70938.0000000001}], "round_levels": [{"level": "8500", "price": 3837.85, "distance_pips": 0.8}, {"level": "8525", "price": 3837.852, "distance_pips": 0.55}, {"level": "8550", "price": 3837.855, "distance_pips": 0.3}, {"level": "8575", "price": 3837.858, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.7680282293964444}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3801.368, "bottom": 3799.497, "created_at_bar": 273, "lo": 3799.497, "hi": 3801.368}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 291}, {"price": 3871.459, "bar_index": 293}, {"price": 3870.101, "bar_index": 288}, {"price": 3867.242, "bar_index": 282}, {"price": 3852.113, "bar_index": 275}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 111}, {"price": 3741.553, "bar_index": 107}, {"price": 3742.965, "bar_index": 126}, {"price": 3744.591, "bar_index": 104}, {"price": 3744.709, "bar_index": 101}]}, "fvgs_m15": [{"type": "Bullish", "top": 3831.154, "bottom": 3829.99, "created_at_bar": 267, "lo": 3829.99, "hi": 3831.154}, {"type": "Bearish", "top": 3866.149, "bottom": 3859.405, "created_at_bar": 295, "lo": 3859.405, "hi": 3866.149}], "order_blocks_m15": [{"top": 3829.99, "bottom": 3828.102, "bar_index": 265, "lo": 3828.102, "hi": 3829.99, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 293, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 294}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 281}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 266}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 275}, {"price": 3871.459, "bar_index": 280}, {"price": 3870.478, "bar_index": 272}, {"price": 3870.101, "bar_index": 266}, {"price": 3870.097, "bar_index": 264}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 111}, {"price": 3822.667, "bar_index": 154}, {"price": 3822.809, "bar_index": 108}, {"price": 3823.219, "bar_index": 102}, {"price": 3823.404, "bar_index": 142}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 199, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3842.46, "bottom": 3839.183, "created_at_bar": 299, "lo": 3839.183, "hi": 3842.46}], "order_blocks_m5": [{"top": 3847.233, "bottom": 3842.46, "bar_index": 297, "lo": 3842.46, "hi": 3847.233, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 283}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 282}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 277}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 175}, {"price": 3871.459, "bar_index": 202}, {"price": 3871.268, "bar_index": 208}, {"price": 3871.166, "bar_index": 200}, {"price": 3870.48, "bar_index": 197}], "swing_lows_SSL": [{"price": 3832.416, "bar_index": 294}, {"price": 3834.749, "bar_index": 297}, {"price": 3839.552, "bar_index": 281}, {"price": 3842.46, "bar_index": 285}, {"price": 3843.774, "bar_index": 277}]}, "fvgs_m1": [{"type": "Bearish", "top": 3839.865, "bottom": 3838.052, "created_at_bar": 293, "lo": 3838.052, "hi": 3839.865}], "order_blocks_m1": [{"top": 3836.947, "bottom": 3832.416, "bar_index": 294, "lo": 3832.416, "hi": 3836.947, "type": "bull"}, {"top": 3839.183, "bottom": 3836.857, "bar_index": 296, "lo": 3836.857, "hi": 3839.183, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3832.416, "equilibrium": 3852.0885, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3838.015, "bottom": 3837.528, "bar_index": 299}, {"type": "Bullish", "top": 3837.908, "bottom": 3835.463, "bar_index": 298}, {"type": "Bearish", "top": 3839.133, "bottom": 3834.749, "bar_index": 297}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3837.858, "spread_points": 37, "atr_m5_pips": 481.75312551836356, "ticks_per_min": 435, "pdh_pdl_distance_pips": {"PDH": 3796.0000000002765, "PDL": 73861.00000000033}, "eq50_d_distance_pips": 19979.00000000027, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:14:58", "message": "Context+MT5 xong trong 0.23s"}
{"stage": "status_update", "t": "2025-09-30 15:15:00", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:15:00", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:15:38", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:15:38", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:15:38", "message": "Đã lưu thành công file: ctx_20250930_151538.json"}
{"stage": "run-end", "t": "2025-09-30 15:15:38"}
{"stage": "status_update", "t": "2025-09-30 15:15:38", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:15:38", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:16:08", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:16:08", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:16:08", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:16:08", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:16:12", "message": "Upload xong 4 ảnh trong 4.04s"}
{"stage": "run-start", "t": "2025-09-30 15:16:13", "cycle": "2025-09-30 15:16:13", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:15:38) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:14:24) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:13:09) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:16:13Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 431}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:16:13", "broker_time": "2025-09-30T08:16:13Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3835.326, "ask": 3835.363, "last": 0.0, "time": 1759220173}, "tick_stats_5m": {"ticks_per_min": 431, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 386, "median_spread": 37, "p90_spread": 77}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.6619000779481097, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.651207594077216, "M1": 2.648270021846789, "M15": 6.7984513063353145, "H1": 12.112335714801436}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3845.0774861235363, "ema200": 3855.639133064918}, "M5": {"ema50": 3854.5629371029386, "ema200": 3844.0317361856305}, "M15": {"ema50": 3847.0080215396397, "ema200": 3810.548912680579}, "H1": {"ema50": 3811.604082468943, "ema200": 3750.1777227243106}}}, "vwap": {"day": 3858.4203071117904, "asia": null, "london": 3847.8008973517285, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 1264.0000000001237}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 71329.00000000017}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 17447.000000000116}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 68405.99999999994}], "round_levels": [{"level": "3200", "price": 3835.32, "distance_pips": 0.6}, {"level": "3225", "price": 3835.323, "distance_pips": 0.35}, {"level": "3250", "price": 3835.325, "distance_pips": 0.1}, {"level": "3275", "price": 3835.328, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.7954923372356563}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3801.368, "bottom": 3799.497, "created_at_bar": 273, "lo": 3799.497, "hi": 3801.368}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 290}, {"price": 3871.459, "bar_index": 292}, {"price": 3870.101, "bar_index": 287}, {"price": 3867.242, "bar_index": 281}, {"price": 3852.113, "bar_index": 274}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 110}, {"price": 3741.553, "bar_index": 106}, {"price": 3742.965, "bar_index": 125}, {"price": 3744.591, "bar_index": 103}, {"price": 3746.591, "bar_index": 132}]}, "fvgs_m15": [{"type": "Bullish", "top": 3831.154, "bottom": 3829.99, "created_at_bar": 266, "lo": 3829.99, "hi": 3831.154}, {"type": "Bearish", "top": 3839.552, "bottom": 3838.064, "created_at_bar": 299, "lo": 3838.064, "hi": 3839.552}], "order_blocks_m15": [{"top": 3829.99, "bottom": 3828.102, "bar_index": 264, "lo": 3828.102, "hi": 3829.99, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 292, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 293}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 280}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 265}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 274}, {"price": 3871.459, "bar_index": 279}, {"price": 3870.478, "bar_index": 271}, {"price": 3870.101, "bar_index": 265}, {"price": 3870.097, "bar_index": 263}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 110}, {"price": 3822.667, "bar_index": 153}, {"price": 3822.809, "bar_index": 107}, {"price": 3823.219, "bar_index": 101}, {"price": 3823.404, "bar_index": 141}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 198, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3842.46, "bottom": 3839.183, "created_at_bar": 298, "lo": 3839.183, "hi": 3842.46}], "order_blocks_m5": [{"top": 3847.233, "bottom": 3842.46, "bar_index": 296, "lo": 3842.46, "hi": 3847.233, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 282}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 281}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 276}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 174}, {"price": 3871.459, "bar_index": 201}, {"price": 3871.268, "bar_index": 207}, {"price": 3871.166, "bar_index": 199}, {"price": 3870.48, "bar_index": 196}], "swing_lows_SSL": [{"price": 3832.416, "bar_index": 293}, {"price": 3834.749, "bar_index": 296}, {"price": 3839.552, "bar_index": 280}, {"price": 3842.46, "bar_index": 284}, {"price": 3843.774, "bar_index": 276}]}, "fvgs_m1": [{"type": "Bearish", "top": 3839.865, "bottom": 3838.052, "created_at_bar": 292, "lo": 3838.052, "hi": 3839.865}], "order_blocks_m1": [{"top": 3836.947, "bottom": 3832.416, "bar_index": 293, "lo": 3832.416, "hi": 3836.947, "type": "bull"}, {"top": 3844.628, "bottom": 3842.766, "bar_index": 288, "lo": 3842.766, "hi": 3844.628, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3832.416, "equilibrium": 3852.0885, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3839.133, "bottom": 3834.749, "bar_index": 296}, {"type": "Bearish", "top": 3843.405, "bottom": 3839.865, "bar_index": 290}, {"type": "Bearish", "top": 3844.792, "bottom": 3842.632, "bar_index": 289}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3835.326, "spread_points": 37, "atr_m5_pips": 465.1207594077216, "ticks_per_min": 431, "pdh_pdl_distance_pips": {"PDH": 1264.0000000001237, "PDL": 71329.00000000017}, "eq50_d_distance_pips": 17447.000000000116, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:16:13", "message": "Context+MT5 xong trong 0.22s"}
{"stage": "status_update", "t": "2025-09-30 15:16:14", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:16:14", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:16:53", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:16:53", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:16:53", "message": "Đã lưu thành công file: ctx_20250930_151653.json"}
{"stage": "run-end", "t": "2025-09-30 15:16:53"}
{"stage": "status_update", "t": "2025-09-30 15:16:53", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:16:53", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:17:23", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:17:23", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:17:23", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:17:23", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:17:28", "message": "Upload xong 4 ảnh trong 4.47s"}
{"stage": "run-start", "t": "2025-09-30 15:17:28", "cycle": "2025-09-30 15:17:28", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:16:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:15:38) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:14:24) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:17:28Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 434}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:17:28", "broker_time": "2025-09-30T08:17:28Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3837.773, "ask": 3837.81, "last": 0.0, "time": 1759220248}, "tick_stats_5m": {"ticks_per_min": 434, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 383, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.6846071044133496, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.710064736934331, "M1": 2.5583399678110323, "M15": 6.85730844919243, "H1": 12.112335714801436}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3844.486583054311, "ema200": 3855.2660424283767}, "M5": {"ema50": 3854.5699174950955, "ema200": 3844.0335073299093}, "M15": {"ema50": 3847.0137078141493, "ema200": 3810.550355466649}, "H1": {"ema50": 3811.6097687434526, "ema200": 3750.1791655103802}}}, "vwap": {"day": 3858.2297807904088, "asia": null, "london": 3847.5192150840494, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 3711.00000000024}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 73776.00000000029}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 19894.000000000233}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 70853.00000000006}], "round_levels": [{"level": "7700", "price": 3837.77, "distance_pips": 0.3}, {"level": "7725", "price": 3837.773, "distance_pips": 0.05}, {"level": "7750", "price": 3837.775, "distance_pips": 0.2}, {"level": "7775", "price": 3837.778, "distance_pips": 0.45}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.7855518356184973}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3801.368, "bottom": 3799.497, "created_at_bar": 273, "lo": 3799.497, "hi": 3801.368}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 290}, {"price": 3871.459, "bar_index": 292}, {"price": 3870.101, "bar_index": 287}, {"price": 3867.242, "bar_index": 281}, {"price": 3852.113, "bar_index": 274}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 110}, {"price": 3741.553, "bar_index": 106}, {"price": 3742.965, "bar_index": 125}, {"price": 3744.591, "bar_index": 103}, {"price": 3746.591, "bar_index": 132}]}, "fvgs_m15": [{"type": "Bullish", "top": 3831.154, "bottom": 3829.99, "created_at_bar": 266, "lo": 3829.99, "hi": 3831.154}, {"type": "Bearish", "top": 3839.552, "bottom": 3838.365, "created_at_bar": 299, "lo": 3838.365, "hi": 3839.552}], "order_blocks_m15": [{"top": 3829.99, "bottom": 3828.102, "bar_index": 264, "lo": 3828.102, "hi": 3829.99, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 292, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 293}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 280}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 265}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 274}, {"price": 3871.459, "bar_index": 279}, {"price": 3870.478, "bar_index": 271}, {"price": 3870.101, "bar_index": 265}, {"price": 3870.097, "bar_index": 263}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 110}, {"price": 3822.667, "bar_index": 153}, {"price": 3822.809, "bar_index": 107}, {"price": 3823.219, "bar_index": 101}, {"price": 3823.404, "bar_index": 141}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 198, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3842.46, "bottom": 3839.183, "created_at_bar": 298, "lo": 3839.183, "hi": 3842.46}], "order_blocks_m5": [{"top": 3847.233, "bottom": 3842.46, "bar_index": 296, "lo": 3842.46, "hi": 3847.233, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 282}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 281}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 276}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 172}, {"price": 3871.459, "bar_index": 199}, {"price": 3871.268, "bar_index": 205}, {"price": 3871.166, "bar_index": 197}, {"price": 3870.48, "bar_index": 194}], "swing_lows_SSL": [{"price": 3832.416, "bar_index": 291}, {"price": 3834.749, "bar_index": 294}, {"price": 3835.052, "bar_index": 298}, {"price": 3839.552, "bar_index": 278}, {"price": 3842.46, "bar_index": 282}]}, "fvgs_m1": [{"type": "Bearish", "top": 3839.865, "bottom": 3838.052, "created_at_bar": 290, "lo": 3838.052, "hi": 3839.865}], "order_blocks_m1": [{"top": 3836.947, "bottom": 3832.416, "bar_index": 291, "lo": 3832.416, "hi": 3836.947, "type": "bull"}, {"top": 3844.628, "bottom": 3842.766, "bar_index": 286, "lo": 3842.766, "hi": 3844.628, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3832.416, "equilibrium": 3852.0885, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3839.133, "bottom": 3834.749, "bar_index": 294}, {"type": "Bearish", "top": 3843.405, "bottom": 3839.865, "bar_index": 288}, {"type": "Bearish", "top": 3844.792, "bottom": 3842.632, "bar_index": 287}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3837.773, "spread_points": 37, "atr_m5_pips": 471.0064736934331, "ticks_per_min": 434, "pdh_pdl_distance_pips": {"PDH": 3711.00000000024, "PDL": 73776.00000000029}, "eq50_d_distance_pips": 19894.000000000233, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:17:28", "message": "Context+MT5 xong trong 0.23s"}
{"stage": "status_update", "t": "2025-09-30 15:17:29", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:17:29", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:18:07", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 15:18:07", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 15:18:07", "message": "Đã lưu thành công file: ctx_20250930_151807.json"}
{"stage": "run-end", "t": "2025-09-30 15:18:07"}
{"stage": "status_update", "t": "2025-09-30 15:18:07", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 15:18:07", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 15:18:38", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 15:18:38", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 15:18:38", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 15:18:38", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 15:18:42", "message": "Upload xong 4 ảnh trong 3.98s"}
{"stage": "run-start", "t": "2025-09-30 15:18:42", "cycle": "2025-09-30 15:18:42", "session": "london", "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:18:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:16:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:15:38) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T08:18:42Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 386}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 15:18:42", "broker_time": "2025-09-30T08:18:42Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3837.087, "ask": 3837.124, "last": 0.0, "time": 1759220322}, "tick_stats_5m": {"ticks_per_min": 386, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 386, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.6782413421921983, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.726707594077201, "M1": 2.561570786442368, "M15": 6.873951306335299, "H1": 12.112335714801436}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3844.171961093038, "ema200": 3855.0717958987834}, "M5": {"ema50": 3854.536584161762, "ema200": 3844.0250496184663}, "M15": {"ema50": 3846.980374480816, "ema200": 3810.541897755206}, "H1": {"ema50": 3811.5764354101193, "ema200": 3750.170707798937}}}, "vwap": {"day": 3858.1077758503516, "asia": null, "london": 3847.355911320027, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "london", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "BELOW", "distance_pips": 3025.000000000091}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 73090.00000000015}, {"name": "EQ50_D", "price": 3817.879, "relation": "BELOW", "distance_pips": 19208.000000000084}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 70166.99999999991}], "round_levels": [{"level": "800", "price": 3837.08, "distance_pips": 0.7}, {"level": "825", "price": 3837.082, "distance_pips": 0.45}, {"level": "850", "price": 3837.085, "distance_pips": 0.2}, {"level": "875", "price": 3837.088, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.7827858877111422}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 297}, {"price": 3867.242, "bar_index": 294}, {"price": 3834.062, "bar_index": 288}, {"price": 3833.647, "bar_index": 284}, {"price": 3831.428, "bar_index": 279}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 120}, {"price": 3632.264, "bar_index": 131}, {"price": 3633.892, "bar_index": 113}, {"price": 3640.568, "bar_index": 125}, {"price": 3643.331, "bar_index": 136}]}, "fvgs_h1": [{"type": "Bullish", "top": 3801.368, "bottom": 3799.497, "created_at_bar": 273, "lo": 3799.497, "hi": 3801.368}, {"type": "Bearish", "top": 3854.92, "bottom": 3847.233, "created_at_bar": 299, "lo": 3847.233, "hi": 3854.92}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 269, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 296, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 297}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 294}, {"type": "Bullish", "top": 3850.722, "bottom": 3838.031, "bar_index": 292}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 290}, {"price": 3871.459, "bar_index": 292}, {"price": 3870.101, "bar_index": 287}, {"price": 3867.242, "bar_index": 281}, {"price": 3852.113, "bar_index": 274}], "swing_lows_SSL": [{"price": 3739.268, "bar_index": 110}, {"price": 3741.553, "bar_index": 106}, {"price": 3742.965, "bar_index": 125}, {"price": 3744.591, "bar_index": 103}, {"price": 3746.591, "bar_index": 132}]}, "fvgs_m15": [{"type": "Bullish", "top": 3831.154, "bottom": 3829.99, "created_at_bar": 266, "lo": 3829.99, "hi": 3831.154}, {"type": "Bearish", "top": 3839.552, "bottom": 3838.598, "created_at_bar": 299, "lo": 3838.598, "hi": 3839.552}], "order_blocks_m15": [{"top": 3829.99, "bottom": 3828.102, "bar_index": 264, "lo": 3828.102, "hi": 3829.99, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 292, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3739.268, "equilibrium": 3805.5145, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 293}, {"type": "Bullish", "top": 3863.963, "bottom": 3857.807, "bar_index": 280}, {"type": "Bullish", "top": 3833.437, "bottom": 3829.118, "bar_index": 265}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 274}, {"price": 3871.459, "bar_index": 279}, {"price": 3870.478, "bar_index": 271}, {"price": 3870.101, "bar_index": 265}, {"price": 3870.097, "bar_index": 263}], "swing_lows_SSL": [{"price": 3820.97, "bar_index": 110}, {"price": 3822.667, "bar_index": 153}, {"price": 3822.809, "bar_index": 107}, {"price": 3823.219, "bar_index": 101}, {"price": 3823.404, "bar_index": 141}]}, "fvgs_m5": [{"type": "Bullish", "top": 3830.177, "bottom": 3829.359, "created_at_bar": 198, "lo": 3829.359, "hi": 3830.177}, {"type": "Bearish", "top": 3842.46, "bottom": 3839.183, "created_at_bar": 298, "lo": 3839.183, "hi": 3842.46}], "order_blocks_m5": [{"top": 3847.233, "bottom": 3842.46, "bar_index": 296, "lo": 3842.46, "hi": 3847.233, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3820.97, "equilibrium": 3846.3655, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3865.035, "bottom": 3856.504, "bar_index": 282}, {"type": "Bearish", "top": 3869.909, "bottom": 3863.677, "bar_index": 281}, {"type": "Bullish", "top": 3866.273, "bottom": 3862.455, "bar_index": 276}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 171}, {"price": 3871.459, "bar_index": 198}, {"price": 3871.268, "bar_index": 204}, {"price": 3871.166, "bar_index": 196}, {"price": 3870.48, "bar_index": 193}], "swing_lows_SSL": [{"price": 3832.416, "bar_index": 290}, {"price": 3834.749, "bar_index": 293}, {"price": 3835.052, "bar_index": 297}, {"price": 3839.552, "bar_index": 277}, {"price": 3842.46, "bar_index": 281}]}, "fvgs_m1": [{"type": "Bearish", "top": 3839.865, "bottom": 3838.052, "created_at_bar": 289, "lo": 3838.052, "hi": 3839.865}], "order_blocks_m1": [{"top": 3836.947, "bottom": 3832.416, "bar_index": 290, "lo": 3832.416, "hi": 3836.947, "type": "bull"}, {"top": 3844.628, "bottom": 3842.766, "bar_index": 285, "lo": 3842.766, "hi": 3844.628, "type": "bear"}], "premium_discount_m1": {"range_high": 3871.761, "range_low": 3832.416, "equilibrium": 3852.0885, "status": "Discount"}, "liquidity_voids_m1": [{"type": "Bearish", "top": 3839.133, "bottom": 3834.749, "bar_index": 293}, {"type": "Bearish", "top": 3843.405, "bottom": 3839.865, "bar_index": 287}, {"type": "Bearish", "top": 3844.792, "bottom": 3842.632, "bar_index": 286}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3837.087, "spread_points": 37, "atr_m5_pips": 472.6707594077201, "ticks_per_min": 386, "pdh_pdl_distance_pips": {"PDH": 3025.000000000091, "PDL": 73090.00000000015}, "eq50_d_distance_pips": 19208.000000000084, "session_active": "london", "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 15:18:42", "message": "Context+MT5 xong trong 0.25s"}
{"stage": "status_update", "t": "2025-09-30 15:18:43", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 15:18:43", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 15:18:59", "message": "Xem: report_20250930_151807.md"}
{"stage": "status_update", "t": "2025-09-30 15:19:04", "message": "Xem JSON: ctx_20250930_151807.json"}
{"stage": "status_update", "t": "2025-09-30 19:02:32", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:02:36", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:02:54", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:03:20", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:03:33", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:03:34", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:03:35", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:03:37", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 19:03:37", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 19:03:37", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 19:03:37", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:03:42", "message": "Upload xong 4 ảnh trong 4.95s"}
{"stage": "run-start", "t": "2025-09-30 19:03:42", "cycle": "2025-09-30 19:03:42", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 15:18:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:16:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:15:38) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T12:03:42Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 187}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 19:03:42", "broker_time": "2025-09-30T12:03:42Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3813.519, "ask": 3813.556, "last": 0.0, "time": 1759233822}, "tick_stats_5m": {"ticks_per_min": 187, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 215, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.4595412197023113, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.218360291553547, "M1": 1.7895643479442909, "M15": 7.877820693311645, "H1": 14.139496246854064}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3813.43627877749, "ema200": 3814.7317881334407}, "M5": {"ema50": 3817.381730365456, "ema200": 3831.183013693581}, "M15": {"ema50": 3829.3945092656613, "ema200": 3810.2982836911283}, "H1": {"ema50": 3810.6846357002555, "ema200": 3752.46110463136}}}, "vwap": {"day": 3818.825459002238, "asia": null, "london": 3822.215683164948, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 27, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "ABOVE", "distance_pips": 20543.00000000012}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 49521.999999999935}, {"name": "EQ50_D", "price": 3817.879, "relation": "ABOVE", "distance_pips": 4360.000000000127}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 46598.9999999997}], "round_levels": [{"level": "5100", "price": 3813.51, "distance_pips": 0.9}, {"level": "5125", "price": 3813.513, "distance_pips": 0.65}, {"level": "5150", "price": 3813.515, "distance_pips": 0.4}, {"level": "5175", "price": 3813.518, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8771180611183756}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3867.242, "bar_index": 290}, {"price": 3834.062, "bar_index": 284}, {"price": 3833.647, "bar_index": 280}, {"price": 3831.428, "bar_index": 275}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 116}, {"price": 3632.264, "bar_index": 127}, {"price": 3633.892, "bar_index": 109}, {"price": 3640.568, "bar_index": 121}, {"price": 3643.331, "bar_index": 132}]}, "fvgs_h1": [{"type": "Bullish", "top": 3792.206, "bottom": 3788.842, "created_at_bar": 267, "lo": 3788.842, "hi": 3792.206}, {"type": "Bearish", "top": 3839.552, "bottom": 3821.605, "created_at_bar": 296, "lo": 3821.605, "hi": 3839.552}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 265, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 292, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3814.639, "bottom": 3798.264, "bar_index": 297}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 293}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 290}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 275}, {"price": 3871.459, "bar_index": 277}, {"price": 3870.101, "bar_index": 272}, {"price": 3867.242, "bar_index": 266}, {"price": 3852.113, "bar_index": 259}], "swing_lows_SSL": [{"price": 3742.965, "bar_index": 110}, {"price": 3746.591, "bar_index": 117}, {"price": 3747.287, "bar_index": 105}, {"price": 3748.361, "bar_index": 115}, {"price": 3752.285, "bar_index": 121}]}, "fvgs_m15": [{"type": "Bullish", "top": 3812.929, "bottom": 3810.254, "created_at_bar": 298, "lo": 3810.254, "hi": 3812.929}, {"type": "Bearish", "top": 3832.416, "bottom": 3823.837, "created_at_bar": 285, "lo": 3823.837, "hi": 3832.416}], "order_blocks_m15": [{"top": 3801.831, "bottom": 3793.174, "bar_index": 290, "lo": 3793.174, "hi": 3801.831, "type": "bull"}, {"top": 3822.175, "bottom": 3814.754, "bar_index": 286, "lo": 3814.754, "hi": 3822.175, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3742.965, "equilibrium": 3807.3630000000003, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3810.437, "bottom": 3803.232, "bar_index": 293}, {"type": "Bearish", "top": 3838.598, "bottom": 3820.009, "bar_index": 284}, {"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 278}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 229}, {"price": 3871.459, "bar_index": 234}, {"price": 3870.478, "bar_index": 226}, {"price": 3870.101, "bar_index": 220}, {"price": 3870.097, "bar_index": 218}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 272}, {"price": 3797.291, "bar_index": 265}, {"price": 3798.175, "bar_index": 268}, {"price": 3799.993, "bar_index": 270}, {"price": 3802.675, "bar_index": 277}]}, "fvgs_m5": [{"type": "Bullish", "top": 3803.109, "bottom": 3801.024, "created_at_bar": 276, "lo": 3801.024, "hi": 3803.109}, {"type": "Bearish", "top": 3823.612, "bottom": 3819.201, "created_at_bar": 258, "lo": 3819.201, "hi": 3823.612}], "order_blocks_m5": [{"top": 3808.255, "bottom": 3804.375, "bar_index": 290, "lo": 3804.375, "hi": 3808.255, "type": "bull"}, {"top": 3821.605, "bottom": 3815.947, "bar_index": 263, "lo": 3815.947, "hi": 3821.605, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3793.174, "equilibrium": 3832.4674999999997, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3816.334, "bottom": 3808.172, "bar_index": 293}, {"type": "Bearish", "top": 3814.336, "bottom": 3812.034, "bar_index": 286}, {"type": "Bullish", "top": 3808.473, "bottom": 3803.232, "bar_index": 281}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3822.175, "bar_index": 104}, {"price": 3821.605, "bar_index": 116}, {"price": 3821.245, "bar_index": 120}, {"price": 3821.039, "bar_index": 108}, {"price": 3820.751, "bar_index": 112}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 163}, {"price": 3795.895, "bar_index": 167}, {"price": 3796.362, "bar_index": 169}, {"price": 3797.291, "bar_index": 130}, {"price": 3798.107, "bar_index": 175}]}, "fvgs_m1": [{"type": "Bullish", "top": 3812.377, "bottom": 3811.975, "created_at_bar": 269, "lo": 3811.975, "hi": 3812.377}, {"type": "Bearish", "top": 3823.612, "bottom": 3820.925, "created_at_bar": 87, "lo": 3820.925, "hi": 3823.612}], "order_blocks_m1": [{"top": 3804.358, "bottom": 3803.232, "bar_index": 206, "lo": 3803.232, "hi": 3804.358, "type": "bull"}], "premium_discount_m1": {"range_high": 3822.175, "range_low": 3793.174, "equilibrium": 3807.6745, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3815.787, "bottom": 3813.605, "bar_index": 291}, {"type": "Bullish", "top": 3816.206, "bottom": 3814.514, "bar_index": 274}, {"type": "Bullish", "top": 3816.334, "bottom": 3813.711, "bar_index": 270}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3813.519, "spread_points": 37, "atr_m5_pips": 421.8360291553547, "ticks_per_min": 187, "pdh_pdl_distance_pips": {"PDH": 20543.00000000012, "PDL": 49521.999999999935}, "eq50_d_distance_pips": 4360.000000000127, "session_active": null, "mins_to_next_killzone": 27}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 19:03:42", "message": "Context+MT5 xong trong 0.57s"}
{"stage": "status_update", "t": "2025-09-30 19:03:43", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 19:03:43", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 19:04:22", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 19:04:22", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 19:04:22", "message": "Đã lưu thành công file: ctx_20250930_190422.json"}
{"stage": "run-end", "t": "2025-09-30 19:04:22"}
{"stage": "status_update", "t": "2025-09-30 19:04:22", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 19:04:22", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 19:04:52", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 19:04:52", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 19:04:52", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 19:04:52", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:04:57", "message": "Upload xong 4 ảnh trong 4.32s"}
{"stage": "run-start", "t": "2025-09-30 19:04:57", "cycle": "2025-09-30 19:04:57", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 19:04:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 15:18:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:16:53) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T12:04:57Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 219}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 19:04:57", "broker_time": "2025-09-30T12:04:57Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3812.815, "ask": 3812.852, "last": 0.0, "time": 1759233898}, "tick_stats_5m": {"ticks_per_min": 219, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 214, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.45300842581938455, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.218360291553547, "M1": 1.8143097516425069, "M15": 7.877820693311645, "H1": 14.139496246854064}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3813.491660172426, "ema200": 3814.81893310803}, "M5": {"ema50": 3817.3879656595736, "ema200": 3831.1845957831333}, "M15": {"ema50": 3829.400744559779, "ema200": 3810.2998657806806}, "H1": {"ema50": 3810.690870994373, "ema200": 3752.462686720912}}}, "vwap": {"day": 3818.680897249218, "asia": null, "london": 3822.0510046620348, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 26, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "ABOVE", "distance_pips": 21246.999999999844}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 48818.00000000021}, {"name": "EQ50_D", "price": 3817.879, "relation": "ABOVE", "distance_pips": 5063.999999999851}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 45894.99999999998}], "round_levels": [{"level": "8100", "price": 3812.81, "distance_pips": 0.5}, {"level": "8125", "price": 3812.812, "distance_pips": 0.25}, {"level": "8150", "price": 3812.815, "distance_pips": 0.0}, {"level": "8175", "price": 3812.818, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8771180611075955}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3867.242, "bar_index": 290}, {"price": 3834.062, "bar_index": 284}, {"price": 3833.647, "bar_index": 280}, {"price": 3831.428, "bar_index": 275}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 116}, {"price": 3632.264, "bar_index": 127}, {"price": 3633.892, "bar_index": 109}, {"price": 3640.568, "bar_index": 121}, {"price": 3643.331, "bar_index": 132}]}, "fvgs_h1": [{"type": "Bullish", "top": 3792.206, "bottom": 3788.842, "created_at_bar": 267, "lo": 3788.842, "hi": 3792.206}, {"type": "Bearish", "top": 3839.552, "bottom": 3821.605, "created_at_bar": 296, "lo": 3821.605, "hi": 3839.552}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 265, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 292, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3814.639, "bottom": 3798.264, "bar_index": 297}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 293}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 290}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 275}, {"price": 3871.459, "bar_index": 277}, {"price": 3870.101, "bar_index": 272}, {"price": 3867.242, "bar_index": 266}, {"price": 3852.113, "bar_index": 259}], "swing_lows_SSL": [{"price": 3742.965, "bar_index": 110}, {"price": 3746.591, "bar_index": 117}, {"price": 3747.287, "bar_index": 105}, {"price": 3748.361, "bar_index": 115}, {"price": 3752.285, "bar_index": 121}]}, "fvgs_m15": [{"type": "Bullish", "top": 3803.038, "bottom": 3801.831, "created_at_bar": 292, "lo": 3801.831, "hi": 3803.038}, {"type": "Bearish", "top": 3832.416, "bottom": 3823.837, "created_at_bar": 285, "lo": 3823.837, "hi": 3832.416}], "order_blocks_m15": [{"top": 3801.831, "bottom": 3793.174, "bar_index": 290, "lo": 3793.174, "hi": 3801.831, "type": "bull"}, {"top": 3822.175, "bottom": 3814.754, "bar_index": 286, "lo": 3814.754, "hi": 3822.175, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3742.965, "equilibrium": 3807.3630000000003, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3810.437, "bottom": 3803.232, "bar_index": 293}, {"type": "Bearish", "top": 3838.598, "bottom": 3820.009, "bar_index": 284}, {"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 278}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 229}, {"price": 3871.459, "bar_index": 234}, {"price": 3870.478, "bar_index": 226}, {"price": 3870.101, "bar_index": 220}, {"price": 3870.097, "bar_index": 218}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 272}, {"price": 3797.291, "bar_index": 265}, {"price": 3798.175, "bar_index": 268}, {"price": 3799.993, "bar_index": 270}, {"price": 3802.675, "bar_index": 277}]}, "fvgs_m5": [{"type": "Bullish", "top": 3803.109, "bottom": 3801.024, "created_at_bar": 276, "lo": 3801.024, "hi": 3803.109}, {"type": "Bearish", "top": 3823.612, "bottom": 3819.201, "created_at_bar": 258, "lo": 3819.201, "hi": 3823.612}], "order_blocks_m5": [{"top": 3808.255, "bottom": 3804.375, "bar_index": 290, "lo": 3804.375, "hi": 3808.255, "type": "bull"}, {"top": 3821.605, "bottom": 3815.947, "bar_index": 263, "lo": 3815.947, "hi": 3821.605, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3793.174, "equilibrium": 3832.4674999999997, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3816.334, "bottom": 3808.172, "bar_index": 293}, {"type": "Bearish", "top": 3814.336, "bottom": 3812.034, "bar_index": 286}, {"type": "Bullish", "top": 3808.473, "bottom": 3803.232, "bar_index": 281}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3822.175, "bar_index": 103}, {"price": 3821.605, "bar_index": 115}, {"price": 3821.245, "bar_index": 119}, {"price": 3821.039, "bar_index": 107}, {"price": 3820.751, "bar_index": 111}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 162}, {"price": 3795.895, "bar_index": 166}, {"price": 3796.362, "bar_index": 168}, {"price": 3797.291, "bar_index": 129}, {"price": 3798.107, "bar_index": 174}]}, "fvgs_m1": [{"type": "Bullish", "top": 3812.377, "bottom": 3811.975, "created_at_bar": 268, "lo": 3811.975, "hi": 3812.377}, {"type": "Bearish", "top": 3823.612, "bottom": 3820.925, "created_at_bar": 86, "lo": 3820.925, "hi": 3823.612}], "order_blocks_m1": [{"top": 3804.358, "bottom": 3803.232, "bar_index": 205, "lo": 3803.232, "hi": 3804.358, "type": "bull"}], "premium_discount_m1": {"range_high": 3822.175, "range_low": 3793.174, "equilibrium": 3807.6745, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3815.787, "bottom": 3813.605, "bar_index": 290}, {"type": "Bullish", "top": 3816.206, "bottom": 3814.514, "bar_index": 273}, {"type": "Bullish", "top": 3816.334, "bottom": 3813.711, "bar_index": 269}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3812.815, "spread_points": 37, "atr_m5_pips": 421.8360291553547, "ticks_per_min": 219, "pdh_pdl_distance_pips": {"PDH": 21246.999999999844, "PDL": 48818.00000000021}, "eq50_d_distance_pips": 5063.999999999851, "session_active": null, "mins_to_next_killzone": 26}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 19:04:57", "message": "Context+MT5 xong trong 0.37s"}
{"stage": "status_update", "t": "2025-09-30 19:04:58", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 19:04:58", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 19:05:37", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 19:05:37", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 19:05:37", "message": "Đã lưu thành công file: ctx_20250930_190537.json"}
{"stage": "run-end", "t": "2025-09-30 19:05:37"}
{"stage": "status_update", "t": "2025-09-30 19:05:37", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 19:05:37", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 19:06:07", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 19:06:07", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 19:06:07", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 19:06:07", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:06:12", "message": "Upload xong 4 ảnh trong 5.05s"}
{"stage": "run-start", "t": "2025-09-30 19:06:12", "cycle": "2025-09-30 19:06:12", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 19:05:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 19:04:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:18:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T12:06:12Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 284}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 19:06:12", "broker_time": "2025-09-30T12:06:12Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3813.049, "ask": 3813.086, "last": 0.0, "time": 1759233973}, "tick_stats_5m": {"ticks_per_min": 284, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 220, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.4551798374225166, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 4.145691699249198, "M1": 1.8276285977352449, "M15": 8.001820693311636, "H1": 14.263496246854055}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3813.3201864465605, "ema200": 3814.679054009344}, "M5": {"ema50": 3817.1409513315907, "ema200": 3831.0850950421154}, "M15": {"ema50": 3829.3134112264456, "ema200": 3810.2777065767004}, "H1": {"ema50": 3810.60353766104, "ema200": 3752.440527516932}}}, "vwap": {"day": 3818.3793352258685, "asia": null, "london": 3821.7039890399915, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 24, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "ABOVE", "distance_pips": 21012.99999999992}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 49052.00000000013}, {"name": "EQ50_D", "price": 3817.879, "relation": "ABOVE", "distance_pips": 4829.999999999927}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 46128.999999999905}], "round_levels": [{"level": "400", "price": 3813.04, "distance_pips": 0.9}, {"level": "425", "price": 3813.043, "distance_pips": 0.65}, {"level": "450", "price": 3813.045, "distance_pips": 0.4}, {"level": "475", "price": 3813.048, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8924928017804132}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3867.242, "bar_index": 290}, {"price": 3834.062, "bar_index": 284}, {"price": 3833.647, "bar_index": 280}, {"price": 3831.428, "bar_index": 275}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 116}, {"price": 3632.264, "bar_index": 127}, {"price": 3633.892, "bar_index": 109}, {"price": 3640.568, "bar_index": 121}, {"price": 3643.331, "bar_index": 132}]}, "fvgs_h1": [{"type": "Bullish", "top": 3792.206, "bottom": 3788.842, "created_at_bar": 267, "lo": 3788.842, "hi": 3792.206}, {"type": "Bearish", "top": 3839.552, "bottom": 3821.605, "created_at_bar": 296, "lo": 3821.605, "hi": 3839.552}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 265, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 292, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3814.639, "bottom": 3798.264, "bar_index": 297}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 293}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 290}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 275}, {"price": 3871.459, "bar_index": 277}, {"price": 3870.101, "bar_index": 272}, {"price": 3867.242, "bar_index": 266}, {"price": 3852.113, "bar_index": 259}], "swing_lows_SSL": [{"price": 3742.965, "bar_index": 110}, {"price": 3746.591, "bar_index": 117}, {"price": 3747.287, "bar_index": 105}, {"price": 3748.361, "bar_index": 115}, {"price": 3752.285, "bar_index": 121}]}, "fvgs_m15": [{"type": "Bullish", "top": 3812.929, "bottom": 3810.254, "created_at_bar": 298, "lo": 3810.254, "hi": 3812.929}, {"type": "Bearish", "top": 3832.416, "bottom": 3823.837, "created_at_bar": 285, "lo": 3823.837, "hi": 3832.416}], "order_blocks_m15": [{"top": 3801.831, "bottom": 3793.174, "bar_index": 290, "lo": 3793.174, "hi": 3801.831, "type": "bull"}, {"top": 3822.175, "bottom": 3814.754, "bar_index": 286, "lo": 3814.754, "hi": 3822.175, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3742.965, "equilibrium": 3807.3630000000003, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3810.437, "bottom": 3803.232, "bar_index": 293}, {"type": "Bearish", "top": 3838.598, "bottom": 3820.009, "bar_index": 284}, {"type": "Bearish", "top": 3869.909, "bottom": 3854.92, "bar_index": 278}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 228}, {"price": 3871.459, "bar_index": 233}, {"price": 3870.478, "bar_index": 225}, {"price": 3870.101, "bar_index": 219}, {"price": 3870.097, "bar_index": 217}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 271}, {"price": 3797.291, "bar_index": 264}, {"price": 3798.175, "bar_index": 267}, {"price": 3799.993, "bar_index": 269}, {"price": 3802.675, "bar_index": 276}]}, "fvgs_m5": [{"type": "Bullish", "top": 3803.109, "bottom": 3801.024, "created_at_bar": 275, "lo": 3801.024, "hi": 3803.109}, {"type": "Bearish", "top": 3823.612, "bottom": 3819.201, "created_at_bar": 257, "lo": 3819.201, "hi": 3823.612}], "order_blocks_m5": [{"top": 3808.255, "bottom": 3804.375, "bar_index": 289, "lo": 3804.375, "hi": 3808.255, "type": "bull"}, {"top": 3817.894, "bottom": 3813.605, "bar_index": 297, "lo": 3813.605, "hi": 3817.894, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3793.174, "equilibrium": 3832.4674999999997, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3816.334, "bottom": 3808.172, "bar_index": 292}, {"type": "Bearish", "top": 3814.336, "bottom": 3812.034, "bar_index": 285}, {"type": "Bullish", "top": 3808.473, "bottom": 3803.232, "bar_index": 280}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3822.175, "bar_index": 101}, {"price": 3821.605, "bar_index": 113}, {"price": 3821.245, "bar_index": 117}, {"price": 3821.039, "bar_index": 105}, {"price": 3820.751, "bar_index": 109}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 160}, {"price": 3795.895, "bar_index": 164}, {"price": 3796.362, "bar_index": 166}, {"price": 3797.291, "bar_index": 127}, {"price": 3798.107, "bar_index": 172}]}, "fvgs_m1": [{"type": "Bullish", "top": 3811.353, "bottom": 3810.093, "created_at_bar": 265, "lo": 3810.093, "hi": 3811.353}, {"type": "Bearish", "top": 3823.612, "bottom": 3820.925, "created_at_bar": 84, "lo": 3820.925, "hi": 3823.612}], "order_blocks_m1": [{"top": 3804.358, "bottom": 3803.232, "bar_index": 203, "lo": 3803.232, "hi": 3804.358, "type": "bull"}], "premium_discount_m1": {"range_high": 3822.175, "range_low": 3793.174, "equilibrium": 3807.6745, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3815.787, "bottom": 3813.605, "bar_index": 288}, {"type": "Bullish", "top": 3816.206, "bottom": 3814.514, "bar_index": 271}, {"type": "Bullish", "top": 3816.334, "bottom": 3813.711, "bar_index": 267}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3813.049, "spread_points": 37, "atr_m5_pips": 414.56916992491983, "ticks_per_min": 284, "pdh_pdl_distance_pips": {"PDH": 21012.99999999992, "PDL": 49052.00000000013}, "eq50_d_distance_pips": 4829.999999999927, "session_active": null, "mins_to_next_killzone": 24}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 19:06:13", "message": "Context+MT5 xong trong 0.50s"}
{"stage": "status_update", "t": "2025-09-30 19:06:14", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 19:06:14", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 19:16:20", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:16:21", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:16:22", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:16:22", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:16:22", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:16:28", "message": "Đã tắt auto-run."}
{"stage": "status_update", "t": "2025-09-30 19:16:29", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 19:16:30", "message": "Tự động chạy sau 31s."}
{"stage": "status_update", "t": "2025-09-30 19:16:31", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 19:16:35", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 19:17:03", "message": "Đã nạp 2 prompt từ file."}
{"stage": "status_update", "t": "2025-09-30 19:17:05", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 19:17:05", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 19:17:05", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 19:17:05", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 19:17:09", "message": "Upload xong 4 ảnh trong 4.48s"}
{"stage": "run-start", "t": "2025-09-30 19:17:09", "cycle": "2025-09-30 19:17:09", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 19:05:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 19:04:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 15:18:07) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T12:17:09Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 240}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 19:17:09", "broker_time": "2025-09-30T12:17:09Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3815.266, "ask": 3815.303, "last": 0.0, "time": 1759234630}, "tick_stats_5m": {"ticks_per_min": 240, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 246, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.4757525704316857, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102}, "volatility": {"ATR": {"M5": 3.9960825655968266, "M1": 1.7510243444181033, "M15": 7.5276906437869116, "H1": 14.263496246854055}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3813.89438951363, "ema200": 3814.5627772703456}, "M5": {"ema50": 3817.1605701191475, "ema200": 3831.1114383677573}, "M15": {"ema50": 3828.9430547215516, "ema200": 3810.2268904154134}, "H1": {"ema50": 3810.7518906022165, "ema200": 3752.4781693079767}}}, "vwap": {"day": 3817.030687355964, "asia": null, "london": 3820.096049882907, "newyork_am": null, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": null, "mins_to_next_killzone": 13, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "ABOVE", "distance_pips": 18795.99999999982}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 51269.00000000023}, {"name": "EQ50_D", "price": 3817.879, "relation": "ABOVE", "distance_pips": 2612.999999999829}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 48346.0}], "round_levels": [{"level": "2600", "price": 3815.26, "distance_pips": 0.6}, {"level": "2625", "price": 3815.263, "distance_pips": 0.35}, {"level": "2650", "price": 3815.265, "distance_pips": 0.1}, {"level": "2675", "price": 3815.268, "distance_pips": 0.15}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.9259067947781786}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 293}, {"price": 3867.242, "bar_index": 290}, {"price": 3834.062, "bar_index": 284}, {"price": 3833.647, "bar_index": 280}, {"price": 3831.428, "bar_index": 275}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 116}, {"price": 3632.264, "bar_index": 127}, {"price": 3633.892, "bar_index": 109}, {"price": 3640.568, "bar_index": 121}, {"price": 3643.331, "bar_index": 132}]}, "fvgs_h1": [{"type": "Bullish", "top": 3792.206, "bottom": 3788.842, "created_at_bar": 267, "lo": 3788.842, "hi": 3792.206}, {"type": "Bearish", "top": 3839.552, "bottom": 3821.605, "created_at_bar": 296, "lo": 3821.605, "hi": 3839.552}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 265, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 292, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3814.639, "bottom": 3798.264, "bar_index": 297}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 293}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 290}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 274}, {"price": 3871.459, "bar_index": 276}, {"price": 3870.101, "bar_index": 271}, {"price": 3867.242, "bar_index": 265}, {"price": 3852.113, "bar_index": 258}], "swing_lows_SSL": [{"price": 3742.965, "bar_index": 109}, {"price": 3746.591, "bar_index": 116}, {"price": 3747.287, "bar_index": 104}, {"price": 3748.361, "bar_index": 114}, {"price": 3752.285, "bar_index": 120}]}, "fvgs_m15": [{"type": "Bullish", "top": 3812.929, "bottom": 3810.254, "created_at_bar": 297, "lo": 3810.254, "hi": 3812.929}, {"type": "Bearish", "top": 3832.416, "bottom": 3823.837, "created_at_bar": 284, "lo": 3823.837, "hi": 3832.416}], "order_blocks_m15": [{"top": 3801.831, "bottom": 3793.174, "bar_index": 289, "lo": 3793.174, "hi": 3801.831, "type": "bull"}, {"top": 3822.175, "bottom": 3814.754, "bar_index": 285, "lo": 3814.754, "hi": 3822.175, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3742.965, "equilibrium": 3807.3630000000003, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bearish", "top": 3816.41, "bottom": 3815.046, "bar_index": 299}, {"type": "Bullish", "top": 3810.437, "bottom": 3803.232, "bar_index": 292}, {"type": "Bearish", "top": 3838.598, "bottom": 3820.009, "bar_index": 283}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 226}, {"price": 3871.459, "bar_index": 231}, {"price": 3870.478, "bar_index": 223}, {"price": 3870.101, "bar_index": 217}, {"price": 3870.097, "bar_index": 215}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 269}, {"price": 3797.291, "bar_index": 262}, {"price": 3798.175, "bar_index": 265}, {"price": 3799.993, "bar_index": 267}, {"price": 3802.675, "bar_index": 274}]}, "fvgs_m5": [{"type": "Bullish", "top": 3814.093, "bottom": 3810.095, "created_at_bar": 291, "lo": 3810.095, "hi": 3814.093}, {"type": "Bearish", "top": 3823.612, "bottom": 3819.201, "created_at_bar": 255, "lo": 3819.201, "hi": 3823.612}], "order_blocks_m5": [{"top": 3808.255, "bottom": 3804.375, "bar_index": 287, "lo": 3804.375, "hi": 3808.255, "type": "bull"}, {"top": 3821.605, "bottom": 3815.947, "bar_index": 260, "lo": 3815.947, "hi": 3821.605, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3793.174, "equilibrium": 3832.4674999999997, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3816.41, "bottom": 3815.046, "bar_index": 299}, {"type": "Bullish", "top": 3816.334, "bottom": 3808.172, "bar_index": 290}, {"type": "Bearish", "top": 3814.336, "bottom": 3812.034, "bar_index": 283}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3821.605, "bar_index": 102}, {"price": 3821.245, "bar_index": 106}, {"price": 3817.894, "bar_index": 279}, {"price": 3817.548, "bar_index": 258}, {"price": 3817.496, "bar_index": 261}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 149}, {"price": 3795.895, "bar_index": 153}, {"price": 3796.362, "bar_index": 155}, {"price": 3797.291, "bar_index": 116}, {"price": 3798.107, "bar_index": 161}]}, "fvgs_m1": [{"type": "Bullish", "top": 3814.426, "bottom": 3814.37, "created_at_bar": 295, "lo": 3814.37, "hi": 3814.426}, {"type": "Bearish", "top": 3823.612, "bottom": 3820.925, "created_at_bar": 73, "lo": 3820.925, "hi": 3823.612}], "order_blocks_m1": [{"top": 3814.37, "bottom": 3812.541, "bar_index": 293, "lo": 3812.541, "hi": 3814.37, "type": "bull"}], "premium_discount_m1": {"range_high": 3821.605, "range_low": 3793.174, "equilibrium": 3807.3895, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3815.756, "bottom": 3813.641, "bar_index": 294}, {"type": "Bullish", "top": 3815.787, "bottom": 3813.605, "bar_index": 277}, {"type": "Bullish", "top": 3816.206, "bottom": 3814.514, "bar_index": 260}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3815.266, "spread_points": 37, "atr_m5_pips": 399.6082565596827, "ticks_per_min": 240, "pdh_pdl_distance_pips": {"PDH": 18795.99999999982, "PDL": 51269.00000000023}, "eq50_d_distance_pips": 2612.999999999829, "session_active": null, "mins_to_next_killzone": 13}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 19:17:10", "message": "Context+MT5 xong trong 0.55s"}
{"stage": "status_update", "t": "2025-09-30 19:17:10", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 19:17:10", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 19:17:12", "message": "Đã nạp 2 prompt từ file."}
{"stage": "status_update", "t": "2025-09-30 19:17:49", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 19:17:49", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 19:17:49", "message": "Đã lưu thành công file: ctx_20250930_191749.json"}
{"stage": "run-end", "t": "2025-09-30 19:17:49"}
{"stage": "status_update", "t": "2025-09-30 19:17:49", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 19:17:49", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 20:19:59", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 20:19:59", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 20:19:59", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 20:19:59", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:20:03", "message": "Upload xong 4 ảnh trong 4.71s"}
{"stage": "run-start", "t": "2025-09-30 20:20:48", "cycle": "2025-09-30 20:20:48", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 19:17:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 19:05:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 19:04:22) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T13:20:48Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 269}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 20:20:48", "broker_time": "2025-09-30T13:20:48Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3817.67, "ask": 3817.707, "last": 0.0, "time": 1759238404}, "tick_stats_5m": {"ticks_per_min": 269, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 325, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.4980605768160069, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102, "london_high": 3859.405, "london_low": 3793.174}, "volatility": {"ATR": {"M5": 4.248897077032392, "M1": 1.811824766851957, "M15": 7.4537913233274855, "H1": 14.179027126663984}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3815.9314356042096, "ema200": 3814.490795968617}, "M5": {"ema50": 3816.809934089056, "ema200": 3829.7951951019354}, "M15": {"ema50": 3827.0260819589116, "ema200": 3810.906197516714}, "H1": {"ema50": 3811.179479484414, "ema200": 3753.234890195478}}}, "vwap": {"day": 3811.8206534497954, "asia": null, "london": 3811.6022978316873, "newyork_am": 3815.668734097347, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "newyork_am", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "ABOVE", "distance_pips": 16391.999999999825}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 53673.000000000226}, {"name": "EQ50_D", "price": 3817.879, "relation": "ABOVE", "distance_pips": 208.99999999983265}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 50750.0}], "round_levels": [{"level": "6700", "price": 3817.67, "distance_pips": 0.0}, {"level": "6725", "price": 3817.673, "distance_pips": 0.25}, {"level": "6750", "price": 3817.675, "distance_pips": 0.5}, {"level": "6775", "price": 3817.678, "distance_pips": 0.75}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8708142214084776}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3867.242, "bar_index": 289}, {"price": 3834.062, "bar_index": 283}, {"price": 3833.647, "bar_index": 279}, {"price": 3831.428, "bar_index": 274}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 115}, {"price": 3632.264, "bar_index": 126}, {"price": 3633.892, "bar_index": 108}, {"price": 3640.568, "bar_index": 120}, {"price": 3643.331, "bar_index": 131}]}, "fvgs_h1": [{"type": "Bullish", "top": 3792.206, "bottom": 3788.842, "created_at_bar": 266, "lo": 3788.842, "hi": 3792.206}, {"type": "Bearish", "top": 3839.552, "bottom": 3821.605, "created_at_bar": 295, "lo": 3821.605, "hi": 3839.552}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 264, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 291, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3814.639, "bottom": 3798.264, "bar_index": 296}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 292}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 289}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 270}, {"price": 3871.459, "bar_index": 272}, {"price": 3870.101, "bar_index": 267}, {"price": 3867.242, "bar_index": 261}, {"price": 3852.113, "bar_index": 254}], "swing_lows_SSL": [{"price": 3742.965, "bar_index": 105}, {"price": 3746.591, "bar_index": 112}, {"price": 3748.361, "bar_index": 110}, {"price": 3752.285, "bar_index": 116}, {"price": 3760.112, "bar_index": 145}]}, "fvgs_m15": [{"type": "Bullish", "top": 3803.038, "bottom": 3801.831, "created_at_bar": 287, "lo": 3801.831, "hi": 3803.038}, {"type": "Bearish", "top": 3832.416, "bottom": 3823.837, "created_at_bar": 280, "lo": 3823.837, "hi": 3832.416}], "order_blocks_m15": [{"top": 3817.098, "bottom": 3808.889, "bar_index": 296, "lo": 3808.889, "hi": 3817.098, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 272, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3742.965, "equilibrium": 3807.3630000000003, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3817.67, "bottom": 3816.794, "bar_index": 299}, {"type": "Bullish", "top": 3821.685, "bottom": 3810.448, "bar_index": 297}, {"type": "Bullish", "top": 3810.437, "bottom": 3803.232, "bar_index": 288}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 214}, {"price": 3871.459, "bar_index": 219}, {"price": 3870.478, "bar_index": 211}, {"price": 3870.101, "bar_index": 205}, {"price": 3870.097, "bar_index": 203}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 257}, {"price": 3797.291, "bar_index": 250}, {"price": 3798.175, "bar_index": 253}, {"price": 3799.993, "bar_index": 255}, {"price": 3802.675, "bar_index": 262}]}, "fvgs_m5": [{"type": "Bullish", "top": 3803.109, "bottom": 3801.024, "created_at_bar": 261, "lo": 3801.024, "hi": 3803.109}, {"type": "Bearish", "top": 3823.612, "bottom": 3819.201, "created_at_bar": 243, "lo": 3819.201, "hi": 3823.612}], "order_blocks_m5": [{"top": 3817.015, "bottom": 3808.889, "bar_index": 292, "lo": 3808.889, "hi": 3817.015, "type": "bull"}, {"top": 3839.183, "bottom": 3834.749, "bar_index": 238, "lo": 3834.749, "hi": 3839.183, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3793.174, "equilibrium": 3832.4674999999997, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bullish", "top": 3817.67, "bottom": 3816.794, "bar_index": 299}, {"type": "Bearish", "top": 3820.296, "bottom": 3814.264, "bar_index": 296}, {"type": "Bullish", "top": 3819.173, "bottom": 3810.448, "bar_index": 293}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3821.685, "bar_index": 278}, {"price": 3820.761, "bar_index": 282}, {"price": 3820.296, "bar_index": 284}, {"price": 3819.476, "bar_index": 274}, {"price": 3817.894, "bar_index": 221}], "swing_lows_SSL": [{"price": 3798.107, "bar_index": 103}, {"price": 3800.6, "bar_index": 107}, {"price": 3802.675, "bar_index": 118}, {"price": 3803.038, "bar_index": 133}, {"price": 3803.043, "bar_index": 121}]}, "fvgs_m1": [{"type": "Bullish", "top": 3816.794, "bottom": 3815.709, "created_at_bar": 299, "lo": 3815.709, "hi": 3816.794}, {"type": "Bearish", "top": 3818.725, "bottom": 3818.536, "created_at_bar": 286, "lo": 3818.536, "hi": 3818.725}], "order_blocks_m1": [{"top": 3820.296, "bottom": 3818.725, "bar_index": 284, "lo": 3818.725, "hi": 3820.296, "type": "bear"}], "premium_discount_m1": {"range_high": 3821.685, "range_low": 3797.707, "equilibrium": 3809.696, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3817.67, "bottom": 3816.794, "bar_index": 299}, {"type": "Bullish", "top": 3817.118, "bottom": 3815.114, "bar_index": 298}, {"type": "Bearish", "top": 3818.536, "bottom": 3815.506, "bar_index": 286}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3817.67, "spread_points": 37, "atr_m5_pips": 424.88970770323925, "ticks_per_min": 269, "pdh_pdl_distance_pips": {"PDH": 16391.999999999825, "PDL": 53673.000000000226}, "eq50_d_distance_pips": 208.99999999983265, "session_active": null, "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 20:20:49", "message": "Context+MT5 xong trong 45.32s"}
{"stage": "status_update", "t": "2025-09-30 20:20:50", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 20:20:50", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 20:21:30", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 20:21:30", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 20:21:30", "message": "Đã lưu thành công file: ctx_20250930_202130.json"}
{"stage": "run-end", "t": "2025-09-30 20:21:30"}
{"stage": "status_update", "t": "2025-09-30 20:21:30", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 20:21:30", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 20:22:00", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 20:22:00", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 20:22:00", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 20:22:00", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:22:04", "message": "Upload xong 4 ảnh trong 4.27s"}
{"stage": "run-start", "t": "2025-09-30 20:22:04", "cycle": "2025-09-30 20:22:04", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 451, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 20:21:30) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 451, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 19:17:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 19:05:37) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T13:22:04Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 298}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 20:22:04", "broker_time": "2025-09-30T13:22:04Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3816.974, "ask": 3817.011, "last": 0.0, "time": 1759238525}, "tick_stats_5m": {"ticks_per_min": 298, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 328, "median_spread": 37, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.49160201922720254, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102, "london_high": 3859.405, "london_low": 3793.174}, "volatility": {"ATR": {"M5": 4.364682791318113, "M1": 1.8110397539251566, "M15": 7.5695770376132065, "H1": 14.179027126663984}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3816.152790832057, "ema200": 3814.3298173391254}, "M5": {"ema50": 3816.806365461605, "ema200": 3829.794289629299}, "M15": {"ema50": 3827.0225133314607, "ema200": 3810.9052920440777}, "H1": {"ema50": 3811.175910856963, "ema200": 3753.2339847228413}}}, "vwap": {"day": 3811.6226329410583, "asia": null, "london": 3811.1087897325933, "newyork_am": 3815.791552248798, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "newyork_am", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "ABOVE", "distance_pips": 17087.999999999738}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 52977.00000000031}, {"name": "EQ50_D", "price": 3817.879, "relation": "ABOVE", "distance_pips": 904.9999999997453}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 50054.00000000009}], "round_levels": [{"level": "9700", "price": 3816.97, "distance_pips": 0.4}, {"level": "9725", "price": 3816.973, "distance_pips": 0.15}, {"level": "9750", "price": 3816.975, "distance_pips": 0.1}, {"level": "9775", "price": 3816.978, "distance_pips": 0.35}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8477133796161477}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3867.242, "bar_index": 289}, {"price": 3834.062, "bar_index": 283}, {"price": 3833.647, "bar_index": 279}, {"price": 3831.428, "bar_index": 274}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 115}, {"price": 3632.264, "bar_index": 126}, {"price": 3633.892, "bar_index": 108}, {"price": 3640.568, "bar_index": 120}, {"price": 3643.331, "bar_index": 131}]}, "fvgs_h1": [{"type": "Bullish", "top": 3792.206, "bottom": 3788.842, "created_at_bar": 266, "lo": 3788.842, "hi": 3792.206}, {"type": "Bearish", "top": 3839.552, "bottom": 3821.605, "created_at_bar": 295, "lo": 3821.605, "hi": 3839.552}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 264, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 291, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3814.639, "bottom": 3798.264, "bar_index": 296}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 292}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 289}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 270}, {"price": 3871.459, "bar_index": 272}, {"price": 3870.101, "bar_index": 267}, {"price": 3867.242, "bar_index": 261}, {"price": 3852.113, "bar_index": 254}], "swing_lows_SSL": [{"price": 3742.965, "bar_index": 105}, {"price": 3746.591, "bar_index": 112}, {"price": 3748.361, "bar_index": 110}, {"price": 3752.285, "bar_index": 116}, {"price": 3760.112, "bar_index": 145}]}, "fvgs_m15": [{"type": "Bullish", "top": 3803.038, "bottom": 3801.831, "created_at_bar": 287, "lo": 3801.831, "hi": 3803.038}, {"type": "Bearish", "top": 3832.416, "bottom": 3823.837, "created_at_bar": 280, "lo": 3823.837, "hi": 3832.416}], "order_blocks_m15": [{"top": 3817.098, "bottom": 3808.889, "bar_index": 296, "lo": 3808.889, "hi": 3817.098, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 272, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3742.965, "equilibrium": 3807.3630000000003, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3821.685, "bottom": 3810.448, "bar_index": 297}, {"type": "Bullish", "top": 3810.437, "bottom": 3803.232, "bar_index": 288}, {"type": "Bearish", "top": 3838.598, "bottom": 3820.009, "bar_index": 279}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 214}, {"price": 3871.459, "bar_index": 219}, {"price": 3870.478, "bar_index": 211}, {"price": 3870.101, "bar_index": 205}, {"price": 3870.097, "bar_index": 203}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 257}, {"price": 3797.291, "bar_index": 250}, {"price": 3798.175, "bar_index": 253}, {"price": 3799.993, "bar_index": 255}, {"price": 3802.675, "bar_index": 262}]}, "fvgs_m5": [{"type": "Bullish", "top": 3803.109, "bottom": 3801.024, "created_at_bar": 261, "lo": 3801.024, "hi": 3803.109}, {"type": "Bearish", "top": 3823.612, "bottom": 3819.201, "created_at_bar": 243, "lo": 3819.201, "hi": 3823.612}], "order_blocks_m5": [{"top": 3817.015, "bottom": 3808.889, "bar_index": 292, "lo": 3808.889, "hi": 3817.015, "type": "bull"}, {"top": 3839.183, "bottom": 3834.749, "bar_index": 238, "lo": 3834.749, "hi": 3839.183, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3793.174, "equilibrium": 3832.4674999999997, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3820.296, "bottom": 3814.264, "bar_index": 296}, {"type": "Bullish", "top": 3819.173, "bottom": 3810.448, "bar_index": 293}, {"type": "Bullish", "top": 3816.334, "bottom": 3808.172, "bar_index": 278}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3821.685, "bar_index": 275}, {"price": 3820.761, "bar_index": 279}, {"price": 3820.296, "bar_index": 281}, {"price": 3819.476, "bar_index": 271}, {"price": 3819.188, "bar_index": 297}], "swing_lows_SSL": [{"price": 3800.6, "bar_index": 104}, {"price": 3802.675, "bar_index": 115}, {"price": 3803.038, "bar_index": 130}, {"price": 3803.043, "bar_index": 118}, {"price": 3803.165, "bar_index": 128}]}, "fvgs_m1": [{"type": "Bullish", "top": 3816.794, "bottom": 3815.709, "created_at_bar": 296, "lo": 3815.709, "hi": 3816.794}, {"type": "Bearish", "top": 3823.612, "bottom": 3820.925, "created_at_bar": 12, "lo": 3820.925, "hi": 3823.612}], "order_blocks_m1": [{"top": 3820.296, "bottom": 3818.725, "bar_index": 281, "lo": 3818.725, "hi": 3820.296, "type": "bear"}], "premium_discount_m1": {"range_high": 3821.685, "range_low": 3798.107, "equilibrium": 3809.8959999999997, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3817.118, "bottom": 3815.114, "bar_index": 295}, {"type": "Bearish", "top": 3818.536, "bottom": 3815.506, "bar_index": 283}, {"type": "Bullish", "top": 3818.936, "bottom": 3816.272, "bar_index": 273}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3816.974, "spread_points": 37, "atr_m5_pips": 436.46827913181136, "ticks_per_min": 298, "pdh_pdl_distance_pips": {"PDH": 17087.999999999738, "PDL": 52977.00000000031}, "eq50_d_distance_pips": 904.9999999997453, "session_active": null, "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 20:22:04", "message": "Context+MT5 xong trong 0.23s"}
{"stage": "status_update", "t": "2025-09-30 20:22:05", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 20:22:05", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 20:22:44", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 20:22:44", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 20:22:44", "message": "Đã lưu thành công file: ctx_20250930_202244.json"}
{"stage": "run-end", "t": "2025-09-30 20:22:44"}
{"stage": "status_update", "t": "2025-09-30 20:22:44", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 20:22:44", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 20:23:14", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 20:23:14", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 20:23:14", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 20:23:14", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:23:19", "message": "Upload xong 4 ảnh trong 4.88s"}
{"stage": "run-start", "t": "2025-09-30 20:23:19", "cycle": "2025-09-30 20:23:19", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 451, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 20:22:44) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 451, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 20:21:30) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 451, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 19:17:49) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 450, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T13:23:19Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37, "median_ticks_per_min": 334}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 20:23:19", "broker_time": "2025-09-30T13:23:19Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3812.917, "ask": 3812.954, "last": 0.0, "time": 1759238600}, "tick_stats_5m": {"ticks_per_min": 334, "median_spread": 37, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 331, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.4539549385694668, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102, "london_high": 3859.405, "london_low": 3793.174}, "volatility": {"ATR": {"M5": 4.196419734877948, "M1": 1.8620925866977793, "M15": 7.585077037613213, "H1": 14.179027126663984}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3816.342421951487, "ema200": 3814.1767424952827}, "M5": {"ema50": 3816.904681765702, "ema200": 3829.6900534512815}, "M15": {"ema50": 3827.079415292245, "ema200": 3810.919729855023}, "H1": {"ema50": 3811.2328128177473, "ema200": 3753.2484225337867}}}, "vwap": {"day": 3811.4278539203615, "asia": null, "london": 3810.631901960783, "newyork_am": 3815.877791449182, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "newyork_am", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "ABOVE", "distance_pips": 21144.99999999998}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 48920.00000000007}, {"name": "EQ50_D", "price": 3817.879, "relation": "ABOVE", "distance_pips": 4961.999999999989}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 45996.99999999984}], "round_levels": [{"level": "9100", "price": 3812.91, "distance_pips": 0.7}, {"level": "9125", "price": 3812.912, "distance_pips": 0.45}, {"level": "9150", "price": 3812.915, "distance_pips": 0.2}, {"level": "9175", "price": 3812.918, "distance_pips": 0.05}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8817039842974161}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3867.242, "bar_index": 289}, {"price": 3834.062, "bar_index": 283}, {"price": 3833.647, "bar_index": 279}, {"price": 3831.428, "bar_index": 274}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 115}, {"price": 3632.264, "bar_index": 126}, {"price": 3633.892, "bar_index": 108}, {"price": 3640.568, "bar_index": 120}, {"price": 3643.331, "bar_index": 131}]}, "fvgs_h1": [{"type": "Bullish", "top": 3792.206, "bottom": 3788.842, "created_at_bar": 266, "lo": 3788.842, "hi": 3792.206}, {"type": "Bearish", "top": 3839.552, "bottom": 3821.605, "created_at_bar": 295, "lo": 3821.605, "hi": 3839.552}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 264, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 291, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3814.639, "bottom": 3798.264, "bar_index": 296}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 292}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 289}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 270}, {"price": 3871.459, "bar_index": 272}, {"price": 3870.101, "bar_index": 267}, {"price": 3867.242, "bar_index": 261}, {"price": 3852.113, "bar_index": 254}], "swing_lows_SSL": [{"price": 3742.965, "bar_index": 105}, {"price": 3746.591, "bar_index": 112}, {"price": 3748.361, "bar_index": 110}, {"price": 3752.285, "bar_index": 116}, {"price": 3760.112, "bar_index": 145}]}, "fvgs_m15": [{"type": "Bullish", "top": 3803.038, "bottom": 3801.831, "created_at_bar": 287, "lo": 3801.831, "hi": 3803.038}, {"type": "Bearish", "top": 3832.416, "bottom": 3823.837, "created_at_bar": 280, "lo": 3823.837, "hi": 3832.416}], "order_blocks_m15": [{"top": 3817.098, "bottom": 3808.889, "bar_index": 296, "lo": 3808.889, "hi": 3817.098, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 272, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3742.965, "equilibrium": 3807.3630000000003, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3819.405, "bottom": 3816.691, "bar_index": 299}, {"type": "Bullish", "top": 3821.685, "bottom": 3810.448, "bar_index": 297}, {"type": "Bullish", "top": 3810.437, "bottom": 3803.232, "bar_index": 288}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 213}, {"price": 3871.459, "bar_index": 218}, {"price": 3870.478, "bar_index": 210}, {"price": 3870.101, "bar_index": 204}, {"price": 3870.097, "bar_index": 202}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 256}, {"price": 3797.291, "bar_index": 249}, {"price": 3798.175, "bar_index": 252}, {"price": 3799.993, "bar_index": 254}, {"price": 3802.675, "bar_index": 261}]}, "fvgs_m5": [{"type": "Bullish", "top": 3803.109, "bottom": 3801.024, "created_at_bar": 260, "lo": 3801.024, "hi": 3803.109}, {"type": "Bearish", "top": 3823.612, "bottom": 3819.201, "created_at_bar": 242, "lo": 3819.201, "hi": 3823.612}], "order_blocks_m5": [{"top": 3817.015, "bottom": 3808.889, "bar_index": 291, "lo": 3808.889, "hi": 3817.015, "type": "bull"}, {"top": 3839.183, "bottom": 3834.749, "bar_index": 237, "lo": 3834.749, "hi": 3839.183, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3793.174, "equilibrium": 3832.4674999999997, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3820.296, "bottom": 3814.264, "bar_index": 295}, {"type": "Bullish", "top": 3819.173, "bottom": 3810.448, "bar_index": 292}, {"type": "Bullish", "top": 3816.334, "bottom": 3808.172, "bar_index": 277}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3821.685, "bar_index": 273}, {"price": 3820.761, "bar_index": 277}, {"price": 3820.296, "bar_index": 279}, {"price": 3819.476, "bar_index": 269}, {"price": 3819.188, "bar_index": 295}], "swing_lows_SSL": [{"price": 3800.6, "bar_index": 102}, {"price": 3802.675, "bar_index": 113}, {"price": 3803.038, "bar_index": 128}, {"price": 3803.043, "bar_index": 116}, {"price": 3803.165, "bar_index": 126}]}, "fvgs_m1": [{"type": "Bullish", "top": 3807.943, "bottom": 3807.201, "created_at_bar": 183, "lo": 3807.201, "hi": 3807.943}, {"type": "Bearish", "top": 3823.612, "bottom": 3820.925, "created_at_bar": 10, "lo": 3820.925, "hi": 3823.612}], "order_blocks_m1": [{"top": 3820.296, "bottom": 3818.725, "bar_index": 279, "lo": 3818.725, "hi": 3820.296, "type": "bear"}], "premium_discount_m1": {"range_high": 3821.685, "range_low": 3799.722, "equilibrium": 3810.7035, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3817.118, "bottom": 3815.114, "bar_index": 293}, {"type": "Bearish", "top": 3818.536, "bottom": 3815.506, "bar_index": 281}, {"type": "Bullish", "top": 3818.936, "bottom": 3816.272, "bar_index": 271}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3812.917, "spread_points": 37, "atr_m5_pips": 419.6419734877948, "ticks_per_min": 334, "pdh_pdl_distance_pips": {"PDH": 21144.99999999998, "PDL": 48920.00000000007}, "eq50_d_distance_pips": 4961.999999999989, "session_active": null, "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 20:23:20", "message": "Context+MT5 xong trong 0.66s"}
{"stage": "status_update", "t": "2025-09-30 20:23:21", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 20:23:21", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 20:24:00", "message": "Lỗi nghiêm trọng trong worker: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods."}
{"stage": "status_update", "t": "2025-09-30 20:24:00", "message": "Cảnh báo: Không tìm thấy khối JSON nào để lưu."}
{"stage": "status_update", "t": "2025-09-30 20:24:00", "message": "Đã lưu thành công file: ctx_20250930_202400.json"}
{"stage": "run-end", "t": "2025-09-30 20:24:00"}
{"stage": "status_update", "t": "2025-09-30 20:24:00", "message": "Đã hoàn tất phân tích toàn bộ thư mục."}
{"stage": "status_update", "t": "2025-09-30 20:24:00", "message": "Tự động chạy sau 30s."}
{"stage": "status_update", "t": "2025-09-30 20:24:30", "message": "Lưu ý: Cache ảnh đang bật, KHÔNG nên xoá file trên Gemini sau phân tích."}
{"stage": "status_update", "t": "2025-09-30 20:24:30", "message": "Đã xoá kết quả khỏi giao diện."}
{"stage": "status_update", "t": "2025-09-30 20:24:30", "message": "Đang nạp lại ảnh từ thư mục đã chọn..."}
{"stage": "status_update", "t": "2025-09-30 20:24:30", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:24:36", "message": "Upload xong 4 ảnh trong 5.28s"}
{"stage": "run-start", "t": "2025-09-30 20:24:36", "cycle": "2025-09-30 20:24:36", "session": null, "trend_checklist": {"trend": "flat", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": ["[LỖI PHÂN TÍCH] Đã xảy ra lỗi.", "Chi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.", "Traceback:", "Traceback (most recent call last):", "File \"D:\\app_gemini\\src\\core\\worker.py\", line 451, in run_analysis_worker"], "recent_history_summary": "--- Context T-0 (2025-09-30 20:24:00) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 451, in run_analysis_worker\n\n--- Context T-1 (2025-09-30 20:22:44) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 451, in run_analysis_worker\n\n--- Context T-2 (2025-09-30 20:21:30) (Images: H1, M1, M15, M5) ---\n[LỖI PHÂN TÍCH] Đã xảy ra lỗi.\nChi tiết: 404 models/gemini-1.5-flash is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.\nTraceback:\nTraceback (most recent call last):\nFile \"D:\\app_gemini\\src\\core\\worker.py\", line 451, in run_analysis_worker", "run_meta": {"analysis_id": "2025-09-30T13:24:36Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"checklist_pass_ratio": null, "backtest_results": {"summary": {"total_proposed": 0, "wins": 0, "losses": 0, "untriggered": 0, "win_rate": null}}, "median_spread": 37.0, "median_ticks_per_min": 364}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3, "allowed_killzones": ["london", "newyork_pre", "newyork_post"], "news_blackout_min_before_after": 15}, "environment_flags": {"news_soon": false, "high_spread": false, "low_liquidity": false, "volatility_regime": "trending", "trend_regime": "trending"}, "mt5": {"symbol": "XAUUSD", "generated_at": "2025-09-30 20:24:36", "broker_time": "2025-09-30T13:24:36Z", "account": {"balance": 186.35, "equity": 186.35, "free_margin": 186.35, "currency": "USD", "leverage": 2000}, "positions": [], "info": {"digits": 3, "point": 0.001, "contract_size": 100.0, "spread_current": 37, "swap_long": -513.7, "swap_short": 0.0}, "symbol_rules": {"volume_min": 0.01, "volume_max": 200.0, "volume_step": 0.01, "trade_tick_value": 0.1, "trade_tick_size": 0.001, "stop_level_points": 0, "freeze_level_points": 0, "margin_initial": 0.0, "margin_maintenance": 0.0}, "pip": {"points_per_pip": 10, "value_per_point": 0.1, "pip_value_per_lot": 1.0}, "tick": {"bid": 3813.045, "ask": 3813.082, "last": 0.0, "time": 1759238676}, "tick_stats_5m": {"ticks_per_min": 364, "median_spread": 37.0, "p90_spread": 37}, "tick_stats_30m": {"ticks_per_min": 332, "median_spread": 37.0, "p90_spread": 37}, "levels": {"daily": {"open": 3766.92, "high": 3871.761, "low": 3763.997, "eq50": 3817.879, "midnight_open": null}, "prev_day": {"high": 3834.062, "low": 3763.997}, "weekly": {"open": 3764.779, "high": 3871.761, "low": 3763.408}, "prev_week": {"high": 3791.146, "low": 3683.837}, "monthly": {"open": 3447.973, "high": 3871.761, "low": 3437.09}}, "day_open": 3766.92, "prev_day_close": 3832.896, "adr": {"d5": 46.02960000000003, "d10": 45.509000000000015, "d20": 42.027650000000015}, "day_range": 107.76400000000012, "day_range_pct_of_adr20": 256.41214771703886, "position_in_day_range": 0.45514271927545535, "sessions_today": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "session_liquidity": {"asia_high": 3850.722, "asia_low": 3828.102, "london_high": 3859.405, "london_low": 3793.174}, "volatility": {"ATR": {"M5": 4.3002768777351035, "M1": 1.8702441907694198, "M15": 7.6385770376131985, "H1": 14.179027126663984}}, "volatility_regime": "trending", "trend_refs": {"EMA": {"M1": {"ema50": 3816.347761686927, "ema200": 3814.1705710310207}, "M5": {"ema50": 3816.8098974519767, "ema200": 3829.666003700038}, "M15": {"ema50": 3826.985729017735, "ema200": 3810.8959587107443}, "H1": {"ema50": 3811.1391265432376, "ema200": 3753.224651389508}}}, "vwap": {"day": 3811.194995737342, "asia": null, "london": 3810.0515204178882, "newyork_am": 3815.940059703183, "newyork_pm": null}, "kills": {"asia": {"start": "06:00", "end": "09:00"}, "london": {"start": "14:00", "end": "17:00"}, "newyork_am": {"start": "19:30", "end": "22:00"}, "newyork_pm": {"start": "00:00", "end": "03:00"}}, "is_silver_bullet_window": false, "killzone_active": "newyork_am", "mins_to_next_killzone": null, "key_levels_nearby": [{"name": "PDH", "price": 3834.062, "relation": "ABOVE", "distance_pips": 21016.999999999825}, {"name": "PDL", "price": 3763.997, "relation": "BELOW", "distance_pips": 49048.000000000226}, {"name": "EQ50_D", "price": 3817.879, "relation": "ABOVE", "distance_pips": 4833.999999999833}, {"name": "DO", "price": 3766.92, "relation": "BELOW", "distance_pips": 46125.0}], "round_levels": [{"level": "400", "price": 3813.04, "distance_pips": 0.5}, {"level": "425", "price": 3813.043, "distance_pips": 0.25}, {"level": "450", "price": 3813.045, "distance_pips": 0.0}, {"level": "475", "price": 3813.048, "distance_pips": 0.25}], "atr_norm": {"spread_as_pct_of_atr_m5": 0.8604097143459885}, "ict_patterns": {"liquidity_h1": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 292}, {"price": 3867.242, "bar_index": 289}, {"price": 3834.062, "bar_index": 283}, {"price": 3833.647, "bar_index": 279}, {"price": 3831.428, "bar_index": 274}], "swing_lows_SSL": [{"price": 3627.806, "bar_index": 115}, {"price": 3632.264, "bar_index": 126}, {"price": 3633.892, "bar_index": 108}, {"price": 3640.568, "bar_index": 120}, {"price": 3643.331, "bar_index": 131}]}, "fvgs_h1": [{"type": "Bullish", "top": 3792.206, "bottom": 3788.842, "created_at_bar": 266, "lo": 3788.842, "hi": 3792.206}, {"type": "Bearish", "top": 3839.552, "bottom": 3821.605, "created_at_bar": 295, "lo": 3821.605, "hi": 3839.552}], "order_blocks_h1": [{"top": 3788.842, "bottom": 3767.907, "bar_index": 264, "lo": 3767.907, "hi": 3788.842, "type": "bull"}, {"top": 3870.478, "bottom": 3862.623, "bar_index": 291, "lo": 3862.623, "hi": 3870.478, "type": "bear"}], "premium_discount_h1": {"range_high": 3871.761, "range_low": 3627.806, "equilibrium": 3749.7835, "status": "Premium"}, "liquidity_voids_h1": [{"type": "Bullish", "top": 3814.639, "bottom": 3798.264, "bar_index": 296}, {"type": "Bearish", "top": 3871.761, "bottom": 3854.92, "bar_index": 292}, {"type": "Bullish", "top": 3867.242, "bottom": 3845.851, "bar_index": 289}], "mss_h1": null, "liquidity_m15": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 270}, {"price": 3871.459, "bar_index": 272}, {"price": 3870.101, "bar_index": 267}, {"price": 3867.242, "bar_index": 261}, {"price": 3852.113, "bar_index": 254}], "swing_lows_SSL": [{"price": 3742.965, "bar_index": 105}, {"price": 3746.591, "bar_index": 112}, {"price": 3748.361, "bar_index": 110}, {"price": 3752.285, "bar_index": 116}, {"price": 3760.112, "bar_index": 145}]}, "fvgs_m15": [{"type": "Bullish", "top": 3803.038, "bottom": 3801.831, "created_at_bar": 287, "lo": 3801.831, "hi": 3803.038}, {"type": "Bearish", "top": 3832.416, "bottom": 3823.837, "created_at_bar": 280, "lo": 3823.837, "hi": 3832.416}], "order_blocks_m15": [{"top": 3817.098, "bottom": 3808.889, "bar_index": 296, "lo": 3808.889, "hi": 3817.098, "type": "bull"}, {"top": 3871.459, "bottom": 3866.149, "bar_index": 272, "lo": 3866.149, "hi": 3871.459, "type": "bear"}], "premium_discount_m15": {"range_high": 3871.761, "range_low": 3742.965, "equilibrium": 3807.3630000000003, "status": "Premium"}, "liquidity_voids_m15": [{"type": "Bullish", "top": 3821.685, "bottom": 3810.448, "bar_index": 297}, {"type": "Bullish", "top": 3810.437, "bottom": 3803.232, "bar_index": 288}, {"type": "Bearish", "top": 3838.598, "bottom": 3820.009, "bar_index": 279}], "mss_m15": null, "liquidity_m5": {"swing_highs_BSL": [{"price": 3871.761, "bar_index": 213}, {"price": 3871.459, "bar_index": 218}, {"price": 3870.478, "bar_index": 210}, {"price": 3870.101, "bar_index": 204}, {"price": 3870.097, "bar_index": 202}], "swing_lows_SSL": [{"price": 3793.174, "bar_index": 256}, {"price": 3797.291, "bar_index": 249}, {"price": 3798.175, "bar_index": 252}, {"price": 3799.993, "bar_index": 254}, {"price": 3802.675, "bar_index": 261}]}, "fvgs_m5": [{"type": "Bullish", "top": 3803.109, "bottom": 3801.024, "created_at_bar": 260, "lo": 3801.024, "hi": 3803.109}, {"type": "Bearish", "top": 3823.612, "bottom": 3819.201, "created_at_bar": 242, "lo": 3819.201, "hi": 3823.612}], "order_blocks_m5": [{"top": 3817.015, "bottom": 3808.889, "bar_index": 291, "lo": 3808.889, "hi": 3817.015, "type": "bull"}, {"top": 3839.183, "bottom": 3834.749, "bar_index": 237, "lo": 3834.749, "hi": 3839.183, "type": "bear"}], "premium_discount_m5": {"range_high": 3871.761, "range_low": 3793.174, "equilibrium": 3832.4674999999997, "status": "Discount"}, "liquidity_voids_m5": [{"type": "Bearish", "top": 3820.296, "bottom": 3814.264, "bar_index": 295}, {"type": "Bullish", "top": 3819.173, "bottom": 3810.448, "bar_index": 292}, {"type": "Bullish", "top": 3816.334, "bottom": 3808.172, "bar_index": 277}], "mss_m5": null, "liquidity_m1": {"swing_highs_BSL": [{"price": 3821.685, "bar_index": 271}, {"price": 3820.761, "bar_index": 275}, {"price": 3820.296, "bar_index": 277}, {"price": 3819.476, "bar_index": 267}, {"price": 3819.405, "bar_index": 297}], "swing_lows_SSL": [{"price": 3802.675, "bar_index": 111}, {"price": 3803.038, "bar_index": 126}, {"price": 3803.043, "bar_index": 114}, {"price": 3803.165, "bar_index": 124}, {"price": 3803.553, "bar_index": 105}]}, "fvgs_m1": [{"type": "Bullish", "top": 3807.943, "bottom": 3807.201, "created_at_bar": 181, "lo": 3807.201, "hi": 3807.943}, {"type": "Bearish", "top": 3823.612, "bottom": 3820.925, "created_at_bar": 8, "lo": 3820.925, "hi": 3823.612}], "order_blocks_m1": [{"top": 3820.296, "bottom": 3818.725, "bar_index": 277, "lo": 3818.725, "hi": 3820.296, "type": "bear"}], "premium_discount_m1": {"range_high": 3821.685, "range_low": 3800.6, "equilibrium": 3811.1425, "status": "Premium"}, "liquidity_voids_m1": [{"type": "Bullish", "top": 3817.118, "bottom": 3815.114, "bar_index": 291}, {"type": "Bearish", "top": 3818.536, "bottom": 3815.506, "bar_index": 279}, {"type": "Bullish", "top": 3818.936, "bottom": 3816.272, "bar_index": 269}], "mss_m1": null}, "risk_model": {}, "rr_projection": {}}, "mt5_lite": {"symbol": "XAUUSD", "positions": [], "current_price": 3813.045, "spread_points": 37, "atr_m5_pips": 430.02768777351037, "ticks_per_min": 364, "pdh_pdl_distance_pips": {"PDH": 21016.999999999825, "PDL": 49048.000000000226}, "eq50_d_distance_pips": 4833.999999999833, "session_active": null, "mins_to_next_killzone": null}, "similar_past_scenarios": null}
{"stage": "status_update", "t": "2025-09-30 20:24:37", "message": "Context+MT5 xong trong 0.73s"}
{"stage": "status_update", "t": "2025-09-30 20:24:38", "message": "Đang phân tích toàn bộ thư mục..."}
{"stage": "status_update", "t": "2025-09-30 20:24:38", "message": "Worker: Không có lệnh mở, dùng prompt Vision Tìm Lệnh Mới."}
{"stage": "status_update", "t": "2025-09-30 20:24:39", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:24:39", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:36:11", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:36:12", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:36:12", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:36:12", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:36:13", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:36:13", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
{"stage": "status_update", "t": "2025-09-30 20:43:46", "message": "Xem: report_20250930_202400.md"}
{"stage": "status_update", "t": "2025-09-30 20:43:50", "message": "Xem: report_20250930_202400.md"}
{"stage": "status_update", "t": "2025-09-30 20:43:51", "message": "Xem: report_20250930_202244.md"}
{"stage": "status_update", "t": "2025-09-30 20:43:51", "message": "Xem: report_20250930_202244.md"}
{"stage": "status_update", "t": "2025-09-30 20:43:54", "message": "Xem: report_20250930_202130.md"}
{"stage": "status_update", "t": "2025-09-30 20:43:55", "message": "Xem: report_20250930_190537.md"}
{"stage": "status_update", "t": "2025-09-30 20:43:56", "message": "Xem: report_20250930_202400.md"}
{"stage": "status_update", "t": "2025-09-30 20:44:02", "message": "Xem: report_20250930_202244.md"}
{"stage": "status_update", "t": "2025-09-30 20:44:03", "message": "Xem: report_20250930_202244.md"}
{"stage": "status_update", "t": "2025-09-30 20:44:16", "message": "Xem JSON: ctx_20250930_202244.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:19", "message": "Xem JSON: ctx_20250930_202400.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:20", "message": "Xem JSON: ctx_20250930_202244.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:21", "message": "Xem JSON: ctx_20250930_202130.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:22", "message": "Xem JSON: ctx_20250930_191749.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:23", "message": "Xem JSON: ctx_20250930_202130.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:23", "message": "Xem JSON: ctx_20250930_190537.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:24", "message": "Xem JSON: ctx_20250930_151807.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:24", "message": "Xem JSON: ctx_20250930_151653.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:24", "message": "Xem JSON: ctx_20250930_151653.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:25", "message": "Xem JSON: ctx_20250930_151424.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:26", "message": "Xem JSON: ctx_20250930_151424.json"}
{"stage": "status_update", "t": "2025-09-30 20:44:27", "message": "Xem: report_20250930_202130.md"}
{"stage": "status_update", "t": "2025-09-30 20:44:27", "message": "Xem: report_20250930_191749.md"}
{"stage": "status_update", "t": "2025-09-30 20:44:28", "message": "Xem: report_20250930_190422.md"}
{"stage": "status_update", "t": "2025-09-30 20:45:06", "message": "Đã nạp 4 ảnh. Sẵn sàng phân tích 1 lần."}
