2025-10-15 12:56:18,704 - APP.persistence.log_handler - INFO - Đã cấu hình logging xoay vòng. File log: Log\app_debug.log, Size: 5MB, Backups: 5
2025-10-15 12:56:18,705 - APP.persistence.log_handler - DEBUG - Hoàn tất thiết lập logging cho ứng dụng.
2025-10-15 12:56:18,705 - __main__ - INFO - Ứng dụng đang khởi động...
2025-10-15 12:56:19,762 - APP.ui.app_ui - DEBUG - Bắt đầu khởi tạo AppUI.
2025-10-15 12:56:19,763 - APP.utils.threading_utils - INFO - Khởi tạo ThreadPoolExecutor với tối đa 10 luồng.
2025-10-15 12:56:19,764 - APP.ui.app_ui - DEBUG - Khởi tạo các biến Tkinter.
2025-10-15 12:56:19,768 - APP.utils.general_utils - DEBUG - Bắt đầu deobfuscate text với salt.
2025-10-15 12:56:19,769 - APP.utils.general_utils - DEBUG - Tạo machine key.
2025-10-15 12:56:19,769 - APP.utils.general_utils - DEBUG - Đã tạo machine key. Độ dài: 32 bytes.
2025-10-15 12:56:19,770 - APP.utils.general_utils - DEBUG - Thực hiện XOR bytes.
2025-10-15 12:56:19,770 - APP.utils.general_utils - DEBUG - Đã deobfuscate text thành công.
2025-10-15 12:56:19,772 - APP.ui.app_ui - DEBUG - Các biến Tkinter đã được khởi tạo.
2025-10-15 12:56:19,774 - APP.ui.utils.timeframe_detector - DEBUG - TimeframeDetector đã được khởi tạo và biên dịch 9 mẫu regex.
2025-10-15 12:56:19,774 - APP.ui.utils.ui_builder - DEBUG - Bắt đầu build_ui.
2025-10-15 12:56:19,918 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.symbols' vào nhóm 'chart.init' (metadata={'component': 'chart'})
2025-10-15 12:56:19,920 - APP.services.mt5_service - DEBUG - Bắt đầu get_all_symbols.
2025-10-15 12:56:19,921 - APP.services.mt5_service - DEBUG - Bắt đầu ensure_initialized. Path: None
2025-10-15 12:56:19,922 - APP.services.mt5_service - DEBUG - Bắt đầu connect MT5. Path: None
2025-10-15 12:56:20,178 - APP.services.mt5_service - INFO - Kết nối MT5 thành công.
2025-10-15 12:56:20,186 - APP.services.mt5_service - DEBUG - Kết thúc connect MT5.
2025-10-15 12:56:20,188 - APP.services.mt5_service - DEBUG - Kết thúc ensure_initialized. Kết quả: True
2025-10-15 12:56:20,208 - APP.services.mt5_service - DEBUG - Đã lấy được 357 symbols.
2025-10-15 12:56:20,229 - APP.utils.threading_utils - DEBUG - Task 'chart.symbols' (group=chart.init) hoàn tất sau 0.31s
2025-10-15 12:56:20,571 - APP.ui.components.chart_tab - DEBUG - ChartTab UI đã được khởi tạo hoàn chỉnh.
2025-10-15 12:56:20,996 - APP.ui.utils.ui_builder - DEBUG - Kết thúc build_ui.
2025-10-15 12:56:20,996 - APP.ui.components.history_manager - DEBUG - Bắt đầu liên kết các widget UI cho HistoryManager.
2025-10-15 12:56:20,997 - APP.ui.components.history_manager - DEBUG - Đã tạo md_manager cho history_list.
2025-10-15 12:56:20,997 - APP.ui.components.history_manager - DEBUG - Đã tạo json_manager cho json_list.
2025-10-15 12:56:20,998 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.update_models' vào nhóm 'ui.io.models' (metadata={'component': 'ui', 'operation': 'update_models'})
2025-10-15 12:56:20,999 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.update_models vào group ui.io.models (metadata={'component': 'ui', 'operation': 'update_models'})
2025-10-15 12:56:20,999 - APP.ui.app_ui - DEBUG - Bắt đầu worker cập nhật danh sách mô hình AI.
2025-10-15 12:56:20,999 - APP.ui.app_ui - DEBUG - Bắt đầu áp dụng cấu hình lên UI.
2025-10-15 12:56:21,001 - APP.ui.app_ui - DEBUG - Bắt đầu quá trình tải file từ thư mục: C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots.
2025-10-15 12:56:21,027 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.scan_folder' vào nhóm 'ui.io.scan' (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 12:56:21,029 - APP.ui.app_ui - DEBUG - Luồng quét thư mục bắt đầu cho: C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots.
2025-10-15 12:56:21,029 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.scan_folder vào group ui.io.scan (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 12:56:21,032 - APP.ui.app_ui - DEBUG - Symbol đã thay đổi thành: XAUUSD, đang đồng bộ hóa các thành phần.
2025-10-15 12:56:21,033 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 12:56:21,046 - APP.ui.app_ui - INFO - Luồng quét đã hoàn tất, tìm thấy 4 file.
2025-10-15 12:56:21,046 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 12:56:21,048 - APP.utils.threading_utils - DEBUG - Task 'ui.io.scan_folder' (group=ui.io.scan) hoàn tất sau 0.02s
2025-10-15 12:56:21,049 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,071 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,072 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 12:56:21,074 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 12:56:21,078 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,080 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 12:56:21,081 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,081 - APP.ui.app_ui - DEBUG - Thông báo cho ChartTab để vẽ lại biểu đồ.
2025-10-15 12:56:21,083 - APP.ui.components.chart_tab - DEBUG - Resetting chart stream due to config change (event=None)
2025-10-15 12:56:21,084 - APP.ui.components.chart_tab - INFO - ChartTab đã dừng stream dữ liệu.
2025-10-15 12:56:21,084 - APP.ui.controllers.chart_controller - INFO - Khởi động ChartController cho symbol=XAUUSD
2025-10-15 12:56:21,085 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M15', 'candles': 150, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:21,088 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:21,090 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M15', 'candles': 150, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:21,093 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:21,094 - APP.ui.components.chart_tab - INFO - ChartTab đã bắt đầu stream dữ liệu.
2025-10-15 12:56:21,101 - APP.ui.components.chart_tab - DEBUG - Resetting chart stream due to config change (event=None)
2025-10-15 12:56:21,104 - APP.ui.controllers.chart_controller - INFO - Dừng ChartController stream hiện tại.
2025-10-15 12:56:21,106 - APP.utils.threading_utils - INFO - Cancel group 'chart.refresh' → task 'chart.info'
2025-10-15 12:56:21,110 - APP.utils.threading_utils - INFO - Cancel group 'chart.refresh' → task 'chart.draw'
2025-10-15 12:56:21,111 - APP.ui.components.chart_tab - INFO - ChartTab đã dừng stream dữ liệu.
2025-10-15 12:56:21,112 - APP.ui.controllers.chart_controller - INFO - Khởi động ChartController cho symbol=XAUUSD
2025-10-15 12:56:21,113 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:21,148 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:21,150 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:21,153 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:21,153 - APP.ui.components.chart_tab - INFO - ChartTab đã bắt đầu stream dữ liệu.
2025-10-15 12:56:21,154 - APP.ui.app_ui - INFO - Chuyển đổi Autorun sang: Bật
2025-10-15 12:56:21,154 - APP.ui.app_ui - DEBUG - Lên lịch chạy tự động tiếp theo sau 60000ms.
2025-10-15 12:56:21,156 - APP.ui.components.prompt_manager - DEBUG - Yêu cầu tải prompts từ đĩa. Silent: True
2025-10-15 12:56:21,158 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._load_prompts_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_load_prompts_worker'})
2025-10-15 12:56:21,165 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._load_prompts_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_load_prompts_worker'})
2025-10-15 12:56:21,166 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 12:56:21,167 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 12:56:21,168 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,169 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,169 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 12:56:21,170 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,171 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,175 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:21,201 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,204 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:21,205 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,207 - APP.services.te_service - INFO - Đăng nhập thành công vào Trading Economics API với định dạng key username/password.
2025-10-15 12:56:21,209 - APP.services.news_service - DEBUG - Cấu hình NewsService đã được cập nhật.
2025-10-15 12:56:21,210 - APP.utils.threading_utils - DEBUG - Gửi task 'news.refresh.autorun' vào nhóm 'news.polling' (metadata={'component': 'news', 'priority': 'autorun', 'timeout_sec': 20})
2025-10-15 12:56:21,211 - APP.ui.app_ui - INFO - Đã áp dụng cấu hình lên UI thành công.
2025-10-15 12:56:21,212 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:21,214 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:21,215 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:56:21,216 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:56:21,216 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:56:21,217 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:56:21,217 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:21,218 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: refresh_all_lists
2025-10-15 12:56:21,219 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 12:56:21,219 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 12:56:21,220 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,221 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,221 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 12:56:21,259 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,262 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:56:21,263 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:21,286 - APP.ui.app_ui - INFO - Phát hiện symbol XAUUSD từ ảnh (auto=True, giữ symbol hiện tại XAUUSD).
2025-10-15 12:56:21,290 - APP.services.gemini_service - INFO - Đã tìm thấy 41 model khả dụng.
2025-10-15 12:56:21,293 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:21,294 - APP.utils.threading_utils - DEBUG - Task 'ui.io.update_models' (group=ui.io.models) hoàn tất sau 0.29s
2025-10-15 12:56:21,295 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui_success
2025-10-15 12:56:21,296 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:56:21,297 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:56:21,297 - APP.ui.components.prompt_manager - DEBUG - Yêu cầu tải prompts từ đĩa. Silent: False
2025-10-15 12:56:21,298 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._load_prompts_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_load_prompts_worker'})
2025-10-15 12:56:21,298 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._load_prompts_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_load_prompts_worker'})
2025-10-15 12:56:21,300 - APP.ui.app_ui - DEBUG - AppUI đã khởi tạo xong.
2025-10-15 12:56:21,574 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 12:56:21,585 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 12:56:21,593 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.51s
2025-10-15 12:56:21,596 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.52s
2025-10-15 12:56:21,600 - APP.ui.components.prompt_manager - DEBUG - Worker bắt đầu đọc các file prompt.
2025-10-15 12:56:21,610 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 12:56:21,612 - APP.ui.components.prompt_manager - DEBUG - Bắt đầu chuẩn hóa prompt. Độ dài raw: 4058
2025-10-15 12:56:21,613 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành JSON.
2025-10-15 12:56:21,614 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành Python literal.
2025-10-15 12:56:21,615 - APP.ui.components.prompt_manager - DEBUG - Không thể chuẩn hóa, trả về văn bản thô.
2025-10-15 12:56:21,617 - APP.ui.components.prompt_manager - DEBUG - Bắt đầu chuẩn hóa prompt. Độ dài raw: 4058
2025-10-15 12:56:21,617 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành JSON.
2025-10-15 12:56:21,618 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành Python literal.
2025-10-15 12:56:21,619 - APP.ui.components.prompt_manager - DEBUG - Không thể chuẩn hóa, trả về văn bản thô.
2025-10-15 12:56:21,620 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._load_prompts_worker' (group=ui.misc) hoàn tất sau 0.02s
2025-10-15 12:56:21,621 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 12:56:21,655 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:21,685 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 12:56:21,686 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.08s
2025-10-15 12:56:21,687 - APP.utils.threading_utils - DEBUG - Gửi task 'news.provider.fmp' vào nhóm 'news.polling' (metadata={'component': 'news', 'provider': 'fmp', 'priority': 'autorun'})
2025-10-15 12:56:21,689 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 12:56:21,689 - APP.utils.threading_utils - DEBUG - Gửi task 'news.provider.te' vào nhóm 'news.polling' (metadata={'component': 'news', 'provider': 'te', 'priority': 'autorun'})
2025-10-15 12:56:21,694 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:21,731 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.11s
2025-10-15 12:56:21,736 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:21,737 - APP.ui.components.prompt_manager - DEBUG - Cập nhật UI với nội dung prompt đã tải.
2025-10-15 12:56:21,742 - APP.ui.components.prompt_manager - DEBUG - Kết thúc cập nhật UI cho prompts.
2025-10-15 12:56:21,742 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:21,744 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:21,842 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,843 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,843 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:21,844 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:21,845 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,848 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,850 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,855 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,856 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,859 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:21,864 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,865 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,873 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:21,874 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:21,875 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,875 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:21,876 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,890 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,930 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M15', num_candles=150, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:21,932 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,935 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:21,938 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,938 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:21,993 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:21,994 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:21,995 - APP.utils.threading_utils - INFO - Task 'chart.info' (group=chart.refresh) bị hủy sau 0.91s
2025-10-15 12:56:21,996 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M15', num_candles=150, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:21,999 - APP.ui.controllers.chart_controller - DEBUG - Future chart.info bị cancel, không cập nhật UI.
2025-10-15 12:56:22,000 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:22,000 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 12:56:22,001 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:22,010 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 12:56:22,044 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.04s
2025-10-15 12:56:22,045 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 12:56:22,049 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 12:56:22,050 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.01s
2025-10-15 12:56:22,069 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:22,097 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:22,496 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:22,498 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:22,498 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:22,999 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:23,001 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:23,002 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:23,503 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:23,505 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:23,507 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 1.46s
2025-10-15 12:56:23,507 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:23,507 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:23,508 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:23,508 - APP.ui.components.prompt_manager - DEBUG - Worker bắt đầu đọc các file prompt.
2025-10-15 12:56:23,509 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.603
2025-10-15 12:56:23,510 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.603
2025-10-15 12:56:23,511 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.527
2025-10-15 12:56:23,518 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 343, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:23,524 - APP.services.fmp_service - DEBUG - Đang lấy dữ liệu lịch kinh tế từ investpy...
2025-10-15 12:56:23,524 - APP.ui.components.prompt_manager - DEBUG - Bắt đầu chuẩn hóa prompt. Độ dài raw: 4058
2025-10-15 12:56:23,529 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 343, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:23,531 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 343, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:23,572 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành JSON.
2025-10-15 12:56:23,614 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:56:23,631 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 449, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:23,720 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành Python literal.
2025-10-15 12:56:23,721 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 449, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:23,766 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 449, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:23,768 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 12:56:23,770 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:23,770 - APP.ui.components.prompt_manager - DEBUG - Không thể chuẩn hóa, trả về văn bản thô.
2025-10-15 12:56:23,771 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:23,772 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:23,775 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:23,777 - APP.ui.components.prompt_manager - DEBUG - Bắt đầu chuẩn hóa prompt. Độ dài raw: 4058
2025-10-15 12:56:23,779 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:23,780 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:23,783 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:23,827 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành JSON.
2025-10-15 12:56:23,830 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:23,834 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:23,835 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:23,836 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành Python literal.
2025-10-15 12:56:23,836 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:23,837 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:23,837 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:23,838 - APP.ui.components.prompt_manager - DEBUG - Không thể chuẩn hóa, trả về văn bản thô.
2025-10-15 12:56:23,838 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:23,839 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:23,840 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:23,841 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._load_prompts_worker' (group=ui.misc) hoàn tất sau 0.33s
2025-10-15 12:56:23,842 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:23,843 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:23,846 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:23,868 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:23,892 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:23,897 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:23,898 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:23,901 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:23,901 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:23,902 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:23,902 - APP.ui.components.prompt_manager - DEBUG - Cập nhật UI với nội dung prompt đã tải.
2025-10-15 12:56:23,903 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:23,903 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:23,904 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:23,907 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:23,908 - APP.ui.components.prompt_manager - DEBUG - Kết thúc cập nhật UI cho prompts.
2025-10-15 12:56:23,908 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:23,912 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:23,925 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:23,937 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:23,938 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:23,952 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:23,981 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:23,985 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:23,985 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:23,986 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:23,986 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:23,987 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:23,987 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:23,988 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:23,988 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:23,989 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:23,992 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:23,995 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:24,004 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:28,380 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:28,381 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:28,382 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:28,382 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:28,386 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:28,387 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:28,387 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:28,388 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:28,392 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:28,394 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:28,396 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:28,397 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:28,401 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:28,408 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:22+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:28,410 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:28,416 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:22+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:28,418 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:28,419 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:22+07:00
2025-10-15 12:56:28,420 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:28,420 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:22+07:00 trong DST: True
2025-10-15 12:56:28,451 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:28,454 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:28,456 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:28,457 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:28,458 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:28,458 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:28,460 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:22+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:28,462 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:23+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:28,463 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:28,464 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:22+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:28,465 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:23+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:28,466 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:28,468 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:22+07:00
2025-10-15 12:56:28,469 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:23+07:00
2025-10-15 12:56:28,470 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.383334056009
2025-10-15 12:56:28,471 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:22+07:00 trong DST: True
2025-10-15 12:56:28,481 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:23+07:00 trong DST: True
2025-10-15 12:56:28,488 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.383334056009, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:28,496 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 12:56:28,517 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:28,518 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:28,555 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:28,564 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:28,565 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:28,607 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.129899484515
2025-10-15 12:56:28,608 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:28,608 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:28,609 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:28,611 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:28,613 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:28,614 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.119018406569
2025-10-15 12:56:28,614 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.383334056009
2025-10-15 12:56:28,615 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.383334056009
2025-10-15 12:56:28,615 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:28,619 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.383334056009, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:28,622 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.383334056009, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:28,622 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.809381571868
2025-10-15 12:56:28,623 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:28,625 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:28,627 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:28,627 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.129899484515
2025-10-15 12:56:28,629 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.129899484515
2025-10-15 12:56:28,668 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.879270177538
2025-10-15 12:56:28,671 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:28,671 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:28,672 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:28,674 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.119018406569
2025-10-15 12:56:28,674 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.119018406569
2025-10-15 12:56:28,676 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.435201774216
2025-10-15 12:56:28,690 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:28,732 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:28,732 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:28,733 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.809381571868
2025-10-15 12:56:28,733 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.809381571868
2025-10-15 12:56:28,734 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.323734277074
2025-10-15 12:56:28,734 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:28,734 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:28,735 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:28,735 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.879270177538
2025-10-15 12:56:28,736 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.879270177538
2025-10-15 12:56:28,737 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.589767774271
2025-10-15 12:56:28,739 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:28,739 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:28,740 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:28,741 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.435201774216
2025-10-15 12:56:28,741 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.435201774216
2025-10-15 12:56:28,742 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.315673040485
2025-10-15 12:56:28,742 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:28,743 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:28,743 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.129899484515, 'ema200': 4194.119018406569}, 'M5': {'ema50': 4194.809381571868, 'ema200': 4182.879270177538}, 'M15': {'ema50': 4187.435201774216, 'ema200': 4157.323734277074}, 'H1': {'ema50': 4140.589767774271, 'ema200': 4073.315673040485}}
2025-10-15 12:56:28,744 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.323734277074
2025-10-15 12:56:28,744 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.323734277074
2025-10-15 12:56:28,745 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:28,746 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:28,747 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:28,747 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.590163231620123, TRs count: 179
2025-10-15 12:56:28,748 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.589767774271
2025-10-15 12:56:28,751 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.589767774271
2025-10-15 12:56:28,752 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:28,752 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:28,795 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:28,797 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.30991463360959, TRs count: 119
2025-10-15 12:56:28,798 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.315673040485
2025-10-15 12:56:28,801 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.129899484515, 'ema200': 4194.119018406569}, 'M5': {'ema50': 4194.809381571868, 'ema200': 4182.879270177538}, 'M15': {'ema50': 4187.435201774216, 'ema200': 4157.323734277074}, 'H1': {'ema50': 4140.589767774271, 'ema200': 4073.315673040485}}
2025-10-15 12:56:28,803 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:28,806 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.590163231620123, TRs count: 179
2025-10-15 12:56:28,811 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:28,812 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.315673040485
2025-10-15 12:56:28,813 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:28,814 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.30991463360959, TRs count: 119
2025-10-15 12:56:28,856 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.129899484515, 'ema200': 4194.119018406569}, 'M5': {'ema50': 4194.809381571868, 'ema200': 4182.879270177538}, 'M15': {'ema50': 4187.435201774216, 'ema200': 4157.323734277074}, 'H1': {'ema50': 4140.589767774271, 'ema200': 4073.315673040485}}
2025-10-15 12:56:28,857 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:28,858 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:28,858 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:28,859 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:28,861 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:28,862 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.590163231620123, TRs count: 179
2025-10-15 12:56:28,863 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:28,863 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:28,864 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:28,865 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.590163231620123, 'M1': 2.30991463360959, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:28,870 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:28,871 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.590163231620123, 'M1': 2.30991463360959, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:28,922 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:28,923 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.30991463360959, TRs count: 119
2025-10-15 12:56:28,924 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:28,924 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.603, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:28,925 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:28,925 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.603, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:28,926 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:28,927 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:28,928 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:28,928 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:28,929 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:28,932 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:28,932 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:28,933 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:28,935 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:28,936 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:28,938 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8797.999999999774
2025-10-15 12:56:28,938 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:28,939 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8797.999999999774
2025-10-15 12:56:28,939 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97999.00000000025
2025-10-15 12:56:29,011 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.590163231620123, 'M1': 2.30991463360959, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:29,014 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97999.00000000025
2025-10-15 12:56:29,015 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 2492.000000000189
2025-10-15 12:56:29,017 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:29,017 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 2492.000000000189
2025-10-15 12:56:29,019 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26966.999999999643
2025-10-15 12:56:29,020 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.527, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:29,021 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26966.999999999643
2025-10-15 12:56:29,021 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:29,022 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:29,022 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:29,024 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8797.999999999774}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97999.00000000025}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2492.000000000189}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26966.999999999643}]
2025-10-15 12:56:29,025 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:29,026 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8797.999999999774}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97999.00000000025}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2492.000000000189}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26966.999999999643}]
2025-10-15 12:56:29,026 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:29,027 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:29,028 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:29,030 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:29,030 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:29,031 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:29,031 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:29,032 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8721.999999999753
2025-10-15 12:56:29,033 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:29,033 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:29,033 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97923.00000000023
2025-10-15 12:56:29,034 - APP.services.mt5_service - DEBUG - Position in day range: 0.5386956521739162
2025-10-15 12:56:29,119 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:29,120 - APP.services.mt5_service - DEBUG - Position in day range: 0.5386956521739162
2025-10-15 12:56:29,123 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:22+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:29,123 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 2416.0000000001673
2025-10-15 12:56:29,124 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:22+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:29,124 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:22+07:00
2025-10-15 12:56:29,125 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26890.99999999962
2025-10-15 12:56:29,125 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:22+07:00
2025-10-15 12:56:29,125 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:22+07:00 trong DST: True
2025-10-15 12:56:29,126 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:29,127 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:22+07:00 trong DST: True
2025-10-15 12:56:29,127 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:29,128 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8721.999999999753}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97923.00000000023}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2416.0000000001673}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26890.99999999962}]
2025-10-15 12:56:29,132 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:29,150 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:29,151 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:29,151 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:29,152 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:29,153 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:29,153 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:29,154 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:29,154 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:29,155 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:29,155 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:29,156 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:29,157 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:29,158 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6000', 'price': 4188.6, 'distance_pips': 0.3}, {'level': '6025', 'price': 4188.602, 'distance_pips': 0.05}, {'level': '6050', 'price': 4188.605, 'distance_pips': 0.2}, {'level': '6075', 'price': 4188.608, 'distance_pips': 0.45}]
2025-10-15 12:56:29,158 - APP.services.mt5_service - DEBUG - Position in day range: 0.5375155279503133
2025-10-15 12:56:29,159 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6000', 'price': 4188.6, 'distance_pips': 0.3}, {'level': '6025', 'price': 4188.602, 'distance_pips': 0.05}, {'level': '6050', 'price': 4188.605, 'distance_pips': 0.2}, {'level': '6075', 'price': 4188.608, 'distance_pips': 0.45}]
2025-10-15 12:56:29,164 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6618769160616929}
2025-10-15 12:56:29,187 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:23+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:29,188 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6618769160616929}
2025-10-15 12:56:29,188 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:29,189 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:23+07:00
2025-10-15 12:56:29,189 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:29,189 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:29,190 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:23+07:00 trong DST: True
2025-10-15 12:56:29,216 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:29,216 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:29,217 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:29,217 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:29,218 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.603
2025-10-15 12:56:29,219 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:29,219 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.603
2025-10-15 12:56:29,220 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,221 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:29,222 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,227 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:29,251 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:29,252 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:29,252 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,253 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:29,266 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '5200', 'price': 4188.52, 'distance_pips': 0.7}, {'level': '5225', 'price': 4188.523, 'distance_pips': 0.45}, {'level': '5250', 'price': 4188.525, 'distance_pips': 0.2}, {'level': '5275', 'price': 4188.528, 'distance_pips': 0.05}]
2025-10-15 12:56:29,282 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:29,283 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,288 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6618769160616929}
2025-10-15 12:56:29,309 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:29,310 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:29,310 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:29,311 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:29,311 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:29,312 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.603
2025-10-15 12:56:29,313 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:29,313 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.603
2025-10-15 12:56:29,314 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,315 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.527
2025-10-15 12:56:29,330 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,343 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:29,344 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,345 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:29,346 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,346 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:29,347 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,382 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:29,406 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:29,408 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:29,409 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,413 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.603
2025-10-15 12:56:29,423 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,435 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:29,437 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:29,437 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:29,438 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,439 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.603
2025-10-15 12:56:29,441 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:29,444 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.527
2025-10-15 12:56:29,470 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,470 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:29,474 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,476 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:29,501 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,502 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:29,502 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:29,506 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:29,507 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:29,531 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.527
2025-10-15 12:56:29,532 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,533 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.603
2025-10-15 12:56:29,534 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,565 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:29,595 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,596 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:29,636 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:29,639 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:29,640 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,641 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.603
2025-10-15 12:56:29,642 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,643 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:29,643 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,644 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:29,644 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:29,645 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.527
2025-10-15 12:56:29,646 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:29,647 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:29,648 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:29,649 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:29,649 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,650 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:29,650 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:29,651 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:29,652 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:29,653 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:29,654 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:29,654 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:29,655 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:29,655 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:29,656 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:29,657 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:29,658 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:29,803 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:29,815 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:29,816 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:29,818 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:29,821 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:29,823 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:29,824 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:29,836 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:29,951 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:29,957 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:29,962 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:29,964 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:29,964 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:29,966 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:29,967 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:29,967 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:29,968 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:29,968 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:29,969 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:29,969 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:29,970 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:29,970 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:29,970 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:29,971 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:29,971 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:29,971 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:29,972 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:29,973 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:29,978 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:29,978 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:29,979 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:29,980 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:29,981 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:30,085 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:30,088 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:30,089 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:30,090 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:30,090 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:30,091 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:30,091 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:30,092 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:30,093 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:30,093 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:30,094 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:30,094 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:30,094 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,095 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:30,095 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:30,095 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:30,096 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:30,135 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:30,137 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:30,139 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:30,142 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,143 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:30,143 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:30,143 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.603, 'ask': 4188.64, 'last': 0.0, 'time': 1760532982}
2025-10-15 12:56:30,144 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:30,144 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:30,145 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:30,145 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:30,146 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:30,146 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 8.99s
2025-10-15 12:56:30,147 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:30,147 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:30,149 - APP.services.te_service - DEBUG - Đang thực hiện cuộc gọi API đến Trading Economics...
2025-10-15 12:56:30,150 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:30,151 - APP.services.te_service - WARNING - Bỏ qua xác minh SSL cho Trading Economics API.
2025-10-15 12:56:30,151 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:30,152 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,154 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:56:30,154 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,164 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:56:30,195 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:30,198 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.603, 'ask': 4188.64, 'last': 0.0, 'time': 1760532982}
2025-10-15 12:56:30,198 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:30,199 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:56:30,218 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:56:30,247 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:30,327 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:56:30,359 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:30,383 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,384 - APP.services.te_service - WARNING - Trading Economics trả về lỗi 403 - có thể do API key không hợp lệ hoặc hết hạn. Trả về danh sách rỗng để tránh dừng hệ thống.
2025-10-15 12:56:30,393 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:30,396 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:30,397 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:30,398 - APP.services.te_service - DEBUG - Đã khôi phục context SSL mặc định.
2025-10-15 12:56:30,398 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:30,398 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 343, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:30,399 - APP.utils.threading_utils - DEBUG - Task 'news.provider.te' (group=news.polling) hoàn tất sau 0.25s
2025-10-15 12:56:30,400 - APP.utils.threading_utils - INFO - Task 'chart.draw' (group=chart.refresh) bị hủy sau 9.31s
2025-10-15 12:56:30,408 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 449, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:30,480 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:30,482 - APP.ui.controllers.chart_controller - DEBUG - Future chart.draw bị cancel, không cập nhật UI.
2025-10-15 12:56:30,490 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,497 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:30,499 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,501 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:30,514 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.05s
2025-10-15 12:56:30,547 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,552 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:30,553 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,553 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:30,554 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6618769160616929}
2025-10-15 12:56:30,556 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:30,558 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:30,560 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:30,560 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,562 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:30,564 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:30,597 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:30,609 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:30,611 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:30,612 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8797.999999999774}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97999.00000000025}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2492.000000000189}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26966.999999999643}]
2025-10-15 12:56:30,614 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:22+07:00
2025-10-15 12:56:30,614 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:56:30,703 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:30,768 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:30,769 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:30,770 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:30,771 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:30,771 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:30,772 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:30,772 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:30,773 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:31,165 - APP.utils.threading_utils - WARNING - Task 'chart.info' (group=chart.refresh) vượt timeout 10.00s → cancel
2025-10-15 12:56:31,274 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:31,276 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:31,276 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:31,277 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.641
2025-10-15 12:56:31,282 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 340, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:31,363 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 449, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:31,365 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:31,368 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:31,370 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:31,372 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:31,373 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:31,374 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:31,378 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:31,406 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:31,407 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:31,440 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:31,496 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:31,502 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:31,507 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:31,511 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:31,515 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:31,519 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:31,520 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:31,520 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:31,523 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:31,525 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:31,526 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:31,527 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:31,529 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:31+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:31,531 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:31+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:31,532 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:31+07:00
2025-10-15 12:56:31,533 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:31+07:00 trong DST: True
2025-10-15 12:56:31,533 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:31,534 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:31,562 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:31,564 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:31,596 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.371534628122
2025-10-15 12:56:31,659 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.371534628122, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:31,686 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:31,687 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.079232817849
2025-10-15 12:56:31,688 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:31,688 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.106162685176
2025-10-15 12:56:31,688 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:31,689 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.7587149052015
2025-10-15 12:56:31,689 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:31,689 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.866414456145
2025-10-15 12:56:31,690 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:31,690 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.384535107549
2025-10-15 12:56:31,696 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:31,698 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.3108785556815
2025-10-15 12:56:31,699 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:31,700 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.539101107605
2025-10-15 12:56:31,701 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:31,702 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.302817319092
2025-10-15 12:56:31,703 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.079232817849, 'ema200': 4194.106162685176}, 'M5': {'ema50': 4194.7587149052015, 'ema200': 4182.866414456145}, 'M15': {'ema50': 4187.384535107549, 'ema200': 4157.3108785556815}, 'H1': {'ema50': 4140.539101107605, 'ema200': 4073.302817319092}}
2025-10-15 12:56:31,704 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:31,705 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:31,705 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:31,706 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:31,707 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:31,708 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:31,708 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:31,709 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:31,709 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:31,709 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:31,710 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.641, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:31,710 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:31,710 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:31,712 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:31,713 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:31,713 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7835.999999999331
2025-10-15 12:56:31,714 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97036.99999999981
2025-10-15 12:56:31,714 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1529.9999999997453
2025-10-15 12:56:31,714 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26004.9999999992
2025-10-15 12:56:31,715 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:31,715 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7835.999999999331}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97036.99999999981}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1529.9999999997453}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26004.9999999992}]
2025-10-15 12:56:31,716 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:31,716 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:31,717 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:31,718 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:31,718 - APP.services.mt5_service - DEBUG - Position in day range: 0.5237577639751515
2025-10-15 12:56:31,719 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:31+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:31,720 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:31+07:00
2025-10-15 12:56:31,720 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:31+07:00 trong DST: True
2025-10-15 12:56:31,721 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:31,748 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:31,748 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:31,749 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:31,749 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:31,750 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6400', 'price': 4187.64, 'distance_pips': 0.1}, {'level': '6425', 'price': 4187.642, 'distance_pips': 0.15}, {'level': '6450', 'price': 4187.645, 'distance_pips': 0.4}, {'level': '6475', 'price': 4187.648, 'distance_pips': 0.65}]
2025-10-15 12:56:31,750 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:31,751 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:31,752 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:31,752 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:31,753 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.641
2025-10-15 12:56:31,789 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:31,793 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:31,795 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:31,797 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:31,798 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:31,799 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.641
2025-10-15 12:56:31,800 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:31,801 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:31,802 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:31,802 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:31,803 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:31,805 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.641
2025-10-15 12:56:31,807 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:31,809 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:31,813 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:31,815 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:31,874 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:31,876 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.641
2025-10-15 12:56:31,877 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:31,878 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:31,879 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:31,882 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:31,882 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:31,883 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:31,884 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:31,885 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:31,886 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:31,886 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:31,887 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:31,933 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:31,936 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:31,936 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:31,937 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:31,938 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:31,939 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:31,940 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:31,967 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:31,969 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:31,969 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:31,970 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:31,970 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:31,970 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:31,971 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:31,971 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:32,029 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:32,032 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:32,034 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:32,065 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:32,095 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:32,126 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:32,127 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:32,128 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:32,155 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.641, 'ask': 4187.678, 'last': 0.0, 'time': 1760532991}
2025-10-15 12:56:32,156 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:32,158 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.68s
2025-10-15 12:56:32,276 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:32,492 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:32,494 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:32,503 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:32,507 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:32,528 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:32,530 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:32,531 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:32,532 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:32,533 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:32,533 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:33,073 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:33,074 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:33,075 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:33,076 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.588
2025-10-15 12:56:33,081 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 341, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:33,134 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 448, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:33,135 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:33,135 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:33,138 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:33,138 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:33,138 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:33,139 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:33,142 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:33,143 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:33,143 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:33,143 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:33,145 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:33,146 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:33,146 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:33,147 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:33,150 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:33,151 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:33,151 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:33,152 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:33,155 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:33,156 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:33,157 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:33,158 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:33,158 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:32+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:33,159 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:32+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:33,159 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:32+07:00
2025-10-15 12:56:33,159 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:32+07:00 trong DST: True
2025-10-15 12:56:33,163 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:33,186 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:33,187 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:33,188 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:33,189 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.370557947709
2025-10-15 12:56:33,193 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.370557947709, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:33,215 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:33,216 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.078448504123
2025-10-15 12:56:33,217 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:33,217 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.105963680201
2025-10-15 12:56:33,217 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:33,218 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.757930591476
2025-10-15 12:56:33,218 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:33,219 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86621545117
2025-10-15 12:56:33,219 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:33,220 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.383750793823
2025-10-15 12:56:33,220 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:33,221 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.3106795507065
2025-10-15 12:56:33,221 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:33,222 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.53831679388
2025-10-15 12:56:33,235 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:33,251 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3026183141164
2025-10-15 12:56:33,253 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.078448504123, 'ema200': 4194.105963680201}, 'M5': {'ema50': 4194.757930591476, 'ema200': 4182.86621545117}, 'M15': {'ema50': 4187.383750793823, 'ema200': 4157.3106795507065}, 'H1': {'ema50': 4140.53831679388, 'ema200': 4073.3026183141164}}
2025-10-15 12:56:33,253 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:33,256 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:33,257 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:33,258 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:33,279 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:33,280 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:33,281 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:33,299 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:33,309 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:33,310 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:33,311 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.588, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:33,311 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:33,311 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:33,312 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:33,312 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:33,312 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7782.999999999447
2025-10-15 12:56:33,313 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 96983.99999999993
2025-10-15 12:56:33,313 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1476.9999999998618
2025-10-15 12:56:33,314 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 25951.999999999316
2025-10-15 12:56:33,314 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:33,315 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7782.999999999447}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 96983.99999999993}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1476.9999999998618}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 25951.999999999316}]
2025-10-15 12:56:33,316 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:33,319 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:33,338 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:33,339 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:33,340 - APP.services.mt5_service - DEBUG - Position in day range: 0.5229347826086936
2025-10-15 12:56:33,341 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:32+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:33,342 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:32+07:00
2025-10-15 12:56:33,342 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:32+07:00 trong DST: True
2025-10-15 12:56:33,343 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:33,343 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:33,344 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:33,344 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:33,345 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:33,345 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '5800', 'price': 4187.58, 'distance_pips': 0.8}, {'level': '5825', 'price': 4187.582, 'distance_pips': 0.55}, {'level': '5850', 'price': 4187.585, 'distance_pips': 0.3}, {'level': '5875', 'price': 4187.587, 'distance_pips': 0.05}]
2025-10-15 12:56:33,346 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:33,346 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:33,381 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:33,384 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:33,387 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.588
2025-10-15 12:56:33,388 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:33,389 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:33,391 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:33,392 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:33,392 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:33,393 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.588
2025-10-15 12:56:33,393 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:33,394 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:33,395 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:33,395 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:33,396 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:33,397 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.588
2025-10-15 12:56:33,397 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:33,399 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:33,400 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:33,401 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:33,401 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:33,402 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.588
2025-10-15 12:56:33,402 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:33,403 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:33,403 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:33,404 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:33,404 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:33,405 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:33,406 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:33,407 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:33,407 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:33,407 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:33,408 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:33,408 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:33,409 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:33,409 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:33,440 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:33,481 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:33,482 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:33,483 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:33,485 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:33,485 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:33,486 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:33,487 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:33,487 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:33,488 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:33,488 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:33,488 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:33,489 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:33,489 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:33,490 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:33,490 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:33,491 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:33,492 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:33,493 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:33,494 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:33,494 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.588, 'ask': 4187.625, 'last': 0.0, 'time': 1760532992}
2025-10-15 12:56:33,495 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:33,496 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.00s
2025-10-15 12:56:33,510 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:34,494 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:34,497 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:34,503 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:34,503 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:34,507 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:34,508 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:34,535 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:34,540 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:34,541 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:34,541 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:35,043 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:35,044 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:35,045 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:35,045 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.731
2025-10-15 12:56:35,050 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 342, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:35,098 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 448, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:35,100 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:35,101 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:35,103 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:35,103 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:35,104 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:35,105 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:35,109 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:35,109 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:35,110 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:35,110 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:35,113 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:35,113 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:35,113 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:35,114 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:35,116 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:35,117 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:35,118 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:35,118 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:35,121 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:35,121 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:35,122 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:35,122 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:35,123 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:34+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:35,124 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:34+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:35,124 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:34+07:00
2025-10-15 12:56:35,125 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:34+07:00 trong DST: True
2025-10-15 12:56:35,125 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:35,125 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:35,126 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:35,127 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:35,127 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.370309318123
2025-10-15 12:56:35,133 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.370309318123, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:35,163 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:35,164 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.082762229613
2025-10-15 12:56:35,165 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:35,165 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.107058207564
2025-10-15 12:56:35,166 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:35,166 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.762244316966
2025-10-15 12:56:35,167 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:35,167 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.867309978533
2025-10-15 12:56:35,168 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:35,168 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.388064519314
2025-10-15 12:56:35,169 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:35,169 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.311774078069
2025-10-15 12:56:35,169 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:35,170 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.54263051937
2025-10-15 12:56:35,170 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:35,170 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.30371284148
2025-10-15 12:56:35,171 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.082762229613, 'ema200': 4194.107058207564}, 'M5': {'ema50': 4194.762244316966, 'ema200': 4182.867309978533}, 'M15': {'ema50': 4187.388064519314, 'ema200': 4157.311774078069}, 'H1': {'ema50': 4140.54263051937, 'ema200': 4073.30371284148}}
2025-10-15 12:56:35,171 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:35,172 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:35,172 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:35,173 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:35,173 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:35,174 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:35,174 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:35,174 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:35,175 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:35,175 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:35,175 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.731, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:35,176 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:35,176 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:35,176 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:35,177 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:35,177 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7925.999999999476
2025-10-15 12:56:35,178 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97126.99999999996
2025-10-15 12:56:35,178 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1619.9999999998909
2025-10-15 12:56:35,178 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26094.999999999345
2025-10-15 12:56:35,179 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:35,179 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7925.999999999476}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97126.99999999996}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1619.9999999998909}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26094.999999999345}]
2025-10-15 12:56:35,180 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:35,180 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:35,181 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:35,181 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:35,182 - APP.services.mt5_service - DEBUG - Position in day range: 0.525155279503104
2025-10-15 12:56:35,182 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:34+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:35,182 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:34+07:00
2025-10-15 12:56:35,183 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:34+07:00 trong DST: True
2025-10-15 12:56:35,183 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:35,183 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:35,184 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:35,184 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:35,185 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:35,185 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7300', 'price': 4187.73, 'distance_pips': 0.1}, {'level': '7325', 'price': 4187.733, 'distance_pips': 0.15}, {'level': '7350', 'price': 4187.735, 'distance_pips': 0.4}, {'level': '7375', 'price': 4187.738, 'distance_pips': 0.65}]
2025-10-15 12:56:35,186 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:35,186 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:35,187 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:35,187 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:35,188 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.731
2025-10-15 12:56:35,188 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:35,188 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:35,189 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:35,190 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:35,190 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:35,191 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.731
2025-10-15 12:56:35,191 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:35,191 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:35,193 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:35,194 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:35,194 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:35,200 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.731
2025-10-15 12:56:35,218 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:35,220 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:35,225 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:35,226 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:35,227 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:35,227 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.731
2025-10-15 12:56:35,228 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:35,228 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:35,229 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:35,230 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:35,230 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:35,231 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:35,231 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:35,232 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:35,232 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:35,233 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:35,234 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:35,234 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:35,235 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:35,235 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:35,235 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:35,236 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:35,236 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:35,236 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:35,237 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:35,237 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:35,237 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:35,237 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:35,238 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:35,238 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:35,239 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:35,239 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:35,240 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:35,240 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:35,241 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:35,241 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:35,242 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:35,243 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:35,244 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:35,244 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:35,244 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.731, 'ask': 4187.768, 'last': 0.0, 'time': 1760532994}
2025-10-15 12:56:35,245 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:35,246 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 0.75s
2025-10-15 12:56:35,269 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:35,519 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:35,521 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:35,529 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:35,530 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:35,530 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:35,531 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:35,531 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:35,532 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:35,533 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:35,533 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:35,713 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:35,713 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:35,725 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.01s
2025-10-15 12:56:35,820 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:36,035 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:36,037 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:36,038 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:36,039 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.675
2025-10-15 12:56:36,044 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 340, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:36,095 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 448, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:36,096 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:36,096 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:36,105 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:36,106 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:36,107 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:36,107 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:36,110 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:36,111 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:36,112 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:36,113 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:36,115 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:36,115 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:36,116 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:36,116 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:36,119 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:36,120 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:36,120 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:36,121 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:36,123 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:36,125 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:36,125 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:36,126 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:36,126 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:35+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:36,127 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:35+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:36,127 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:35+07:00
2025-10-15 12:56:36,127 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:35+07:00 trong DST: True
2025-10-15 12:56:36,128 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:36,128 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:36,132 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:36,148 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:36,154 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.369475080589
2025-10-15 12:56:36,158 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.369475080589, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:36,186 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:36,187 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.072526935495
2025-10-15 12:56:36,188 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:36,188 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.104461192638
2025-10-15 12:56:36,189 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:36,189 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.74989137579
2025-10-15 12:56:36,190 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:36,190 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.864175650175
2025-10-15 12:56:36,191 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:36,217 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.375711578137
2025-10-15 12:56:36,218 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:36,219 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.308639749711
2025-10-15 12:56:36,219 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:36,219 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.529022676233
2025-10-15 12:56:36,220 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:36,220 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.300260105161
2025-10-15 12:56:36,221 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.072526935495, 'ema200': 4194.104461192638}, 'M5': {'ema50': 4194.74989137579, 'ema200': 4182.864175650175}, 'M15': {'ema50': 4187.375711578137, 'ema200': 4157.308639749711}, 'H1': {'ema50': 4140.529022676233, 'ema200': 4073.300260105161}}
2025-10-15 12:56:36,221 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:36,222 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:36,224 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:36,225 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:36,246 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:36,247 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:36,248 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:36,249 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:36,249 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:36,249 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:36,250 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.675, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:36,250 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:36,250 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:36,251 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:36,252 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:36,252 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7869.999999999891
2025-10-15 12:56:36,252 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97071.00000000036
2025-10-15 12:56:36,254 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1564.0000000003056
2025-10-15 12:56:36,254 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26038.99999999976
2025-10-15 12:56:36,255 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:36,280 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7869.999999999891}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97071.00000000036}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1564.0000000003056}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26038.99999999976}]
2025-10-15 12:56:36,281 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:36,282 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:36,282 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:36,282 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:36,283 - APP.services.mt5_service - DEBUG - Position in day range: 0.5242857142857191
2025-10-15 12:56:36,284 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:35+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:36,284 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:35+07:00
2025-10-15 12:56:36,287 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:35+07:00 trong DST: True
2025-10-15 12:56:36,297 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:56:36,311 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:36,312 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:56:36,313 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.00s
2025-10-15 12:56:36,314 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:36,315 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:36,315 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:36,317 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:36,318 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6700', 'price': 4187.67, 'distance_pips': 0.5}, {'level': '6725', 'price': 4187.672, 'distance_pips': 0.25}, {'level': '6750', 'price': 4187.675, 'distance_pips': 0.0}, {'level': '6775', 'price': 4187.677, 'distance_pips': 0.25}]
2025-10-15 12:56:36,319 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:36,324 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:56:36,341 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:36,343 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:36,343 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:36,344 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.675
2025-10-15 12:56:36,344 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:36,345 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:36,346 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:36,346 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:36,346 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:36,348 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.675
2025-10-15 12:56:36,350 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:36,351 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:36,376 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:36,376 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:36,377 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:36,377 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.675
2025-10-15 12:56:36,378 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:36,379 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:36,380 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:36,381 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:36,382 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:36,407 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.675
2025-10-15 12:56:36,408 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:36,408 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:36,409 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:36,410 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:36,412 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:36,413 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:36,436 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:36,437 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:36,438 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:36,439 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:36,439 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:36,440 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:36,440 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:36,441 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:36,467 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:36,467 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:36,468 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:36,468 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:36,469 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:36,469 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:36,469 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:36,470 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:36,470 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:36,470 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:36,471 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:36,471 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:36,471 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:36,472 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:36,474 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:36,475 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:36,483 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:36,502 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:36,502 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:36,503 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:36,527 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.675, 'ask': 4187.712, 'last': 0.0, 'time': 1760532995}
2025-10-15 12:56:36,528 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:36,529 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.01s
2025-10-15 12:56:36,543 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:36,880 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:56:36,881 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:36,882 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:56:36,884 - APP.utils.threading_utils - INFO - Task 'chart.info' (group=chart.refresh) bị hủy sau 15.74s
2025-10-15 12:56:36,885 - APP.ui.controllers.chart_controller - DEBUG - Future chart.info bị cancel, không cập nhật UI.
2025-10-15 12:56:36,909 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 12:56:37,522 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:37,523 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:37,524 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:37,527 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:37,533 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:37,534 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:37,534 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:37,535 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:37,536 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:37,536 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:37,537 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:37,538 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:37,539 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:37,562 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:37,563 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:37,564 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:37,564 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:37,565 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:37,566 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:37,947 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 12:56:38,017 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 12:56:38,069 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:38,073 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:38,073 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:38,577 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:38,579 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:38,579 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:38,580 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:38,580 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.18
2025-10-15 12:56:38,581 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.268
2025-10-15 12:56:38,586 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 341, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:38,591 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 341, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:38,660 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 12:56:38,707 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 448, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:38,721 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 448, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:38,721 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:38,726 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:38,728 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:38,732 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:38,738 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:38,742 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:38,743 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 12:56:38,743 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:38,744 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:38,745 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:38,745 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:38,746 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:38,746 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:38,749 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:38,754 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:38,788 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:38,790 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:38,791 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:38,792 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:38,793 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:38,796 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:38,799 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:38,804 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:38,805 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:38,806 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:38,806 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:38,807 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:38,808 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:38,810 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:38,813 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:38,815 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:38,815 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:38,820 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:38,846 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:38,847 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:38,856 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:38,858 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:38,859 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:38,859 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:38,861 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:38,864 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:38,864 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:38,865 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:38,866 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:38+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:38,866 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:38,867 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:38+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:38,867 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:38,867 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:38+07:00
2025-10-15 12:56:38,868 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:37+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:38,868 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:38+07:00 trong DST: True
2025-10-15 12:56:38,869 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:37+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:38,869 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:38,870 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:37+07:00
2025-10-15 12:56:38,870 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:38,872 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:37+07:00 trong DST: True
2025-10-15 12:56:38,872 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:38,873 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:38,874 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:38,875 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:38,875 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.368176021088
2025-10-15 12:56:38,876 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:38,880 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.368176021088, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:38,955 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:38,957 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:38,958 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.368187131898
2025-10-15 12:56:38,959 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.0680171315735
2025-10-15 12:56:38,964 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.368187131898, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:38,965 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:38,967 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:38,967 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.103316914032
2025-10-15 12:56:38,968 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.066173994319
2025-10-15 12:56:38,968 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:38,968 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:38,969 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.747499218926
2025-10-15 12:56:38,969 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.10284925234
2025-10-15 12:56:38,970 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:38,970 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:38,971 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.863568685001
2025-10-15 12:56:38,971 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.747499218926
2025-10-15 12:56:38,972 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:38,975 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.373319421275
2025-10-15 12:56:39,007 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:39,042 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:39,043 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.308032784537
2025-10-15 12:56:39,044 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.863568685001
2025-10-15 12:56:39,045 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:39,046 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:39,046 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.52788542133
2025-10-15 12:56:39,047 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:39,048 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.373319421275
2025-10-15 12:56:39,048 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2999715479473
2025-10-15 12:56:39,048 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:39,049 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.0680171315735, 'ema200': 4194.103316914032}, 'M5': {'ema50': 4194.747499218926, 'ema200': 4182.863568685001}, 'M15': {'ema50': 4187.373319421275, 'ema200': 4157.308032784537}, 'H1': {'ema50': 4140.52788542133, 'ema200': 4073.2999715479473}}
2025-10-15 12:56:39,049 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.308032784537
2025-10-15 12:56:39,049 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:39,050 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:39,050 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:39,051 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.52788542133
2025-10-15 12:56:39,051 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:39,052 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:39,052 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:39,053 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2999715479473
2025-10-15 12:56:39,054 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:39,054 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.066173994319, 'ema200': 4194.10284925234}, 'M5': {'ema50': 4194.747499218926, 'ema200': 4182.863568685001}, 'M15': {'ema50': 4187.373319421275, 'ema200': 4157.308032784537}, 'H1': {'ema50': 4140.52788542133, 'ema200': 4073.2999715479473}}
2025-10-15 12:56:39,054 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:39,055 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:39,055 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:39,056 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:39,057 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:39,057 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:39,058 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:39,060 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:39,061 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:39,061 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.268, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:39,062 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:39,062 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:39,063 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:39,063 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:39,064 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:39,064 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:39,065 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:39,065 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7462.999999999738
2025-10-15 12:56:39,066 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:39,097 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 96664.00000000022
2025-10-15 12:56:39,128 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:39,131 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1157.0000000001528
2025-10-15 12:56:39,156 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 25631.999999999607
2025-10-15 12:56:39,158 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:39,159 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:39,159 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.18, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:39,190 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7462.999999999738}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 96664.00000000022}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1157.0000000001528}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 25631.999999999607}]
2025-10-15 12:56:39,193 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:39,227 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:39,232 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:39,235 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:39,237 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:39,239 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:39,240 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:39,240 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:39,241 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7375.0
2025-10-15 12:56:39,241 - APP.services.mt5_service - DEBUG - Position in day range: 0.5179658385093192
2025-10-15 12:56:39,242 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 96576.00000000048
2025-10-15 12:56:39,243 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:38+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:39,243 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1069.0000000004147
2025-10-15 12:56:39,244 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:38+07:00
2025-10-15 12:56:39,245 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 25543.99999999987
2025-10-15 12:56:39,245 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:38+07:00 trong DST: True
2025-10-15 12:56:39,246 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:39,246 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:39,247 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7375.0}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 96576.00000000048}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1069.0000000004147}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 25543.99999999987}]
2025-10-15 12:56:39,247 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:39,247 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:39,248 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:39,249 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:39,249 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,250 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:39,252 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:39,252 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:39,252 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2600', 'price': 4187.26, 'distance_pips': 0.8}, {'level': '2625', 'price': 4187.262, 'distance_pips': 0.55}, {'level': '2650', 'price': 4187.265, 'distance_pips': 0.3}, {'level': '2675', 'price': 4187.267, 'distance_pips': 0.05}]
2025-10-15 12:56:39,253 - APP.services.mt5_service - DEBUG - Position in day range: 0.5165993788819941
2025-10-15 12:56:39,254 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:39,258 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:37+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:39,285 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:37+07:00
2025-10-15 12:56:39,288 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,292 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:37+07:00 trong DST: True
2025-10-15 12:56:39,294 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:39,296 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:39,298 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:39,299 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.268
2025-10-15 12:56:39,301 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:39,303 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:39,303 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:39,304 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:39,304 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,305 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:39,307 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:39,308 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:39,309 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '1800', 'price': 4187.18, 'distance_pips': 0.0}, {'level': '1825', 'price': 4187.182, 'distance_pips': 0.25}, {'level': '1850', 'price': 4187.185, 'distance_pips': 0.5}, {'level': '1875', 'price': 4187.188, 'distance_pips': 0.75}]
2025-10-15 12:56:39,309 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:39,310 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:39,310 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.268
2025-10-15 12:56:39,311 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,311 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:39,312 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:39,313 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:39,313 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:39,314 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:39,315 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.18
2025-10-15 12:56:39,315 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:39,316 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:39,316 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:39,333 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:39,347 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.268
2025-10-15 12:56:39,350 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:39,380 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:39,382 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:39,384 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:39,386 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:39,387 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.18
2025-10-15 12:56:39,389 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:39,390 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:39,390 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:39,390 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:39,391 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:39,392 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:39,393 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.268
2025-10-15 12:56:39,393 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:39,394 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:39,394 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:39,395 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:39,395 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.18
2025-10-15 12:56:39,396 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:39,397 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:39,397 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:39,398 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:39,399 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,401 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:39,401 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:39,401 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:39,402 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:39,402 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:39,403 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:39,403 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:39,404 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:39,405 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.18
2025-10-15 12:56:39,405 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:39,406 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:39,406 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:39,407 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:39,407 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:39,408 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:39,408 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:39,410 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:39,410 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:39,414 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:39,441 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:39,483 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,484 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:39,485 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:39,485 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:39,486 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:39,486 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:39,487 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:39,487 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:39,488 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,488 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:39,488 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:39,488 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:39,489 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:39,489 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:39,490 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:39,490 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:39,491 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:39,491 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:39,492 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:39,492 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:39,493 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:39,493 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:39,494 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:39,494 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:39,495 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:39,495 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:39,497 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:39,497 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:39,498 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:39,498 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:39,499 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,499 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:39,500 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.268, 'ask': 4187.305, 'last': 0.0, 'time': 1760532998}
2025-10-15 12:56:39,501 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:39,501 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:39,501 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:39,502 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.98s
2025-10-15 12:56:39,502 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:39,533 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,534 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:39,535 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:39,568 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:39,595 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:39,609 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:39,627 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:39,663 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:39,750 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:39,761 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:56:39,771 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,771 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:56:39,774 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.18, 'ask': 4187.217, 'last': 0.0, 'time': 1760532997}
2025-10-15 12:56:39,776 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:56:39,777 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:56:39,777 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:56:39,778 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:56:39,834 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,844 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 12:56:39,845 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:39,883 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 341, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:39,887 - APP.services.fmp_service - INFO - Lấy thành công 402 sự kiện từ investpy cho 7 ngày tới.
2025-10-15 12:56:39,890 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 448, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:39,896 - APP.utils.threading_utils - DEBUG - Task 'news.provider.fmp' (group=news.polling) hoàn tất sau 16.37s
2025-10-15 12:56:39,902 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:39,953 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:39,970 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:40,003 - APP.ui.app_ui - DEBUG - Callback nhận được 144 sự kiện tin tức mới.
2025-10-15 12:56:40,004 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:40,032 - APP.services.news_service - INFO - NewsService làm mới cache (144 sự kiện, priority=autorun, source=network, latency=18.31s)
2025-10-15 12:56:40,033 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:40,033 - APP.utils.threading_utils - DEBUG - Task 'news.refresh.autorun' (group=news.polling) hoàn tất sau 18.34s
2025-10-15 12:56:40,034 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:40,039 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:56:40,061 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:40,062 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:40,062 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:40,063 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:40,063 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:40,064 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:40,064 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:40,064 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:40,091 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:40,092 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:40,092 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:40,093 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:40,093 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:40,094 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7375.0}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 96576.00000000048}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1069.0000000004147}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 25543.99999999987}]
2025-10-15 12:56:40,094 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:37+07:00
2025-10-15 12:56:40,095 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:56:40,095 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:40,096 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:56:40,097 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.57s
2025-10-15 12:56:40,166 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:40,184 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:40,185 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:56:40,186 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:40,187 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:40,529 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:40,530 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:40,532 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:40,533 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:40,540 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:40,541 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:40,541 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:40,542 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:40,542 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:40,543 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:40,543 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:40,544 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:40,544 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:40,545 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:40,546 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:40,546 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:40,547 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:40,547 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:40,548 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:40,822 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:40,822 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:40,831 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.01s
2025-10-15 12:56:40,888 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:41,049 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:41,051 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:41,051 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:41,552 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:41,554 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:41,554 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:41,555 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:41,555 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.656
2025-10-15 12:56:41,556 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.656
2025-10-15 12:56:41,560 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 343, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:41,565 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 343, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:41,670 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 448, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:41,677 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 448, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:41,678 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:41,678 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:41,679 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:41,679 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:41,681 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:41,684 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:41,685 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:41,685 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:41,686 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:41,686 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:41,686 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:41,687 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:41,692 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:41,702 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:41,716 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:41,718 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:41,718 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:41,719 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:41,719 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:41,720 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:41,722 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:41,724 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:41,724 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:41,725 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:41,726 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:41,750 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:41,751 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:41,752 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:41,755 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:41,783 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:41,784 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:41,784 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:41,786 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:41,787 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:41,812 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:41,813 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:41,814 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:41,814 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:41,815 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:41,819 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:41,821 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:41,844 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:41,846 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:40+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:41,876 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:41,877 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:40+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:41,877 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:41,877 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:40+07:00
2025-10-15 12:56:41,878 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:40+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:41,878 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:40+07:00 trong DST: True
2025-10-15 12:56:41,881 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:40+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:41,882 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:41,883 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:40+07:00
2025-10-15 12:56:41,884 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:41,903 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:40+07:00 trong DST: True
2025-10-15 12:56:41,905 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:41,906 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:41,907 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:41,907 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:41,908 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.366970277603
2025-10-15 12:56:41,908 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:41,912 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.366970277603, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:41,914 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:41,938 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:41,939 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.366970277603
2025-10-15 12:56:41,939 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.079821053143
2025-10-15 12:56:41,945 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.366970277603, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:41,966 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:41,967 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:41,968 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.106311938907
2025-10-15 12:56:41,968 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.079821053143
2025-10-15 12:56:41,968 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:41,969 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:41,969 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.759303140496
2025-10-15 12:56:41,970 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.106311938907
2025-10-15 12:56:41,970 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:41,971 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:41,971 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.866563709877
2025-10-15 12:56:41,972 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.759303140496
2025-10-15 12:56:41,972 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:41,974 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:41,975 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.385123342843
2025-10-15 12:56:41,975 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.866563709877
2025-10-15 12:56:41,996 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:41,997 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:41,998 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.311027809413
2025-10-15 12:56:41,998 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.385123342843
2025-10-15 12:56:41,999 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:41,999 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:42,000 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.5396893429
2025-10-15 12:56:42,000 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.311027809413
2025-10-15 12:56:42,001 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:42,001 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:42,002 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.302966572823
2025-10-15 12:56:42,002 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.5396893429
2025-10-15 12:56:42,002 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.079821053143, 'ema200': 4194.106311938907}, 'M5': {'ema50': 4194.759303140496, 'ema200': 4182.866563709877}, 'M15': {'ema50': 4187.385123342843, 'ema200': 4157.311027809413}, 'H1': {'ema50': 4140.5396893429, 'ema200': 4073.302966572823}}
2025-10-15 12:56:42,003 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:42,003 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:42,003 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.302966572823
2025-10-15 12:56:42,004 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:42,005 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.079821053143, 'ema200': 4194.106311938907}, 'M5': {'ema50': 4194.759303140496, 'ema200': 4182.866563709877}, 'M15': {'ema50': 4187.385123342843, 'ema200': 4157.311027809413}, 'H1': {'ema50': 4140.5396893429, 'ema200': 4073.302966572823}}
2025-10-15 12:56:42,006 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:42,007 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:42,015 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:42,028 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:42,029 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:42,030 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:42,031 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:42,031 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:42,032 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:42,032 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:42,033 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:42,034 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:42,034 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:42,034 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:42,035 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:42,036 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:42,037 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:42,038 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.656, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:42,038 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:42,063 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:42,063 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.656, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:42,064 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:42,064 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:42,065 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:42,065 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:42,065 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:42,066 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:42,066 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7850.999999999658
2025-10-15 12:56:42,066 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:42,067 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97052.00000000013
2025-10-15 12:56:42,068 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7850.999999999658
2025-10-15 12:56:42,069 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1545.0000000000728
2025-10-15 12:56:42,069 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97052.00000000013
2025-10-15 12:56:42,070 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26019.999999999527
2025-10-15 12:56:42,093 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1545.0000000000728
2025-10-15 12:56:42,093 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:42,094 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26019.999999999527
2025-10-15 12:56:42,094 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7850.999999999658}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97052.00000000013}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1545.0000000000728}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26019.999999999527}]
2025-10-15 12:56:42,095 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:42,095 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:42,096 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7850.999999999658}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97052.00000000013}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1545.0000000000728}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26019.999999999527}]
2025-10-15 12:56:42,096 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:42,097 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:42,097 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:42,099 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:42,099 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:42,099 - APP.services.mt5_service - DEBUG - Position in day range: 0.5239906832298149
2025-10-15 12:56:42,100 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:42,101 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:40+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:42,101 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:42,101 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:40+07:00
2025-10-15 12:56:42,118 - APP.services.mt5_service - DEBUG - Position in day range: 0.5239906832298149
2025-10-15 12:56:42,119 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:40+07:00 trong DST: True
2025-10-15 12:56:42,120 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:40+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:42,120 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:42,121 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:40+07:00
2025-10-15 12:56:42,121 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:42,121 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:40+07:00 trong DST: True
2025-10-15 12:56:42,122 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:42,122 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:42,123 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,123 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:42,123 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,124 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:42,124 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6500', 'price': 4187.65, 'distance_pips': 0.6}, {'level': '6525', 'price': 4187.652, 'distance_pips': 0.35}, {'level': '6550', 'price': 4187.655, 'distance_pips': 0.1}, {'level': '6575', 'price': 4187.657, 'distance_pips': 0.15}]
2025-10-15 12:56:42,125 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,126 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:42,126 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,127 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,127 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6500', 'price': 4187.65, 'distance_pips': 0.6}, {'level': '6525', 'price': 4187.652, 'distance_pips': 0.35}, {'level': '6550', 'price': 4187.655, 'distance_pips': 0.1}, {'level': '6575', 'price': 4187.657, 'distance_pips': 0.15}]
2025-10-15 12:56:42,127 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,128 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:42,128 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:42,129 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,130 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.656
2025-10-15 12:56:42,131 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,131 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:42,132 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:42,133 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:42,135 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.656
2025-10-15 12:56:42,156 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:42,158 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:42,159 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:42,159 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:42,160 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:42,160 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:42,161 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.656
2025-10-15 12:56:42,163 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:42,163 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:42,164 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:42,164 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:42,167 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.656
2025-10-15 12:56:42,188 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:42,189 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:42,189 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:42,190 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:42,191 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:42,192 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:42,197 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:42,219 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:42,221 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.656
2025-10-15 12:56:42,222 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.656
2025-10-15 12:56:42,222 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:42,224 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:42,225 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:42,225 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:42,228 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:42,247 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:42,247 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:42,248 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:42,248 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:42,249 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:42,249 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.656
2025-10-15 12:56:42,250 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.656
2025-10-15 12:56:42,250 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:42,251 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:42,252 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:42,252 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:42,253 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:42,253 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:42,254 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:42,254 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:42,255 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,256 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,257 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,257 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,257 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:42,258 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:42,258 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:42,283 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:42,283 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:42,284 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:42,284 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:42,285 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:42,285 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:42,286 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:42,286 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:42,287 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:42,287 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:42,287 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:42,288 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:42,289 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:42,312 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:42,312 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:42,312 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:42,314 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:42,314 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:42,315 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:42,315 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:42,316 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:42,316 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:42,318 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,318 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:42,319 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,345 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:42,345 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:42,346 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:42,346 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:42,347 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:42,347 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:42,348 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:42,349 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:42,350 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:42,374 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:42,375 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:42,375 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:42,376 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,376 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:42,377 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,378 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:42,378 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:42,379 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:42,380 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:42,381 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,381 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.656, 'ask': 4187.693, 'last': 0.0, 'time': 1760533000}
2025-10-15 12:56:42,382 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:42,382 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:42,405 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:42,406 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.87s
2025-10-15 12:56:42,406 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:42,408 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:42,409 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,409 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:56:42,410 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.656, 'ask': 4187.693, 'last': 0.0, 'time': 1760533000}
2025-10-15 12:56:42,410 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:56:42,411 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:56:42,417 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:56:42,435 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:56:42,436 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:56:42,437 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,438 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,438 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 343, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:42,438 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 448, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:42,439 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,439 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,439 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,440 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,440 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,441 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,442 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,443 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,444 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:42,444 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:42,445 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:42,465 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:42,466 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,466 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,467 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:42,467 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:42,467 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:42,468 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:42,469 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7850.999999999658}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97052.00000000013}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1545.0000000000728}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26019.999999999527}]
2025-10-15 12:56:42,469 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:40+07:00
2025-10-15 12:56:42,469 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:56:42,470 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:42,471 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:56:42,472 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.94s
2025-10-15 12:56:42,475 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:42,593 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:42,594 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:42,594 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:56:42,595 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:42,595 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:42,598 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:42,599 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:42,600 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:42,602 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:42,739 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:42,739 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:42,740 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:42,740 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:42,741 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:42,742 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:42,742 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:42,742 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:42,743 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:42,744 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:42,744 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:42,745 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:42,745 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:42,746 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:42,747 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:43,248 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:43,250 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:43,250 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:43,752 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:43,753 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:43,754 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:43,755 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:43,756 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.781
2025-10-15 12:56:43,756 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.841
2025-10-15 12:56:43,763 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 341, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:43,768 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 341, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:43,837 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 447, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:43,850 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:43,855 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 447, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:43,856 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:43,869 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:43,872 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:43,873 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:43,873 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:43,875 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:43,876 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:43,876 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:43,877 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:43,877 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:43,881 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:43,883 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:43,884 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:43,907 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:43,908 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:43,908 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:43,909 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:43,909 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:43,912 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:43,913 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:43,913 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:43,918 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:43,935 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:43,937 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:43,938 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:43,938 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:43,941 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:43,941 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:43,942 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:43,957 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:43,967 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:43,968 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:43,968 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:43,969 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:43,969 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:43,973 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:44,000 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:44,001 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:44,002 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:44,002 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:44,003 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:44,003 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:44,003 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:42+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:44,005 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:44,006 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:42+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:44,006 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:43+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:44,007 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:42+07:00
2025-10-15 12:56:44,007 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:43+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:44,010 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:42+07:00 trong DST: True
2025-10-15 12:56:44,027 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:43+07:00
2025-10-15 12:56:44,029 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:44,029 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:43+07:00 trong DST: True
2025-10-15 12:56:44,030 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:44,030 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:44,031 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:44,031 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:44,032 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:44,033 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:44,033 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.36648855696
2025-10-15 12:56:44,035 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:44,044 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.36648855696, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:44,061 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.36648855696
2025-10-15 12:56:44,062 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:44,066 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.36648855696, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:44,066 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.08142889628
2025-10-15 12:56:44,067 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:44,067 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:44,069 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.08142889628
2025-10-15 12:56:44,069 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.106719899106
2025-10-15 12:56:44,070 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:44,070 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:44,092 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.106719899106
2025-10-15 12:56:44,093 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.760910983633
2025-10-15 12:56:44,094 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:44,094 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:44,094 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.760910983633
2025-10-15 12:56:44,095 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.866971670075
2025-10-15 12:56:44,095 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:44,096 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:44,096 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.866971670075
2025-10-15 12:56:44,096 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.38673118598
2025-10-15 12:56:44,097 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:44,097 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:44,098 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.38673118598
2025-10-15 12:56:44,098 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.311435769611
2025-10-15 12:56:44,099 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:44,100 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:44,100 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.311435769611
2025-10-15 12:56:44,101 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.541297186037
2025-10-15 12:56:44,102 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:44,102 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:44,122 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.541297186037
2025-10-15 12:56:44,122 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:44,124 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.303374533022
2025-10-15 12:56:44,124 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.303374533022
2025-10-15 12:56:44,125 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.08142889628, 'ema200': 4194.106719899106}, 'M5': {'ema50': 4194.760910983633, 'ema200': 4182.866971670075}, 'M15': {'ema50': 4187.38673118598, 'ema200': 4157.311435769611}, 'H1': {'ema50': 4140.541297186037, 'ema200': 4073.303374533022}}
2025-10-15 12:56:44,125 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.08142889628, 'ema200': 4194.106719899106}, 'M5': {'ema50': 4194.760910983633, 'ema200': 4182.866971670075}, 'M15': {'ema50': 4187.38673118598, 'ema200': 4157.311435769611}, 'H1': {'ema50': 4140.541297186037, 'ema200': 4073.303374533022}}
2025-10-15 12:56:44,126 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:44,126 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:44,127 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:44,128 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:44,128 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:44,128 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:44,131 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:44,132 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:44,132 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:44,154 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:44,156 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:44,157 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:44,157 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:44,158 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:44,158 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:44,159 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:44,160 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:44,161 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:44,161 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:44,162 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:44,279 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.841, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:44,295 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.781, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:44,296 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:44,297 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:44,303 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:44,335 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:44,337 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:44,339 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:44,339 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:44,349 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:44,350 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8036.000000000058
2025-10-15 12:56:44,351 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97237.00000000054
2025-10-15 12:56:44,352 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1730.000000000473
2025-10-15 12:56:44,353 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26204.999999999927
2025-10-15 12:56:44,373 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:44,374 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8036.000000000058}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97237.00000000054}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1730.000000000473}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26204.999999999927}]
2025-10-15 12:56:44,411 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7975.999999999658
2025-10-15 12:56:44,441 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:44,442 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97177.00000000013
2025-10-15 12:56:44,445 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1670.0000000000728
2025-10-15 12:56:44,446 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:44,448 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26144.999999999527
2025-10-15 12:56:44,448 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:44,449 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7975.999999999658}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97177.00000000013}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1670.0000000000728}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26144.999999999527}]
2025-10-15 12:56:44,451 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:44,452 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:44,453 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:44,453 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:44,454 - APP.services.mt5_service - DEBUG - Position in day range: 0.5268633540372746
2025-10-15 12:56:44,454 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:44,455 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:43+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:44,455 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:44,455 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:43+07:00
2025-10-15 12:56:44,456 - APP.services.mt5_service - DEBUG - Position in day range: 0.5259316770186349
2025-10-15 12:56:44,482 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:43+07:00 trong DST: True
2025-10-15 12:56:44,487 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:42+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:44,487 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:44,489 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:42+07:00
2025-10-15 12:56:44,490 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:44,491 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:42+07:00 trong DST: True
2025-10-15 12:56:44,495 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:44,496 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:44,496 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:44,497 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:44,497 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:44,498 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:44,499 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8400', 'price': 4187.84, 'distance_pips': 0.1}, {'level': '8425', 'price': 4187.842, 'distance_pips': 0.15}, {'level': '8450', 'price': 4187.845, 'distance_pips': 0.4}, {'level': '8475', 'price': 4187.847, 'distance_pips': 0.65}]
2025-10-15 12:56:44,499 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:44,500 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:44,501 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:44,501 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:44,502 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7800', 'price': 4187.78, 'distance_pips': 0.1}, {'level': '7825', 'price': 4187.782, 'distance_pips': 0.15}, {'level': '7850', 'price': 4187.785, 'distance_pips': 0.4}, {'level': '7875', 'price': 4187.787, 'distance_pips': 0.65}]
2025-10-15 12:56:44,502 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:44,503 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:44,504 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:44,535 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:44,538 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.841
2025-10-15 12:56:44,563 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:44,564 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:44,564 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:44,565 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:44,566 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.781
2025-10-15 12:56:44,567 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:44,596 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:44,597 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:44,600 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:44,601 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:44,602 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.841
2025-10-15 12:56:44,612 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:44,626 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:44,627 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:44,628 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:44,631 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:44,632 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:44,633 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.781
2025-10-15 12:56:44,634 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:44,657 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:44,658 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:44,659 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:44,659 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.841
2025-10-15 12:56:44,660 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:44,662 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:44,663 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:44,664 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:44,686 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:44,688 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.781
2025-10-15 12:56:44,689 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:44,689 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:44,690 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:44,691 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:44,691 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:44,692 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:44,695 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.841
2025-10-15 12:56:44,695 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:44,696 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:44,718 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:44,720 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:44,722 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.781
2025-10-15 12:56:44,722 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:44,723 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:44,727 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:44,751 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:44,752 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:44,753 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:44,754 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:44,754 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:44,757 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:44,757 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:44,785 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:44,788 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:44,788 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:44,789 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:44,790 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:44,813 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:44,814 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:44,815 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:44,816 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:44,816 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:44,816 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:44,817 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:44,820 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:44,821 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:44,821 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:44,821 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:44,843 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:44,845 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:44,845 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:44,847 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:44,848 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:44,850 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:44,851 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:44,851 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:44,875 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:44,877 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:44,878 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:44,878 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:44,879 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:44,880 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:44,882 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:44,882 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:44,883 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:44,884 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:44,905 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:44,907 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:44,907 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:44,908 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:44,909 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:44,910 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:44,913 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:44,913 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:44,914 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:44,939 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:44,940 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:44,941 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:44,941 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:44,942 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:44,943 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:44,944 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.841, 'ask': 4187.878, 'last': 0.0, 'time': 1760533003}
2025-10-15 12:56:44,944 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:44,945 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:44,946 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:44,968 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.37s
2025-10-15 12:56:44,971 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:44,972 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:44,974 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:56:44,974 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:56:45,001 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.781, 'ask': 4187.818, 'last': 0.0, 'time': 1760533002}
2025-10-15 12:56:45,004 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:56:45,008 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:56:45,028 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:56:45,029 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:56:45,031 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:45,032 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:45,032 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 341, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:45,033 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 447, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:45,033 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:45,034 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:45,034 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:45,035 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:45,035 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:45,037 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:45,061 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:45,063 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:45,131 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:45,183 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:45,222 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:45,236 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:45,251 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:45,253 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:45,257 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:45,281 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:45,283 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:45,284 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:45,285 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:45,352 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7975.999999999658}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97177.00000000013}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1670.0000000000728}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26144.999999999527}]
2025-10-15 12:56:45,354 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:42+07:00
2025-10-15 12:56:45,354 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:56:45,357 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:45,359 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:56:45,361 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.76s
2025-10-15 12:56:45,405 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:45,406 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:45,407 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:56:45,408 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:45,408 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:45,602 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:45,602 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:45,604 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:45,606 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:45,613 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:45,614 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:45,614 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:45,615 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:45,616 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:45,616 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:45,617 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:45,617 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:45,618 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:45,618 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:45,619 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:45,620 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:45,620 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:45,621 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:45,621 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:45,889 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:45,890 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:45,900 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.01s
2025-10-15 12:56:45,912 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:46,122 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:46,124 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:46,125 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:46,626 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:46,628 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:46,628 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:46,629 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:46,629 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.841
2025-10-15 12:56:46,630 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.804
2025-10-15 12:56:46,635 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 340, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:46,640 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 340, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:46,713 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 446, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:46,720 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:46,723 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 446, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:46,724 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:46,726 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:46,731 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:46,745 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:46,746 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:46,748 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:46,749 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:46,749 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:46,750 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:46,750 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:46,753 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:46,753 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:46,754 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:46,762 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:46,777 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:46,778 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:46,779 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:46,780 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:46,781 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:46,782 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:46,782 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:46,784 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:46,785 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:46,785 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:46,786 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:46,786 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:46,789 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:46,789 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:46,790 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:46,812 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:46,814 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:46,815 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:46,815 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:46,819 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:46,820 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:46,841 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:46,842 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:46,843 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:46,845 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:46,846 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:46,847 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:46,848 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:45+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:46,849 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:46,850 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:45+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:46,851 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:45+07:00
2025-10-15 12:56:46,851 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:45+07:00 trong DST: True
2025-10-15 12:56:46,874 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:46,876 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:46,876 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:46+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:46,877 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:46,877 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:46+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:46,877 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:46,878 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:46+07:00
2025-10-15 12:56:46,880 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:46,880 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:46+07:00 trong DST: True
2025-10-15 12:56:46,881 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.366050866665
2025-10-15 12:56:46,882 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:46,889 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.366050866665, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:46,902 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:46,904 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:46,904 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:46,905 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.085624974711
2025-10-15 12:56:46,906 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:46,906 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:46,907 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.366050866665
2025-10-15 12:56:46,907 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.107784575724
2025-10-15 12:56:46,910 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.366050866665, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:46,911 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:46,911 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:46,913 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.765107062064
2025-10-15 12:56:46,913 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.085624974711
2025-10-15 12:56:46,914 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:46,914 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:46,936 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.868036346693
2025-10-15 12:56:46,937 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.107784575724
2025-10-15 12:56:46,937 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:46,938 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:46,938 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.390927264411
2025-10-15 12:56:46,939 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.765107062064
2025-10-15 12:56:46,939 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:46,940 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:46,940 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.312500446229
2025-10-15 12:56:46,940 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.868036346693
2025-10-15 12:56:46,941 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:46,941 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:46,943 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.545493264468
2025-10-15 12:56:46,944 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.390927264411
2025-10-15 12:56:46,945 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:46,966 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:46,967 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.304439209639
2025-10-15 12:56:46,968 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.312500446229
2025-10-15 12:56:46,968 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.085624974711, 'ema200': 4194.107784575724}, 'M5': {'ema50': 4194.765107062064, 'ema200': 4182.868036346693}, 'M15': {'ema50': 4187.390927264411, 'ema200': 4157.312500446229}, 'H1': {'ema50': 4140.545493264468, 'ema200': 4073.304439209639}}
2025-10-15 12:56:46,969 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:46,969 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:46,970 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.545493264468
2025-10-15 12:56:46,970 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:46,970 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:46,971 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:46,971 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.304439209639
2025-10-15 12:56:46,972 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:46,973 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.085624974711, 'ema200': 4194.107784575724}, 'M5': {'ema50': 4194.765107062064, 'ema200': 4182.868036346693}, 'M15': {'ema50': 4187.390927264411, 'ema200': 4157.312500446229}, 'H1': {'ema50': 4140.545493264468, 'ema200': 4073.304439209639}}
2025-10-15 12:56:46,974 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:46,975 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:46,975 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:46,985 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:46,998 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:46,999 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:47,000 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:47,001 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:47,001 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:47,002 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:47,003 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:47,003 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:47,004 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.841, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:47,004 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:47,006 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:47,006 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:47,007 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:47,031 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:47,032 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:47,033 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:47,033 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:47,033 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.804, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:47,034 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8036.000000000058
2025-10-15 12:56:47,034 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:47,035 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97237.00000000054
2025-10-15 12:56:47,035 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:47,035 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1730.000000000473
2025-10-15 12:56:47,036 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:47,036 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26204.999999999927
2025-10-15 12:56:47,037 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:47,038 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7998.999999999796
2025-10-15 12:56:47,038 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:47,039 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97200.00000000028
2025-10-15 12:56:47,039 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8036.000000000058}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97237.00000000054}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1730.000000000473}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26204.999999999927}]
2025-10-15 12:56:47,040 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1693.000000000211
2025-10-15 12:56:47,040 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:47,058 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26167.999999999665
2025-10-15 12:56:47,060 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:47,061 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:47,061 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:47,062 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7998.999999999796}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97200.00000000028}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1693.000000000211}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26167.999999999665}]
2025-10-15 12:56:47,062 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:47,062 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:47,063 - APP.services.mt5_service - DEBUG - Position in day range: 0.5268633540372746
2025-10-15 12:56:47,064 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:47,064 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:45+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:47,065 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:47,065 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:45+07:00
2025-10-15 12:56:47,066 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:47,066 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:45+07:00 trong DST: True
2025-10-15 12:56:47,066 - APP.services.mt5_service - DEBUG - Position in day range: 0.5262888198757798
2025-10-15 12:56:47,067 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:47,068 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:46+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:47,069 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:47,070 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:46+07:00
2025-10-15 12:56:47,070 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:47,092 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:46+07:00 trong DST: True
2025-10-15 12:56:47,094 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,095 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:47,095 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,095 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:47,096 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8400', 'price': 4187.84, 'distance_pips': 0.1}, {'level': '8425', 'price': 4187.842, 'distance_pips': 0.15}, {'level': '8450', 'price': 4187.845, 'distance_pips': 0.4}, {'level': '8475', 'price': 4187.847, 'distance_pips': 0.65}]
2025-10-15 12:56:47,096 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:47,097 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:47,097 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,098 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,099 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,100 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,100 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8000', 'price': 4187.8, 'distance_pips': 0.4}, {'level': '8025', 'price': 4187.802, 'distance_pips': 0.15}, {'level': '8050', 'price': 4187.805, 'distance_pips': 0.1}, {'level': '8075', 'price': 4187.807, 'distance_pips': 0.35}]
2025-10-15 12:56:47,100 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:47,101 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:47,111 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.841
2025-10-15 12:56:47,124 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,126 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:47,127 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,128 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:47,128 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:47,129 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:47,130 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.804
2025-10-15 12:56:47,131 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:47,132 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:47,132 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:47,156 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:47,158 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.841
2025-10-15 12:56:47,159 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:47,159 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:47,160 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:47,160 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:47,161 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:47,162 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.804
2025-10-15 12:56:47,163 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:47,164 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:47,171 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:47,189 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:47,190 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:47,191 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.841
2025-10-15 12:56:47,192 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:47,192 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:47,193 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:47,195 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:47,196 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:47,220 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:47,220 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:47,221 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:47,222 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.804
2025-10-15 12:56:47,223 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.841
2025-10-15 12:56:47,224 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:47,225 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:47,226 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:47,226 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:47,234 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:47,251 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:47,252 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:47,252 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:47,253 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:47,253 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,254 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.804
2025-10-15 12:56:47,254 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,256 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:47,256 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:47,257 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:47,257 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:47,258 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:47,281 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:47,282 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:47,282 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:47,283 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,284 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:47,284 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,284 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:47,285 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:47,285 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:47,289 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:47,290 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:47,291 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:47,291 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:47,292 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:47,315 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:47,317 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:47,318 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:47,319 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:47,320 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:47,320 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:47,320 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:47,321 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:47,343 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:47,344 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:47,345 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:47,345 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:47,346 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,346 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:47,346 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,347 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:47,347 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:47,348 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:47,348 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:47,352 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:47,374 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:47,375 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:47,376 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:47,376 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:47,377 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:47,377 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:47,378 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,379 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,380 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:47,382 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:47,392 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:56:47,393 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:56:47,406 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,407 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:47,409 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:56:47,410 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.841, 'ask': 4187.878, 'last': 0.0, 'time': 1760533005}
2025-10-15 12:56:47,411 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:47,412 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:56:47,412 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:56:47,413 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:47,414 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:56:47,415 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:47,437 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,438 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:47,438 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,439 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:47,439 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 340, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:47,440 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:47,440 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 446, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:47,441 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:47,441 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,443 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,444 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.804, 'ask': 4187.841, 'last': 0.0, 'time': 1760533006}
2025-10-15 12:56:47,444 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,445 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:47,466 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.86s
2025-10-15 12:56:47,468 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,469 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,469 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,470 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,471 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,471 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,471 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:47,472 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:47,472 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:47,472 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:47,473 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,474 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,476 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:47,477 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:47,498 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:47,499 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:47,500 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8036.000000000058}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97237.00000000054}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1730.000000000473}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26204.999999999927}]
2025-10-15 12:56:47,500 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:45+07:00
2025-10-15 12:56:47,501 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:56:47,501 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:47,502 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:56:47,503 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.90s
2025-10-15 12:56:47,546 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:47,656 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:47,657 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:47,657 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:56:47,658 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:47,658 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:47,661 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:47,661 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:47,663 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:47,665 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:47,793 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:47,793 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:47,794 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:47,795 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:47,795 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:47,796 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:47,797 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:47,797 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:47,797 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:47,798 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:47,798 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:47,799 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:47,800 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:47,800 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:47,801 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:48,302 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:48,304 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:48,304 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:48,806 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:48,807 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:48,808 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:48,808 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:48,809 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.81
2025-10-15 12:56:48,809 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.81
2025-10-15 12:56:48,814 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 339, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:48,823 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 339, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:48,927 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 446, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:48,934 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 446, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:48,934 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:48,934 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:48,935 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:48,936 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:48,938 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:48,940 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:48,940 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:48,941 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:48,941 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:48,942 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:48,942 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:48,943 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:48,951 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:48,966 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:48,967 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:48,968 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:48,968 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:48,968 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:48,969 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:48,969 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:48,971 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:48,973 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:48,974 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:48,975 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:48,975 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:48,976 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:48,976 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:48,977 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:49,001 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:49,003 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:49,004 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:49,005 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:49,006 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:49,006 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:49,006 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:49,007 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:49,020 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:49,034 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:49,035 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:49,035 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:49,036 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:49,036 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:49,037 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:49,038 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:49,038 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:48+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:49,038 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:48+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:49,039 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:48+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:49,061 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:48+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:49,062 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:48+07:00
2025-10-15 12:56:49,063 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:48+07:00
2025-10-15 12:56:49,063 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:48+07:00 trong DST: True
2025-10-15 12:56:49,063 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:48+07:00 trong DST: True
2025-10-15 12:56:49,064 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:49,064 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:49,065 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:49,065 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:49,065 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:49,066 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:49,067 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:49,069 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:49,073 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.365906265631
2025-10-15 12:56:49,093 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.365906265631
2025-10-15 12:56:49,097 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.365906265631, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:49,105 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.365906265631, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:49,121 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:49,123 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:49,124 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.085860268829
2025-10-15 12:56:49,124 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.085860268829
2025-10-15 12:56:49,124 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:49,125 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:49,125 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.107844277216
2025-10-15 12:56:49,125 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.107844277216
2025-10-15 12:56:49,126 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:49,126 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:49,127 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.7653423561815
2025-10-15 12:56:49,127 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.7653423561815
2025-10-15 12:56:49,127 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:49,128 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:49,128 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.868096048185
2025-10-15 12:56:49,129 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.868096048185
2025-10-15 12:56:49,129 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:49,131 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:49,131 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.39116255853
2025-10-15 12:56:49,132 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.39116255853
2025-10-15 12:56:49,133 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:49,142 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:49,147 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.312560147721
2025-10-15 12:56:49,152 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.312560147721
2025-10-15 12:56:49,154 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:49,155 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:49,155 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.545728558585
2025-10-15 12:56:49,156 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.545728558585
2025-10-15 12:56:49,156 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:49,156 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:49,157 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3044989111318
2025-10-15 12:56:49,157 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3044989111318
2025-10-15 12:56:49,158 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.085860268829, 'ema200': 4194.107844277216}, 'M5': {'ema50': 4194.7653423561815, 'ema200': 4182.868096048185}, 'M15': {'ema50': 4187.39116255853, 'ema200': 4157.312560147721}, 'H1': {'ema50': 4140.545728558585, 'ema200': 4073.3044989111318}}
2025-10-15 12:56:49,158 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.085860268829, 'ema200': 4194.107844277216}, 'M5': {'ema50': 4194.7653423561815, 'ema200': 4182.868096048185}, 'M15': {'ema50': 4187.39116255853, 'ema200': 4157.312560147721}, 'H1': {'ema50': 4140.545728558585, 'ema200': 4073.3044989111318}}
2025-10-15 12:56:49,159 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:49,159 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:49,160 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:49,160 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:49,161 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:49,162 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:49,163 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:49,164 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:49,164 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:49,165 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:49,168 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:49,188 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:49,189 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:49,190 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:49,191 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:49,191 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:49,192 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:49,192 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:49,193 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:49,194 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:49,194 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.81, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:49,195 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.81, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:49,196 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:49,197 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:49,220 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:49,222 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:49,223 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:49,223 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:49,224 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:49,224 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:49,225 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8005.000000000109
2025-10-15 12:56:49,226 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8005.000000000109
2025-10-15 12:56:49,226 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97206.00000000058
2025-10-15 12:56:49,229 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97206.00000000058
2025-10-15 12:56:49,248 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1699.0000000005239
2025-10-15 12:56:49,249 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1699.0000000005239
2025-10-15 12:56:49,250 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26173.999999999978
2025-10-15 12:56:49,250 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26173.999999999978
2025-10-15 12:56:49,251 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:49,251 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:49,251 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8005.000000000109}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97206.00000000058}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1699.0000000005239}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26173.999999999978}]
2025-10-15 12:56:49,252 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8005.000000000109}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97206.00000000058}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1699.0000000005239}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26173.999999999978}]
2025-10-15 12:56:49,252 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:49,253 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:49,253 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:49,254 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:49,256 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:49,257 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:49,257 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:49,257 - APP.services.mt5_service - DEBUG - Position in day range: 0.526381987577648
2025-10-15 12:56:49,258 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:49,258 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:48+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:49,258 - APP.services.mt5_service - DEBUG - Position in day range: 0.526381987577648
2025-10-15 12:56:49,264 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:48+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:49,266 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:48+07:00
2025-10-15 12:56:49,271 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:48+07:00
2025-10-15 12:56:49,273 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:48+07:00 trong DST: True
2025-10-15 12:56:49,275 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:48+07:00 trong DST: True
2025-10-15 12:56:49,278 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:49,281 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:49,282 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:49,283 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:49,284 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:49,284 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:49,285 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,285 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,285 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,286 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,286 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8100', 'price': 4187.81, 'distance_pips': 0.0}, {'level': '8125', 'price': 4187.812, 'distance_pips': 0.25}, {'level': '8150', 'price': 4187.815, 'distance_pips': 0.5}, {'level': '8175', 'price': 4187.818, 'distance_pips': 0.75}]
2025-10-15 12:56:49,287 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8100', 'price': 4187.81, 'distance_pips': 0.0}, {'level': '8125', 'price': 4187.812, 'distance_pips': 0.25}, {'level': '8150', 'price': 4187.815, 'distance_pips': 0.5}, {'level': '8175', 'price': 4187.818, 'distance_pips': 0.75}]
2025-10-15 12:56:49,288 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:49,288 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:49,288 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,289 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,289 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,290 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,290 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:49,312 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:49,313 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.81
2025-10-15 12:56:49,314 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.81
2025-10-15 12:56:49,315 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:49,316 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:49,316 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:49,317 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:49,318 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:49,319 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:49,319 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:49,320 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:49,320 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:49,321 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:49,324 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.81
2025-10-15 12:56:49,327 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.81
2025-10-15 12:56:49,335 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:49,341 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:49,344 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:49,345 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:49,346 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:49,347 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:49,347 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:49,348 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:49,348 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:49,349 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:49,350 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.81
2025-10-15 12:56:49,351 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:49,351 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:49,352 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:49,365 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.81
2025-10-15 12:56:49,367 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:49,371 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:49,374 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:49,376 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:49,377 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.81
2025-10-15 12:56:49,378 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:49,379 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:49,379 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:49,380 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:49,380 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:49,382 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:49,383 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:49,383 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.81
2025-10-15 12:56:49,384 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,387 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:49,391 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,393 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:49,395 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:49,397 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:49,398 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:49,400 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:49,402 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:49,405 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,407 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:49,408 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,408 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:49,409 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:49,409 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:49,410 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:49,410 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:49,411 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:49,412 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:49,413 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:49,413 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:49,413 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:49,414 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:49,414 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:49,422 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:49,424 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:49,425 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:49,428 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:49,429 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:49,430 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:49,431 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:49,432 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:49,436 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:49,437 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,437 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:49,437 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,438 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:49,438 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:49,439 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:49,439 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:49,439 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:49,440 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:49,440 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:49,440 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:49,441 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:49,441 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:49,443 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:49,443 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:49,444 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,444 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:49,445 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,458 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:49,461 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:49,465 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:49,467 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:49,468 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,469 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:49,469 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.81, 'ask': 4187.847, 'last': 0.0, 'time': 1760533008}
2025-10-15 12:56:49,470 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:49,470 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:49,471 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:49,471 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.81s
2025-10-15 12:56:49,472 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:49,476 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,477 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:56:49,477 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:56:49,477 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.81, 'ask': 4187.847, 'last': 0.0, 'time': 1760533008}
2025-10-15 12:56:49,493 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:56:49,494 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:56:49,496 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:56:49,498 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:56:49,499 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,499 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,500 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 339, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:49,500 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 446, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:49,500 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:49,500 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,515 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,525 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,532 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,550 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,563 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,577 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,609 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,652 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:49,695 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:49,701 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:49,708 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:49,709 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,710 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,710 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:49,710 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:49,712 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:49,713 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:49,714 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:49,786 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:49,788 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8005.000000000109}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97206.00000000058}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1699.0000000005239}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26173.999999999978}]
2025-10-15 12:56:49,790 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:48+07:00
2025-10-15 12:56:49,797 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:56:49,808 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:49,810 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:56:49,814 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.15s
2025-10-15 12:56:49,896 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:49,897 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:49,897 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:56:49,898 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:49,899 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:49,968 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:49,969 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:49,970 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:49,970 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:49,971 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:49,971 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:49,972 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:49,972 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:50,474 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:50,476 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:50,477 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:50,478 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.771
2025-10-15 12:56:50,482 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 336, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:50,529 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:50,530 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:50,531 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:50,533 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:50,533 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:50,533 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:50,534 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:50,537 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:50,538 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:50,538 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:50,538 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:50,544 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:50,563 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:50,564 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:50,564 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:50,567 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:50,570 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:50,570 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:50,597 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:50,601 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:50,623 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:50,624 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:50,625 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:50,625 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:50+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:50,626 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:50+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:50,626 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:50+07:00
2025-10-15 12:56:50,627 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:50+07:00 trong DST: True
2025-10-15 12:56:50,627 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:50,628 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:50,628 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:50,629 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:50,629 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.365680286623
2025-10-15 12:56:50,634 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.365680286623, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:50,655 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:50,655 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.084330857064
2025-10-15 12:56:50,656 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:50,656 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.1074562175145
2025-10-15 12:56:50,657 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:50,657 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.763812944417
2025-10-15 12:56:50,658 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:50,658 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.867707988484
2025-10-15 12:56:50,658 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:50,659 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.389633146765
2025-10-15 12:56:50,659 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:50,660 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.31217208802
2025-10-15 12:56:50,660 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:50,660 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.54557169584
2025-10-15 12:56:50,661 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:50,662 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3044591101366
2025-10-15 12:56:50,662 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.084330857064, 'ema200': 4194.1074562175145}, 'M5': {'ema50': 4194.763812944417, 'ema200': 4182.867707988484}, 'M15': {'ema50': 4187.389633146765, 'ema200': 4157.31217208802}, 'H1': {'ema50': 4140.54557169584, 'ema200': 4073.3044591101366}}
2025-10-15 12:56:50,663 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:50,664 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:50,672 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:50,686 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:50,686 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:50,687 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:50,688 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:50,688 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:50,689 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:50,689 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:50,690 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.771, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:50,690 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:50,691 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:50,691 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:50,692 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:50,693 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7965.99999999944
2025-10-15 12:56:50,694 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97166.99999999991
2025-10-15 12:56:50,694 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1659.9999999998545
2025-10-15 12:56:50,695 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26134.99999999931
2025-10-15 12:56:50,695 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:50,695 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7965.99999999944}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97166.99999999991}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1659.9999999998545}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26134.99999999931}]
2025-10-15 12:56:50,696 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:50,717 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:50,718 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:50,719 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:50,719 - APP.services.mt5_service - DEBUG - Position in day range: 0.5257763975155259
2025-10-15 12:56:50,720 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:50+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:50,720 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:50,720 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:50+07:00
2025-10-15 12:56:50,723 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:50,723 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:50+07:00 trong DST: True
2025-10-15 12:56:50,724 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:50,725 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:50,726 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:50,727 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:50,728 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:50,747 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7700', 'price': 4187.77, 'distance_pips': 0.1}, {'level': '7725', 'price': 4187.773, 'distance_pips': 0.15}, {'level': '7750', 'price': 4187.775, 'distance_pips': 0.4}, {'level': '7775', 'price': 4187.778, 'distance_pips': 0.65}]
2025-10-15 12:56:50,749 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:50,750 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:50,751 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:50,751 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:50,752 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.771
2025-10-15 12:56:50,753 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:50,754 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:50,756 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:50,758 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:50,758 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:50,782 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.771
2025-10-15 12:56:50,783 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:50,784 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:50,785 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:50,786 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:50,786 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:50,788 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.771
2025-10-15 12:56:50,790 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:50,790 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:50,803 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:50,811 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:50,812 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:50,814 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:50,815 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:50,868 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:50,869 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:50,870 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:50,870 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:50,871 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:50,872 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:50,873 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.771
2025-10-15 12:56:50,874 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:50,875 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:50,876 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:50,877 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:50,877 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:50,879 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:50,879 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:50,913 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:50,968 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:50,981 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.01s
2025-10-15 12:56:50,991 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:51,315 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:56:51,316 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:56:51,374 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:51,376 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:51,376 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:51,377 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:51,377 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:51,378 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:51,378 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:51,378 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:51,379 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:51,379 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:51,381 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.06s
2025-10-15 12:56:51,381 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:51,383 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:51,384 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.806
2025-10-15 12:56:51,385 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:51,385 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:51,386 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:51,386 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:51,386 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:51,387 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:51,387 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:51,392 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 335, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:51,393 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:51,405 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:51,440 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:56:51,440 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:51,455 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:51,467 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:51,468 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:51,468 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:51,469 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:51,469 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:51,471 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:51,471 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:51,472 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:51,472 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:51,473 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:51,475 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:51,475 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:51,476 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:51,479 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:51,485 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:51,487 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:51,488 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.771, 'ask': 4187.808, 'last': 0.0, 'time': 1760533010}
2025-10-15 12:56:51,489 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:51,491 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:51,494 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:51,498 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.79s
2025-10-15 12:56:51,500 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:51,501 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:51,501 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:51,502 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:51,503 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:51,504 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:51,504 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:51,505 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:51,519 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:51,528 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:51,529 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:51,530 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:51,530 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:50+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:51,531 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:50+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:51,531 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:50+07:00
2025-10-15 12:56:51,532 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:50+07:00 trong DST: True
2025-10-15 12:56:51,532 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:51,532 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:51,533 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:51,534 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:51,534 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.365666072812
2025-10-15 12:56:51,541 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.365666072812, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:51,549 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:51,551 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.085703406084
2025-10-15 12:56:51,553 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:51,554 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.107804476221
2025-10-15 12:56:51,555 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:51,557 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.765185493437
2025-10-15 12:56:51,560 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:51,560 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:51,641 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86805624719
2025-10-15 12:56:51,689 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:51,696 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.391005695785
2025-10-15 12:56:51,696 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:51,697 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.312520346726
2025-10-15 12:56:51,698 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:51,704 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.54557169584
2025-10-15 12:56:51,723 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:51,725 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3044591101366
2025-10-15 12:56:51,750 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.085703406084, 'ema200': 4194.107804476221}, 'M5': {'ema50': 4194.765185493437, 'ema200': 4182.86805624719}, 'M15': {'ema50': 4187.391005695785, 'ema200': 4157.312520346726}, 'H1': {'ema50': 4140.54557169584, 'ema200': 4073.3044591101366}}
2025-10-15 12:56:51,752 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:51,754 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:51,758 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:51,789 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:51,822 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:51,823 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:51,825 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:51,825 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:51,829 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:51,830 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:51,831 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.806, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:51,832 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:51,834 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:51,834 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:51,840 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:51,841 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8000.999999999294
2025-10-15 12:56:51,842 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97201.99999999977
2025-10-15 12:56:51,843 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1694.999999999709
2025-10-15 12:56:51,844 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26169.999999999163
2025-10-15 12:56:51,845 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:51,847 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8000.999999999294}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97201.99999999977}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1694.999999999709}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26169.999999999163}]
2025-10-15 12:56:51,848 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:51,851 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:51,871 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:51,872 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:51,873 - APP.services.mt5_service - DEBUG - Position in day range: 0.5263198757763932
2025-10-15 12:56:51,874 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:50+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:51,875 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:50+07:00
2025-10-15 12:56:51,876 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:50+07:00 trong DST: True
2025-10-15 12:56:51,876 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:51,877 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:51,878 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:51,878 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:51,879 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:51,880 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8000', 'price': 4187.8, 'distance_pips': 0.6}, {'level': '8025', 'price': 4187.802, 'distance_pips': 0.35}, {'level': '8050', 'price': 4187.805, 'distance_pips': 0.1}, {'level': '8075', 'price': 4187.807, 'distance_pips': 0.15}]
2025-10-15 12:56:51,880 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:51,892 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:51,906 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:51,909 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:51,909 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:51,910 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:51,911 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.806
2025-10-15 12:56:51,914 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:51,935 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:51,940 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:51,941 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:51,942 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:51,942 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:51,943 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:51,947 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:51,950 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:51,971 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:51,972 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:51,972 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:51,973 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.806
2025-10-15 12:56:51,976 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:52,002 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:52,004 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:52,005 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:52,005 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:52,007 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:52,008 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.806
2025-10-15 12:56:52,018 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:52,032 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:52,033 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:52,034 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:52,034 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:52,035 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.806
2025-10-15 12:56:52,036 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:52,040 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:52,064 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:52,065 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:52,065 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,066 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,066 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:52,504 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:52,505 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:52,506 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:52,506 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:52,507 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:52,507 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:52,507 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:52,508 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:52,508 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:52,508 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:52,509 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:52,509 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:52,509 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.813
2025-10-15 12:56:52,510 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:52,510 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:52,511 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:52,511 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:52,512 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:52,512 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:52,512 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,517 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 334, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:52,517 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,529 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:52,539 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:52,566 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:52,573 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:52,590 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:52,591 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:52,592 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:52,592 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:52,596 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:52,596 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:52,598 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:56:52,598 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:52,598 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:56:52,601 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,621 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.806, 'ask': 4187.843, 'last': 0.0, 'time': 1760533010}
2025-10-15 12:56:52,625 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:56:52,625 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:52,626 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:56:52,627 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:56:52,627 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:52,628 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:56:52,632 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:52,647 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,654 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:52,655 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,655 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:52,656 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 335, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:52,656 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:52,656 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:52,659 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:52,659 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,660 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:52,660 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,661 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:52,661 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,662 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:52,662 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,667 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:52,688 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,689 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:52,689 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,690 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:52,690 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,691 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:52,691 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,695 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:52,726 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:52,738 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:52,747 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:52,748 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:52,749 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:52,750 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:52,750 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:51+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:52,751 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:52,751 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:51+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:52,752 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,752 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:51+07:00
2025-10-15 12:56:52,752 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,753 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:51+07:00 trong DST: True
2025-10-15 12:56:52,753 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:52,754 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:52,756 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:52,756 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:52,757 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:52,757 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,776 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:52,778 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,779 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.3655676769595
2025-10-15 12:56:52,779 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8000.999999999294}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97201.99999999977}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1694.999999999709}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26169.999999999163}]
2025-10-15 12:56:52,782 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.3655676769595, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:52,782 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:50+07:00
2025-10-15 12:56:52,783 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:52,784 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:56:52,785 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.086919092359
2025-10-15 12:56:52,786 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:52,786 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:52,787 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:56:52,788 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.108112933932
2025-10-15 12:56:52,789 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:52,791 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.7664011797115
2025-10-15 12:56:52,803 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.08s
2025-10-15 12:56:52,814 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:52,816 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.868364704901
2025-10-15 12:56:52,816 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:52,817 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.392221382059
2025-10-15 12:56:52,817 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:52,817 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.312828804437
2025-10-15 12:56:52,818 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:52,821 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.546787382115
2025-10-15 12:56:52,821 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:52,822 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.304767567848
2025-10-15 12:56:52,830 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:52,841 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.086919092359, 'ema200': 4194.108112933932}, 'M5': {'ema50': 4194.7664011797115, 'ema200': 4182.868364704901}, 'M15': {'ema50': 4187.392221382059, 'ema200': 4157.312828804437}, 'H1': {'ema50': 4140.546787382115, 'ema200': 4073.304767567848}}
2025-10-15 12:56:52,842 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:52,843 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:52,843 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:56:52,844 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:52,844 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:52,845 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:52,845 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:52,846 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:52,846 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:52,846 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:52,847 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:52,848 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:52,849 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:52,849 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:52,852 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.813, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:52,853 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:52,877 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:52,878 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:52,878 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:52,879 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8007.999999999811
2025-10-15 12:56:52,879 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97209.00000000029
2025-10-15 12:56:52,880 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1702.0000000002256
2025-10-15 12:56:52,880 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26176.99999999968
2025-10-15 12:56:52,880 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:52,909 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8007.999999999811}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97209.00000000029}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1702.0000000002256}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26176.99999999968}]
2025-10-15 12:56:52,910 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:52,911 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:52,932 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:52,934 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:52,934 - APP.services.mt5_service - DEBUG - Position in day range: 0.5264285714285751
2025-10-15 12:56:52,935 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:51+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:52,935 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:51+07:00
2025-10-15 12:56:52,936 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:51+07:00 trong DST: True
2025-10-15 12:56:52,936 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:52,936 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:52,937 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:52,938 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:52,940 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:52,941 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,941 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,942 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8100', 'price': 4187.81, 'distance_pips': 0.3}, {'level': '8125', 'price': 4187.812, 'distance_pips': 0.05}, {'level': '8150', 'price': 4187.815, 'distance_pips': 0.2}, {'level': '8175', 'price': 4187.818, 'distance_pips': 0.45}]
2025-10-15 12:56:52,942 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:52,966 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:52,968 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:52,969 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:52,969 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:52,970 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:52,970 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:52,971 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:52,972 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.813
2025-10-15 12:56:52,972 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:52,973 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:52,976 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:52,977 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:53,001 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:53,002 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:53,003 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:53,004 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:53,004 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:53,005 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.813
2025-10-15 12:56:53,006 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:53,007 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:53,008 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:53,009 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:53,009 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:53,033 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.813
2025-10-15 12:56:53,034 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:53,034 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:53,035 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:53,035 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:53,037 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:53,038 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.813
2025-10-15 12:56:53,038 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:53,039 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:53,040 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:53,064 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:53,064 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:53,065 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:53,065 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:53,504 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:53,506 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:53,506 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:53,507 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:53,507 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:53,508 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:53,508 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:53,508 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:53,509 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:53,509 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:53,510 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:53,510 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:53,510 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.306
2025-10-15 12:56:53,511 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:53,511 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:53,512 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:53,512 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:53,513 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:53,513 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:53,513 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:53,518 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 334, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:53,519 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:53,531 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:53,569 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:53,576 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:53,590 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:53,591 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:53,592 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:53,592 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:53,593 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:53,595 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:53,596 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:53,596 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:53,597 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:53,597 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:53,598 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:53,599 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:53,599 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:53,605 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:53,622 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:53,623 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:53,623 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.813, 'ask': 4187.85, 'last': 0.0, 'time': 1760533011}
2025-10-15 12:56:53,624 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:53,624 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:53,625 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:53,625 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.72s
2025-10-15 12:56:53,627 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:53,628 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:53,629 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:53,629 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:53,632 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:53,632 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:53,633 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:53,633 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:53,657 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:53,658 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:53,659 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:53,659 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:53,660 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:53+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:53,660 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:53+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:53,661 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:53+07:00
2025-10-15 12:56:53,687 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:53+07:00 trong DST: True
2025-10-15 12:56:53,688 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:53,689 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:53,689 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:53,690 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:53,691 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.365396406954
2025-10-15 12:56:53,695 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.365396406954, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:53,695 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:53,696 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:53,723 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.105311249221
2025-10-15 12:56:53,802 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:53,846 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.1127796005985
2025-10-15 12:56:53,857 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:53,860 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.784793336574
2025-10-15 12:56:53,903 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:53,905 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.873031371568
2025-10-15 12:56:53,906 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:53,907 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.410613538922
2025-10-15 12:56:53,909 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:53,910 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.317495471104
2025-10-15 12:56:53,911 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:53,912 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.565179538978
2025-10-15 12:56:53,945 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:53,946 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.309434234515
2025-10-15 12:56:53,974 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.105311249221, 'ema200': 4194.1127796005985}, 'M5': {'ema50': 4194.784793336574, 'ema200': 4182.873031371568}, 'M15': {'ema50': 4187.410613538922, 'ema200': 4157.317495471104}, 'H1': {'ema50': 4140.565179538978, 'ema200': 4073.309434234515}}
2025-10-15 12:56:54,002 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:54,041 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:54,042 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:54,044 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:54,045 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:54,047 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:54,048 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:54,048 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:54,049 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:54,049 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:54,050 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:54,050 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:54,051 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.306, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:54,051 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:54,052 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:54,052 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:54,052 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:54,053 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8500.999999999294
2025-10-15 12:56:54,053 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97701.99999999977
2025-10-15 12:56:54,054 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 2194.999999999709
2025-10-15 12:56:54,054 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26669.999999999163
2025-10-15 12:56:54,055 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:54,055 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8500.999999999294}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97701.99999999977}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2194.999999999709}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26669.999999999163}]
2025-10-15 12:56:54,056 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:54,057 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:54,058 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:54,058 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:54,059 - APP.services.mt5_service - DEBUG - Position in day range: 0.5340838509316727
2025-10-15 12:56:54,059 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:53+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:54,059 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:53+07:00
2025-10-15 12:56:54,060 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:54,060 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:53+07:00 trong DST: True
2025-10-15 12:56:54,061 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:54,061 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:54,062 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:54,062 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:54,063 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:54,063 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:54,064 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:54,064 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,065 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:54,065 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,066 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:54,066 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3000', 'price': 4188.3, 'distance_pips': 0.6}, {'level': '3025', 'price': 4188.302, 'distance_pips': 0.35}, {'level': '3050', 'price': 4188.305, 'distance_pips': 0.1}, {'level': '3075', 'price': 4188.307, 'distance_pips': 0.15}]
2025-10-15 12:56:54,067 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:54,068 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:54,072 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,094 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,094 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:54,095 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.306
2025-10-15 12:56:54,096 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:54,096 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:54,097 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:54,097 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:54,098 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:54,098 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.306
2025-10-15 12:56:54,100 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:54,100 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:54,101 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:54,102 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:54,102 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:54,124 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.306
2025-10-15 12:56:54,124 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:54,125 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:54,126 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:54,126 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:54,127 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:54,127 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.306
2025-10-15 12:56:54,128 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:54,128 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:54,129 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:54,129 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:54,130 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,131 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,132 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:54,572 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:54,574 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:54,574 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:54,575 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:54,575 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:54,576 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:54,576 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:54,576 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:54,577 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:54,577 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:54,577 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:54,578 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:54,578 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.11
2025-10-15 12:56:54,578 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:54,579 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:54,580 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:54,580 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:54,580 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:54,581 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:54,581 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,586 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 333, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:54,587 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,598 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:54,630 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:54,645 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:54,656 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:54,656 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:54,657 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:54,657 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:54,658 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:54,660 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:54,661 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:54,661 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:54,663 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:54,664 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:56:54,664 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,664 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:56:54,665 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:54,683 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.306, 'ask': 4188.343, 'last': 0.0, 'time': 1760533013}
2025-10-15 12:56:54,685 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:56:54,687 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:56:54,690 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:54,691 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:56:54,692 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:56:54,692 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:54,692 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,694 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:54,694 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,695 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:54,695 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 334, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:54,718 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:54,719 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:54,719 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:54,719 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,720 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:54,720 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,721 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:54,721 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,724 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:54,725 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,725 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:54,726 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,727 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:54,727 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,752 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:54,753 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,757 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:54,758 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,782 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:54,783 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:54,784 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:54,784 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:54,785 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:54,785 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:54,786 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:54+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:54,789 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:54,789 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:54+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:54,790 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,812 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:54+07:00
2025-10-15 12:56:54,814 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,814 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:54+07:00 trong DST: True
2025-10-15 12:56:54,815 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:54,815 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:54,816 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:54,816 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:54,817 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,817 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:54,818 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,820 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:54,820 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8500.999999999294}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97701.99999999977}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2194.999999999709}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26669.999999999163}]
2025-10-15 12:56:54,843 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.364789485608
2025-10-15 12:56:54,844 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:53+07:00
2025-10-15 12:56:54,847 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.364789485608, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:54,848 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:56:54,848 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:54,850 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:54,851 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.097624974711
2025-10-15 12:56:54,852 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:56:54,877 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:54,878 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.94s
2025-10-15 12:56:54,879 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.110829351843
2025-10-15 12:56:54,879 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:54,880 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.777107062064
2025-10-15 12:56:54,881 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:54,881 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.871081122812
2025-10-15 12:56:54,882 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:54,883 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.402927264412
2025-10-15 12:56:54,883 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:54,887 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.315545222348
2025-10-15 12:56:54,901 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:54,905 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.557493264468
2025-10-15 12:56:54,906 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:54,907 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3074839857586
2025-10-15 12:56:54,907 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.097624974711, 'ema200': 4194.110829351843}, 'M5': {'ema50': 4194.777107062064, 'ema200': 4182.871081122812}, 'M15': {'ema50': 4187.402927264412, 'ema200': 4157.315545222348}, 'H1': {'ema50': 4140.557493264468, 'ema200': 4073.3074839857586}}
2025-10-15 12:56:54,908 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:54,909 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:54,909 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:54,910 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:54,910 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:54,910 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:54,911 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:54,912 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:54,913 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:54,913 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:54,914 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.11, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:54,914 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:54,915 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:54,934 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:54,936 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:54,936 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8304.999999999382
2025-10-15 12:56:54,937 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97505.99999999985
2025-10-15 12:56:54,938 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1998.9999999997963
2025-10-15 12:56:54,938 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26473.99999999925
2025-10-15 12:56:54,939 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:54,939 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8304.999999999382}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97505.99999999985}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1998.9999999997963}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26473.99999999925}]
2025-10-15 12:56:54,940 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:54,940 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:54,941 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:54,941 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:54,941 - APP.services.mt5_service - DEBUG - Position in day range: 0.5310403726708045
2025-10-15 12:56:54,942 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:54+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:54,942 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:54+07:00
2025-10-15 12:56:54,942 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:54+07:00 trong DST: True
2025-10-15 12:56:54,945 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:54,945 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:54,946 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:54,948 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,964 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,964 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '1000', 'price': 4188.1, 'distance_pips': 1.0}, {'level': '1025', 'price': 4188.102, 'distance_pips': 0.75}, {'level': '1050', 'price': 4188.105, 'distance_pips': 0.5}, {'level': '1075', 'price': 4188.108, 'distance_pips': 0.25}]
2025-10-15 12:56:54,965 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:54,965 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:54,966 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:54,966 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:54,966 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.11
2025-10-15 12:56:54,967 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:54,967 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:54,968 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:54,969 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:54,969 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:54,970 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.11
2025-10-15 12:56:54,970 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:54,970 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:54,971 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:54,972 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:54,972 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:54,973 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.11
2025-10-15 12:56:54,973 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:54,973 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:54,975 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:54,976 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:54,976 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:54,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.11
2025-10-15 12:56:54,977 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:54,977 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:54,998 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:54,999 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:55,001 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:55,001 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:56:55,002 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:55,002 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:55,003 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:55,003 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:55,004 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:55,004 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:55,005 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:55,006 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:55,006 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:55,007 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:55,009 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:55,032 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:55,033 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:55,033 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:55,034 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:55,034 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:55,034 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:55,035 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:55,035 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:55,035 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:55,036 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:55,040 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:55,064 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:55,065 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:55,066 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:55,066 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:55,067 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:55,068 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:55,096 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:55,097 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:55,099 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:55,111 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:55,124 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:55,124 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:55,125 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:55,125 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.11, 'ask': 4188.147, 'last': 0.0, 'time': 1760533014}
2025-10-15 12:56:55,126 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:55,126 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.08s
2025-10-15 12:56:55,129 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:55,130 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:55,130 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:55,132 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:55,134 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:55,153 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:55,153 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:55,154 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:55,223 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:55,655 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:55,657 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:55,658 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:55,658 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.045
2025-10-15 12:56:55,664 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 333, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:55,706 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:55,712 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:55,714 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:55,716 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:55,717 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:55,717 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:55,718 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:55,721 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:55,721 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:55,721 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:55,722 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:55,723 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:55,727 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:55,728 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:55,749 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:55,751 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:55,751 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:55,752 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:55,753 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:55,758 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:55,782 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:55,784 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:55,784 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:55,785 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:55+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:55,785 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:55+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:55,785 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:55+07:00
2025-10-15 12:56:55,786 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:55+07:00 trong DST: True
2025-10-15 12:56:55,786 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:55,787 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:55,787 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:55,794 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:55,815 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.364510082789
2025-10-15 12:56:55,819 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.364510082789, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:55,843 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:55,844 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.095075955103
2025-10-15 12:56:55,844 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:55,845 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.110182585673
2025-10-15 12:56:55,845 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:55,846 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.774558042456
2025-10-15 12:56:55,846 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:55,846 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.870434356642
2025-10-15 12:56:55,847 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:55,847 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.4003782448035
2025-10-15 12:56:55,847 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:55,848 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.3148984561785
2025-10-15 12:56:55,849 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:55,849 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.55494424486
2025-10-15 12:56:55,850 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:55,851 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3068372195894
2025-10-15 12:56:55,852 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.095075955103, 'ema200': 4194.110182585673}, 'M5': {'ema50': 4194.774558042456, 'ema200': 4182.870434356642}, 'M15': {'ema50': 4187.4003782448035, 'ema200': 4157.3148984561785}, 'H1': {'ema50': 4140.55494424486, 'ema200': 4073.3068372195894}}
2025-10-15 12:56:55,875 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:55,878 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:55,879 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:55,883 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:55,905 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:55,906 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:55,906 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:55,907 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:55,908 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:55,908 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:55,908 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.045, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:55,909 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:55,909 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:55,910 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:55,910 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:55,910 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8239.999999999782
2025-10-15 12:56:55,911 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97441.00000000026
2025-10-15 12:56:55,911 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1934.0000000001965
2025-10-15 12:56:55,912 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26408.99999999965
2025-10-15 12:56:55,913 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:55,941 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8239.999999999782}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97441.00000000026}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1934.0000000001965}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26408.99999999965}]
2025-10-15 12:56:55,942 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:55,958 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:55,961 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:55,963 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:55,964 - APP.services.mt5_service - DEBUG - Position in day range: 0.5300310559006244
2025-10-15 12:56:55,965 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:55+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:55,965 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:55+07:00
2025-10-15 12:56:55,966 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:55+07:00 trong DST: True
2025-10-15 12:56:55,966 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:55,967 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:55,967 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:55,968 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:55,968 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:55,969 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '400', 'price': 4188.04, 'distance_pips': 0.5}, {'level': '425', 'price': 4188.042, 'distance_pips': 0.25}, {'level': '450', 'price': 4188.045, 'distance_pips': 0.0}, {'level': '475', 'price': 4188.047, 'distance_pips': 0.25}]
2025-10-15 12:56:55,970 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:55,970 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:55,970 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:55,971 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:55,972 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.045
2025-10-15 12:56:55,972 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:55,973 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:55,974 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:55,978 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:56,003 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:56,004 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.045
2025-10-15 12:56:56,008 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:56,015 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:56,033 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:56,034 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:56,034 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:56,035 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.045
2025-10-15 12:56:56,036 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:56,036 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:56,037 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:56,039 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:56,040 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:56,054 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.045
2025-10-15 12:56:56,063 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:56,065 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:56,067 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:56,067 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:56,069 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:56,070 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:56,070 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:56,071 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:56,072 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:56,095 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:56,096 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:56,097 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:56,098 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:56,098 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:56,099 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:56,102 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:56,103 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:56,111 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:56,127 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:56,128 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:56:56,130 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:56,196 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:56,197 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.07s
2025-10-15 12:56:56,198 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:56,199 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:56,200 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:56,202 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:56,204 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:56,205 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:56,206 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:56,207 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:56,207 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:56,208 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:56,209 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:56,210 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:56,212 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:56:56,212 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:56:56,212 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:56,216 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:56:56,216 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.045, 'ask': 4188.082, 'last': 0.0, 'time': 1760533015}
2025-10-15 12:56:56,217 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:56:56,218 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:56:56,220 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:56:56,220 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:56,221 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:56,221 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 333, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:56,221 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:56,222 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:56,222 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:56,223 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:56,224 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:56,227 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:56,285 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:56,306 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:56,358 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:56,366 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:56,442 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:56,454 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:56,506 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:56,510 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:56,511 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:56,511 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:56:56,513 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:56,514 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:56,515 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:56,515 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:56,516 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:56,517 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:56,517 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:56,518 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:56,518 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:56,518 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:56,519 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:56,519 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:56,519 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8239.999999999782}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97441.00000000026}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1934.0000000001965}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26408.99999999965}]
2025-10-15 12:56:56,520 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:55+07:00
2025-10-15 12:56:56,520 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:56:56,521 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:56,522 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:56:56,531 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.43s
2025-10-15 12:56:56,566 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:56,574 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:56,577 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:56:56,578 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:56,578 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:57,017 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:57,018 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:57,019 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:57,020 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.979
2025-10-15 12:56:57,024 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 332, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:57,069 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:57,070 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:57,071 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:57,073 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:57,073 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:57,073 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:57,074 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:57,077 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:57,078 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:57,078 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:57,079 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:57,081 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:57,081 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:57,081 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:57,082 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:57,084 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:57,085 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:57,085 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:57,085 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:57,088 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:57,088 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:57,089 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:57,089 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:57,090 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:56+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:57,091 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:56+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:57,091 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:56+07:00
2025-10-15 12:56:57,092 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:56+07:00 trong DST: True
2025-10-15 12:56:57,092 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:57,092 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:57,093 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:57,094 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:57,094 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.364226676353
2025-10-15 12:56:57,098 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.364226676353, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:57,099 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:57,099 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.0924877198095
2025-10-15 12:56:57,100 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:57,101 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.109525869256
2025-10-15 12:56:57,102 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:57,103 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.771969807162
2025-10-15 12:56:57,103 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:57,124 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:57,125 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.869777640225
2025-10-15 12:56:57,127 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:57,127 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:57,128 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.39779000951
2025-10-15 12:56:57,128 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:57,129 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.314241739761
2025-10-15 12:56:57,129 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:57,130 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.552356009566
2025-10-15 12:56:57,132 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:57,134 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.306180503171
2025-10-15 12:56:57,157 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.0924877198095, 'ema200': 4194.109525869256}, 'M5': {'ema50': 4194.771969807162, 'ema200': 4182.869777640225}, 'M15': {'ema50': 4187.39779000951, 'ema200': 4157.314241739761}, 'H1': {'ema50': 4140.552356009566, 'ema200': 4073.306180503171}}
2025-10-15 12:56:57,158 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:57,159 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:57,160 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:57,160 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:57,161 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:57,163 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:57,164 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:57,165 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:57,187 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:57,187 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:57,188 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:57,189 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:57,189 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:57,190 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:57,191 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:57,191 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:57,192 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:57,192 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.979, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:57,193 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:57,194 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:57,195 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:57,196 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:57,196 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:57,197 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8173.999999999978
2025-10-15 12:56:57,221 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97375.00000000045
2025-10-15 12:56:57,221 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1868.000000000393
2025-10-15 12:56:57,222 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26342.999999999847
2025-10-15 12:56:57,222 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:57,223 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8173.999999999978}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97375.00000000045}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1868.000000000393}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26342.999999999847}]
2025-10-15 12:56:57,223 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:57,696 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:57,698 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:57,698 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:57,699 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:56:57,700 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:57,700 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.381
2025-10-15 12:56:57,701 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:57,706 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 332, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:57,707 - APP.services.mt5_service - DEBUG - Position in day range: 0.5290062111801305
2025-10-15 12:56:57,719 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:56+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:57,731 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:56+07:00
2025-10-15 12:56:57,768 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:56+07:00 trong DST: True
2025-10-15 12:56:57,775 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:57,780 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:57,781 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:56:57,781 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:57,782 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:57,782 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:57,784 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:56:57,784 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:57,785 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:57,785 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:57,785 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:56:57,786 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9700', 'price': 4187.97, 'distance_pips': 0.9}, {'level': '9725', 'price': 4187.972, 'distance_pips': 0.65}, {'level': '9750', 'price': 4187.975, 'distance_pips': 0.4}, {'level': '9775', 'price': 4187.977, 'distance_pips': 0.15}]
2025-10-15 12:56:57,789 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:56:57,789 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:57,797 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:56:57,813 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:57,814 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:57,815 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:57,816 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:56:57,816 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:57,817 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:56:57,817 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.979
2025-10-15 12:56:57,820 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:56:57,826 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:57,845 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:57,846 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:57,847 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:56:57,847 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:57,848 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:56:57,848 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:57,864 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:56:57,873 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:57,874 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:57,875 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.979
2025-10-15 12:56:57,875 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:56:57,876 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:57,877 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:56:57,877 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:57,880 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:57,881 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:57,881 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:56:57,882 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:57,882 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:56:57,883 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:57,884 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:56:57,887 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.979
2025-10-15 12:56:57,908 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:57+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:56:57,909 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:57,910 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:57+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:57,911 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:57,911 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:57+07:00
2025-10-15 12:56:57,912 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:57,913 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:57+07:00 trong DST: True
2025-10-15 12:56:57,914 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:57,914 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:57,935 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:57,938 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:57,938 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.979
2025-10-15 12:56:57,939 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:56:57,939 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:57,941 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:56:57,941 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:57,942 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.363934046891
2025-10-15 12:56:57,944 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:57,971 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.363934046891, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:56:57,972 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:57,972 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:57,973 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:57,973 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.108252425692
2025-10-15 12:56:57,973 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:57,974 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:57,975 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.113525869256
2025-10-15 12:56:57,976 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:56:57,976 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:57,977 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.787734513045
2025-10-15 12:56:57,977 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:58,000 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:56:58,002 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:58,002 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.873777640225
2025-10-15 12:56:58,002 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:58,003 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:56:58,003 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:58,004 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.413554715392
2025-10-15 12:56:58,004 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:58,004 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:56:58,005 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:58,005 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.318241739761
2025-10-15 12:56:58,006 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:58,007 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:56:58,007 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:58,009 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.5681207154485
2025-10-15 12:56:58,009 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:58,009 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:56:58,032 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:58,033 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:58,034 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3101805031715
2025-10-15 12:56:58,035 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:58,035 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.108252425692, 'ema200': 4194.113525869256}, 'M5': {'ema50': 4194.787734513045, 'ema200': 4182.873777640225}, 'M15': {'ema50': 4187.413554715392, 'ema200': 4157.318241739761}, 'H1': {'ema50': 4140.5681207154485, 'ema200': 4073.3101805031715}}
2025-10-15 12:56:58,036 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:58,036 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:56:58,064 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:58,064 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:56:58,065 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:58,066 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:58,066 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,067 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.436414633609636, TRs count: 119
2025-10-15 12:56:58,067 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,068 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:56:58,069 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:58,070 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:58,070 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:56:58,071 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:58,071 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:56:58,072 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:58,096 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:56:58,097 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:58,098 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.436414633609636, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:56:58,098 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:56:58,099 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:56:58,100 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:56:58,101 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.381, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:56:58,120 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:56:58,126 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:56:58,127 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:56:58,128 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:56:58,128 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,129 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:56:58,129 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.979, 'ask': 4188.016, 'last': 0.0, 'time': 1760533016}
2025-10-15 12:56:58,129 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:56:58,130 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:58,130 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8576.000000000022
2025-10-15 12:56:58,131 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.02s
2025-10-15 12:56:58,133 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97777.0000000005
2025-10-15 12:56:58,134 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 2270.0000000004366
2025-10-15 12:56:58,155 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26744.99999999989
2025-10-15 12:56:58,156 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:56:58,157 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8576.000000000022}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97777.0000000005}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2270.0000000004366}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26744.99999999989}]
2025-10-15 12:56:58,158 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:56:58,159 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:58,159 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:56:58,159 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:56:58,160 - APP.services.mt5_service - DEBUG - Position in day range: 0.5352484472049759
2025-10-15 12:56:58,160 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:57+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:56:58,160 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:57+07:00
2025-10-15 12:56:58,161 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:57+07:00 trong DST: True
2025-10-15 12:56:58,161 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:56:58,162 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:56:58,163 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:56:58,163 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,164 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,164 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3800', 'price': 4188.38, 'distance_pips': 0.1}, {'level': '3825', 'price': 4188.382, 'distance_pips': 0.15}, {'level': '3850', 'price': 4188.385, 'distance_pips': 0.4}, {'level': '3875', 'price': 4188.387, 'distance_pips': 0.65}]
2025-10-15 12:56:58,165 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:58,165 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,187 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,188 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:58,189 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.381
2025-10-15 12:56:58,190 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:58,190 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:58,190 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:58,191 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:58,270 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:56:58,301 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:56:58,311 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.381
2025-10-15 12:56:58,312 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:58,353 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:56:58,354 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:58,356 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:56:58,357 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:56:58,359 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.381
2025-10-15 12:56:58,361 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:58,364 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:56:58,366 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:58,367 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:56:58,368 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:56:58,371 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.381
2025-10-15 12:56:58,373 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:56:58,374 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:56:58,377 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:56:58,379 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:56:58,380 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,438 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,441 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:58,442 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:58,449 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:58,510 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:58,511 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:58,515 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:58,516 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:58,517 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:58,517 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:56:58,517 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:58,518 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:56:58,519 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:56:58,520 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:56:58,520 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:56:58,521 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:56:58,521 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:56:58,522 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,522 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,523 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:56:58,523 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:56:58,524 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:56:58,525 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:56:58,526 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:58,527 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:58,528 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,528 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:56:58,529 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:56:58,529 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.381, 'ask': 4188.418, 'last': 0.0, 'time': 1760533017}
2025-10-15 12:56:58,531 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:56:58,532 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:56:58,533 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:56:58,533 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:56:58,535 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,535 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,536 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 332, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:56:58,536 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:56:58,537 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,537 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,541 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,544 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,564 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,565 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,565 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,566 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,566 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:56:58,567 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:56:58,567 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:58,567 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:58,568 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,568 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,575 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:56:58,592 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:56:58,594 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:56:58,594 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:56:58,595 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8576.000000000022}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97777.0000000005}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2270.0000000004366}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26744.99999999989}]
2025-10-15 12:56:58,595 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:57+07:00
2025-10-15 12:56:58,595 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:56:58,596 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:58,597 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:56:58,603 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.48s
2025-10-15 12:56:58,637 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:56:58,656 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:56:58,657 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:56:58,658 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:56:58,658 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:56:59,128 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:59,128 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:56:59,130 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:59,132 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:56:59,138 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:59,138 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:59,139 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:59,139 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:59,140 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:59,140 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:59,141 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:59,141 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:56:59,142 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:59,142 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:56:59,143 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:59,144 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:56:59,144 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:59,145 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:56:59,145 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:56:59,647 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:56:59,648 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:56:59,649 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:00,150 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:00,152 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:00,153 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:00,153 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:00,154 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.334
2025-10-15 12:57:00,154 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.019
2025-10-15 12:57:00,161 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 334, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:00,169 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 334, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:00,297 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 444, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:00,304 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:00,304 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 444, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:00,305 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:00,306 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:00,308 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:00,308 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:00,308 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:00,310 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:00,311 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:00,311 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:00,312 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:00,312 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:00,315 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:00,315 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:00,316 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:00,320 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:00,321 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:00,322 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:00,324 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:00,344 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:00,347 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:00,347 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:00,348 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:00,351 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:00,353 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:00,373 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:00,373 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:00,375 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:00,376 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:00,376 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:00,377 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:00,378 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:00,380 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:00,381 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:00,406 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:00,408 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:00,409 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:00,410 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:00,410 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:00,410 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:00,414 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:00,415 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:00,416 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:00,442 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:59+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:00,442 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:00,469 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:59+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:00,470 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:59+07:00
2025-10-15 12:57:00,471 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:00,471 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:59+07:00 trong DST: True
2025-10-15 12:57:00,472 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:56:59+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:00,472 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:00,473 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:59+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:00,474 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:00,474 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:59+07:00
2025-10-15 12:57:00,475 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:00,477 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:00,477 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:59+07:00 trong DST: True
2025-10-15 12:57:00,499 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.320513972669
2025-10-15 12:57:00,500 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:00,505 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.320513972669, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:00,506 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:00,507 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:00,508 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:00,519 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:00,532 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.108470030061
2025-10-15 12:57:00,532 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.320513972669
2025-10-15 12:57:00,533 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:00,540 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.320513972669, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:00,540 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8290002865715
2025-10-15 12:57:00,560 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:00,561 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:00,562 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.7695776503
2025-10-15 12:57:00,562 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.108470030061
2025-10-15 12:57:00,563 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:00,563 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:00,564 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.869170675051
2025-10-15 12:57:00,564 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8290002865715
2025-10-15 12:57:00,565 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:00,565 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:00,566 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.395397852647
2025-10-15 12:57:00,566 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.7695776503
2025-10-15 12:57:00,567 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:00,567 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:00,568 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.313634774587
2025-10-15 12:57:00,569 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.869170675051
2025-10-15 12:57:00,592 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:00,593 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:00,594 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.5499638527035
2025-10-15 12:57:00,594 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.395397852647
2025-10-15 12:57:00,594 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:00,595 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:00,595 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.305573537997
2025-10-15 12:57:00,595 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.313634774587
2025-10-15 12:57:00,596 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.108470030061, 'ema200': 4194.8290002865715}, 'M5': {'ema50': 4194.7695776503, 'ema200': 4182.869170675051}, 'M15': {'ema50': 4187.395397852647, 'ema200': 4157.313634774587}, 'H1': {'ema50': 4140.5499638527035, 'ema200': 4073.305573537997}}
2025-10-15 12:57:00,596 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:00,597 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:00,597 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.548669735056
2025-10-15 12:57:00,598 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:00,598 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:00,599 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:00,599 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3052451797885
2025-10-15 12:57:00,601 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.2717761474465763, TRs count: 119
2025-10-15 12:57:00,603 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.108470030061, 'ema200': 4194.8290002865715}, 'M5': {'ema50': 4194.7695776503, 'ema200': 4182.869170675051}, 'M15': {'ema50': 4187.395397852647, 'ema200': 4157.313634774587}, 'H1': {'ema50': 4140.548669735056, 'ema200': 4073.3052451797885}}
2025-10-15 12:57:00,627 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:00,629 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:00,629 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:00,630 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:00,634 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:00,657 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:00,657 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:00,658 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.2717761474465763, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:00,658 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.2717761474465763, TRs count: 119
2025-10-15 12:57:00,659 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:00,660 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:00,660 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.334, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:00,661 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:00,661 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:00,662 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:00,662 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:00,664 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:00,689 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:00,690 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.2717761474465763, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:00,690 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:00,691 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:00,691 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8528.999999999542
2025-10-15 12:57:00,692 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.019, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:00,692 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97730.00000000001
2025-10-15 12:57:00,692 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:00,693 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 2222.9999999999563
2025-10-15 12:57:00,693 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:00,694 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26697.99999999941
2025-10-15 12:57:00,696 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:00,720 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:00,720 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:00,721 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8528.999999999542}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97730.00000000001}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2222.9999999999563}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26697.99999999941}]
2025-10-15 12:57:00,721 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8213.999999999942
2025-10-15 12:57:00,722 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:00,722 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97415.00000000042
2025-10-15 12:57:00,723 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:00,724 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1908.0000000003565
2025-10-15 12:57:00,726 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:00,727 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26382.99999999981
2025-10-15 12:57:00,727 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:00,734 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:00,748 - APP.services.mt5_service - DEBUG - Position in day range: 0.5345186335403722
2025-10-15 12:57:00,749 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8213.999999999942}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97415.00000000042}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1908.0000000003565}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26382.99999999981}]
2025-10-15 12:57:00,750 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:59+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:00,750 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:00,751 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:59+07:00
2025-10-15 12:57:00,751 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:00,752 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:59+07:00 trong DST: True
2025-10-15 12:57:00,752 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:00,753 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:00,753 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:00,754 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:00,754 - APP.services.mt5_service - DEBUG - Position in day range: 0.5296273291925523
2025-10-15 12:57:00,755 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:00,758 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:56:59+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:00,778 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:56:59+07:00
2025-10-15 12:57:00,780 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:00,781 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:56:59+07:00 trong DST: True
2025-10-15 12:57:00,782 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:00,782 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:00,782 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3300', 'price': 4188.33, 'distance_pips': 0.4}, {'level': '3325', 'price': 4188.332, 'distance_pips': 0.15}, {'level': '3350', 'price': 4188.335, 'distance_pips': 0.1}, {'level': '3375', 'price': 4188.337, 'distance_pips': 0.35}]
2025-10-15 12:57:00,783 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:00,783 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:00,784 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:00,784 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:00,784 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:00,785 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:00,785 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:00,786 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:00,786 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '100', 'price': 4188.01, 'distance_pips': 0.9}, {'level': '125', 'price': 4188.012, 'distance_pips': 0.65}, {'level': '150', 'price': 4188.015, 'distance_pips': 0.4}, {'level': '175', 'price': 4188.017, 'distance_pips': 0.15}]
2025-10-15 12:57:00,789 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.334
2025-10-15 12:57:00,790 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:00,791 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:00,815 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:00,816 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:00,817 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:00,818 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:00,820 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:00,821 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:00,822 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.019
2025-10-15 12:57:00,844 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:00,845 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:00,846 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.334
2025-10-15 12:57:00,847 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:00,847 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:00,848 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:00,849 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:00,849 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:00,852 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:00,854 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:00,879 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.019
2025-10-15 12:57:00,880 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:00,883 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:00,884 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:00,910 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:00,911 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.334
2025-10-15 12:57:00,912 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:00,914 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:00,916 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:00,941 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:00,943 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:00,946 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.019
2025-10-15 12:57:00,947 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:00,970 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:00,972 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:00,973 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:00,973 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:00,974 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:00,978 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:01,000 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.334
2025-10-15 12:57:01,001 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:01,002 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:01,003 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.019
2025-10-15 12:57:01,003 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:01,004 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:01,039 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:01,063 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:01,067 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:01,069 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:01,097 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,098 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:01,099 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,100 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,125 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:01,126 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,126 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:01,127 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:01,128 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:01,130 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:01,132 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:01,133 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:01,134 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:01,134 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:01,156 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:01,157 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:01,158 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:01,159 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:01,159 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:01,159 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:01,160 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:01,160 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:01,161 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:01,161 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:01,161 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:01,162 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:01,162 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:01,163 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:01,164 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:01,165 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:01,165 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,166 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:01,166 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,190 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:01,191 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:01,192 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:01,192 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:01,194 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:01,195 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:01,195 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:01,196 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:01,202 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,220 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:01,221 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,221 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:01,222 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:01,223 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:01,223 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:01,224 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:01,225 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:01,227 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:01,227 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:01,228 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:01,230 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,251 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.334, 'ask': 4188.371, 'last': 0.0, 'time': 1760533019}
2025-10-15 12:57:01,252 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:01,254 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:01,258 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:01,280 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:01,282 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:01,286 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:01,290 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,313 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,347 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:01,353 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 334, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:01,366 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:01,379 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:01,380 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 444, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:01,406 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:01,410 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:01,438 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,439 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.03s
2025-10-15 12:57:01,440 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,440 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:01,441 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,442 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.019, 'ask': 4188.056, 'last': 0.0, 'time': 1760533019}
2025-10-15 12:57:01,443 - APP.ui.app_ui - INFO - Phát hiện thư mục ảnh thay đổi, thực hiện quét lại và đoán symbol.
2025-10-15 12:57:01,443 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,445 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:01,446 - APP.ui.app_ui - DEBUG - Bắt đầu quá trình tải file từ thư mục: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots.
2025-10-15 12:57:01,468 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,468 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.34s
2025-10-15 12:57:01,470 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,470 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,471 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.scan_folder' vào nhóm 'ui.io.scan' (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 12:57:01,471 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,471 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.scan_folder vào group ui.io.scan (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 12:57:01,472 - APP.ui.app_ui - DEBUG - Luồng quét thư mục bắt đầu cho: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots.
2025-10-15 12:57:01,473 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,474 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:01,475 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:01,503 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:01,532 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:01,561 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:01,655 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,667 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,668 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:01,670 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:01,672 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:01,673 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:01,674 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8528.999999999542}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97730.00000000001}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2222.9999999999563}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26697.99999999941}]
2025-10-15 12:57:01,675 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:56:59+07:00
2025-10-15 12:57:01,675 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:01,676 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:01,677 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:01,679 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.55s
2025-10-15 12:57:01,729 - APP.ui.app_ui - INFO - Luồng quét đã hoàn tất, tìm thấy 3 file.
2025-10-15 12:57:01,733 - APP.utils.threading_utils - DEBUG - Task 'ui.io.scan_folder' (group=ui.io.scan) hoàn tất sau 0.26s
2025-10-15 12:57:01,837 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:01,838 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:01,839 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:01,841 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:01,842 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:01,846 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:57:01,847 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:57:01,848 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:57:01,848 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:01,849 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: refresh_all_lists
2025-10-15 12:57:01,849 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 12:57:01,849 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 12:57:01,851 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:57:01,853 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:57:01,854 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 12:57:01,857 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:57:01,865 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:57:01,870 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:01,873 - APP.ui.app_ui - INFO - Phát hiện symbol XAUUSD từ ảnh (auto=True, giữ symbol hiện tại XAUUSD).
2025-10-15 12:57:01,876 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:01,879 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 12:57:01,879 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 12:57:01,919 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 12:57:01,922 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 12:57:01,925 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.05s
2025-10-15 12:57:01,927 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.05s
2025-10-15 12:57:01,977 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:01,983 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:02,134 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:02,134 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:02,136 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:02,138 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:02,145 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:02,146 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:02,146 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:02,147 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:02,148 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:02,149 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:02,150 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:02,150 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:02,151 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:02,151 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:02,152 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:02,152 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:02,153 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:02,154 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:02,154 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:02,655 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:02,657 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:02,657 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:03,159 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:03,161 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:03,161 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:03,162 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:03,162 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.649
2025-10-15 12:57:03,163 - APP.services.mt5_service - DEBUG - Current price (cp): 4187.605
2025-10-15 12:57:03,169 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 333, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:03,237 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 333, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:03,376 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 444, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:03,403 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:03,409 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:03,415 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 444, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:03,418 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:03,444 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:03,464 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:03,468 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:03,470 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:03,475 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:03,477 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:03,498 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:03,502 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:03,502 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:03,503 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:03,503 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:03,504 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:03,528 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:03,531 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:03,532 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:03,534 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:03,535 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:03,535 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:03,536 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:03,536 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:03,540 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:03,541 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:03,561 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:03,564 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:03,565 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:03,565 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:03,566 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:03,566 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:03,568 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:03,570 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:03,570 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:03,578 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:03,592 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:03,594 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:03,595 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:03,596 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:03,599 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:03,626 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:03,627 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:03,627 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:02+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:03,628 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:03,629 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:02+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:03,629 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:03,630 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:02+07:00
2025-10-15 12:57:03,631 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:03+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:03,631 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:02+07:00 trong DST: True
2025-10-15 12:57:03,632 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:03+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:03,634 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:03+07:00
2025-10-15 12:57:03,635 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:03,636 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:03+07:00 trong DST: True
2025-10-15 12:57:03,658 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:03,658 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:03,659 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:03,659 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:03,661 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:03,661 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:03,662 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:03,665 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:03,689 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:03,689 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:03,690 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:03,695 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:03,696 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:03,697 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:03,717 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:03,718 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:03,719 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:03,720 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:03,720 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:03,721 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:03,721 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:03,721 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:03,722 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:03,722 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:03,723 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:03,723 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:03,723 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:03,724 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:03,725 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:03,727 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:03,727 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:03,728 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:03,728 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:03,729 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:03,729 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:03,729 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:03,752 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:03,753 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:03,754 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:03,754 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:03,754 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:03,755 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:03,755 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:03,756 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:03,758 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:03,758 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:03,759 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:03,759 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:03,780 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:03,781 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:03,781 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:03,782 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:03,783 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:03,783 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:03,784 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:03,785 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:03,785 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:03,786 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:03,786 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:03,787 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:03,789 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:03,790 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:03,790 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:03,801 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:03,814 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:03,814 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.605, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:03,816 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4187.649, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:03,816 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:03,817 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:03,817 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:03,818 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:03,819 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:03,819 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:03,820 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:03,820 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:03,821 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7799.999999999272
2025-10-15 12:57:03,821 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 7844.000000000051
2025-10-15 12:57:03,822 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97000.99999999975
2025-10-15 12:57:03,843 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97045.00000000052
2025-10-15 12:57:03,845 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1493.9999999996871
2025-10-15 12:57:03,845 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1538.0000000004657
2025-10-15 12:57:03,846 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 25968.99999999914
2025-10-15 12:57:03,846 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26012.99999999992
2025-10-15 12:57:03,847 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:03,847 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:03,848 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7799.999999999272}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97000.99999999975}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1493.9999999996871}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 25968.99999999914}]
2025-10-15 12:57:03,848 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7844.000000000051}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97045.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1538.0000000004657}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26012.99999999992}]
2025-10-15 12:57:03,849 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:03,849 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:03,850 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:03,851 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:03,852 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:03,854 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:03,861 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:03,870 - APP.services.mt5_service - DEBUG - Position in day range: 0.5231987577639704
2025-10-15 12:57:03,871 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:03,872 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:03+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:03,872 - APP.services.mt5_service - DEBUG - Position in day range: 0.5238819875776471
2025-10-15 12:57:03,872 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:03+07:00
2025-10-15 12:57:03,873 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:02+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:03,873 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:03+07:00 trong DST: True
2025-10-15 12:57:03,874 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:02+07:00
2025-10-15 12:57:03,874 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:03,874 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:02+07:00 trong DST: True
2025-10-15 12:57:03,875 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:03,875 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:03,876 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:03,876 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:03,877 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:03,877 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:03,878 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:03,878 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:03,879 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6000', 'price': 4187.6, 'distance_pips': 0.5}, {'level': '6025', 'price': 4187.602, 'distance_pips': 0.25}, {'level': '6050', 'price': 4187.605, 'distance_pips': 0.0}, {'level': '6075', 'price': 4187.608, 'distance_pips': 0.25}]
2025-10-15 12:57:03,879 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:03,880 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:03,880 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6400', 'price': 4187.64, 'distance_pips': 0.9}, {'level': '6425', 'price': 4187.642, 'distance_pips': 0.65}, {'level': '6450', 'price': 4187.645, 'distance_pips': 0.4}, {'level': '6475', 'price': 4187.648, 'distance_pips': 0.15}]
2025-10-15 12:57:03,881 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:03,882 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:03,882 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:03,883 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:03,883 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:03,884 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:03,884 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.605
2025-10-15 12:57:03,908 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:03,909 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:03,910 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.649
2025-10-15 12:57:03,910 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:03,911 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:03,912 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:03,912 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:03,914 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:03,915 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:03,916 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:03,919 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:03,938 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.605
2025-10-15 12:57:03,938 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:03,939 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:03,940 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4187.649
2025-10-15 12:57:03,940 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:03,941 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:03,942 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:03,942 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:03,942 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:03,943 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:03,944 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:03,945 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:03,945 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.605
2025-10-15 12:57:03,946 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:03,947 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:03,950 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4187.649
2025-10-15 12:57:03,971 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:03,972 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:03,973 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:03,973 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:03,973 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:03,974 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:03,975 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:03,976 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:03,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.605
2025-10-15 12:57:03,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:03,978 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:03,978 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4187.649
2025-10-15 12:57:03,979 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:03,979 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:04,003 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:04,004 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:04,005 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:04,005 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,006 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:04,007 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,007 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:04,008 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:04,030 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,031 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:04,032 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,032 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:04,032 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:04,033 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:04,034 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:04,034 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:04,035 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:04,035 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:04,036 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:04,036 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:04,036 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:04,041 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:04,041 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:04,063 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:04,064 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:04,065 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:04,065 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:04,065 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:04,066 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:04,067 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:04,067 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:04,068 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:04,068 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:04,069 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:04,070 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,070 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:04,070 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,071 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:04,071 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:04,098 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:04,098 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:04,099 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:04,099 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:04,102 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:04,102 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:04,110 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:04,126 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:04,127 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:04,128 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,129 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,129 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:04,131 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:04,131 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:04,131 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:04,133 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,133 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.605, 'ask': 4187.642, 'last': 0.0, 'time': 1760533023}
2025-10-15 12:57:04,134 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:04,154 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:04,157 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:04,158 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:04,158 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:04,159 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:04,159 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,160 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:04,161 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,161 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:04,162 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 333, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:04,163 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:04,163 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 444, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:04,164 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:04,165 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,169 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:04,186 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,187 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:04,187 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,188 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,188 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,189 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4187.649, 'ask': 4187.686, 'last': 0.0, 'time': 1760533022}
2025-10-15 12:57:04,189 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,189 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:04,190 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,190 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.05s
2025-10-15 12:57:04,190 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,191 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,192 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:04,192 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:04,192 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:04,193 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:04,194 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,194 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,195 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:04,195 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:04,196 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:04,197 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:04,213 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:04,218 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 7799.999999999272}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97000.99999999975}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1493.9999999996871}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 25968.99999999914}]
2025-10-15 12:57:04,257 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:03+07:00
2025-10-15 12:57:04,282 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:04,299 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:04,373 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:04,414 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.28s
2025-10-15 12:57:04,535 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:04,535 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:04,536 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:04,537 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:04,538 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:05,143 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:05,144 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:05,146 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:05,148 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:05,156 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:05,156 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:05,156 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:05,157 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:05,158 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:05,160 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:05,160 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:05,161 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:05,161 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:05,162 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:05,162 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:05,164 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:05,165 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:05,165 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:05,169 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:05,692 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:05,694 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:05,695 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:06,196 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:06,198 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:06,198 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:06,199 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:06,199 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.035
2025-10-15 12:57:06,200 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.058
2025-10-15 12:57:06,205 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 337, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:06,213 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 337, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:06,305 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:06,309 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:06,309 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:06,310 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:06,310 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:06,311 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:06,313 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:06,315 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:06,316 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:06,318 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:06,319 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:57:06,319 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:06,320 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:06,321 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:57:06,322 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.00s
2025-10-15 12:57:06,323 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:06,341 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:06,346 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:06,352 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:06,355 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:06,379 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:06,380 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:06,380 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:06,405 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:57:06,408 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:06,409 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:06,412 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:06,439 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:06,440 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:06,442 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:06,442 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:06,443 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:06,443 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:06,470 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:06,474 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:06,503 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:06,504 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:06,504 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:06,533 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:06,534 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:06,534 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:06,535 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:06,539 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:06,568 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:06,571 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:06,572 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:06,572 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:06,573 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:06,576 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:06,595 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:06+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:06,596 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:06,597 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:06+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:06,598 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:04+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:06,598 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:06+07:00
2025-10-15 12:57:06,599 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:04+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:06,599 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:06+07:00 trong DST: True
2025-10-15 12:57:06,600 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:04+07:00
2025-10-15 12:57:06,600 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:06,600 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:04+07:00 trong DST: True
2025-10-15 12:57:06,601 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:06,602 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:06,602 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:06,603 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:06,604 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:06,626 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:06,627 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:06,629 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:06,633 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:06,634 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:06,634 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:06,642 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:06,659 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:06,660 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:06,660 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:06,661 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:06,661 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:06,661 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:06,662 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:06,663 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:06,664 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:06,665 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:06,688 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:06,689 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:06,689 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:06,690 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:06,690 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:06,691 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:06,691 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:06,692 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:06,692 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:06,692 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:06,693 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:06,693 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:06,694 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:06,695 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:06,695 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:06,696 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:06,717 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:06,718 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:06,719 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:06,720 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:06,720 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:06,721 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:06,721 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:06,722 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:06,722 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:06,723 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:06,723 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:06,724 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:06,724 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:06,726 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:06,726 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:06,727 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:06,737 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:06,749 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:06,750 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:06,751 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:06,751 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:06,751 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:06,752 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:06,752 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:06,753 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:06,753 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:06,754 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.058, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:06,754 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:06,754 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:06,755 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.035, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:06,755 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:06,756 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:06,757 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:06,757 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:06,758 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:06,758 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8252.999999999702
2025-10-15 12:57:06,759 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97454.00000000017
2025-10-15 12:57:06,783 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1947.0000000001164
2025-10-15 12:57:06,784 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:06,784 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26421.99999999957
2025-10-15 12:57:06,785 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:06,785 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:06,785 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8229.999999999563
2025-10-15 12:57:06,786 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8252.999999999702}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97454.00000000017}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1947.0000000001164}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26421.99999999957}]
2025-10-15 12:57:06,786 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97431.00000000004
2025-10-15 12:57:06,786 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:06,787 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 1923.9999999999782
2025-10-15 12:57:06,788 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:06,790 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:06,791 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26398.999999999432
2025-10-15 12:57:06,808 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:06,809 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:06,810 - APP.services.mt5_service - DEBUG - Position in day range: 0.5302329192546603
2025-10-15 12:57:06,810 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8229.999999999563}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97431.00000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1923.9999999999782}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26398.999999999432}]
2025-10-15 12:57:06,811 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:06+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:06,813 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:06,813 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:06+07:00
2025-10-15 12:57:06,814 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:06,814 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:06,815 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:06+07:00 trong DST: True
2025-10-15 12:57:06,815 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:06,816 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:06,816 - APP.services.mt5_service - DEBUG - Position in day range: 0.5298757763975154
2025-10-15 12:57:06,816 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:06,817 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:04+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:06,817 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:06,817 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:04+07:00
2025-10-15 12:57:06,818 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:06,818 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:04+07:00 trong DST: True
2025-10-15 12:57:06,820 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:06,820 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:06,821 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:06,822 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '500', 'price': 4188.05, 'distance_pips': 0.8}, {'level': '525', 'price': 4188.052, 'distance_pips': 0.55}, {'level': '550', 'price': 4188.055, 'distance_pips': 0.3}, {'level': '575', 'price': 4188.057, 'distance_pips': 0.05}]
2025-10-15 12:57:06,845 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:06,847 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:06,848 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:06,849 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:06,849 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:06,852 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:06,876 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '300', 'price': 4188.03, 'distance_pips': 0.5}, {'level': '325', 'price': 4188.032, 'distance_pips': 0.25}, {'level': '350', 'price': 4188.035, 'distance_pips': 0.0}, {'level': '375', 'price': 4188.037, 'distance_pips': 0.25}]
2025-10-15 12:57:06,876 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:06,878 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:06,880 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.058
2025-10-15 12:57:06,880 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:06,880 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:06,881 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:06,882 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:06,885 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:06,909 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:06,911 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:06,912 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.035
2025-10-15 12:57:06,938 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.06s
2025-10-15 12:57:06,940 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:06,941 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:06,943 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:06,944 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:06,978 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:06,986 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:07,000 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.058
2025-10-15 12:57:07,001 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:07,002 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:07,002 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:07,003 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:07,003 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.035
2025-10-15 12:57:07,004 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:07,005 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:07,005 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:07,006 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:07,006 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:07,008 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:07,018 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.058
2025-10-15 12:57:07,033 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:07,033 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:07,034 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:07,035 - APP.ui.app_ui - INFO - Phát hiện thư mục ảnh thay đổi, thực hiện quét lại và đoán symbol.
2025-10-15 12:57:07,035 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:07,036 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:07,036 - APP.ui.app_ui - DEBUG - Bắt đầu quá trình tải file từ thư mục: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots.
2025-10-15 12:57:07,037 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.035
2025-10-15 12:57:07,038 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:07,040 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:07,050 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:07,057 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.scan_folder' vào nhóm 'ui.io.scan' (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 12:57:07,064 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:07,065 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:07,065 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.scan_folder vào group ui.io.scan (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 12:57:07,066 - APP.ui.app_ui - DEBUG - Luồng quét thư mục bắt đầu cho: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots.
2025-10-15 12:57:07,067 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:07,067 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.058
2025-10-15 12:57:07,096 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:07,097 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:07,098 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:07,098 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:07,099 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.035
2025-10-15 12:57:07,102 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:07,106 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:07,107 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:07,107 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:07,108 - APP.ui.app_ui - INFO - Luồng quét đã hoàn tất, tìm thấy 4 file.
2025-10-15 12:57:07,109 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,112 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:07,112 - APP.utils.threading_utils - DEBUG - Task 'ui.io.scan_folder' (group=ui.io.scan) hoàn tất sau 0.05s
2025-10-15 12:57:07,113 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,113 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:07,114 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:07,114 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,115 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:07,115 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,116 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:07,116 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:07,116 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:07,117 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:07,117 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:07,118 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:07,118 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:07,119 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:07,119 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:07,120 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:07,120 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:07,120 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:07,121 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:07,121 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:07,121 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:07,122 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:07,122 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:07,122 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:07,123 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:07,123 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:07,124 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:07,124 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:07,124 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:07,125 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,125 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:07,125 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,126 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:07,126 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:07,126 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:07,127 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:07,127 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:07,128 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:07,128 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:07,129 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:07,129 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:07,130 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:07,130 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:07,130 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:07,131 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,131 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:07,132 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,133 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:07,135 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:07,135 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:07,136 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:07,158 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,159 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:07,160 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.058, 'ask': 4188.095, 'last': 0.0, 'time': 1760533026}
2025-10-15 12:57:07,160 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:07,161 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:07,162 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:07,164 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.02s
2025-10-15 12:57:07,168 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:57:07,185 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:57:07,186 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:57:07,187 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:07,187 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:57:07,188 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:07,188 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,189 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:07,189 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:07,190 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.035, 'ask': 4188.072, 'last': 0.0, 'time': 1760533024}
2025-10-15 12:57:07,192 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:07,193 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: refresh_all_lists
2025-10-15 12:57:07,193 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:07,195 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:07,196 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 12:57:07,196 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:07,197 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 12:57:07,218 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,219 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,219 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:57:07,219 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 337, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:07,220 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:57:07,220 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 12:57:07,220 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:07,221 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 12:57:07,222 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,222 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:57:07,223 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,223 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:57:07,224 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 12:57:07,224 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,224 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:07,226 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,227 - APP.ui.app_ui - INFO - Phát hiện symbol XAUUSD từ ảnh (auto=True, giữ symbol hiện tại XAUUSD).
2025-10-15 12:57:07,228 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,244 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:07,246 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:07,258 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,324 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,380 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,394 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:07,409 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:07,449 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:07,452 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:07,455 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,456 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,463 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:07,499 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:07,503 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:07,504 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:07,507 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8229.999999999563}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97431.00000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 1923.9999999999782}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26398.999999999432}]
2025-10-15 12:57:07,543 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:04+07:00
2025-10-15 12:57:07,547 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:07,550 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:07,555 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:07,557 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 12:57:07,558 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.33s
2025-10-15 12:57:07,561 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 12:57:07,562 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.42s
2025-10-15 12:57:07,566 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.35s
2025-10-15 12:57:07,603 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:07,608 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:07,627 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:07,628 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:07,629 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:07,630 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:07,631 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:08,149 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:08,150 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:08,151 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:08,154 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:08,162 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:08,163 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:08,164 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:08,164 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:08,165 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:08,184 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:08,185 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:08,187 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:08,188 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:08,189 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:08,190 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:08,191 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:08,191 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:08,191 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:08,192 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:08,694 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:08,696 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:08,696 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:09,198 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:09,199 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:09,200 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:09,200 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:09,201 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.398
2025-10-15 12:57:09,201 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.398
2025-10-15 12:57:09,207 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 339, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:09,211 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 339, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:09,299 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:09,313 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:09,313 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:09,314 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:09,314 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:09,315 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:09,317 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:09,319 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:09,320 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:09,321 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:09,321 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:09,322 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:09,322 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:09,340 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:09,344 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:09,349 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:09,349 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:09,349 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:09,350 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:09,350 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:09,351 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:09,352 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:09,356 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:09,376 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:09,376 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:09,377 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:09,377 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:09,378 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:09,378 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:09,378 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:09,381 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:09,384 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:09,387 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:09,395 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:09,397 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:09,402 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:09,403 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:09,406 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:09,409 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:09,411 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:09,412 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:09,412 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:09,413 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:09,414 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:09,415 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:08+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:09,415 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:09,416 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:08+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:09,422 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:09,423 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:08+07:00
2025-10-15 12:57:09,424 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:08+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:09,425 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:08+07:00 trong DST: True
2025-10-15 12:57:09,430 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:08+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:09,432 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:09,434 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:08+07:00
2025-10-15 12:57:09,437 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:09,438 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:08+07:00 trong DST: True
2025-10-15 12:57:09,438 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:09,439 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:09,441 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:09,441 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:09,442 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:09,442 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:09,446 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:09,450 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:09,453 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:09,456 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:09,457 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:09,463 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:09,467 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:09,468 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:09,469 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:09,469 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:09,470 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:09,470 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:09,470 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:09,471 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:09,471 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:09,472 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:09,472 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:09,472 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:09,473 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:09,473 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:09,474 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:09,474 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:09,474 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:09,475 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:09,475 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:09,475 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:09,476 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:09,476 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:09,477 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:09,477 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:09,477 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:09,478 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:09,479 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:09,479 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:09,480 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:09,491 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:09,498 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:09,498 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:09,499 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:09,500 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:09,500 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:09,500 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:09,501 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:09,501 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:09,502 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:09,502 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:09,503 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:09,503 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:09,504 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:09,504 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:09,504 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:09,505 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:09,506 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:09,506 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:09,507 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.398, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:09,507 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:09,507 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:09,508 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:09,508 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:09,509 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:09,509 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:09,509 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:09,510 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:09,510 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.398, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:09,518 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:09,521 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8592.999999999847
2025-10-15 12:57:09,522 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:09,525 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97794.00000000032
2025-10-15 12:57:09,527 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:09,527 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 2287.000000000262
2025-10-15 12:57:09,531 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:09,532 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 8592.999999999847
2025-10-15 12:57:09,533 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 97794.00000000032
2025-10-15 12:57:09,534 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 2287.000000000262
2025-10-15 12:57:09,534 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26761.999999999716
2025-10-15 12:57:09,535 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 26761.999999999716
2025-10-15 12:57:09,535 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:09,536 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:09,536 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8592.999999999847}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97794.00000000032}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2287.000000000262}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26761.999999999716}]
2025-10-15 12:57:09,536 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8592.999999999847}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97794.00000000032}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2287.000000000262}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26761.999999999716}]
2025-10-15 12:57:09,537 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:09,537 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:09,538 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:09,540 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:09,541 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:09,549 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:09,550 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:09,552 - APP.services.mt5_service - DEBUG - Position in day range: 0.5355124223602528
2025-10-15 12:57:09,555 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:09,560 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:08+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:09,562 - APP.services.mt5_service - DEBUG - Position in day range: 0.5355124223602528
2025-10-15 12:57:09,563 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:08+07:00
2025-10-15 12:57:09,564 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:08+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:09,564 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:08+07:00 trong DST: True
2025-10-15 12:57:09,565 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:08+07:00
2025-10-15 12:57:09,565 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:09,566 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:08+07:00 trong DST: True
2025-10-15 12:57:09,566 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:09,566 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:09,567 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:09,567 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:09,567 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,568 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:09,568 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,569 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,569 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3900', 'price': 4188.39, 'distance_pips': 0.8}, {'level': '3925', 'price': 4188.392, 'distance_pips': 0.55}, {'level': '3950', 'price': 4188.395, 'distance_pips': 0.3}, {'level': '3975', 'price': 4188.398, 'distance_pips': 0.05}]
2025-10-15 12:57:09,570 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,571 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:09,572 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,572 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,573 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:09,573 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3900', 'price': 4188.39, 'distance_pips': 0.8}, {'level': '3925', 'price': 4188.392, 'distance_pips': 0.55}, {'level': '3950', 'price': 4188.395, 'distance_pips': 0.3}, {'level': '3975', 'price': 4188.398, 'distance_pips': 0.05}]
2025-10-15 12:57:09,578 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.398
2025-10-15 12:57:09,589 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:09,593 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:09,594 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,594 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:09,595 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,596 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:09,596 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:09,597 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:09,597 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.398
2025-10-15 12:57:09,598 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:09,598 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:09,599 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.398
2025-10-15 12:57:09,599 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:09,599 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:09,601 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:09,602 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:09,603 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:09,603 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:09,606 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:09,613 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:09,617 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.398
2025-10-15 12:57:09,619 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:09,621 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:09,624 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.398
2025-10-15 12:57:09,627 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:09,627 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:09,629 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:09,629 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:09,630 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:09,631 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:09,631 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:09,631 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:09,632 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.398
2025-10-15 12:57:09,633 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:09,634 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.398
2025-10-15 12:57:09,634 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:09,635 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:09,638 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:09,644 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:09,647 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:09,648 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:09,654 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:09,658 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:09,659 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:09,660 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.398
2025-10-15 12:57:09,660 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,661 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:09,662 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,662 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:09,662 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:09,663 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:09,664 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:09,664 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:09,665 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:09,665 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,666 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:09,666 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,673 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:09,679 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:09,682 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:09,690 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:09,690 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:09,691 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:09,691 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:09,691 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:09,692 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:09,692 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:09,693 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:09,694 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:09,695 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:09,695 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:09,695 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:09,696 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:09,696 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:09,697 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:09,697 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:09,705 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:09,710 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:09,713 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,713 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:09,715 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,717 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:09,720 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:09,720 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:09,721 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:09,721 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:09,722 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:09,722 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:09,722 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:09,723 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:09,723 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:09,724 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:09,725 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,725 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:09,725 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,726 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:09,727 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:09,727 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,728 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:09,734 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:09,745 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.398, 'ask': 4188.435, 'last': 0.0, 'time': 1760533028}
2025-10-15 12:57:09,747 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:09,751 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:09,752 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,753 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,754 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:09,754 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:09,755 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 339, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:09,755 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:09,756 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:09,758 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:09,758 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,759 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:09,760 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,766 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:09,777 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,779 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,780 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,781 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:09,782 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,783 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:09,784 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,784 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:09,784 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,785 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,785 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:09,785 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.398, 'ask': 4188.435, 'last': 0.0, 'time': 1760533028}
2025-10-15 12:57:09,786 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:09,786 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:09,786 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:09,787 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.63s
2025-10-15 12:57:09,787 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:09,790 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,791 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,791 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:09,800 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:09,802 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:09,804 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:09,805 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 8592.999999999847}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 97794.00000000032}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2287.000000000262}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 26761.999999999716}]
2025-10-15 12:57:09,809 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:08+07:00
2025-10-15 12:57:09,809 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:09,810 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:09,811 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:09,813 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.66s
2025-10-15 12:57:09,881 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:09,991 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:09,992 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:09,992 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:09,994 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:09,994 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:10,172 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:10,173 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:10,174 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:10,176 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:10,194 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:10,195 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:10,196 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:10,197 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:10,198 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:10,217 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:10,217 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:10,218 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:10,219 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:10,219 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:10,220 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:10,220 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:10,221 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:10,222 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:10,222 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:10,724 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:10,725 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:10,726 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:11,228 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:11,229 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:11,230 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:11,230 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:11,231 - APP.services.mt5_service - DEBUG - Current price (cp): 4188.957
2025-10-15 12:57:11,231 - APP.services.mt5_service - DEBUG - Current price (cp): 4189.005
2025-10-15 12:57:11,238 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 339, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:11,243 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 339, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:11,314 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:11,320 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:11,330 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:11,330 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:11,331 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:11,333 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:11,334 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:11,334 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:11,336 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:11,337 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:11,337 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:11,338 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:11,338 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:11,342 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:11,343 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:11,343 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:11,347 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:11,347 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:11,347 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:11,348 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:11,348 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:11,351 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:11,352 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:11,352 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:11,356 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:11,377 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:11,378 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:11,378 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:11,379 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:11,381 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:11,383 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:11,384 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:11,390 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:11,408 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:11,409 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:11,410 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:11,410 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:11,413 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:11,413 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:11,415 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:11,440 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:11,440 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:11,441 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:11,442 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:11,442 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:11,442 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:11,443 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:10+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:11,445 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:11+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:11,445 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:10+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:11,446 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:11+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:11,446 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:10+07:00
2025-10-15 12:57:11,447 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:11+07:00
2025-10-15 12:57:11,447 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:10+07:00 trong DST: True
2025-10-15 12:57:11,471 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:11+07:00 trong DST: True
2025-10-15 12:57:11,472 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:11,473 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:11,473 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:11,474 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:11,474 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:11,475 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:11,477 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:11,479 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:11,480 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:11,501 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:11,506 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:11,510 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:11,528 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:11,530 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:11,531 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:11,531 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:11,532 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:11,532 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:11,532 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:11,533 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:11,533 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:11,534 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:11,534 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:11,535 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:11,535 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:11,535 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:11,536 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:11,536 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:11,537 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:11,538 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:11,538 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:11,540 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:11,541 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:11,541 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:11,542 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:11,564 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:11,564 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:11,565 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:11,565 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:11,566 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:11,566 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:11,566 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:11,567 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:11,567 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:11,568 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:11,568 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:11,569 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:11,570 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:11,572 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:11,572 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:11,595 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:11,595 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:11,596 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:11,596 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:11,597 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:11,597 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:11,598 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:11,598 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:11,599 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:11,599 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:11,600 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:11,600 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:11,601 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:11,602 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:11,602 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:11,603 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:11,603 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4189.005, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:11,604 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4188.957, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:11,625 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:11,628 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:11,628 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:11,629 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:11,629 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:11,630 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:11,630 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:11,630 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:11,631 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 9199.999999999818
2025-10-15 12:57:11,631 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 9152.000000000044
2025-10-15 12:57:11,632 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 98401.00000000029
2025-10-15 12:57:11,633 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 98353.00000000052
2025-10-15 12:57:11,633 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 2894.000000000233
2025-10-15 12:57:11,634 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 2846.0000000004584
2025-10-15 12:57:11,635 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 27368.999999999687
2025-10-15 12:57:11,635 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 27320.999999999913
2025-10-15 12:57:11,636 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:11,636 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:11,653 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 9152.000000000044}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 98353.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2846.0000000004584}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 27320.999999999913}]
2025-10-15 12:57:11,654 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 9199.999999999818}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 98401.00000000029}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2894.000000000233}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 27368.999999999687}]
2025-10-15 12:57:11,655 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:11,655 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:11,656 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:11,656 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:11,657 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:11,657 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:11,658 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:11,658 - APP.services.mt5_service - DEBUG - Position in day range: 0.5441925465838583
2025-10-15 12:57:11,659 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:11,659 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:10+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:11,659 - APP.services.mt5_service - DEBUG - Position in day range: 0.5449378881987617
2025-10-15 12:57:11,660 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:10+07:00
2025-10-15 12:57:11,660 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:11+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:11,660 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:10+07:00 trong DST: True
2025-10-15 12:57:11,661 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:11+07:00
2025-10-15 12:57:11,661 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:11,662 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:11+07:00 trong DST: True
2025-10-15 12:57:11,662 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:11,662 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:11,663 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:11,663 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:11,663 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,664 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:11,664 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,665 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,665 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9500', 'price': 4188.95, 'distance_pips': 0.7}, {'level': '9525', 'price': 4188.952, 'distance_pips': 0.45}, {'level': '9550', 'price': 4188.955, 'distance_pips': 0.2}, {'level': '9575', 'price': 4188.957, 'distance_pips': 0.05}]
2025-10-15 12:57:11,666 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,666 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:11,667 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '00', 'price': 4189.0, 'distance_pips': 0.5}, {'level': '25', 'price': 4189.002, 'distance_pips': 0.25}, {'level': '50', 'price': 4189.005, 'distance_pips': 0.0}, {'level': '75', 'price': 4189.007, 'distance_pips': 0.25}]
2025-10-15 12:57:11,669 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,676 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,677 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:11,680 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:11,681 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,685 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.957
2025-10-15 12:57:11,687 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,688 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:11,688 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:11,689 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:11,689 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.005
2025-10-15 12:57:11,690 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:11,690 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:11,691 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:11,691 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:11,691 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:11,692 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:11,692 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4188.957
2025-10-15 12:57:11,693 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:11,694 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:11,694 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:11,696 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:11,697 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4189.005
2025-10-15 12:57:11,698 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:11,698 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:11,699 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:11,707 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:11,712 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:11,715 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:11,721 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4188.957
2025-10-15 12:57:11,723 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:11,724 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:11,725 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:11,727 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4189.005
2025-10-15 12:57:11,728 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:11,740 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:11,743 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:11,746 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:11,748 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:11,750 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:11,751 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:11,752 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:11,753 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:11,753 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.005
2025-10-15 12:57:11,754 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4188.957
2025-10-15 12:57:11,755 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:11,755 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:11,756 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:11,756 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:11,757 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:11,757 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:11,759 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:11,759 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:11,760 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,760 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,767 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,770 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,771 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:11,772 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:11,775 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:11,779 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:11,780 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:11,783 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:11,783 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:11,784 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:11,784 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:11,784 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:11,785 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:11,785 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:11,785 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:11,786 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:11,786 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:11,786 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:11,787 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:11,787 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:11,787 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:11,788 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:11,788 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:11,789 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:11,789 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:11,789 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:11,790 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:11,790 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,790 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:11,791 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,791 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:11,791 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:11,798 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:11,803 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:11,804 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:11,807 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:11,809 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:11,812 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:11,813 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:11,815 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:11,816 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:11,816 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:11,818 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,818 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:11,818 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,820 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:11,821 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:11,821 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:11,822 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:11,830 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:11,832 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:11,834 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,836 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:11,837 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4189.005, 'ask': 4189.042, 'last': 0.0, 'time': 1760533031}
2025-10-15 12:57:11,839 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:11,840 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:11,842 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:11,842 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:11,843 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,844 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.67s
2025-10-15 12:57:11,847 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:11,848 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4188.957, 'ask': 4188.994, 'last': 0.0, 'time': 1760533030}
2025-10-15 12:57:11,849 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:11,849 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:11,849 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:11,850 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,850 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,851 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 339, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:11,851 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:11,852 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,852 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,853 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,853 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,853 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,854 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,863 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,865 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,866 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:11,867 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:11,869 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:11,870 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:11,871 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,874 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,874 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:11,875 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:11,875 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:11,876 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:11,891 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:11,912 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 9152.000000000044}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 98353.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 2846.0000000004584}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 27320.999999999913}]
2025-10-15 12:57:11,919 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:10+07:00
2025-10-15 12:57:11,932 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:11,936 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:11,961 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:12,042 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.87s
2025-10-15 12:57:12,208 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:12,209 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:12,210 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:12,211 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:12,212 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:12,215 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:12,215 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:12,217 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:12,219 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:12,273 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:12,282 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:12,301 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:12,302 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:12,302 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:12,303 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:12,303 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:12,304 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:12,305 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:12,305 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:12,306 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:12,306 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.02s
2025-10-15 12:57:12,307 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:12,307 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:12,309 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:12,309 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:12,310 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:12,310 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:12,315 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:12,812 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:12,814 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:12,814 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:13,316 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:13,318 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:13,318 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:13,319 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:13,320 - APP.services.mt5_service - DEBUG - Current price (cp): 4189.686
2025-10-15 12:57:13,320 - APP.services.mt5_service - DEBUG - Current price (cp): 4189.824
2025-10-15 12:57:13,326 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 343, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:13,331 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 343, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:13,397 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 446, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:13,408 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:13,431 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 446, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:13,435 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:13,436 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:13,439 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:13,439 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:13,440 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:13,442 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:13,443 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:13,443 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:13,444 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:13,445 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:13,453 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:13,468 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:13,469 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:13,474 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:13,474 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:13,475 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:13,475 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:13,476 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:13,478 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:13,487 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:13,500 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:13,502 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:13,502 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:13,503 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:13,503 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:13,504 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:13,506 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:13,507 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:13,508 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:13,510 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:13,532 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:13,532 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:13,533 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:13,533 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:13,536 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:13,537 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:13,537 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:13,562 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:13,563 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:13,564 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:13,564 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:13,564 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:13,565 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:13,565 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:12+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:13,566 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:12+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:13,566 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:12+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:13,567 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:12+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:13,567 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:12+07:00
2025-10-15 12:57:13,568 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:12+07:00
2025-10-15 12:57:13,568 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:12+07:00 trong DST: True
2025-10-15 12:57:13,569 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:12+07:00 trong DST: True
2025-10-15 12:57:13,570 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:13,571 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:13,572 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:13,572 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:13,595 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:13,596 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:13,598 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:13,600 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:13,602 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:13,603 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:13,627 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:13,631 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:13,631 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:13,632 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:13,634 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:13,634 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:13,635 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:13,635 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:13,636 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:13,657 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:13,658 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:13,659 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:13,659 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:13,660 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:13,660 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:13,661 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:13,661 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:13,661 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:13,662 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:13,663 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:13,664 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:13,664 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:13,665 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:13,665 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:13,666 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:13,666 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:13,667 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:13,687 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:13,688 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:13,689 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:13,690 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:13,690 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:13,691 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:13,691 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:13,691 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:13,692 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:13,692 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:13,693 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:13,694 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:13,696 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:13,722 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:13,723 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:13,723 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:13,724 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:13,724 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:13,725 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:13,726 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:13,727 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:13,728 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:13,729 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:13,753 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:13,754 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:13,754 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4189.686, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:13,755 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:13,755 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:13,756 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:13,757 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:13,757 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:13,757 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:13,758 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:13,759 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:13,760 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4189.824, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:13,760 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 9880.999999999403
2025-10-15 12:57:13,761 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:13,785 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:13,786 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99081.99999999988
2025-10-15 12:57:13,787 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:13,787 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 3574.999999999818
2025-10-15 12:57:13,787 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:13,789 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28049.999999999272
2025-10-15 12:57:13,790 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:13,790 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10018.999999999323
2025-10-15 12:57:13,791 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 9880.999999999403}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99081.99999999988}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3574.999999999818}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28049.999999999272}]
2025-10-15 12:57:13,812 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99219.9999999998
2025-10-15 12:57:13,814 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:13,814 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 3712.999999999738
2025-10-15 12:57:13,815 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:13,816 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28187.999999999192
2025-10-15 12:57:13,816 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:13,817 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:13,817 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:13,818 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10018.999999999323}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99219.9999999998}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3712.999999999738}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28187.999999999192}]
2025-10-15 12:57:13,818 - APP.services.mt5_service - DEBUG - Position in day range: 0.5555124223602459
2025-10-15 12:57:13,819 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:13,819 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:12+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:13,822 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:13,822 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:12+07:00
2025-10-15 12:57:13,832 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:13,842 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:12+07:00 trong DST: True
2025-10-15 12:57:13,843 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:13,844 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:13,844 - APP.services.mt5_service - DEBUG - Position in day range: 0.5576552795031019
2025-10-15 12:57:13,845 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:13,845 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:12+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:13,845 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:13,846 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:12+07:00
2025-10-15 12:57:13,846 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:13,847 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:12+07:00 trong DST: True
2025-10-15 12:57:13,847 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:13,847 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:13,848 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6800', 'price': 4189.68, 'distance_pips': 0.6}, {'level': '6825', 'price': 4189.682, 'distance_pips': 0.35}, {'level': '6850', 'price': 4189.685, 'distance_pips': 0.1}, {'level': '6875', 'price': 4189.688, 'distance_pips': 0.15}]
2025-10-15 12:57:13,849 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:13,850 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:13,851 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:13,852 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:13,852 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:13,853 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:13,876 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8200', 'price': 4189.82, 'distance_pips': 0.4}, {'level': '8225', 'price': 4189.822, 'distance_pips': 0.15}, {'level': '8250', 'price': 4189.825, 'distance_pips': 0.1}, {'level': '8275', 'price': 4189.827, 'distance_pips': 0.35}]
2025-10-15 12:57:13,877 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:13,878 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:13,878 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:13,879 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:13,879 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.686
2025-10-15 12:57:13,880 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:13,880 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:13,881 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:13,882 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:13,885 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:13,886 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:13,908 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:13,910 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.824
2025-10-15 12:57:13,911 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4189.686
2025-10-15 12:57:13,912 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:13,912 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:13,912 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:13,913 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:13,915 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:13,916 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:13,939 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:13,940 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:13,940 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:13,940 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:13,941 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4189.686
2025-10-15 12:57:13,942 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4189.824
2025-10-15 12:57:13,943 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:13,943 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:13,944 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:13,946 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:13,946 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:13,947 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:13,948 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:13,948 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:13,957 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:13,973 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.686
2025-10-15 12:57:13,974 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:13,975 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:13,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4189.824
2025-10-15 12:57:13,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:13,979 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:13,983 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:14,001 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:14,001 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:14,002 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:14,003 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,004 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:14,004 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,004 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:14,005 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:14,006 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.824
2025-10-15 12:57:14,006 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:14,008 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:14,009 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:14,009 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:14,010 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:14,026 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:14,033 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:14,034 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:14,035 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,035 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:14,035 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,036 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:14,036 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:14,037 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:14,037 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:14,037 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:14,038 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:14,038 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:14,039 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:14,040 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:14,040 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:14,041 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:14,042 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:14,042 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:14,042 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:14,065 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:14,067 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:14,068 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:14,068 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:14,069 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:14,069 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,070 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:14,071 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,071 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:14,072 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:14,072 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:14,091 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:14,096 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:14,097 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:14,098 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:14,098 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:14,099 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:14,099 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:14,100 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:14,101 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,102 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:14,102 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:14,103 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:14,103 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4189.686, 'ask': 4189.723, 'last': 0.0, 'time': 1760533032}
2025-10-15 12:57:14,128 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,130 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:14,131 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:14,132 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,135 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:14,147 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:14,156 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,157 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:14,158 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,158 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:14,158 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 343, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:14,159 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:14,159 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 446, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:14,160 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:14,160 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,161 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:14,161 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,162 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:14,162 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,163 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:14,165 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:14,166 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,166 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:14,167 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,179 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,185 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4189.824, 'ask': 4189.861, 'last': 0.0, 'time': 1760533032}
2025-10-15 12:57:14,186 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:14,186 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,187 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.97s
2025-10-15 12:57:14,188 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,188 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,189 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:14,189 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:14,189 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:14,190 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:14,190 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,191 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,191 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:14,191 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:14,192 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:14,193 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:14,193 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 9880.999999999403}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99081.99999999988}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3574.999999999818}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28049.999999999272}]
2025-10-15 12:57:14,195 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:12+07:00
2025-10-15 12:57:14,196 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:14,208 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:14,220 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:14,222 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.01s
2025-10-15 12:57:14,222 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:14,224 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:14,255 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:14,256 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:14,258 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:14,259 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:14,260 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:14,276 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:14,280 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:14,300 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:14,322 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:14,461 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:14,462 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:14,462 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:14,463 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:14,464 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:14,849 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:14,850 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:14,851 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:14,852 - APP.services.mt5_service - DEBUG - Current price (cp): 4189.828
2025-10-15 12:57:14,858 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 342, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:14,915 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:14,916 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:14,916 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:14,919 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:14,919 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:14,920 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:14,920 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:14,924 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:14,925 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:14,925 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:14,926 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:14,927 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:14,928 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:14,928 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:14,929 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:14,931 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:14,932 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:14,932 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:14,933 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:14,936 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:14,937 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:14,937 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:14,938 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:14,938 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:14+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:14,939 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:14+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:14,939 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:14+07:00
2025-10-15 12:57:14,939 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:14+07:00 trong DST: True
2025-10-15 12:57:14,940 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:14,940 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:14,940 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:14,942 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:14,942 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:14,947 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:14,948 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:14,968 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:14,970 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:14,971 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:14,972 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:14,973 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:14,973 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:14,973 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:14,974 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:14,975 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:14,975 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:15,001 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:15,003 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:15,003 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:15,004 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:15,005 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:15,005 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:15,005 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:15,006 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:15,007 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:15,009 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:15,028 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:15,031 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:15,032 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:15,033 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:15,033 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:15,034 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:15,035 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4189.828, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:15,036 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:15,036 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:15,037 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:15,037 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:15,038 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10023.000000000138
2025-10-15 12:57:15,039 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99224.00000000061
2025-10-15 12:57:15,040 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 3717.000000000553
2025-10-15 12:57:15,040 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28192.000000000007
2025-10-15 12:57:15,041 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:15,041 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10023.000000000138}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99224.00000000061}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3717.000000000553}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28192.000000000007}]
2025-10-15 12:57:15,063 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:15,066 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:15,067 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:15,067 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:15,068 - APP.services.mt5_service - DEBUG - Position in day range: 0.5577173913043567
2025-10-15 12:57:15,068 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:14+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:15,068 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:14+07:00
2025-10-15 12:57:15,069 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:14+07:00 trong DST: True
2025-10-15 12:57:15,070 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:15,070 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:15,071 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:15,072 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:15,072 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:15,073 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8200', 'price': 4189.82, 'distance_pips': 0.8}, {'level': '8225', 'price': 4189.822, 'distance_pips': 0.55}, {'level': '8250', 'price': 4189.825, 'distance_pips': 0.3}, {'level': '8275', 'price': 4189.827, 'distance_pips': 0.05}]
2025-10-15 12:57:15,076 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:15,093 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:15,094 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:15,094 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:15,095 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.828
2025-10-15 12:57:15,096 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:15,096 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:15,097 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:15,097 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:15,098 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:15,098 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4189.828
2025-10-15 12:57:15,099 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:15,099 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:15,100 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:15,102 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:15,102 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:15,107 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4189.828
2025-10-15 12:57:15,127 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:15,128 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:15,129 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:15,130 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:15,130 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:15,131 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.828
2025-10-15 12:57:15,131 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:15,132 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:15,132 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:15,133 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:15,133 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:15,135 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:15,135 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:15,136 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:15,157 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:15,159 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:15,160 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:15,160 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:15,160 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:15,161 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:15,161 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:15,162 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:15,162 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:15,162 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:15,163 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:15,165 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:15,165 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:15,166 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:15,166 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:15,189 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:15,191 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:15,192 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:15,192 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:15,193 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:15,193 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:15,194 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:15,194 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:15,196 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:15,198 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:15,198 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:15,220 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4189.828, 'ask': 4189.865, 'last': 0.0, 'time': 1760533034}
2025-10-15 12:57:15,222 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:15,222 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.00s
2025-10-15 12:57:15,223 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:15,224 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:15,225 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:15,231 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:15,257 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:15,259 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:15,260 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:15,264 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:15,282 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:15,284 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:15,323 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:15,346 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:15,408 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:15,412 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:15,415 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:15,455 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:15,457 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:15,458 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:15,460 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:15,463 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:15,966 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:15,968 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:15,968 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:16,470 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:16,471 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:16,472 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:16,472 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:16,473 - APP.services.mt5_service - DEBUG - Current price (cp): 4189.805
2025-10-15 12:57:16,473 - APP.services.mt5_service - DEBUG - Current price (cp): 4189.749
2025-10-15 12:57:16,481 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 343, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:16,486 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 343, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:16,572 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:16,578 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:16,591 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:16,591 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:16,592 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:16,594 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:16,594 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:16,595 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:16,597 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:16,597 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:16,598 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:16,598 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:16,599 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:16,602 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:16,603 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:16,604 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:16,611 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:16,622 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:16,624 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:16,625 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:16,626 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:16,628 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:16,629 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:16,629 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:16,631 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:16,632 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:16,633 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:16,633 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:16,635 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:16,659 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:16,660 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:16,660 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:16,662 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:16,663 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:16,665 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:16,665 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:16,666 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:16,672 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:16,687 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:16,689 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:16,692 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:16,693 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:16,693 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:16,694 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:16,695 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:15+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:16,696 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:16,719 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:15+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:16,720 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:16,721 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:15+07:00
2025-10-15 12:57:16,721 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:16+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:16,722 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:15+07:00 trong DST: True
2025-10-15 12:57:16,722 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:16+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:16,723 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:16,723 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:16+07:00
2025-10-15 12:57:16,724 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:16,724 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:16+07:00 trong DST: True
2025-10-15 12:57:16,724 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:16,725 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:16,727 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:16,728 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:16,729 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:16,747 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:16,750 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:16,755 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:16,756 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:16,757 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:16,769 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:16,783 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:16,785 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:16,785 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:16,786 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:16,786 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:16,787 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:16,787 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:16,788 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:16,789 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:16,789 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:16,790 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:16,791 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:16,791 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:16,812 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:16,813 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:16,814 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:16,814 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:16,815 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:16,815 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:16,816 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:16,816 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:16,817 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:16,817 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:16,818 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:16,818 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:16,819 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:16,819 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:16,820 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:16,820 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:16,822 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:16,823 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:16,824 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:16,845 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:16,847 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:16,847 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:16,848 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:16,849 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:16,850 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:16,850 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:16,851 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:16,852 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:16,853 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:16,853 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:16,854 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:16,877 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:16,878 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:16,879 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:16,879 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:16,880 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:16,880 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:16,881 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:16,881 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:16,882 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:16,883 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4189.805, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:16,883 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4189.749, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:16,884 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:16,885 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:16,893 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:16,911 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:16,912 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:16,912 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:16,913 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:16,914 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:16,915 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 9943.999999999505
2025-10-15 12:57:16,916 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10000.0
2025-10-15 12:57:16,916 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99144.99999999999
2025-10-15 12:57:16,936 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99201.00000000048
2025-10-15 12:57:16,937 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 3637.99999999992
2025-10-15 12:57:16,938 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 3694.0000000004147
2025-10-15 12:57:16,938 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28112.999999999374
2025-10-15 12:57:16,939 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28168.99999999987
2025-10-15 12:57:16,939 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:16,940 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:16,940 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 9943.999999999505}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99144.99999999999}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3637.99999999992}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28112.999999999374}]
2025-10-15 12:57:16,940 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10000.0}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99201.00000000048}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3694.0000000004147}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28168.99999999987}]
2025-10-15 12:57:16,941 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:16,941 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:16,942 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:16,943 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:16,943 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:16,944 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:16,945 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:16,945 - APP.services.mt5_service - DEBUG - Position in day range: 0.5564906832298128
2025-10-15 12:57:16,945 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:16,946 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:16+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:16,947 - APP.services.mt5_service - DEBUG - Position in day range: 0.5573602484472118
2025-10-15 12:57:16,965 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:16+07:00
2025-10-15 12:57:16,966 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:15+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:16,966 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:16+07:00 trong DST: True
2025-10-15 12:57:16,967 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:15+07:00
2025-10-15 12:57:16,967 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:16,967 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:15+07:00 trong DST: True
2025-10-15 12:57:16,968 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:16,968 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:16,968 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:16,969 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:16,969 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:16,970 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:16,971 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:16,971 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:16,972 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7400', 'price': 4189.74, 'distance_pips': 0.9}, {'level': '7425', 'price': 4189.742, 'distance_pips': 0.65}, {'level': '7450', 'price': 4189.745, 'distance_pips': 0.4}, {'level': '7475', 'price': 4189.747, 'distance_pips': 0.15}]
2025-10-15 12:57:17,033 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,090 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:17,131 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8000', 'price': 4189.8, 'distance_pips': 0.5}, {'level': '8025', 'price': 4189.802, 'distance_pips': 0.25}, {'level': '8050', 'price': 4189.805, 'distance_pips': 0.0}, {'level': '8075', 'price': 4189.807, 'distance_pips': 0.25}]
2025-10-15 12:57:17,149 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,155 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:17,240 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,245 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,246 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:17,247 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,248 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.749
2025-10-15 12:57:17,249 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:17,250 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:17,250 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.805
2025-10-15 12:57:17,251 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:17,251 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:17,252 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:17,253 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:17,253 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:17,254 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:17,254 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:17,255 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:17,256 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4189.749
2025-10-15 12:57:17,256 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:17,258 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:17,259 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4189.805
2025-10-15 12:57:17,260 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:17,260 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:17,262 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:17,262 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:17,292 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:17,316 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:17,320 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:17,350 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:17,384 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:17,407 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:17,408 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4189.749
2025-10-15 12:57:17,409 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:17,410 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:17,412 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4189.805
2025-10-15 12:57:17,440 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:17,442 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:17,443 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:17,443 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:17,444 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:17,447 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:17,461 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.07s
2025-10-15 12:57:17,469 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:17,471 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:17,472 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.749
2025-10-15 12:57:17,473 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:17,473 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:17,474 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.805
2025-10-15 12:57:17,474 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:17,475 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:17,476 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:17,479 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:17,480 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:17,501 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:17,502 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:17,503 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,503 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,504 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,504 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,504 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:17,505 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:17,506 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:17,506 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:17,507 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:17,508 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:17,509 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:17,509 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:17,510 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:17,533 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:17,534 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:17,535 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:17,536 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:17,536 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:17,536 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:17,537 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:17,538 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:17,539 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:17,539 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:17,540 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:17,540 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:17,565 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:17,566 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:17,568 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:17,568 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:17,569 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:17,569 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,569 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:17,570 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,571 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:17,572 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:17,573 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:17,576 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:17,599 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:17,600 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:17,601 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:17,602 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:17,604 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:17,615 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:17,625 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:17,627 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:17,627 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,628 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,628 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:17,629 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:17,629 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,629 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4189.749, 'ask': 4189.786, 'last': 0.0, 'time': 1760533036}
2025-10-15 12:57:17,633 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:17,635 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:17,636 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:17,659 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:17,660 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:17,661 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:17,663 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:17,663 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,664 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:17,668 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,689 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 343, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:17,691 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:17,692 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:17,692 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:17,693 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,693 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:17,694 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,696 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:17,722 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:17,723 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,724 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,725 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,725 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4189.805, 'ask': 4189.842, 'last': 0.0, 'time': 1760533035}
2025-10-15 12:57:17,726 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,728 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:17,729 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,751 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.52s
2025-10-15 12:57:17,752 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,753 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,753 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:17,753 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:17,754 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:17,754 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:17,755 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,755 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,756 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:17,756 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:17,757 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:17,757 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:17,758 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 9943.999999999505}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99144.99999999999}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3637.99999999992}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28112.999999999374}]
2025-10-15 12:57:17,761 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:16+07:00
2025-10-15 12:57:17,761 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:17,771 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:17,785 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:17,787 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.56s
2025-10-15 12:57:17,835 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:17,954 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:17,955 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:17,956 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:17,958 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:17,958 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:18,233 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:18,233 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:18,235 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:18,237 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:18,245 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:18,246 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:18,246 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:18,247 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:18,248 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:18,249 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:18,250 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:18,250 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:18,251 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:18,251 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:18,252 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:18,253 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:18,255 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:18,255 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:18,256 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:18,758 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:18,760 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:18,761 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:19,262 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:19,264 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:19,265 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:19,265 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:19,266 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.274
2025-10-15 12:57:19,266 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.298
2025-10-15 12:57:19,273 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 346, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:19,278 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 346, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:19,387 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 446, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:19,387 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 446, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:19,388 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:19,389 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:19,389 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:19,390 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:19,392 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:19,394 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:19,395 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:19,395 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:19,396 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:19,396 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:19,397 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:19,397 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:19,400 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:19,404 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:19,404 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:19,405 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:19,405 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:19,406 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:19,406 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:19,407 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:19,408 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:19,410 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:19,410 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:19,411 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:19,411 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:19,412 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:19,412 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:19,413 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:19,416 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:19,440 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:19,441 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:19,442 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:19,442 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:19,442 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:19,443 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:19,443 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:19,447 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:19,473 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:19,474 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:19,474 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:19,475 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:19,475 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:19,477 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:19,478 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:19,478 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:19+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:19,478 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:18+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:19,479 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:19+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:19,482 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:18+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:19,502 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:18+07:00
2025-10-15 12:57:19,503 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:19+07:00
2025-10-15 12:57:19,504 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:18+07:00 trong DST: True
2025-10-15 12:57:19,504 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:19+07:00 trong DST: True
2025-10-15 12:57:19,505 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:19,506 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:19,506 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:19,506 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:19,507 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:19,507 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:19,508 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:19,510 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:19,511 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:19,514 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:19,535 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:19,541 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:19,561 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:19,564 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:19,564 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:19,565 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:19,565 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:19,565 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:19,566 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:19,567 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:19,567 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:19,568 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:19,568 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:19,569 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:19,569 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:19,570 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:19,571 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:19,571 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:19,573 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:19,573 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:19,580 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:19,595 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:19,596 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:19,597 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:19,597 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:19,598 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:19,598 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:19,599 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:19,599 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:19,599 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:19,600 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:19,600 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:19,601 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:19,602 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:19,603 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:19,603 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:19,604 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:19,618 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:19,627 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:19,628 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:19,629 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:19,629 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:19,630 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:19,631 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:19,632 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:19,632 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:19,633 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:19,634 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:19,636 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:19,661 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:19,662 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:19,663 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:19,664 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:19,667 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:19,693 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:19,693 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.274, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:19,694 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:19,695 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:19,696 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.298, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:19,718 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:19,719 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:19,719 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:19,720 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:19,720 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:19,721 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:19,721 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:19,721 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10469.000000000051
2025-10-15 12:57:19,722 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10492.999999999483
2025-10-15 12:57:19,722 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99670.00000000052
2025-10-15 12:57:19,723 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99693.99999999996
2025-10-15 12:57:19,723 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4163.000000000466
2025-10-15 12:57:19,724 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4186.999999999898
2025-10-15 12:57:19,724 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28637.99999999992
2025-10-15 12:57:19,725 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28661.999999999352
2025-10-15 12:57:19,725 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:19,726 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:19,727 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10469.000000000051}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99670.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4163.000000000466}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28637.99999999992}]
2025-10-15 12:57:19,728 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10492.999999999483}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99693.99999999996}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4186.999999999898}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28661.999999999352}]
2025-10-15 12:57:19,729 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:19,737 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:19,748 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:19,749 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:19,750 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:19,750 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:19,751 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:19,751 - APP.services.mt5_service - DEBUG - Position in day range: 0.5650155279503093
2025-10-15 12:57:19,751 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:19,752 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:19+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:19,752 - APP.services.mt5_service - DEBUG - Position in day range: 0.5646428571428648
2025-10-15 12:57:19,753 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:19+07:00
2025-10-15 12:57:19,753 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:18+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:19,753 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:19+07:00 trong DST: True
2025-10-15 12:57:19,754 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:18+07:00
2025-10-15 12:57:19,754 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:19,754 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:18+07:00 trong DST: True
2025-10-15 12:57:19,755 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:19,755 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:19,756 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:19,756 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:19,756 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:19,757 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:19,758 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:19,759 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2900', 'price': 4190.29, 'distance_pips': 0.8}, {'level': '2925', 'price': 4190.292, 'distance_pips': 0.55}, {'level': '2950', 'price': 4190.295, 'distance_pips': 0.3}, {'level': '2975', 'price': 4190.297, 'distance_pips': 0.05}]
2025-10-15 12:57:19,760 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:19,785 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:19,786 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:19,786 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:19,787 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:19,787 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:19,788 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2700', 'price': 4190.27, 'distance_pips': 0.4}, {'level': '2725', 'price': 4190.273, 'distance_pips': 0.15}, {'level': '2750', 'price': 4190.275, 'distance_pips': 0.1}, {'level': '2775', 'price': 4190.278, 'distance_pips': 0.35}]
2025-10-15 12:57:19,789 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.298
2025-10-15 12:57:19,790 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:19,791 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:19,791 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:19,792 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:19,792 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:19,819 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:19,819 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:19,820 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:19,821 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.274
2025-10-15 12:57:19,822 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:19,823 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:19,844 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.298
2025-10-15 12:57:19,845 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:19,845 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:19,846 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:19,847 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:19,847 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:19,848 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:19,849 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:19,849 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:19,850 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.274
2025-10-15 12:57:19,850 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:19,851 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:19,852 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.298
2025-10-15 12:57:19,853 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:19,855 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:19,862 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:19,881 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:19,881 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:19,882 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:19,883 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:19,886 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:19,886 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:19,911 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.298
2025-10-15 12:57:19,914 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.274
2025-10-15 12:57:19,916 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:19,938 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:19,939 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:19,939 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:19,940 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:19,941 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:19,941 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:19,942 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:19,943 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:19,943 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:19,944 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:19,945 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.274
2025-10-15 12:57:19,946 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:19,947 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:19,948 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:19,971 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:19,972 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:19,973 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:19,973 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:19,974 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:19,974 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:19,975 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:19,975 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:19,975 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:19,976 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:19,977 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:19,978 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:19,986 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:20,002 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:20,003 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:20,004 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:20,004 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:20,005 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:20,005 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:20,006 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:20,006 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,006 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:20,007 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:20,009 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:20,009 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:20,010 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:20,010 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:20,011 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:20,034 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:20,035 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:20,036 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:20,036 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:20,037 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:20,037 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:20,038 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:20,038 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:20,041 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:20,041 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:20,059 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:20,063 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:20,064 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:20,065 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:20,065 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,066 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:20,066 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.298, 'ask': 4190.335, 'last': 0.0, 'time': 1760533039}
2025-10-15 12:57:20,067 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:20,067 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:20,068 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:20,069 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.83s
2025-10-15 12:57:20,069 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:20,070 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,072 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:20,072 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:20,073 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:20,073 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:20,097 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:20,098 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:20,100 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:20,102 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:20,102 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:20,103 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,104 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.274, 'ask': 4190.311, 'last': 0.0, 'time': 1760533038}
2025-10-15 12:57:20,110 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:20,127 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:20,127 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:20,128 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:20,128 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,129 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:20,129 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 346, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:20,130 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 446, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:20,130 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,130 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:20,131 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,131 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:20,132 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,134 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:20,135 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:20,219 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,266 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:20,269 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:20,271 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:20,272 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:20,272 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:20,272 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:20,274 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:20,275 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,319 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:20,323 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:20,381 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:20,382 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:20,384 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:20,406 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10469.000000000051}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99670.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4163.000000000466}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28637.99999999992}]
2025-10-15 12:57:20,443 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:18+07:00
2025-10-15 12:57:20,445 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:20,451 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:20,453 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:20,457 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.22s
2025-10-15 12:57:20,469 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:20,469 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:20,470 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:20,471 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:20,472 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:20,542 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:20,543 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:20,544 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:20,545 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:20,545 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:20,546 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:20,547 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:20,547 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:21,048 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:21,050 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:21,051 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:21,052 - APP.services.mt5_service - DEBUG - Current price (cp): 4189.928
2025-10-15 12:57:21,057 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 346, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:21,114 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:21,115 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:21,116 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:21,118 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:21,118 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:21,118 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:21,119 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:21,122 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:21,122 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:21,123 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:21,123 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:21,125 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:21,126 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:21,126 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:21,127 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:21,129 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:21,130 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:21,130 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:21,130 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:21,135 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:21,158 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:21,160 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:21,160 - APP.ui.app_ui - INFO - Autorun tick: Kích hoạt worker kiểm tra.
2025-10-15 12:57:21,161 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:21,161 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.autorun.guard' vào nhóm 'ui.autorun' (metadata={'component': 'analysis', 'operation': 'autorun_guard'})
2025-10-15 12:57:21,161 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:20+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:21,162 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.autorun.guard vào group ui.autorun (metadata={'component': 'analysis', 'operation': 'autorun_guard'})
2025-10-15 12:57:21,163 - APP.ui.app_ui - DEBUG - Autorun tick worker: Bắt đầu kiểm tra điều kiện.
2025-10-15 12:57:21,163 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:20+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:21,167 - APP.ui.app_ui - INFO - Autorun tick worker: Điều kiện hợp lệ, yêu cầu bắt đầu phân tích trên luồng UI.
2025-10-15 12:57:21,173 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:20+07:00
2025-10-15 12:57:21,186 - APP.utils.threading_utils - DEBUG - Task 'ui.autorun.guard' (group=ui.autorun) hoàn tất sau 0.02s
2025-10-15 12:57:21,187 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:20+07:00 trong DST: True
2025-10-15 12:57:21,188 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:21,189 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:21,189 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:21,191 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:21,191 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:21,197 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: _request_autorun_start
2025-10-15 12:57:21,197 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:21,198 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:21,219 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:21,220 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:21,221 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:21,221 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:21,221 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:21,222 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:21,223 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:21,223 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:21,224 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:21,225 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:21,225 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:21,225 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:21,226 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:21,227 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:21,229 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:21,235 - APP.services.te_service - INFO - Đăng nhập thành công vào Trading Economics API với định dạng key username/password.
2025-10-15 12:57:21,254 - APP.services.news_service - DEBUG - Cấu hình NewsService đã được cập nhật.
2025-10-15 12:57:21,255 - APP.utils.threading_utils - DEBUG - Gửi task 'news.refresh.autorun' vào nhóm 'news.polling' (metadata={'component': 'news', 'priority': 'autorun', 'timeout_sec': 20})
2025-10-15 12:57:21,257 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:21,259 - APP.utils.threading_utils - DEBUG - Gửi task 'news.provider.fmp' vào nhóm 'news.polling' (metadata={'component': 'news', 'provider': 'fmp', 'priority': 'autorun'})
2025-10-15 12:57:21,260 - APP.utils.threading_utils - DEBUG - Gửi task 'analysis.session.autorun-20251015-125721' vào nhóm 'analysis.session' (metadata={'component': 'analysis', 'session_id': 'autorun-20251015-125721', 'priority': 'autorun'})
2025-10-15 12:57:21,260 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:21,261 - APP.utils.threading_utils - DEBUG - Gửi task 'news.provider.te' vào nhóm 'news.polling' (metadata={'component': 'news', 'provider': 'te', 'priority': 'autorun'})
2025-10-15 12:57:21,286 - APP.services.fmp_service - DEBUG - Đang lấy dữ liệu lịch kinh tế từ investpy...
2025-10-15 12:57:21,287 - APP.core.analysis_controller - INFO - Đã submit phiên phân tích autorun-20251015-125721 (priority=autorun)
2025-10-15 12:57:21,287 - APP.core.analysis_worker - DEBUG - Bắt đầu AnalysisWorker.run với model: models/gemini-2.5-flash
2025-10-15 12:57:21,287 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:21,288 - APP.services.te_service - DEBUG - Đang thực hiện cuộc gọi API đến Trading Economics...
2025-10-15 12:57:21,310 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 12:57:21,311 - APP.ui.app_ui - INFO - Autorun autorun-20251015-125721 bắt đầu ngay lập tức.
2025-10-15 12:57:21,312 - APP.core.analysis_worker - DEBUG - GIAI ĐOẠN 1: Khởi tạo và kiểm tra đầu vào.
2025-10-15 12:57:21,312 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:21,313 - APP.services.te_service - WARNING - Bỏ qua xác minh SSL cho Trading Economics API.
2025-10-15 12:57:21,313 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:21,314 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:21,317 - APP.ui.utils.ui_builder - DEBUG - Đã thay đổi trạng thái nút Start/Stop thành 'disabled'. Các điều khiển khác không bị ảnh hưởng.
2025-10-15 12:57:21,317 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:21,319 - APP.ui.app_ui - INFO - Phiên autorun-20251015-125721 bắt đầu (priority=autorun, source=autorun).
2025-10-15 12:57:21,319 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:21,321 - APP.services.gemini_service - INFO - Đã khởi tạo model 'models/gemini-2.5-flash' thành công.
2025-10-15 12:57:21,323 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:21,323 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:21,326 - APP.core.analysis_worker - DEBUG - BẮT ĐẦU GIAI ĐOẠN 2: Xây dựng ngữ cảnh và kiểm tra điều kiện.
2025-10-15 12:57:21,327 - APP.core.analysis_worker - DEBUG - BẮT ĐẦU GIAI ĐOẠN 3: Chuẩn bị và upload ảnh (TaskGroup analysis.upload).
2025-10-15 12:57:21,329 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:21,330 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:21,356 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:57:21,361 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-RUN.
2025-10-15 12:57:21,362 - APP.analysis.image_processor - DEBUG - Đang thử tải cache upload.
2025-10-15 12:57:21,362 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:21,363 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:57:21,367 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:21,370 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:21,371 - APP.analysis.image_processor - DEBUG - Đã tải cache upload với 13 mục.
2025-10-15 12:57:21,372 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:21,374 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:21,375 - APP.utils.threading_utils - DEBUG - Gửi task 'analysis.upload.autorun-20251015-125721.0' vào nhóm 'analysis.upload' (metadata={'component': 'analysis', 'session_id': 'autorun-20251015-125721', 'index': 0})
2025-10-15 12:57:21,376 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:21,377 - APP.utils.threading_utils - DEBUG - Gửi task 'analysis.upload.autorun-20251015-125721.1' vào nhóm 'analysis.upload' (metadata={'component': 'analysis', 'session_id': 'autorun-20251015-125721', 'index': 1})
2025-10-15 12:57:21,378 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:21,379 - APP.utils.threading_utils - DEBUG - Gửi task 'analysis.upload.autorun-20251015-125721.2' vào nhóm 'analysis.upload' (metadata={'component': 'analysis', 'session_id': 'autorun-20251015-125721', 'index': 2})
2025-10-15 12:57:21,382 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:21,413 - APP.utils.threading_utils - DEBUG - Gửi task 'analysis.upload.autorun-20251015-125721.3' vào nhóm 'analysis.upload' (metadata={'component': 'analysis', 'session_id': 'autorun-20251015-125721', 'index': 3})
2025-10-15 12:57:21,452 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:21,454 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:21,455 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:21,456 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:21,457 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:21,458 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4189.928, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:21,459 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:21,460 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:21,460 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:21,461 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:21,462 - APP.services.te_service - WARNING - Trading Economics trả về lỗi 403 - có thể do API key không hợp lệ hoặc hết hạn. Trả về danh sách rỗng để tránh dừng hệ thống.
2025-10-15 12:57:21,463 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:21,464 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:21,465 - APP.services.te_service - DEBUG - Đã khôi phục context SSL mặc định.
2025-10-15 12:57:21,465 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:21,466 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:21,467 - APP.utils.threading_utils - DEBUG - Task 'news.provider.te' (group=news.polling) hoàn tất sau 0.18s
2025-10-15 12:57:21,467 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:21,468 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10122.999999999593
2025-10-15 12:57:21,472 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99324.00000000007
2025-10-15 12:57:21,472 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 3817.0000000000073
2025-10-15 12:57:21,473 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28291.99999999946
2025-10-15 12:57:21,473 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:21,474 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10122.999999999593}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99324.00000000007}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3817.0000000000073}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28291.99999999946}]
2025-10-15 12:57:21,475 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:21,972 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:21,974 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:21,975 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:21,977 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.43s
2025-10-15 12:57:21,978 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:21,979 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:21,982 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.082
2025-10-15 12:57:21,983 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:21,990 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 346, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:21,990 - APP.services.mt5_service - DEBUG - Position in day range: 0.5592701863354042
2025-10-15 12:57:22,001 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:20+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:22,034 - APP.analysis.image_processor - DEBUG - Đã tính toán chữ ký cho XAUUSD_H1.png: 30447:1760533021:c2b94c935d545fe2
2025-10-15 12:57:22,045 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:20+07:00
2025-10-15 12:57:22,062 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:57:22,069 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:22,097 - APP.analysis.image_processor - DEBUG - Cache hit cho XAUUSD_H1.png, nhưng chữ ký không khớp.
2025-10-15 12:57:22,099 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:20+07:00 trong DST: True
2025-10-15 12:57:22,100 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:22,100 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:22,101 - APP.analysis.image_processor - DEBUG - Đang chuẩn bị ảnh: XAUUSD_H1.png, Tối ưu hóa: False
2025-10-15 12:57:22,108 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:22,111 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:22,115 - APP.analysis.image_processor - DEBUG - Bỏ qua tối ưu hóa hình ảnh.
2025-10-15 12:57:22,116 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:22,119 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:22,120 - APP.analysis.image_processor - INFO - Dang tai 'XAUUSD_H1.png' len Gemini File API...
2025-10-15 12:57:22,122 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:22,123 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:22,125 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:22,129 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:22,130 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:22,131 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:22,132 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9200', 'price': 4189.92, 'distance_pips': 0.8}, {'level': '9225', 'price': 4189.922, 'distance_pips': 0.55}, {'level': '9250', 'price': 4189.925, 'distance_pips': 0.3}, {'level': '9275', 'price': 4189.927, 'distance_pips': 0.05}]
2025-10-15 12:57:22,179 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:22,204 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:22,206 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:22,207 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:22,207 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:22,208 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:22,210 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:22,210 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:22,210 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:22,213 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:22,214 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.928
2025-10-15 12:57:22,216 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:22,217 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:22,218 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:22,218 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:22,219 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:22,220 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:22,223 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:22,223 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:22,224 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:22,224 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:22,225 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:22,225 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4189.928
2025-10-15 12:57:22,226 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:22,313 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:22,317 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:22,319 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:22,365 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:22,373 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 12:57:22,375 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:22,381 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:22,446 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:22,480 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 12:57:22,484 - APP.core.trading.conditions - DEBUG - Điều kiện NO-RUN được thỏa mãn. Lý do: Các điều kiện cho phép.
2025-10-15 12:57:22,485 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:22,487 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:22,489 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4189.928
2025-10-15 12:57:22,490 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:22,490 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:21+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:22,491 - APP.analysis.context_builder - DEBUG - Bắt đầu xây dựng ngữ cảnh lịch sử với budget: 2000 chars.
2025-10-15 12:57:22,492 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:22,492 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:22,493 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:21+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:22,494 - APP.analysis.context_builder - DEBUG - Parsing last 20 context files from: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots\Reports
2025-10-15 12:57:22,494 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:22,495 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:21+07:00
2025-10-15 12:57:22,496 - APP.analysis.context_builder - WARNING - Thư mục báo cáo không tồn tại: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots\Reports
2025-10-15 12:57:22,496 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:22,497 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:21+07:00 trong DST: True
2025-10-15 12:57:22,497 - APP.analysis.context_builder - DEBUG - Bắt đầu tóm tắt xu hướng checklist từ 0 items.
2025-10-15 12:57:22,498 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:22,499 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:22,499 - APP.analysis.context_builder - DEBUG - Không có items, trả về trend 'unknown'.
2025-10-15 12:57:22,499 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:22,500 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:22,501 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu tạo map timeframe với 4 tên file.
2025-10-15 12:57:22,502 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4189.928
2025-10-15 12:57:22,502 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:22,502 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_H1.png
2025-10-15 12:57:22,503 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:22,505 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:22,505 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'H1' cho 'XAUUSD_H1.png' bằng pattern đã biên dịch.
2025-10-15 12:57:22,506 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:22,506 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:22,507 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M1.png
2025-10-15 12:57:22,547 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:22,551 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:22,557 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:22,558 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M1' cho 'XAUUSD_M1.png' bằng pattern đã biên dịch.
2025-10-15 12:57:22,559 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:22,559 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:22,560 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:22,561 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M15.png
2025-10-15 12:57:22,562 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M15' cho 'XAUUSD_M15.png' bằng pattern đã biên dịch.
2025-10-15 12:57:22,564 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M5.png
2025-10-15 12:57:22,565 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:22,566 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:22,566 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:22,568 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:22,568 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:22,570 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M5' cho 'XAUUSD_M5.png' bằng pattern đã biên dịch.
2025-10-15 12:57:22,575 - APP.ui.utils.timeframe_detector - DEBUG - Kết thúc tạo map timeframe. Map: {'XAUUSD_H1.png': 'H1', 'XAUUSD_M1.png': 'M1', 'XAUUSD_M15.png': 'M15', 'XAUUSD_M5.png': 'M5'}
2025-10-15 12:57:22,576 - APP.analysis.context_builder - DEBUG - Ngữ cảnh lịch sử có kích thước 606 chars (trong budget).
2025-10-15 12:57:22,577 - APP.utils.threading_utils - DEBUG - Task song song 'build_historical_context_async' hoàn tất thành công.
2025-10-15 12:57:22,647 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:22,648 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:22,648 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:22,649 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:22,649 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:22,650 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:22,650 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:22,651 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:22,652 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:22,652 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:22,653 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:22,653 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:22,653 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:22,654 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:22,654 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:22,655 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:22,656 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:22,656 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:22,658 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:22,659 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:22,660 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:22,661 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:22,661 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:22,662 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:22,662 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:22,663 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.082, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:22,706 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:22,706 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:22,707 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:22,707 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:22,708 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10277.000000000044
2025-10-15 12:57:22,708 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99478.00000000052
2025-10-15 12:57:22,710 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 3971.0000000004584
2025-10-15 12:57:22,712 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28445.999999999913
2025-10-15 12:57:22,712 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:22,713 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10277.000000000044}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99478.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3971.0000000004584}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28445.999999999913}]
2025-10-15 12:57:22,713 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:22,995 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:22,998 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:22,998 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:22,999 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:22,999 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:22,999 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:23,000 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:23,000 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:23,001 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:23,001 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:23,002 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:23,002 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:23,002 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:23,004 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.035
2025-10-15 12:57:23,004 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:23,005 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:23,005 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:23,005 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:23,006 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:23,006 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:23,007 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:23,007 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:23,044 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:23,046 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:23,137 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 347, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:23,138 - APP.services.mt5_service - DEBUG - Position in day range: 0.5616614906832372
2025-10-15 12:57:23,142 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:23,159 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:21+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:23,212 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:23,285 - APP.analysis.image_processor - ERROR - Da xay ra loi khong mong muon trong qua trinh tai tep len cho 'XAUUSD_H1.png': Missing required parameter "ragStoreName"
Traceback (most recent call last):
  File "C:\tool\app_gemini-1\APP\analysis\image_processor.py", line 259, in upload_image_to_gemini
    file_obj = upload_fn(**upload_kwargs)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
        path=path, mime_type=mime_type, name=name, display_name=display_name, resumable=resumable
    )
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\client.py", line 120, in create_file
    request = self._local.discovery_api.media().upload(body={"file": file}, media_body=media)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\googleapiclient\discovery.py", line 1114, in method
    raise TypeError('Missing required parameter "%s"' % name)
TypeError: Missing required parameter "ragStoreName"
2025-10-15 12:57:23,322 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:23,333 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:21+07:00
2025-10-15 12:57:23,468 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:23,553 - APP.utils.threading_utils - DEBUG - Task 'analysis.upload.autorun-20251015-125721.0' (group=analysis.upload) hoàn tất sau 1.57s
2025-10-15 12:57:23,554 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:23,554 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:21+07:00 trong DST: True
2025-10-15 12:57:23,555 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:23,556 - APP.core.analysis_worker - ERROR - Không thể xử lý ảnh tại index 0: Không thể upload ảnh: XAUUSD_H1.png
2025-10-15 12:57:23,556 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:23,557 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:23,559 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:23,561 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:23,561 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:23,562 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:23,562 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:23,563 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:23,563 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:23,564 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:23,564 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:23,565 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:23,566 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:23,567 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:23,571 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:23,597 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:23,598 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '800', 'price': 4190.08, 'distance_pips': 0.2}, {'level': '825', 'price': 4190.082, 'distance_pips': 0.05}, {'level': '850', 'price': 4190.085, 'distance_pips': 0.3}, {'level': '875', 'price': 4190.087, 'distance_pips': 0.55}]
2025-10-15 12:57:23,599 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:23,599 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:23,599 - APP.analysis.image_processor - DEBUG - Đã tính toán chữ ký cho XAUUSD_M1.png: 32766:1760533021:1d0c8695fac6dc25
2025-10-15 12:57:23,600 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:23,600 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:23,601 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4189.928, 'ask': 4189.965, 'last': 0.0, 'time': 1760533040}
2025-10-15 12:57:23,601 - APP.analysis.image_processor - DEBUG - Cache hit cho XAUUSD_M1.png, nhưng chữ ký không khớp.
2025-10-15 12:57:23,603 - APP.analysis.image_processor - DEBUG - Đang chuẩn bị ảnh: XAUUSD_M1.png, Tối ưu hóa: False
2025-10-15 12:57:23,603 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:23,604 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:23,605 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:23,616 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:23,628 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:23,632 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:23,632 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 3.36s
2025-10-15 12:57:23,633 - APP.analysis.image_processor - DEBUG - Bỏ qua tối ưu hóa hình ảnh.
2025-10-15 12:57:23,635 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:23,637 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:23,638 - APP.analysis.image_processor - INFO - Dang tai 'XAUUSD_M1.png' len Gemini File API...
2025-10-15 12:57:23,643 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 12:57:23,711 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.082
2025-10-15 12:57:23,714 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:23,714 - APP.analysis.image_processor - DEBUG - Đã tính toán chữ ký cho XAUUSD_M15.png: 31394:1760533021:211cedaa4724489d
2025-10-15 12:57:23,716 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:23,717 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:23,717 - APP.analysis.image_processor - DEBUG - Cache hit cho XAUUSD_M15.png, nhưng chữ ký không khớp.
2025-10-15 12:57:23,718 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:23,723 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:23,724 - APP.analysis.image_processor - DEBUG - Đang chuẩn bị ảnh: XAUUSD_M15.png, Tối ưu hóa: False
2025-10-15 12:57:23,771 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:23,771 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:23,773 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:23,774 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 12:57:23,774 - APP.analysis.image_processor - DEBUG - Bỏ qua tối ưu hóa hình ảnh.
2025-10-15 12:57:23,775 - APP.analysis.image_processor - DEBUG - Đã tính toán chữ ký cho XAUUSD_M5.png: 34527:1760533021:8b57ffe98c060721
2025-10-15 12:57:23,775 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:23,776 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:23,777 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:23,778 - APP.analysis.image_processor - INFO - Dang tai 'XAUUSD_M15.png' len Gemini File API...
2025-10-15 12:57:23,778 - APP.analysis.image_processor - DEBUG - Cache hit cho XAUUSD_M5.png, nhưng chữ ký không khớp.
2025-10-15 12:57:23,779 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:23,780 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:23,783 - APP.analysis.image_processor - DEBUG - Đang chuẩn bị ảnh: XAUUSD_M5.png, Tối ưu hóa: False
2025-10-15 12:57:23,784 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.082
2025-10-15 12:57:23,826 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:23,837 - APP.analysis.image_processor - DEBUG - Bỏ qua tối ưu hóa hình ảnh.
2025-10-15 12:57:23,838 - APP.analysis.image_processor - INFO - Dang tai 'XAUUSD_M5.png' len Gemini File API...
2025-10-15 12:57:23,912 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:23,928 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:24,049 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:24,152 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:24,156 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:24,159 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:24,160 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:24,162 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:24,242 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:22+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:24,245 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:22+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:24,246 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:22+07:00
2025-10-15 12:57:24,247 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:22+07:00 trong DST: True
2025-10-15 12:57:24,248 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:24,248 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:24,336 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:24,347 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:24,429 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:24,616 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:24,764 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.082
2025-10-15 12:57:24,816 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:24,862 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:25,000 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:25,088 - APP.analysis.image_processor - ERROR - Da xay ra loi khong mong muon trong qua trinh tai tep len cho 'XAUUSD_M1.png': Missing required parameter "ragStoreName"
Traceback (most recent call last):
  File "C:\tool\app_gemini-1\APP\analysis\image_processor.py", line 259, in upload_image_to_gemini
    file_obj = upload_fn(**upload_kwargs)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
        path=path, mime_type=mime_type, name=name, display_name=display_name, resumable=resumable
    )
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\client.py", line 120, in create_file
    request = self._local.discovery_api.media().upload(body={"file": file}, media_body=media)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\googleapiclient\discovery.py", line 1114, in method
    raise TypeError('Missing required parameter "%s"' % name)
TypeError: Missing required parameter "ragStoreName"
2025-10-15 12:57:25,095 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:25,096 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:25,097 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:25,098 - APP.utils.threading_utils - DEBUG - Task 'analysis.upload.autorun-20251015-125721.1' (group=analysis.upload) hoàn tất sau 1.54s
2025-10-15 12:57:25,141 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:25,144 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:25,153 - APP.core.analysis_worker - ERROR - Không thể xử lý ảnh tại index 1: Không thể upload ảnh: XAUUSD_M1.png
2025-10-15 12:57:25,159 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:25,195 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:25,212 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 12:57:25,216 - APP.analysis.image_processor - ERROR - Da xay ra loi khong mong muon trong qua trinh tai tep len cho 'XAUUSD_M15.png': Missing required parameter "ragStoreName"
Traceback (most recent call last):
  File "C:\tool\app_gemini-1\APP\analysis\image_processor.py", line 259, in upload_image_to_gemini
    file_obj = upload_fn(**upload_kwargs)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
        path=path, mime_type=mime_type, name=name, display_name=display_name, resumable=resumable
    )
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\client.py", line 120, in create_file
    request = self._local.discovery_api.media().upload(body={"file": file}, media_body=media)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\googleapiclient\discovery.py", line 1114, in method
    raise TypeError('Missing required parameter "%s"' % name)
TypeError: Missing required parameter "ragStoreName"
2025-10-15 12:57:25,223 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:25,228 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:25,326 - APP.utils.threading_utils - DEBUG - Task 'analysis.upload.autorun-20251015-125721.2' (group=analysis.upload) hoàn tất sau 1.69s
2025-10-15 12:57:25,327 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:25,328 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.082
2025-10-15 12:57:25,333 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:25,333 - APP.core.analysis_worker - ERROR - Không thể xử lý ảnh tại index 2: Không thể upload ảnh: XAUUSD_M15.png
2025-10-15 12:57:25,333 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:25,335 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:25,351 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:25,372 - APP.analysis.image_processor - ERROR - Da xay ra loi khong mong muon trong qua trinh tai tep len cho 'XAUUSD_M5.png': Missing required parameter "ragStoreName"
Traceback (most recent call last):
  File "C:\tool\app_gemini-1\APP\analysis\image_processor.py", line 259, in upload_image_to_gemini
    file_obj = upload_fn(**upload_kwargs)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
        path=path, mime_type=mime_type, name=name, display_name=display_name, resumable=resumable
    )
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\client.py", line 120, in create_file
    request = self._local.discovery_api.media().upload(body={"file": file}, media_body=media)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\googleapiclient\discovery.py", line 1114, in method
    raise TypeError('Missing required parameter "%s"' % name)
TypeError: Missing required parameter "ragStoreName"
2025-10-15 12:57:25,411 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:25,411 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:25,414 - APP.utils.threading_utils - DEBUG - Task 'analysis.upload.autorun-20251015-125721.3' (group=analysis.upload) hoàn tất sau 1.71s
2025-10-15 12:57:25,440 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:25,444 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:25,470 - APP.core.analysis_worker - ERROR - Không thể xử lý ảnh tại index 3: Không thể upload ảnh: XAUUSD_M5.png
2025-10-15 12:57:25,470 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:25,471 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:25,472 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 12:57:25,472 - APP.analysis.image_processor - DEBUG - Đang lưu cache upload với 13 mục.
2025-10-15 12:57:25,473 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:25,474 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:25,492 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:25,503 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:25,503 - APP.analysis.image_processor - DEBUG - Đã lưu cache upload thành công.
2025-10-15 12:57:25,503 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:25,506 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:25,507 - APP.utils.threading_utils - DEBUG - Task song song '_execute_stage_3_logic' hoàn tất thành công.
2025-10-15 12:57:25,510 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.36s
2025-10-15 12:57:25,519 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:25,536 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:25,538 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:25,565 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:25,565 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:25,566 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:25,566 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:25,567 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:25,567 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:25,567 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:25,568 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:25,569 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:25,569 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:25,572 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:25,573 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:25,609 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:25,609 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:25,610 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:25,612 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:25,614 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:25,614 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:25,615 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:25,615 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:25,616 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:25,616 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:25,617 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:25,617 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:25,618 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:25,618 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:25,619 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:25,621 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:25,621 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:25,622 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:25,622 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:25,623 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:25,623 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:25,624 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:25,624 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:25,625 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.035, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:25,626 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:25,626 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:25,626 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:25,627 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:25,627 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:25,628 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:25,629 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:25,630 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:25,630 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:25,631 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:25,631 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10229.999999999563
2025-10-15 12:57:25,632 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:25,632 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99431.00000000004
2025-10-15 12:57:25,694 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:25,695 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 3923.999999999978
2025-10-15 12:57:25,721 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:25,721 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28398.999999999432
2025-10-15 12:57:25,722 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:25,723 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:25,724 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10229.999999999563}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99431.00000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3923.999999999978}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28398.999999999432}]
2025-10-15 12:57:25,724 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:25,725 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:25,726 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:25,726 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:25,726 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:25,759 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.082, 'ask': 4190.119, 'last': 0.0, 'time': 1760533041}
2025-10-15 12:57:25,760 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:25,762 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:25,794 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:25,795 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:25,795 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 346, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:25,796 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:25,796 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:25,797 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:25,798 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:25,799 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:25,799 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:25,800 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:25,800 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:25,801 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:25,802 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:25,802 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:25,803 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:25,803 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:25,803 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:25,804 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:25,804 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:25,805 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:25,806 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:25,806 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:25,807 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10277.000000000044}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99478.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3971.0000000004584}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28445.999999999913}]
2025-10-15 12:57:25,808 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:21+07:00
2025-10-15 12:57:25,808 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:25,809 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:25,810 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:25,837 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:25,852 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:25,954 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:25,955 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,056 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,057 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,129 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:26,132 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:26,132 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:26,136 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:26,137 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:26,138 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:26,139 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:26,139 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.539
2025-10-15 12:57:26,139 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:26,148 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 349, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:26,149 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 4.82s
2025-10-15 12:57:26,149 - APP.services.mt5_service - DEBUG - Position in day range: 0.5609316770186336
2025-10-15 12:57:26,160 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,204 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:22+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:26,213 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 445, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:26,214 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:22+07:00
2025-10-15 12:57:26,214 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,214 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:26,215 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:22+07:00 trong DST: True
2025-10-15 12:57:26,215 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,216 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:26,216 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:26,219 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:26,219 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:26,220 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:26,220 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:26,221 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:26,221 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:26,222 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:26,223 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,224 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:26,224 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:26,224 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,229 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:26,245 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:26,263 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '300', 'price': 4190.03, 'distance_pips': 0.5}, {'level': '325', 'price': 4190.032, 'distance_pips': 0.25}, {'level': '350', 'price': 4190.035, 'distance_pips': 0.0}, {'level': '375', 'price': 4190.037, 'distance_pips': 0.25}]
2025-10-15 12:57:26,263 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:26,265 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:26,265 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:26,266 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,266 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:26,268 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,271 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:26,271 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:26,272 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:26,273 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.035
2025-10-15 12:57:26,273 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:26,276 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:26,276 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:26,277 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:26,280 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:26,283 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:26,284 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:26,284 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:26,285 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:26,285 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:26,286 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:26,287 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.035
2025-10-15 12:57:26,294 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:26,320 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:26,361 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:26,362 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:26,362 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:26,363 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:26,364 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:26,364 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:26,365 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:25+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:26,365 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:26,366 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:25+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:26,367 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.035
2025-10-15 12:57:26,368 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:25+07:00
2025-10-15 12:57:26,368 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:26,369 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:25+07:00 trong DST: True
2025-10-15 12:57:26,369 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:26,369 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:26,370 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:26,373 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:26,374 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:26,375 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:26,375 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:26,377 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:26,377 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.035
2025-10-15 12:57:26,378 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:26,379 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:26,385 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:26,421 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:26,422 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:26,423 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:26,423 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:26,424 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:26,425 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:26,425 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,426 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:26,427 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,428 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:26,429 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:26,430 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:26,430 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:26,431 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:26,431 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:26,432 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:26,432 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:26,433 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:26,434 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:26,435 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:26,435 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:26,436 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:26,436 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:26,437 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:26,437 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:26,437 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:26,438 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:26,438 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:26,439 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:26,439 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:26,442 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:26,443 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:26,444 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:26,444 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:26,445 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:26,482 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:26,483 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:26,483 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:26,484 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:26,485 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:26,486 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:26,487 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:26,488 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:26,489 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,489 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:26,490 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,490 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:26,491 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:26,491 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:26,492 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:26,492 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:26,493 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:26,494 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:26,494 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:26,494 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.539, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:26,496 - APP.utils.threading_utils - DEBUG - Task song song 'get_market_data_async' hoàn tất thành công.
2025-10-15 12:57:26,496 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:26,497 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:26,498 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:26,498 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:26,499 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 12:57:26,499 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:26,500 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 12:57:26,500 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10733.999999999469
2025-10-15 12:57:26,501 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 12:57:26,501 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99934.99999999994
2025-10-15 12:57:26,502 - APP.utils.safe_data - DEBUG - Get top-level key 'symbol': XAUUSD
2025-10-15 12:57:26,502 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4427.999999999884
2025-10-15 12:57:26,502 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:26,503 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28902.999999999338
2025-10-15 12:57:26,504 - APP.utils.safe_data - DEBUG - Get top-level key 'volatility_regime': trending
2025-10-15 12:57:26,504 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:26,505 - APP.utils.safe_data - DEBUG - Get top-level key 'ict_patterns': {'liquidity_h1': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': 35}, {'price': 4179.805, 'bar_index': 9}, {'price': 4155.378, 'bar_index': 20}, {'price': 4145.283, 'bar_index': 12}, {'price': 4117.165, 'bar_index': -3}], 'swing_lows_SSL': [{'price': 3944.632, 'bar_index': -48}, {'price': 3947.001, 'bar_index': -38}, {'price': 3952.655, 'bar_index': -35}, {'price': 3970.666, 'bar_index': -28}, {'price': 3975.036, 'bar_index': -25}]}, 'fvgs_h1': [{'type': 'Bullish', 'top': 4157.184, 'bottom': 4146.081}, {'type': 'Bearish', 'top': 4207.086, 'bottom': 4206.478}], 'order_blocks_h1': [{'type': 'Bullish', 'top': 4020.939, 'bottom': 4005.731, 'bar_index': 58}, {'type': 'Bearish', 'top': 4218.311, 'bottom': 4207.086, 'bar_index': 115}], 'liquidity_voids_h1': [{'type': 'Bullish', 'top': 4186.836, 'bottom': 4162.109, 'bar_index': 78}, {'type': 'Bullish', 'top': 4095.667, 'bottom': 4078.257, 'bar_index': 44}, {'type': 'Bullish', 'top': 4045.367, 'bottom': 4008.706, 'bar_index': 29}], 'premium_discount_h1': {'high': 4218.311, 'low': 3975.036, 'equilibrium': 4096.6735, 'status': 'Premium'}, 'mss_h1': {'type': 'Bearish', 'event': 'CHoCH', 'price_level': 3975.036, 'break_bar_index': 31}, 'liquidity_m15': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': -27}, {'price': 4206.478, 'bar_index': -19}, {'price': 4204.346, 'bar_index': -14}, {'price': 4193.778, 'bar_index': -38}, {'price': 4190.951, 'bar_index': -45}], 'swing_lows_SSL': [{'price': 4097.823, 'bar_index': -100}, {'price': 4126.254, 'bar_index': -92}, {'price': 4127.961, 'bar_index': -87}, {'price': 4134.418, 'bar_index': -74}, {'price': 4140.669, 'bar_index': -68}]}, 'fvgs_m15': [{'type': 'Bullish', 'top': 4186.166, 'bottom': 4180.028}, {'type': 'Bearish', 'top': 4207.767, 'bottom': 4203.85}], 'order_blocks_m15': [{'type': 'Bullish', 'top': 4168.145, 'bottom': 4159.337, 'bar_index': 43}, {'type': 'Bearish', 'top': 4200.59, 'bottom': 4193.513, 'bar_index': 87}], 'liquidity_voids_m15': [{'type': 'Bearish', 'top': 4193.834, 'bottom': 4180.184, 'bar_index': 39}, {'type': 'Bullish', 'top': 4203.231, 'bottom': 4191.561, 'bar_index': 33}, {'type': 'Bearish', 'top': 4217.002, 'bottom': 4207.767, 'bar_index': 25}], 'premium_discount_m15': {'high': 4204.346, 'low': 4140.669, 'equilibrium': 4172.5075, 'status': 'Premium'}, 'mss_m15': None, 'liquidity_m5': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': 103}, {'price': 4217.002, 'bar_index': 110}, {'price': 4207.942, 'bar_index': 95}, {'price': 4206.478, 'bar_index': 128}, {'price': 4204.346, 'bar_index': 144}], 'swing_lows_SSL': [{'price': 4150.174, 'bar_index': -14}, {'price': 4153.911, 'bar_index': 9}, {'price': 4157.184, 'bar_index': -8}, {'price': 4158.095, 'bar_index': 4}, {'price': 4159.337, 'bar_index': 14}]}, 'fvgs_m5': [{'type': 'Bullish', 'top': 4187.167, 'bottom': 4186.255}, {'type': 'Bearish', 'top': 4202.712, 'bottom': 4192.902}], 'order_blocks_m5': [{'type': 'Bullish', 'top': 4186.255, 'bottom': 4181.314, 'bar_index': 177}, {'type': 'Bearish', 'top': 4202.804, 'bottom': 4198.267, 'bar_index': 168}], 'liquidity_voids_m5': [{'type': 'Bearish', 'top': 4189.236, 'bottom': 4187.167, 'bar_index': 179}, {'type': 'Bullish', 'top': 4190.013, 'bottom': 4181.504, 'bar_index': 178}, {'type': 'Bearish', 'top': 4198.731, 'bottom': 4192.783, 'bar_index': 170}], 'premium_discount_m5': {'high': 4204.346, 'low': 4159.337, 'equilibrium': 4181.8415, 'status': 'Premium'}, 'mss_m5': None, 'liquidity_m1': {'swing_highs_BSL': [{'price': 4204.346, 'bar_index': -37}, {'price': 4203.585, 'bar_index': -78}, {'price': 4203.317, 'bar_index': -51}, {'price': 4202.804, 'bar_index': -14}, {'price': 4202.677, 'bar_index': -63}], 'swing_lows_SSL': [{'price': 4176.248, 'bar_index': 12}, {'price': 4180.095, 'bar_index': 15}, {'price': 4180.184, 'bar_index': 6}, {'price': 4180.555, 'bar_index': 3}, {'price': 4181.314, 'bar_index': 31}]}, 'fvgs_m1': [{'type': 'Bullish', 'top': 4187.818, 'bottom': 4186.031}, {'type': 'Bearish', 'top': 4192.783, 'bottom': 4192.138}], 'order_blocks_m1': [{'type': 'Bearish', 'top': 4198.731, 'bottom': 4197.213, 'bar_index': 72}], 'liquidity_voids_m1': [{'type': 'Bearish', 'top': 4188.05, 'bottom': 4187.211, 'bar_index': 89}, {'type': 'Bullish', 'top': 4188.443, 'bottom': 4186.099, 'bar_index': 84}, {'type': 'Bullish', 'top': 4186.031, 'bottom': 4182.172, 'bar_index': 83}], 'premium_discount_m1': {'high': 4202.804, 'low': 4181.314, 'equilibrium': 4192.059, 'status': 'Discount'}, 'mss_m1': None}
2025-10-15 12:57:26,505 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10733.999999999469}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99934.99999999994}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4427.999999999884}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28902.999999999338}]
2025-10-15 12:57:26,506 - APP.utils.safe_data - DEBUG - Get top-level key 'news_analysis': {'is_in_news_window': False, 'reason': None, 'upcoming_events': [{'id': 'investpy_15/10/2025_13:30_NY Empire State Manufacturing Index  (Oct)', 'when_utc': datetime.datetime(2025, 10, 15, 13, 30, tzinfo=<UTC>), 'title': 'NY Empire State Manufacturing Index  (Oct)', 'country': 'united states', 'impact': 'medium', 'source': 'investpy', 'actual': 10.7, 'forecast': -1.8, 'previous': -8.7, 'unit': None, 'surprise_score': 6.944444444444445, 'surprise_direction': 'positive', 'when_local': datetime.datetime(2025, 10, 15, 20, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '32m'}, {'id': 'investpy_16/10/2025_13:30_Philadelphia Fed Manufacturing Index  (Oct)', 'when_utc': datetime.datetime(2025, 10, 16, 13, 30, tzinfo=<UTC>), 'title': 'Philadelphia Fed Manufacturing Index  (Oct)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': 8.6, 'previous': 23.2, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 20, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '24h 32m'}, {'id': 'investpy_16/10/2025_13:30_PPI (MoM)  (Sep)', 'when_utc': datetime.datetime(2025, 10, 16, 13, 30, tzinfo=<UTC>), 'title': 'PPI (MoM)  (Sep)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': None, 'previous': -0.1, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 20, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '24h 32m'}], 'last_refresh_utc': datetime.datetime(2025, 10, 15, 12, 56, 21, 687775, tzinfo=<UTC>), 'latency_sec': 18.31459249999898}
2025-10-15 12:57:26,507 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:26,507 - APP.utils.safe_data - DEBUG - Get top-level key 'news_analysis': {'is_in_news_window': False, 'reason': None, 'upcoming_events': [{'id': 'investpy_15/10/2025_13:30_NY Empire State Manufacturing Index  (Oct)', 'when_utc': datetime.datetime(2025, 10, 15, 13, 30, tzinfo=<UTC>), 'title': 'NY Empire State Manufacturing Index  (Oct)', 'country': 'united states', 'impact': 'medium', 'source': 'investpy', 'actual': 10.7, 'forecast': -1.8, 'previous': -8.7, 'unit': None, 'surprise_score': 6.944444444444445, 'surprise_direction': 'positive', 'when_local': datetime.datetime(2025, 10, 15, 20, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '32m'}, {'id': 'investpy_16/10/2025_13:30_Philadelphia Fed Manufacturing Index  (Oct)', 'when_utc': datetime.datetime(2025, 10, 16, 13, 30, tzinfo=<UTC>), 'title': 'Philadelphia Fed Manufacturing Index  (Oct)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': 8.6, 'previous': 23.2, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 20, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '24h 32m'}, {'id': 'investpy_16/10/2025_13:30_PPI (MoM)  (Sep)', 'when_utc': datetime.datetime(2025, 10, 16, 13, 30, tzinfo=<UTC>), 'title': 'PPI (MoM)  (Sep)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': None, 'previous': -0.1, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 20, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '24h 32m'}], 'last_refresh_utc': datetime.datetime(2025, 10, 15, 12, 56, 21, 687775, tzinfo=<UTC>), 'latency_sec': 18.31459249999898}
2025-10-15 12:57:26,512 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:26,520 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:26,537 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 12:57:26,537 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:26,538 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 12:57:26,538 - APP.services.mt5_service - DEBUG - Position in day range: 0.5687577639751539
2025-10-15 12:57:26,541 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:26,567 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:25+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:26,567 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,568 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:25+07:00
2025-10-15 12:57:26,568 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.035, 'ask': 4190.072, 'last': 0.0, 'time': 1760533042}
2025-10-15 12:57:26,569 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:25+07:00 trong DST: True
2025-10-15 12:57:26,569 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:26,570 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:26,570 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:26,571 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:26,572 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:26,573 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,573 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,574 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,581 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,588 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 12:57:26,595 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 347, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:26,596 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '5300', 'price': 4190.53, 'distance_pips': 0.9}, {'level': '5325', 'price': 4190.532, 'distance_pips': 0.65}, {'level': '5350', 'price': 4190.535, 'distance_pips': 0.4}, {'level': '5375', 'price': 4190.537, 'distance_pips': 0.15}]
2025-10-15 12:57:26,597 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,600 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:26,622 - APP.services.fmp_service - INFO - Lấy thành công 402 sự kiện từ investpy cho 7 ngày tới.
2025-10-15 12:57:26,628 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:26,631 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,631 - APP.utils.threading_utils - DEBUG - Task 'news.provider.fmp' (group=news.polling) hoàn tất sau 5.35s
2025-10-15 12:57:26,632 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,632 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,667 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,686 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,689 - APP.ui.app_ui - DEBUG - Callback nhận được 144 sự kiện tin tức mới.
2025-10-15 12:57:26,690 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:26,691 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,691 - APP.services.news_service - INFO - NewsService làm mới cache (144 sự kiện, priority=autorun, source=network, latency=5.43s)
2025-10-15 12:57:26,692 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.539
2025-10-15 12:57:26,692 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,693 - APP.utils.threading_utils - DEBUG - Task 'news.refresh.autorun' (group=news.polling) hoàn tất sau 5.43s
2025-10-15 12:57:26,694 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:26,694 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,696 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:26,698 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,699 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:26,720 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,721 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:26,722 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:26,723 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:26,723 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:26,724 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.539
2025-10-15 12:57:26,724 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:26,725 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:26,725 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:26,725 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:26,726 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,730 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:26,730 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,752 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:26,753 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:26,753 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:57:26,754 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:26,754 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:26,756 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.539
2025-10-15 12:57:26,756 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,757 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:26,757 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,760 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,760 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:26,761 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10229.999999999563}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99431.00000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3923.999999999978}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28398.999999999432}]
2025-10-15 12:57:26,784 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:26,785 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:22+07:00
2025-10-15 12:57:26,786 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:26,786 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:26,787 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:26,787 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:26,788 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.539
2025-10-15 12:57:26,789 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 12:57:26,794 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:26,819 - APP.utils.threading_utils - DEBUG - Task song song '_execute_stage_2_logic' hoàn tất thành công.
2025-10-15 12:57:26,820 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:26,822 - APP.core.analysis_worker - DEBUG - BẮT ĐẦU GIAI ĐOẠN 4: Gọi Model AI
2025-10-15 12:57:26,823 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:26,824 - APP.core.analysis_worker - WARNING - Khong co media nao duoc upload thanh cong; tiep tuc goi model voi prompt van ban.
2025-10-15 12:57:26,845 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:26,846 - APP.ui.components.prompt_manager - DEBUG - Đang lấy nội dung prompts từ UI.
2025-10-15 12:57:26,847 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,847 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,848 - APP.ui.components.prompt_manager - DEBUG - Đang lấy nội dung prompts từ UI.
2025-10-15 12:57:26,848 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:26,849 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:26,849 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:26,850 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:26,850 - APP.analysis.prompt_builder - DEBUG - Không có vị thế, chọn prompt 'no_entry' để tìm kiếm setup.
2025-10-15 12:57:26,851 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:26,851 - APP.analysis.prompt_builder - DEBUG - Bắt đầu xây dựng prompt cuối cùng.
2025-10-15 12:57:26,852 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:26,854 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:26,865 - APP.analysis.prompt_builder - DEBUG - Đã xây dựng xong prompt cuối cùng.
2025-10-15 12:57:26,873 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,875 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:26,875 - APP.core.analysis_worker - DEBUG - --- PROMPT FINAL GỬI ĐẾN AI ---
VAI TRÒ & BỐI CẢNH
- Bạn là một nhà giao dịch ICT chuyên nghiệp và một nhà quản lý rủi ro.
- Nhiệm vụ của bạn là phân tích thị trường theo phương pháp Top-Down VÀ quản lý các lệnh đang mở một cách hiệu quả.
- Bạn phải suy luận logic, dựa trên bằng chứng từ dữ liệu thị trường.

---
### NHIỆM VỤ 1: XÁC ĐỊNH BỐI CẢNH VÀ HÀNH ĐỘNG CẦN THIẾT

**DỰA VÀO `CONTEXT.HAS_ACTIVE_POSITIONS`, HÃY CHỌN MỘT TRONG HAI LUỒNG SAU:**

---
#### LUỒNG A: CHƯA CÓ LỆNH (HAS_ACTIVE_POSITIONS = false)

**A1. QUY TRÌNH PHÂN TÍCH TOP-DOWN 4 BƯỚC**
   - Thực hiện phân tích Top-Down (H1 -> M15 -> M5) để tìm kiếm cơ hội giao dịch chất lượng cao.
   - **Bằng chứng**: Luôn trích dẫn dữ liệu cụ thể từ `EXTRACT_JSON` và `CONCEPT_VALUE_TABLE`.
   - **Kết quả**: Xây dựng một "câu chuyện thị trường", xếp hạng setup (`A+`, `B`, `C`), và lập kế hoạch giao dịch chi tiết nếu phù hợp.

**A2. TẠO ĐỐI TƯỢNG JSON - ĐÁNH GIÁ SETUP**
   - Tổng hợp kết quả phân tích vào đối tượng JSON sau. **Đây phải là phần đầu tiên trong phản hồi của bạn.**
   ```json
   {
     "cycle": "[ĐIỀN THỜI GIAN HIỆN TẠI]",
     "symbol": "[LẤY TỪ DỮ LIỆU]",
     "mode": "expert_setup_evaluation",
     "market_narrative": "[CÂU CHUYỆN THỊ TRƯỜNG TỪ BƯỚC A1]",
     "setup_grade": "[A+/B/C/Không có]",
     "reasoning_summary": "[GIẢI THÍCH NGẮN GỌN VÌ SAO XẾP HẠNG SETUP NHƯ VẬY]",
     "top_down_analysis": {
       "h1_context": { "order_flow": "[...]", "draw_on_liquidity": "[...]" },
       "m15_poi": { "type": "[...]", "price_zone": "[...]", "quality_assessment": "[...]" },
       "m5_m1_confirmation": { "status": "[...]", "signal": "[...]" }
     },
     "proposed_plan": {
       "direction": "[long/short hoặc null]",
       "entry": "[Giá hoặc 0.0]",
       "sl": "[Giá hoặc 0.0]",
       "tp1": "[Giá hoặc 0.0]",
       "tp2": "[Giá hoặc 0.0]",
       "risk_multiplier": "[1.0 cho A+, 0.5 cho B, 0.0 cho các trường hợp khác]"
     }
   }
   ```

---
#### LUỒNG B: ĐANG CÓ LỆNH (HAS_ACTIVE_POSITIONS = true)

**B1. PHÂN TÍCH BỐI CẢNH ĐỂ QUẢN LÝ LỆNH**
   - **Đánh giá lại Draw on Liquidity (H1)**: Mục tiêu giá ban đầu còn hợp lệ không? Có mục tiêu nào mới xuất hiện không?
   - **Phân tích cấu trúc M5/M1**: Cấu trúc thị trường gần nhất (`EXTRACT_JSON.tf.M5.mss_bos`) đang ủng hộ hay chống lại lệnh hiện tại?
   - **Tìm kiếm các vùng cản/hỗ trợ mới**: Có FVG hoặc Order Block nào mới hình thành có thể ảnh hưởng đến lệnh không?

**B2. TẠO ĐỐI TƯỢNG JSON - KẾ HOẠCH QUẢN LÝ**
   - Dựa trên phân tích ở B1, hãy tạo kế hoạch quản lý cho TỪNG lệnh đang mở.
   - **Đây phải là phần đầu tiên trong phản hồi của bạn.**
   ```json
   {
     "cycle": "[ĐIỀN THỜI GIAN HIỆN TẠI]",
     "symbol": "[LẤY TỪ DỮ LIỆU]",
     "mode": "trade_management",
     "market_narrative": "[TÓM TẮT BỐI CẢNH THỊ TRƯỜNG HIỆN TẠI ẢNH HƯỞNG ĐẾN LỆNH]",
     "reasoning_summary": "[GIẢI THÍCH NGẮN GỌN CHO CÁC HÀNH ĐỘNG QUẢN LÝ]",
     "management_plan": {
       "[TICKET_LỆNH_1]": {
         "action": "[HOLD/CLOSE_PARTIAL/MOVE_SL_TO_ENTRY/TRAIL_SL]",
         "percentage": "[50 nếu CLOSE_PARTIAL, ngược lại 0]",
         "sl": "[Giá SL mới, 'entry', 'last_swing_low_m5', 'last_swing_high_m5' hoặc null nếu không đổi]",
         "tp": "[Giá TP mới hoặc null nếu không đổi]",
         "reason": "[Lý do ngắn gọn cho hành động này]"
       },
       "[TICKET_LỆNH_2]": {
         "...": "..."
       },
       "ALL": {
         "action": "[HOLD/CLOSE_ALL]",
         "reason": "[Áp dụng nếu muốn thực hiện hành động cho tất cả lệnh]"
       }
     }
   }
   ```

---
### NHIỆM VỤ 2: VIẾT BÁO CÁO PHÂN TÍCH CHI TIẾT

Dựa vào đối tượng JSON bạn vừa tạo (từ Luồng A hoặc B), hãy viết một báo cáo chuyên nghiệp.

A) **TÓM TẮT NHANH (7 DÒNG):**
   - **(Luồng A)**: Trình bày tóm tắt về cơ hội giao dịch như prompt cũ.
   - **(Luồng B)**: Trình bày tóm tắt về các hành động quản lý được đề xuất cho mỗi lệnh.

B) **PHÂN TÍCH CHUYÊN SÂU:**
   - Diễn giải chi tiết về `market_narrative`.
   - Giải thích lý do đằng sau `setup_grade` (Luồng A) hoặc các quyết định trong `management_plan` (Luồng B), luôn sử dụng bằng chứng từ dữ liệu.

---
**Dữ liệu thị trường và tài khoản (MT5):**
```json
{'symbol': 'XAUUSD', 'generated_at': '2025-10-15 19:57:26', 'broker_time': '2025-10-15T19:57:22+07:00', 'timezone': 'Asia/Ho_Chi_Minh', 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}, 'positions': [], 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}, 'symbol_rules': {'volume_min': 0.01, 'volume_max': 200.0, 'volume_step': 0.01, 'trade_tick_value': 0.1, 'trade_tick_size': 0.001, 'stop_level_points': 0, 'freeze_level_points': 0, 'margin_initial': 0.0, 'margin_maintenance': 0.0}, 'pip': {'points_per_pip': 10, 'value_per_point': 0.1, 'pip_value_per_lot': 1.0}, 'tick': {'bid': 4190.035, 'ask': 4190.072, 'last': 0.0, 'time': 1760533042}, 'tick_stats_5m': {'ticks_per_min': 347, 'median_spread': 37.0, 'p90_spread': 37}, 'tick_stats_30m': {'ticks_per_min': 445, 'median_spread': 37, 'p90_spread': 37}, 'levels': {'daily': {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, 'prev_day': {'high': 4179.805, 'low': 4090.604}, 'weekly': {'open': 4035.257, 'high': 4218.311, 'low': 4024.361}, 'prev_week': {'high': 4059.382, 'low': 3884.095}, 'monthly': {'open': 3863.002, 'high': 4218.311, 'low': 3819.397}}, 'day_open': 4161.636, 'prev_day_close': 4161.674, 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}, 'day_range': 64.39999999999964, 'day_range_pct_of_adr20': 100.43699450091795, 'position_in_day_range': 0.5609316770186336, 'sessions_today': {'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, 'session_liquidity': {'asia_high': 4218.311, 'asia_low': 4184.27}, 'volatility': {'ATR': {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}}, 'volatility_regime': 'trending', 'trend_refs': {'EMA': {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}}, 'vwap': {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}, 'kills': {'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, 'is_silver_bullet_window': False, 'killzone_active': 'newyork_am', 'mins_to_next_killzone': None, 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10229.999999999563}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99431.00000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3923.999999999978}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28398.999999999432}], 'round_levels': [{'level': '300', 'price': 4190.03, 'distance_pips': 0.5}, {'level': '325', 'price': 4190.032, 'distance_pips': 0.25}, {'level': '350', 'price': 4190.035, 'distance_pips': 0.0}, {'level': '375', 'price': 4190.037, 'distance_pips': 0.25}], 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}, 'ict_patterns': {'liquidity_h1': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': 35}, {'price': 4179.805, 'bar_index': 9}, {'price': 4155.378, 'bar_index': 20}, {'price': 4145.283, 'bar_index': 12}, {'price': 4117.165, 'bar_index': -3}], 'swing_lows_SSL': [{'price': 3944.632, 'bar_index': -48}, {'price': 3947.001, 'bar_index': -38}, {'price': 3952.655, 'bar_index': -35}, {'price': 3970.666, 'bar_index': -28}, {'price': 3975.036, 'bar_index': -25}]}, 'fvgs_h1': [{'type': 'Bullish', 'top': 4157.184, 'bottom': 4146.081}, {'type': 'Bearish', 'top': 4207.086, 'bottom': 4206.478}], 'order_blocks_h1': [{'type': 'Bullish', 'top': 4020.939, 'bottom': 4005.731, 'bar_index': 58}, {'type': 'Bearish', 'top': 4218.311, 'bottom': 4207.086, 'bar_index': 115}], 'liquidity_voids_h1': [{'type': 'Bullish', 'top': 4186.836, 'bottom': 4162.109, 'bar_index': 78}, {'type': 'Bullish', 'top': 4095.667, 'bottom': 4078.257, 'bar_index': 44}, {'type': 'Bullish', 'top': 4045.367, 'bottom': 4008.706, 'bar_index': 29}], 'premium_discount_h1': {'high': 4218.311, 'low': 3975.036, 'equilibrium': 4096.6735, 'status': 'Premium'}, 'mss_h1': {'type': 'Bearish', 'event': 'CHoCH', 'price_level': 3975.036, 'break_bar_index': 31}, 'liquidity_m15': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': -27}, {'price': 4206.478, 'bar_index': -19}, {'price': 4204.346, 'bar_index': -14}, {'price': 4193.778, 'bar_index': -38}, {'price': 4190.951, 'bar_index': -45}], 'swing_lows_SSL': [{'price': 4097.823, 'bar_index': -100}, {'price': 4126.254, 'bar_index': -92}, {'price': 4127.961, 'bar_index': -87}, {'price': 4134.418, 'bar_index': -74}, {'price': 4140.669, 'bar_index': -68}]}, 'fvgs_m15': [{'type': 'Bullish', 'top': 4186.166, 'bottom': 4180.028}, {'type': 'Bearish', 'top': 4207.767, 'bottom': 4203.85}], 'order_blocks_m15': [{'type': 'Bullish', 'top': 4168.145, 'bottom': 4159.337, 'bar_index': 43}, {'type': 'Bearish', 'top': 4200.59, 'bottom': 4193.513, 'bar_index': 87}], 'liquidity_voids_m15': [{'type': 'Bearish', 'top': 4193.834, 'bottom': 4180.184, 'bar_index': 39}, {'type': 'Bullish', 'top': 4203.231, 'bottom': 4191.561, 'bar_index': 33}, {'type': 'Bearish', 'top': 4217.002, 'bottom': 4207.767, 'bar_index': 25}], 'premium_discount_m15': {'high': 4204.346, 'low': 4140.669, 'equilibrium': 4172.5075, 'status': 'Premium'}, 'mss_m15': None, 'liquidity_m5': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': 103}, {'price': 4217.002, 'bar_index': 110}, {'price': 4207.942, 'bar_index': 95}, {'price': 4206.478, 'bar_index': 128}, {'price': 4204.346, 'bar_index': 144}], 'swing_lows_SSL': [{'price': 4150.174, 'bar_index': -14}, {'price': 4153.911, 'bar_index': 9}, {'price': 4157.184, 'bar_index': -8}, {'price': 4158.095, 'bar_index': 4}, {'price': 4159.337, 'bar_index': 14}]}, 'fvgs_m5': [{'type': 'Bullish', 'top': 4187.167, 'bottom': 4186.255}, {'type': 'Bearish', 'top': 4202.712, 'bottom': 4192.902}], 'order_blocks_m5': [{'type': 'Bullish', 'top': 4186.255, 'bottom': 4181.314, 'bar_index': 177}, {'type': 'Bearish', 'top': 4202.804, 'bottom': 4198.267, 'bar_index': 168}], 'liquidity_voids_m5': [{'type': 'Bearish', 'top': 4189.236, 'bottom': 4187.167, 'bar_index': 179}, {'type': 'Bullish', 'top': 4190.013, 'bottom': 4181.504, 'bar_index': 178}, {'type': 'Bearish', 'top': 4198.731, 'bottom': 4192.783, 'bar_index': 170}], 'premium_discount_m5': {'high': 4204.346, 'low': 4159.337, 'equilibrium': 4181.8415, 'status': 'Premium'}, 'mss_m5': None, 'liquidity_m1': {'swing_highs_BSL': [{'price': 4204.346, 'bar_index': -37}, {'price': 4203.585, 'bar_index': -78}, {'price': 4203.317, 'bar_index': -51}, {'price': 4202.804, 'bar_index': -14}, {'price': 4202.677, 'bar_index': -63}], 'swing_lows_SSL': [{'price': 4176.248, 'bar_index': 12}, {'price': 4180.095, 'bar_index': 15}, {'price': 4180.184, 'bar_index': 6}, {'price': 4180.555, 'bar_index': 3}, {'price': 4181.314, 'bar_index': 31}]}, 'fvgs_m1': [{'type': 'Bullish', 'top': 4187.818, 'bottom': 4186.031}, {'type': 'Bearish', 'top': 4192.783, 'bottom': 4192.138}], 'order_blocks_m1': [{'type': 'Bearish', 'top': 4198.731, 'bottom': 4197.213, 'bar_index': 72}], 'liquidity_voids_m1': [{'type': 'Bearish', 'top': 4188.05, 'bottom': 4187.211, 'bar_index': 89}, {'type': 'Bullish', 'top': 4188.443, 'bottom': 4186.099, 'bar_index': 84}, {'type': 'Bullish', 'top': 4186.031, 'bottom': 4182.172, 'bar_index': 83}], 'premium_discount_m1': {'high': 4202.804, 'low': 4181.314, 'equilibrium': 4192.059, 'status': 'Discount'}, 'mss_m1': None}, 'risk_model': {}, 'rr_projection': {}, 'news_analysis': {'is_in_news_window': False, 'reason': None, 'upcoming_events': [{'id': 'investpy_15/10/2025_13:30_NY Empire State Manufacturing Index  (Oct)', 'when_utc': datetime.datetime(2025, 10, 15, 13, 30, tzinfo=<UTC>), 'title': 'NY Empire State Manufacturing Index  (Oct)', 'country': 'united states', 'impact': 'medium', 'source': 'investpy', 'actual': 10.7, 'forecast': -1.8, 'previous': -8.7, 'unit': None, 'surprise_score': 6.944444444444445, 'surprise_direction': 'positive', 'when_local': datetime.datetime(2025, 10, 15, 20, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '32m'}, {'id': 'investpy_16/10/2025_13:30_Philadelphia Fed Manufacturing Index  (Oct)', 'when_utc': datetime.datetime(2025, 10, 16, 13, 30, tzinfo=<UTC>), 'title': 'Philadelphia Fed Manufacturing Index  (Oct)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': 8.6, 'previous': 23.2, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 20, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '24h 32m'}, {'id': 'investpy_16/10/2025_13:30_PPI (MoM)  (Sep)', 'when_utc': datetime.datetime(2025, 10, 16, 13, 30, tzinfo=<UTC>), 'title': 'PPI (MoM)  (Sep)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': None, 'previous': -0.1, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 20, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '24h 32m'}], 'last_refresh_utc': datetime.datetime(2025, 10, 15, 12, 56, 21, 687775, tzinfo=<UTC>), 'latency_sec': 18.31459249999898}, 'concept_value_table': '| Khái niệm (Concept) | Giá trị (Value) |\n|---|---|\n| Symbol | XAUUSD |\n| Killzone Hiện tại | newyork_am |\n| Chế độ Biến động | trending |\n| H1 Order Flow | Bearish |\n| M15 Structure | Không rõ |\n| Trong Cửa sổ Tin tức | False |\n| Tin tức Sắp tới | 32m - NY Empire State Manufacturing Index  (Oct) |\n', 'evaluations': {'no_trade': {'blocking': [], 'warnings': [], 'metrics': {'spread': {'current_pips': 3.7, 'threshold_pips': 4.2, 'median_5m_pips': 3.7, 'p90_5m_pips': 3.7, 'median_30m_pips': 3.7, 'p90_30m_pips': 3.7, 'atr_pct': 0.660215038158264}, 'atr': {'atr_m5_pips': 560.4234660191495, 'min_required_pips': 0.3, 'adr20_pips': 6411.980000000005, 'atr_pct_of_adr20': 8.740255989868169}, 'key_levels': {'nearest': {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3923.999999999978}, 'threshold_pips': 5.0, 'levels': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10229.999999999563}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99431.00000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 3923.999999999978}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28398.999999999432}]}, 'collected_at': '2025-10-15T19:57:22+07:00'}, 'messages': [], 'status': 'ok', 'evaluated_at': '2025-10-15T12:57:26.789625+00:00'}}}
```

---
**Bối cảnh bổ sung từ các báo cáo trước:**


[CONTEXT_COMPOSED]
{"CONTEXT_COMPOSED": {"cycle": "2025-10-15 12:57:22", "trend_checklist": {"trend": "unknown", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": null, "recent_history_summary": null, "run_meta": {"analysis_id": "2025-10-15T12:57:22Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"backtest_results": {"status": "not_implemented"}}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3}}}

---
**Phân tích các hình ảnh được cung cấp.**
--- KẾT THÚC PROMPT ---
2025-10-15 12:57:26,876 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,877 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:26,881 - APP.services.gemini_service - DEBUG - Bắt đầu stream tới Gemini API với 5 lần thử.
2025-10-15 12:57:26,882 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:26,885 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:26,885 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:26,917 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:26,918 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:26,919 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:26,920 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:26,921 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:26,921 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:26,922 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,922 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:26,923 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:26,923 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:26,924 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:26,925 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:26,926 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:26,927 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:26,944 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:26,946 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:26,949 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:26,952 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:26,973 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.539, 'ask': 4190.576, 'last': 0.0, 'time': 1760533045}
2025-10-15 12:57:26,974 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:26,974 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.64s
2025-10-15 12:57:26,994 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:27,253 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:27,254 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:27,255 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:27,257 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:27,268 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:27,268 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:27,269 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:27,270 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:27,271 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:27,272 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:27,272 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:27,272 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:27,273 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:27,273 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:27,274 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:27,275 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:27,275 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:27,276 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:27,277 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:27,778 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:27,780 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:27,781 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:28,283 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:28,285 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:28,285 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:28,286 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:28,286 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.834
2025-10-15 12:57:28,287 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.957
2025-10-15 12:57:28,294 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 350, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:28,303 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 350, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:28,427 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 444, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:28,430 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 444, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:28,431 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:28,431 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:28,432 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:28,433 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:28,435 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:28,438 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:28,438 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:28,439 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:28,439 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:28,439 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:28,440 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:28,440 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:28,443 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:28,448 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:28,449 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:28,469 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:28,470 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:28,472 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:28,472 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:28,473 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:28,474 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:28,476 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:28,476 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:28,478 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:28,479 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:28,479 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:28,480 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:28,502 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:28,505 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:28,507 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:28,507 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:28,509 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:28,510 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:28,511 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:28,533 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:28,534 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:28,537 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:28,543 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:28,551 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:28,564 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:28,565 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:28,565 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:28,566 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:28,566 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:28+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:28,567 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:28,567 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:28+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:28,567 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:27+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:28,568 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:28+07:00
2025-10-15 12:57:28,568 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:27+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:28,569 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:28+07:00 trong DST: True
2025-10-15 12:57:28,569 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:27+07:00
2025-10-15 12:57:28,570 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:28,571 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:27+07:00 trong DST: True
2025-10-15 12:57:28,573 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:28,574 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:28,593 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:28,593 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:28,595 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:28,595 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:28,596 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:28,597 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:28,600 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:28,601 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:28,603 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:28,615 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:28,627 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:28,628 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:28,629 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:28,629 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:28,630 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:28,630 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:28,630 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:28,631 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:28,631 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:28,632 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:28,632 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:28,633 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:28,633 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:28,634 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:28,635 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:28,636 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:28,655 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:28,658 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:28,659 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:28,660 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:28,660 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:28,660 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:28,661 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:28,661 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:28,662 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:28,662 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:28,662 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:28,663 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:28,663 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:28,664 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:28,666 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:28,667 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:28,668 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:28,687 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:28,689 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:28,690 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:28,690 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:28,691 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:28,692 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:28,692 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:28,693 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:28,694 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:28,694 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:28,695 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:28,695 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:28,697 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:28,697 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:28,698 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:28,699 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:28,723 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:28,724 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:28,724 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.957, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:28,725 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:28,725 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:28,726 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:28,726 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:28,727 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.834, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:28,727 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:28,730 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:28,730 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:28,730 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:28,754 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11152.000000000044
2025-10-15 12:57:28,755 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:28,755 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100353.00000000052
2025-10-15 12:57:28,756 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:28,757 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4846.000000000458
2025-10-15 12:57:28,757 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11028.999999999542
2025-10-15 12:57:28,758 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29320.999999999913
2025-10-15 12:57:28,758 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100230.00000000001
2025-10-15 12:57:28,759 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4722.999999999956
2025-10-15 12:57:28,760 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:28,760 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29197.99999999941
2025-10-15 12:57:28,761 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:28,780 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11028.999999999542}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100230.00000000001}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4722.999999999956}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29197.99999999941}]
2025-10-15 12:57:28,780 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11152.000000000044}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100353.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4846.000000000458}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29320.999999999913}]
2025-10-15 12:57:28,781 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:28,782 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:28,783 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:28,784 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:28,784 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:28,785 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:28,785 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:28,786 - APP.services.mt5_service - DEBUG - Position in day range: 0.5733385093167699
2025-10-15 12:57:28,786 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:28,787 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:27+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:28,787 - APP.services.mt5_service - DEBUG - Position in day range: 0.5752484472049765
2025-10-15 12:57:28,788 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:27+07:00
2025-10-15 12:57:28,788 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:28+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:28,789 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:27+07:00 trong DST: True
2025-10-15 12:57:28,789 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:28+07:00
2025-10-15 12:57:28,790 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:28,790 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:28,791 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:28+07:00 trong DST: True
2025-10-15 12:57:28,792 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:28,793 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:28,795 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:28,816 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:28,817 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:28,818 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:28,819 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8300', 'price': 4190.83, 'distance_pips': 0.4}, {'level': '8325', 'price': 4190.832, 'distance_pips': 0.15}, {'level': '8350', 'price': 4190.835, 'distance_pips': 0.1}, {'level': '8375', 'price': 4190.837, 'distance_pips': 0.35}]
2025-10-15 12:57:28,819 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:28,820 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:28,820 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:28,822 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:28,823 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9500', 'price': 4190.95, 'distance_pips': 0.7}, {'level': '9525', 'price': 4190.952, 'distance_pips': 0.45}, {'level': '9550', 'price': 4190.955, 'distance_pips': 0.2}, {'level': '9575', 'price': 4190.957, 'distance_pips': 0.05}]
2025-10-15 12:57:28,847 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:28,848 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:28,849 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:28,849 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:28,849 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.834
2025-10-15 12:57:28,850 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:28,851 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:28,851 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:28,853 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:28,854 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.957
2025-10-15 12:57:28,855 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:28,868 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:28,881 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:28,882 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:28,882 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:28,885 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:28,909 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:28,910 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.834
2025-10-15 12:57:28,911 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:28,911 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:28,912 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.957
2025-10-15 12:57:28,912 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:28,913 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:28,914 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:28,914 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:28,942 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:28,943 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:28,944 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:28,944 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:28,948 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.834
2025-10-15 12:57:28,972 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:28,973 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:28,975 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.957
2025-10-15 12:57:28,975 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:28,976 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:28,978 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:28,979 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:29,005 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:29,005 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:29,006 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:29,007 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.834
2025-10-15 12:57:29,065 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:29,066 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:29,068 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:29,149 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.957
2025-10-15 12:57:29,158 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:29,159 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:29,162 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:29,218 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:29,268 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:29,278 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:29,279 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,279 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:29,280 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,280 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,281 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:29,281 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,282 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:29,282 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:29,283 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:29,284 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:29,284 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:29,285 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:29,285 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:29,286 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:29,286 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:29,286 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:29,287 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:29,287 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:29,291 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:29,292 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:29,292 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:29,293 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:29,379 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:29,379 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:29,415 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:29,418 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:29,418 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:29,419 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:29,419 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:29,420 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:29,420 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,420 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:29,421 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,421 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:29,422 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:29,422 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:29,423 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:29,424 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:29,425 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:29,425 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:29,426 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:29,426 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:29,427 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:29,428 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:29,429 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:29,429 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,431 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:29,431 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:29,431 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,432 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,435 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:29,436 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.834, 'ask': 4190.871, 'last': 0.0, 'time': 1760533047}
2025-10-15 12:57:29,436 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:29,437 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:29,437 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:29,438 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:29,438 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:29,439 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:29,439 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,440 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:29,440 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,441 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:29,442 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 350, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:29,443 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:29,443 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 444, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:29,444 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:29,444 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,446 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:29,448 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,448 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:29,470 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,471 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,472 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,472 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.957, 'ask': 4190.994, 'last': 0.0, 'time': 1760533048}
2025-10-15 12:57:29,473 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,473 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:29,473 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,474 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.22s
2025-10-15 12:57:29,474 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,475 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,475 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:29,476 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:29,476 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:29,477 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:29,477 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,478 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,478 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:29,478 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:29,479 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:29,479 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:29,480 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11028.999999999542}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100230.00000000001}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4722.999999999956}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29197.99999999941}]
2025-10-15 12:57:29,480 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:27+07:00
2025-10-15 12:57:29,481 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:29,482 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:29,492 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:29,501 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.25s
2025-10-15 12:57:29,571 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:29,677 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:29,678 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:29,679 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:29,680 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:29,680 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:30,260 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:30,261 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:30,262 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:30,265 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:30,279 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:30,280 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:30,280 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:30,281 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:30,281 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:30,282 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:30,283 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:30,283 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:30,284 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:30,285 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:30,286 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:30,286 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:30,287 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:30,287 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:30,288 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:30,790 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:30,793 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:30,793 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:31,216 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:31,216 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:31,230 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.01s
2025-10-15 12:57:31,295 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:31,297 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:31,297 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:31,298 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:31,298 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.21
2025-10-15 12:57:31,299 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.21
2025-10-15 12:57:31,304 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 352, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:31,305 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:31,310 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 352, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:31,384 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 443, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:31,409 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:31,424 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:31,436 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:31,437 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 443, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:31,438 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:31,439 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:31,439 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:31,440 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:31,440 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:31,443 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:31,447 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:31,448 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:31,474 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:31,475 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:31,476 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:31,476 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:31,477 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:31,488 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:31,503 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:31,504 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:31,505 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:31,505 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:31,506 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:31,506 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:31,507 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:31,511 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:31,537 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:31,537 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:31,538 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:31,538 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:31,539 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:31,539 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:31,540 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:31,548 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:31,566 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:31,570 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:31,573 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:31,595 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:31,597 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:31,601 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:31,603 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:31,605 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:31,606 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:31,629 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:30+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:31,631 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:31,632 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:30+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:31,662 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:31,663 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:30+07:00
2025-10-15 12:57:31,664 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:30+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:31,695 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:30+07:00 trong DST: True
2025-10-15 12:57:31,695 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:30+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:31,697 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:31,698 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:31,700 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:31,722 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:30+07:00
2025-10-15 12:57:31,724 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:31,725 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:30+07:00 trong DST: True
2025-10-15 12:57:31,726 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:31,726 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:31,747 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:31,750 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:31,751 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:31,752 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:31,752 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:31,754 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:31,754 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:31,755 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:31,755 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:31,772 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:31,783 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:31,783 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:31,784 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:31,785 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:31,785 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:31,785 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:31,786 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:31,786 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:31,787 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:31,787 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:31,788 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:31,788 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:31,789 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:31,789 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:31,791 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:31,792 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:31,801 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:31,812 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:31,813 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:31,814 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:31,814 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:31,815 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:31,815 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:31,816 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:31,816 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:31,816 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:31,817 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:31,818 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:31,818 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:31,818 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:31,819 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:31,819 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:31,820 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:31,821 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:31,821 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:31,822 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:31,823 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:31,824 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:31,825 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:31,847 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:31,850 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:31,851 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:31,851 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:31,852 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:31,853 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.21, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:31,854 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:31,855 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:31,856 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:31,856 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:31,857 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:31,857 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:31,858 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:31,883 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:31,886 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10404.999999999745
2025-10-15 12:57:31,887 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:31,905 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99606.00000000022
2025-10-15 12:57:31,906 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:31,907 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4099.00000000016
2025-10-15 12:57:31,907 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.21, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:31,908 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28573.999999999614
2025-10-15 12:57:31,908 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:31,909 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:31,909 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:31,910 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10404.999999999745}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99606.00000000022}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4099.00000000016}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28573.999999999614}]
2025-10-15 12:57:31,910 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:31,910 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:31,911 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:31,911 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:31,912 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10404.999999999745
2025-10-15 12:57:31,912 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:31,913 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99606.00000000022
2025-10-15 12:57:31,913 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:31,914 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4099.00000000016
2025-10-15 12:57:31,918 - APP.services.mt5_service - DEBUG - Position in day range: 0.5636490683229842
2025-10-15 12:57:31,940 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:30+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:31,941 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28573.999999999614
2025-10-15 12:57:31,943 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:30+07:00
2025-10-15 12:57:31,943 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:31,944 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:30+07:00 trong DST: True
2025-10-15 12:57:31,945 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10404.999999999745}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99606.00000000022}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4099.00000000016}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28573.999999999614}]
2025-10-15 12:57:31,945 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:31,945 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:31,946 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:31,969 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:31,970 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:31,971 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:31,971 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:31,972 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:31,972 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:31,973 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2100', 'price': 4190.21, 'distance_pips': 0.0}, {'level': '2125', 'price': 4190.212, 'distance_pips': 0.25}, {'level': '2150', 'price': 4190.215, 'distance_pips': 0.5}, {'level': '2175', 'price': 4190.217, 'distance_pips': 0.75}]
2025-10-15 12:57:31,974 - APP.services.mt5_service - DEBUG - Position in day range: 0.5636490683229842
2025-10-15 12:57:31,975 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:31,975 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:30+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:31,976 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:31,976 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:30+07:00
2025-10-15 12:57:32,004 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,005 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:30+07:00 trong DST: True
2025-10-15 12:57:32,005 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:32,005 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:32,006 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.21
2025-10-15 12:57:32,007 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:32,007 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:32,010 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:32,031 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:32,032 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,034 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:32,034 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,035 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:32,035 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2100', 'price': 4190.21, 'distance_pips': 0.0}, {'level': '2125', 'price': 4190.212, 'distance_pips': 0.25}, {'level': '2150', 'price': 4190.215, 'distance_pips': 0.5}, {'level': '2175', 'price': 4190.217, 'distance_pips': 0.75}]
2025-10-15 12:57:32,036 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:32,037 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:32,037 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.21
2025-10-15 12:57:32,038 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,039 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:32,039 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,040 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:32,041 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:32,042 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:32,043 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.21
2025-10-15 12:57:32,067 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:32,067 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:32,068 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:32,068 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:32,070 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.21
2025-10-15 12:57:32,070 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:32,072 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:32,072 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:32,073 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:32,074 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:32,096 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.21
2025-10-15 12:57:32,097 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:32,098 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:32,098 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:32,098 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:32,099 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:32,100 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:32,101 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.21
2025-10-15 12:57:32,101 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:32,102 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:32,105 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:32,106 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:32,129 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.21
2025-10-15 12:57:32,130 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:32,131 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:32,132 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:32,133 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:32,133 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,135 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:32,136 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,136 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:32,161 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:32,163 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:32,163 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:32,164 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.21
2025-10-15 12:57:32,164 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:32,166 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:32,168 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:32,169 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:32,191 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:32,193 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:32,193 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:32,194 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:32,194 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:32,194 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,195 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:32,195 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,198 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:32,198 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:32,199 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:32,221 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:32,223 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:32,223 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:32,224 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:32,224 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:32,224 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:32,225 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,225 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:32,225 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,226 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:32,226 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:32,226 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:32,227 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:32,228 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:32,229 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:32,229 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:32,239 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:32,250 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:32,252 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:32,252 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:32,253 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:32,254 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:32,254 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,254 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:32,254 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:32,255 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.21, 'ask': 4190.247, 'last': 0.0, 'time': 1760533050}
2025-10-15 12:57:32,258 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:32,259 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:32,260 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:32,261 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:32,261 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:32,262 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:32,262 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:32,285 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,285 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:32,286 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,286 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:32,286 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 352, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:32,287 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:32,287 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 443, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:32,288 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:32,288 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,289 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,290 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,292 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,293 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,315 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,316 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:32,316 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,317 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:32,317 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,318 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:32,318 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,319 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:32,319 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,320 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:32,323 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:32,324 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:32,324 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:32,346 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:32,348 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:32,349 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:32,350 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:32,352 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,354 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:32,394 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,395 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,395 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.21, 'ask': 4190.247, 'last': 0.0, 'time': 1760533050}
2025-10-15 12:57:32,396 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:32,396 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:32,397 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:32,399 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.14s
2025-10-15 12:57:32,400 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:32,402 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:32,403 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10404.999999999745}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99606.00000000022}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4099.00000000016}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28573.999999999614}]
2025-10-15 12:57:32,404 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:30+07:00
2025-10-15 12:57:32,404 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:32,406 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:32,408 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:32,409 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.15s
2025-10-15 12:57:32,472 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:32,588 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:32,589 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:32,590 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:32,590 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:32,591 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:33,274 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:33,275 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:33,277 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:33,278 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:33,286 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:33,287 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:33,288 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:33,288 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:33,289 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:33,290 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:33,291 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:33,292 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:33,292 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:33,293 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:33,319 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:33,322 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:33,323 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:33,329 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:33,348 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:33,849 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:33,851 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:33,851 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:34,353 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:34,355 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:34,356 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:34,356 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:34,357 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.412
2025-10-15 12:57:34,357 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.421
2025-10-15 12:57:34,362 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:34,367 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:34,467 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 442, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:34,469 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 442, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:34,470 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:34,471 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:34,471 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:34,472 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:34,474 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:34,476 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:34,476 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:34,477 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:34,477 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:34,477 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:34,479 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:34,480 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:34,487 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:34,507 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:34,507 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:34,508 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:34,509 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:34,510 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:34,511 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:34,512 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:34,517 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:34,536 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:34,537 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:34,537 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:34,538 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:34,538 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:34,539 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:34,539 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:34,558 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:34,565 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:34,566 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:34,567 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:34,567 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:34,567 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:34,568 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:34,568 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:34,570 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:34,575 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:34,597 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:34,598 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:34,599 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:34,600 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:34,600 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:34,601 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:34,601 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:33+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:34,602 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:34+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:34,602 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:33+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:34,603 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:34+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:34,604 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:33+07:00
2025-10-15 12:57:34,605 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:34+07:00
2025-10-15 12:57:34,630 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:33+07:00 trong DST: True
2025-10-15 12:57:34,631 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:34+07:00 trong DST: True
2025-10-15 12:57:34,632 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:34,633 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:34,633 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:34,634 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:34,635 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:34,635 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:34,649 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:34,659 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:34,659 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:34,660 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:34,664 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:34,690 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:34,691 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:34,692 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:34,692 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:34,693 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:34,693 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:34,693 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:34,694 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:34,694 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:34,695 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:34,695 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:34,696 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:34,699 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:34,722 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:34,722 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:34,723 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:34,723 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:34,724 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:34,724 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:34,725 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:34,725 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:34,726 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:34,726 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:34,726 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:34,727 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:34,740 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:34,753 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:34,754 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:34,755 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:34,756 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:34,756 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:34,757 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:34,758 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:34,759 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:34,761 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:34,761 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:34,762 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:34,784 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:34,785 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:34,786 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:34,786 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:34,787 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:34,787 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:34,788 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:34,789 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:34,789 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:34,791 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:34,792 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:34,793 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:34,800 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:34,816 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:34,818 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:34,819 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:34,819 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.421, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:34,820 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:34,820 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:34,820 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:34,821 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:34,823 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:34,823 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.412, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:34,845 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:34,846 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:34,847 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10615.999999999985
2025-10-15 12:57:34,847 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:34,847 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99817.00000000047
2025-10-15 12:57:34,848 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:34,848 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4310.0000000004
2025-10-15 12:57:34,849 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:34,849 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28784.999999999854
2025-10-15 12:57:34,850 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10606.99999999997
2025-10-15 12:57:34,850 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:34,850 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99808.00000000045
2025-10-15 12:57:34,851 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10615.999999999985}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99817.00000000047}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4310.0000000004}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28784.999999999854}]
2025-10-15 12:57:34,851 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4301.000000000386
2025-10-15 12:57:34,852 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28775.99999999984
2025-10-15 12:57:34,854 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:34,873 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:34,874 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:34,875 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:34,876 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10606.99999999997}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99808.00000000045}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4301.000000000386}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28775.99999999984}]
2025-10-15 12:57:34,876 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:34,876 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:34,877 - APP.services.mt5_service - DEBUG - Position in day range: 0.5669254658385159
2025-10-15 12:57:34,877 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:34,878 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:34+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:34,878 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:34,878 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:34+07:00
2025-10-15 12:57:34,879 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:34,880 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:34+07:00 trong DST: True
2025-10-15 12:57:34,881 - APP.services.mt5_service - DEBUG - Position in day range: 0.5667857142857207
2025-10-15 12:57:34,881 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:34,882 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:33+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:34,882 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:34,882 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:33+07:00
2025-10-15 12:57:34,883 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:34,884 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:33+07:00 trong DST: True
2025-10-15 12:57:34,887 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:34,907 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:34,908 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:34,909 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:34,909 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:34,910 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:34,911 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4200', 'price': 4190.42, 'distance_pips': 0.1}, {'level': '4225', 'price': 4190.422, 'distance_pips': 0.15}, {'level': '4250', 'price': 4190.425, 'distance_pips': 0.4}, {'level': '4275', 'price': 4190.427, 'distance_pips': 0.65}]
2025-10-15 12:57:34,911 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:34,912 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:34,913 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4100', 'price': 4190.41, 'distance_pips': 0.2}, {'level': '4125', 'price': 4190.412, 'distance_pips': 0.05}, {'level': '4150', 'price': 4190.415, 'distance_pips': 0.3}, {'level': '4175', 'price': 4190.417, 'distance_pips': 0.55}]
2025-10-15 12:57:34,913 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:34,914 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:34,916 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:34,917 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:34,917 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:34,940 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:34,942 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:34,943 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.412
2025-10-15 12:57:34,944 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.421
2025-10-15 12:57:34,944 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:34,945 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:34,945 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:34,946 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:34,948 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:34,949 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:34,950 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:34,950 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:34,972 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:34,974 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:34,975 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.412
2025-10-15 12:57:34,975 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.421
2025-10-15 12:57:34,976 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:34,977 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:34,978 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:34,978 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:34,979 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:34,990 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:35,004 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:35,006 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:35,007 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:35,007 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:35,008 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.412
2025-10-15 12:57:35,009 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.421
2025-10-15 12:57:35,042 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:35,043 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:35,043 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:35,044 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:35,045 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:35,046 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:35,047 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:35,047 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:35,047 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:35,048 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:35,049 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.412
2025-10-15 12:57:35,049 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.421
2025-10-15 12:57:35,050 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:35,051 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:35,052 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:35,053 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:35,053 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:35,054 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:35,055 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:35,055 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:35,056 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,056 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,057 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,058 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,059 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:35,059 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:35,060 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:35,060 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:35,061 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:35,061 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:35,062 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:35,063 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:35,063 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:35,063 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:35,064 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:35,064 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:35,065 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:35,065 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:35,065 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:35,066 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:35,066 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:35,066 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:35,067 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:35,068 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:35,068 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:35,068 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:35,069 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:35,069 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:35,070 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:35,070 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,070 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:35,071 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,099 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:35,100 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:35,100 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:35,101 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:35,101 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:35,102 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:35,102 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:35,103 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:35,105 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:35,105 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:35,106 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,129 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:35,130 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,131 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:35,132 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:35,132 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:35,132 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:35,134 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:35,137 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:35,159 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:35,160 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:35,161 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,162 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:35,162 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.412, 'ask': 4190.449, 'last': 0.0, 'time': 1760533053}
2025-10-15 12:57:35,163 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:35,164 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:35,164 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.89s
2025-10-15 12:57:35,165 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,166 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:35,166 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:35,167 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.421, 'ask': 4190.458, 'last': 0.0, 'time': 1760533054}
2025-10-15 12:57:35,174 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:35,189 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:35,190 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:35,190 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:35,191 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,191 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,192 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 353, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:35,192 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 442, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:35,193 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,193 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,194 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,194 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,195 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,196 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,197 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,198 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,199 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:35,202 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:35,218 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:35,221 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:35,253 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:35,282 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,316 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,371 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:35,416 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:35,417 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:35,422 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:35,424 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:35,479 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:35,481 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10615.999999999985}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99817.00000000047}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4310.0000000004}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28784.999999999854}]
2025-10-15 12:57:35,517 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:34+07:00
2025-10-15 12:57:35,521 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:35,525 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:35,527 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:35,530 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.25s
2025-10-15 12:57:35,596 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:35,597 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:35,598 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:35,599 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:35,599 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:35,633 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:35,636 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:35,637 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:35,638 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:35,658 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:35,659 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:35,659 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:35,660 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:36,161 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:36,163 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:36,163 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:36,164 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.262
2025-10-15 12:57:36,170 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 355, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:36,228 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 443, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:36,229 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:36,230 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:36,232 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:36,232 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:36,233 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:36,233 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:36,237 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:36,237 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:36,237 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:36,238 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:36,240 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:36,240 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:36,241 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:36,241 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:36,244 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:36,245 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:36,245 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:36,245 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:36,248 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:36,249 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:36,249 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:36,250 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:36,250 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:35+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:36,251 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:35+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:36,251 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:35+07:00
2025-10-15 12:57:36,252 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:35+07:00 trong DST: True
2025-10-15 12:57:36,252 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:36,252 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:36,253 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:36,254 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:36,254 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:36,258 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:36,259 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:36,259 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:36,260 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:36,260 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:36,261 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:36,261 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:36,261 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:36,262 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:36,262 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:36,262 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:36,263 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:36,279 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:36,281 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:36,282 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:36,283 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:36,283 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:36,284 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:36,284 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:36,285 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:36,285 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:36,286 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:36,286 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:36,287 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:36,287 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:36,288 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:36,288 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:36,288 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:36,289 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.262, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:36,289 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:36,289 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:36,290 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:36,290 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:36,291 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10456.999999999425
2025-10-15 12:57:36,291 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99657.9999999999
2025-10-15 12:57:36,292 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4150.99999999984
2025-10-15 12:57:36,292 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28625.999999999294
2025-10-15 12:57:36,292 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:36,293 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10456.999999999425}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99657.9999999999}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4150.99999999984}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28625.999999999294}]
2025-10-15 12:57:36,293 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:36,300 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:36,305 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:36,307 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:36,308 - APP.services.mt5_service - DEBUG - Position in day range: 0.5644565217391283
2025-10-15 12:57:36,309 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:35+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:36,310 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:35+07:00
2025-10-15 12:57:36,312 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:35+07:00 trong DST: True
2025-10-15 12:57:36,315 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:36,316 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:36,317 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:36,318 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:36,318 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:36,319 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2600', 'price': 4190.26, 'distance_pips': 0.2}, {'level': '2625', 'price': 4190.262, 'distance_pips': 0.05}, {'level': '2650', 'price': 4190.265, 'distance_pips': 0.3}, {'level': '2675', 'price': 4190.267, 'distance_pips': 0.55}]
2025-10-15 12:57:36,319 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:36,320 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:36,320 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:36,320 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:36,322 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.262
2025-10-15 12:57:36,322 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:36,322 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:36,323 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:36,337 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:36,341 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:36,342 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:36,343 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:36,343 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.262
2025-10-15 12:57:36,344 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:36,344 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:36,345 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:36,346 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:36,347 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:36,348 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.262
2025-10-15 12:57:36,349 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:36,349 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:36,516 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:36,517 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:57:36,517 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:36,518 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:57:36,520 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.00s
2025-10-15 12:57:36,520 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:36,521 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:57:36,522 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.262
2025-10-15 12:57:36,523 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:36,524 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:36,524 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:36,526 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:36,527 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:36,528 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:36,531 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:36,531 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:36,532 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:36,532 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:36,533 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:36,534 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:36,534 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:36,535 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:36,537 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:36,539 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.22s
2025-10-15 12:57:36,601 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:36,631 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:36,660 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:36,695 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:36,773 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:36,839 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:36,840 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:36,841 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:36,841 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:36,841 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:36,842 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:36,843 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:36,843 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:36,844 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:36,844 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:36,845 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:36,845 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:36,845 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:36,846 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:36,846 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:36,847 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:36,847 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:36,848 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:36,848 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:36,850 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:36,850 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:37,347 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:37,349 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:37,349 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:37,350 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:37,351 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:37,352 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.366
2025-10-15 12:57:37,352 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:37,360 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 354, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:37,361 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:37,372 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.262, 'ask': 4190.299, 'last': 0.0, 'time': 1760533055}
2025-10-15 12:57:37,412 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:37,427 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 442, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:37,437 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.02s
2025-10-15 12:57:37,438 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:37,439 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:37,442 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:37,443 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:37,444 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:37,444 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:37,448 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:37,452 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:37,471 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:37,473 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:37,475 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:37,476 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:37,477 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:37,477 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:37,508 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:37,508 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:37,509 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:37,512 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:37,513 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:37,536 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:37,549 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:37,579 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:37,617 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:37,669 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:37+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:37,691 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:37+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:37,691 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:37,692 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:37+07:00
2025-10-15 12:57:37,693 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:37,694 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:37+07:00 trong DST: True
2025-10-15 12:57:37,695 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:37,725 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:37,755 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:37,757 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:37,758 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:37,765 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:37,766 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:37,768 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:37,770 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:37,771 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:37,772 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:37,773 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:37,774 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:37,776 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:37,778 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:37,779 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:37,780 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:37,781 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:37,782 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:37,784 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:37,784 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:37,786 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:37,787 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:37,790 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:37,824 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:37,878 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:37,882 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:37,892 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:37,919 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:37,921 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:37,922 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:37,923 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:37,923 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:37,924 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.366, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:37,924 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:37,924 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:37,926 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:37,927 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:37,927 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10560.999999999694
2025-10-15 12:57:37,928 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99762.00000000017
2025-10-15 12:57:37,929 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4255.000000000109
2025-10-15 12:57:37,929 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28729.999999999563
2025-10-15 12:57:37,930 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:37,931 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10560.999999999694}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99762.00000000017}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4255.000000000109}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28729.999999999563}]
2025-10-15 12:57:37,931 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:37,932 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:37,933 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:37,934 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:37,935 - APP.services.mt5_service - DEBUG - Position in day range: 0.5660714285714307
2025-10-15 12:57:37,936 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:37+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:37,936 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:37+07:00
2025-10-15 12:57:37,937 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:37+07:00 trong DST: True
2025-10-15 12:57:37,937 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:37,938 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:37,938 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:37,939 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:37,939 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:37,940 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3600', 'price': 4190.36, 'distance_pips': 0.6}, {'level': '3625', 'price': 4190.362, 'distance_pips': 0.35}, {'level': '3650', 'price': 4190.365, 'distance_pips': 0.1}, {'level': '3675', 'price': 4190.367, 'distance_pips': 0.15}]
2025-10-15 12:57:37,941 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:37,942 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:37,942 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:37,942 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:37,943 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.366
2025-10-15 12:57:37,944 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:37,944 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:37,945 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:37,945 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:37,946 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:37,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.366
2025-10-15 12:57:37,979 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:37,980 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:38,003 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:38,004 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:38,005 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:38,006 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:38,007 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:38,007 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:38,008 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:38,009 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.366
2025-10-15 12:57:38,012 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:38,026 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:38,039 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:38,039 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:38,040 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:38,041 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:38,043 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:38,067 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:38,069 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:38,070 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.366
2025-10-15 12:57:38,071 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:38,071 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:38,073 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:38,074 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:38,074 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:38,075 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:38,098 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:38,569 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:38,571 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:38,572 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:38,573 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:38,573 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:38,574 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:38,574 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:38,574 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:38,575 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:38,575 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:38,575 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:38,576 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:38,576 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.329
2025-10-15 12:57:38,577 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:38,577 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:38,578 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:38,578 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:38,578 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:38,579 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:38,579 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:38,585 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:38,585 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:38,596 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:38,630 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:38,642 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 442, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:38,647 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:38,659 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:38,660 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:38,660 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:38,661 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:38,663 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:38,664 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:38,664 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:38,666 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:38,667 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:38,668 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:38,668 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:38,669 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:38,693 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:38,697 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:38,698 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.366, 'ask': 4190.403, 'last': 0.0, 'time': 1760533057}
2025-10-15 12:57:38,699 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:38,699 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:38,720 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:38,721 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:38,722 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:38,722 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:38,722 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:38,725 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:38,725 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:38,726 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:38,727 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 354, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:38,727 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:38,729 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 442, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:38,730 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:38,756 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:38,781 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:38,789 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:38,790 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:38,791 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:38,791 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:38,818 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:38,819 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:38,819 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:38,842 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:38,846 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:38,846 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:38,847 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:38,847 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:38,848 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:38,848 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:38,849 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:38,850 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:38+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:38,850 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:38,851 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:38+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:38,851 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:38,851 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:38+07:00
2025-10-15 12:57:38,852 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:38,852 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:38+07:00 trong DST: True
2025-10-15 12:57:38,857 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:38,881 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:38,883 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:38,883 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:38,884 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:38,884 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:38,885 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:38,889 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:38,889 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:38,907 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:38,907 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:38,911 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:38,911 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10560.999999999694}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99762.00000000017}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4255.000000000109}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28729.999999999563}]
2025-10-15 12:57:38,912 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:38,912 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:37+07:00
2025-10-15 12:57:38,913 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:38,913 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:38,913 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:38,914 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:38,915 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:38,931 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:38,937 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:38,942 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:38,945 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:38,945 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.42s
2025-10-15 12:57:38,946 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:38,976 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:38,976 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:38,977 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:38,983 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:39,003 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:39,004 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:39,005 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:39,005 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:39,006 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:39,007 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:39,007 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:39,008 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:39,015 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:39,029 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:39,036 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:39,036 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:39,037 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:39,038 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:39,038 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:39,039 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:39,066 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:39,068 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:39,068 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:39,069 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:39,070 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.329, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:39,070 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:39,071 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:39,075 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:39,076 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:39,098 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10523.999999999432
2025-10-15 12:57:39,100 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99724.99999999991
2025-10-15 12:57:39,100 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4217.999999999847
2025-10-15 12:57:39,101 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28692.9999999993
2025-10-15 12:57:39,101 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:39,102 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10523.999999999432}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99724.99999999991}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4217.999999999847}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28692.9999999993}]
2025-10-15 12:57:39,127 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:39,129 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:39,130 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:39,130 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:39,131 - APP.services.mt5_service - DEBUG - Position in day range: 0.5654968944099359
2025-10-15 12:57:39,131 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:38+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:39,131 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:38+07:00
2025-10-15 12:57:39,132 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:38+07:00 trong DST: True
2025-10-15 12:57:39,132 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:39,132 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:39,133 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:39,133 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:39,133 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:39,160 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3200', 'price': 4190.32, 'distance_pips': 0.9}, {'level': '3225', 'price': 4190.322, 'distance_pips': 0.65}, {'level': '3250', 'price': 4190.325, 'distance_pips': 0.4}, {'level': '3275', 'price': 4190.327, 'distance_pips': 0.15}]
2025-10-15 12:57:39,161 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:39,161 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:39,161 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:39,162 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:39,163 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.329
2025-10-15 12:57:39,163 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:39,164 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:39,164 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:39,170 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:39,191 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:39,193 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.329
2025-10-15 12:57:39,195 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:39,196 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:39,197 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:39,200 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:39,226 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:39,231 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.329
2025-10-15 12:57:39,254 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:39,255 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:39,256 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:39,256 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:39,257 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:39,258 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.329
2025-10-15 12:57:39,258 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:39,260 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:39,287 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:39,288 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:39,289 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:39,289 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:39,289 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:39,290 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:39,317 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:39,317 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:39,318 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:39,319 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:39,319 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:39,319 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:39,320 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:39,320 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:39,321 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:39,325 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:39,326 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:39,350 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:39,350 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:39,351 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:39,352 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:39,352 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:39,354 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:39,355 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:39,356 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:39,378 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:39,379 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:39,380 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:39,381 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:39,382 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:39,382 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:39,383 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:39,383 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.329, 'ask': 4190.366, 'last': 0.0, 'time': 1760533058}
2025-10-15 12:57:39,384 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:39,385 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.69s
2025-10-15 12:57:39,477 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:39,700 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:39,701 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:39,702 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:39,704 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:39,711 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:39,711 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:39,712 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:39,712 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:39,713 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:39,714 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:39,715 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:39,715 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:39,716 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:39,717 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:39,717 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:39,718 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:39,719 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:39,719 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:39,719 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:40,221 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:40,223 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:40,224 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:40,725 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:40,727 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:40,727 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:40,729 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:40,730 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.29
2025-10-15 12:57:40,731 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.331
2025-10-15 12:57:40,737 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 349, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:40,742 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 349, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:40,821 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 440, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:40,847 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 440, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:40,847 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:40,848 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:40,849 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:40,849 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:40,851 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:40,855 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:40,855 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:40,855 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:40,856 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:40,856 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:40,857 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:40,861 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:40,866 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:40,875 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:40,876 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:40,876 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:40,876 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:40,877 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:40,877 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:40,878 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:40,880 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:40,883 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:40,883 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:40,884 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:40,884 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:40,885 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:40,887 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:40,888 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:40,910 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:40,913 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:40,914 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:40,914 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:40,915 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:40,916 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:40,918 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:40,970 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:40,971 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:40,972 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:40,975 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:40,976 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:40,976 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:40,977 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:40,979 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:39+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:40,981 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:40,984 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:39+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:41,005 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:41,006 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:39+07:00
2025-10-15 12:57:41,006 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:40+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:41,007 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:39+07:00 trong DST: True
2025-10-15 12:57:41,007 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:40+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:41,008 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:41,008 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:40+07:00
2025-10-15 12:57:41,037 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:41,040 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:40+07:00 trong DST: True
2025-10-15 12:57:41,042 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:41,043 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:41,072 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:41,100 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:41,102 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:41,128 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:41,129 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:41,130 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:41,167 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:41,176 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:41,177 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:41,178 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:41,179 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:41,179 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:41,180 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:41,180 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:41,181 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:41,181 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:41,182 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:41,183 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:41,185 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:41,185 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:41,186 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:41,186 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:41,186 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:41,187 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:41,187 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:41,188 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:41,188 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:41,189 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:41,189 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:41,190 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:41,191 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:41,191 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:41,192 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:41,193 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:41,193 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:41,193 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:41,194 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:41,194 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:41,194 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:41,195 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:41,196 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:41,196 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:41,225 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:41,226 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:41,227 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:41,228 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:41,229 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:41,232 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:41,233 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:41,256 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:41,256 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:41,257 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:41,258 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:41,258 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:41,300 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:41,300 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:41,301 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:41,302 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:41,303 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:41,304 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:41,304 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:41,305 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:41,306 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.331, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:41,307 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.29, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:41,308 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:41,308 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:41,308 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:41,309 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:41,309 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:41,310 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:41,311 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:41,311 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:41,312 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10525.99999999984
2025-10-15 12:57:41,313 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10484.999999999673
2025-10-15 12:57:41,314 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99727.00000000032
2025-10-15 12:57:41,314 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99686.00000000015
2025-10-15 12:57:41,315 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4220.000000000255
2025-10-15 12:57:41,315 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4179.000000000087
2025-10-15 12:57:41,316 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28694.99999999971
2025-10-15 12:57:41,316 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28653.99999999954
2025-10-15 12:57:41,317 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:41,317 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:41,318 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10525.99999999984}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99727.00000000032}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4220.000000000255}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28694.99999999971}]
2025-10-15 12:57:41,318 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10484.999999999673}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99686.00000000015}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4179.000000000087}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28653.99999999954}]
2025-10-15 12:57:41,319 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:41,400 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:41,402 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:41,405 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:41,409 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:41,444 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:41,445 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:41,446 - APP.services.mt5_service - DEBUG - Position in day range: 0.5655279503105634
2025-10-15 12:57:41,475 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:41,479 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:40+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:41,480 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:40+07:00
2025-10-15 12:57:41,482 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:40+07:00 trong DST: True
2025-10-15 12:57:41,502 - APP.services.mt5_service - DEBUG - Position in day range: 0.5648913043478279
2025-10-15 12:57:41,502 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:41,503 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:39+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:41,503 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:41,504 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:39+07:00
2025-10-15 12:57:41,504 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:41,505 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:39+07:00 trong DST: True
2025-10-15 12:57:41,505 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,506 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:41,506 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:41,507 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:41,508 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3300', 'price': 4190.33, 'distance_pips': 0.1}, {'level': '3325', 'price': 4190.332, 'distance_pips': 0.15}, {'level': '3350', 'price': 4190.335, 'distance_pips': 0.4}, {'level': '3375', 'price': 4190.337, 'distance_pips': 0.65}]
2025-10-15 12:57:41,509 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:41,514 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:41,535 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,536 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,537 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:41,537 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:41,538 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2900', 'price': 4190.29, 'distance_pips': 0.0}, {'level': '2925', 'price': 4190.292, 'distance_pips': 0.25}, {'level': '2950', 'price': 4190.295, 'distance_pips': 0.5}, {'level': '2975', 'price': 4190.297, 'distance_pips': 0.75}]
2025-10-15 12:57:41,538 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:41,539 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:41,539 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.331
2025-10-15 12:57:41,543 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,544 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:41,544 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:41,568 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.29
2025-10-15 12:57:41,569 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:41,571 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:41,571 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:41,573 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:41,574 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:41,584 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:41,598 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:41,599 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:41,601 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:41,601 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:41,602 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.29
2025-10-15 12:57:41,602 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.331
2025-10-15 12:57:41,604 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:41,605 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:41,605 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:41,605 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:41,622 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:41,631 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:41,632 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:41,632 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:41,633 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:41,633 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:41,634 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.29
2025-10-15 12:57:41,637 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.331
2025-10-15 12:57:41,645 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:41,660 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:41,661 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:41,662 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:41,663 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:41,664 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:41,665 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:41,665 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:41,666 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:41,667 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:41,693 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.29
2025-10-15 12:57:41,694 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.331
2025-10-15 12:57:41,694 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:41,695 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:41,695 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:41,696 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:41,697 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:41,699 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:41,700 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:41,725 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:41,726 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,727 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,727 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:41,727 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:41,730 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:41,731 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:41,755 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:41,758 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:41,758 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:41,759 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:41,759 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:41,759 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:41,760 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:41,762 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:41,762 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:41,763 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:41,787 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:41,788 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:41,788 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:41,789 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:41,790 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:41,819 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:41,820 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:41,821 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:41,821 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:41,848 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.06s
2025-10-15 12:57:41,850 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:41,851 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:41,851 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:41,852 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:41,852 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:41,853 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:41,855 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,855 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:41,856 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:41,856 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:41,879 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:41,879 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:41,880 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:41,880 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:41,881 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:41,881 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:41,882 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:41,882 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:41,883 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:41,883 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:41,884 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,884 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:41,886 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:41,887 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:41,888 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:41,911 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:41,912 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:41,914 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:41,914 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:41,915 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:41,916 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,917 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.29, 'ask': 4190.327, 'last': 0.0, 'time': 1760533059}
2025-10-15 12:57:41,917 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:41,918 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:41,928 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:41,943 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.24s
2025-10-15 12:57:41,969 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:41,970 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,971 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.331, 'ask': 4190.368, 'last': 0.0, 'time': 1760533060}
2025-10-15 12:57:41,972 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:41,972 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:41,972 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:41,975 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:41,976 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:41,978 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:41,979 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:41,982 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:41,989 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 349, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:42,003 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 440, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:42,005 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:42,006 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:42,006 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:42,007 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:42,007 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:42,007 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:42,008 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:42,011 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:42,011 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:42,012 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:42,012 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:42,015 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:42,037 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:42,078 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:42,178 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:42,195 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:42,220 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:42,221 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:42,253 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:42,295 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10525.99999999984}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99727.00000000032}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4220.000000000255}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28694.99999999971}]
2025-10-15 12:57:42,320 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:40+07:00
2025-10-15 12:57:42,324 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:42,327 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:42,329 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:42,335 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.63s
2025-10-15 12:57:42,491 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:42,492 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:42,493 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:42,494 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:42,495 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:42,710 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:42,711 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:42,713 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:42,714 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:42,724 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:42,725 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:42,726 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:42,726 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:42,727 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:42,727 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:42,729 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:42,729 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:42,730 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:42,730 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:42,731 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:42,733 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:42,751 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:42,752 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:42,753 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:43,253 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:43,255 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:43,255 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:43,756 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:43,758 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:43,758 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:43,759 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:43,760 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.425
2025-10-15 12:57:43,760 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.464
2025-10-15 12:57:43,766 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:43,771 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:43,852 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 440, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:43,861 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 440, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:43,861 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:43,862 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:43,862 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:43,863 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:43,865 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:43,868 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:43,869 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:43,869 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:43,870 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:43,870 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:43,871 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:43,871 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:43,874 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:43,878 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:43,878 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:43,879 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:43,879 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:43,880 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:43,881 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:43,881 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:43,883 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:43,885 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:43,886 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:43,886 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:43,887 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:43,887 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:43,890 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:43,911 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:43,913 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:43,916 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:43,917 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:43,918 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:43,918 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:43,919 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:43,941 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:43,944 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:43,945 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:43,946 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:43,971 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:43,972 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:43,973 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:43,973 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:43,973 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:43,974 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:43,974 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:43+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:43,975 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:43+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:43,975 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:43+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:43,976 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:43+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:43,976 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:43+07:00
2025-10-15 12:57:43,977 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:43+07:00
2025-10-15 12:57:43,977 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:43+07:00 trong DST: True
2025-10-15 12:57:43,979 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:43+07:00 trong DST: True
2025-10-15 12:57:43,979 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:43,980 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:43,980 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:43,981 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:43,981 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:43,982 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:44,004 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:44,006 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:44,007 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:44,008 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:44,034 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:44,039 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:44,040 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:44,042 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:44,043 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:44,063 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:44,064 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:44,065 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:44,065 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:44,066 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:44,066 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:44,067 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:44,067 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:44,068 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:44,068 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:44,068 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:44,069 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:44,069 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:44,070 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:44,070 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:44,071 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:44,071 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:44,072 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:44,074 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:44,074 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:44,075 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:44,097 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:44,098 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:44,098 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:44,099 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:44,099 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:44,099 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:44,100 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:44,100 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:44,101 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:44,102 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:44,102 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:44,103 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:44,104 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:44,105 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:44,107 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:44,128 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:44,129 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:44,129 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:44,130 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:44,130 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:44,131 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:44,131 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:44,132 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:44,132 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:44,133 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:44,134 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:44,134 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:44,135 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:44,135 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:44,136 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.425, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:44,137 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:44,138 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.464, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:44,161 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:44,161 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:44,162 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:44,162 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:44,163 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:44,163 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:44,163 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:44,163 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:44,164 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10619.99999999989
2025-10-15 12:57:44,164 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10658.99999999965
2025-10-15 12:57:44,165 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99821.00000000036
2025-10-15 12:57:44,165 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99860.00000000013
2025-10-15 12:57:44,167 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4314.000000000306
2025-10-15 12:57:44,167 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4353.0000000000655
2025-10-15 12:57:44,168 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28788.99999999976
2025-10-15 12:57:44,168 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28827.99999999952
2025-10-15 12:57:44,168 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:44,188 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:44,189 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10619.99999999989}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99821.00000000036}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4314.000000000306}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28788.99999999976}]
2025-10-15 12:57:44,189 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10658.99999999965}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99860.00000000013}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4353.0000000000655}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28827.99999999952}]
2025-10-15 12:57:44,190 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:44,190 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:44,190 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:44,191 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:44,192 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:44,193 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:44,193 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:44,193 - APP.services.mt5_service - DEBUG - Position in day range: 0.5669875776397567
2025-10-15 12:57:44,194 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:44,194 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:43+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:44,194 - APP.services.mt5_service - DEBUG - Position in day range: 0.5675931677018647
2025-10-15 12:57:44,195 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:43+07:00
2025-10-15 12:57:44,195 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:43+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:44,196 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:43+07:00 trong DST: True
2025-10-15 12:57:44,196 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:43+07:00
2025-10-15 12:57:44,196 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:44,198 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:43+07:00 trong DST: True
2025-10-15 12:57:44,198 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:44,199 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:44,199 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:44,200 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:44,200 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,222 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:44,223 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,223 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,224 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4200', 'price': 4190.42, 'distance_pips': 0.5}, {'level': '4225', 'price': 4190.422, 'distance_pips': 0.25}, {'level': '4250', 'price': 4190.425, 'distance_pips': 0.0}, {'level': '4275', 'price': 4190.427, 'distance_pips': 0.25}]
2025-10-15 12:57:44,224 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,225 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:44,226 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4600', 'price': 4190.46, 'distance_pips': 0.4}, {'level': '4625', 'price': 4190.462, 'distance_pips': 0.15}, {'level': '4650', 'price': 4190.465, 'distance_pips': 0.1}, {'level': '4675', 'price': 4190.467, 'distance_pips': 0.35}]
2025-10-15 12:57:44,226 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,227 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:44,228 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,228 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,230 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:44,230 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,231 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:44,243 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.464
2025-10-15 12:57:44,256 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:44,257 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.425
2025-10-15 12:57:44,257 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:44,258 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:44,259 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:44,260 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:44,261 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:44,261 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:44,262 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:44,272 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:44,287 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.464
2025-10-15 12:57:44,288 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:44,289 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:44,290 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.425
2025-10-15 12:57:44,292 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:44,292 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:44,293 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:44,294 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:44,294 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:44,301 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:44,317 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:44,318 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:44,319 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.464
2025-10-15 12:57:44,319 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:44,320 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:44,321 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.425
2025-10-15 12:57:44,322 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:44,323 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:44,324 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:44,325 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:44,345 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:44,347 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:44,347 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:44,348 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:44,348 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.464
2025-10-15 12:57:44,349 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:44,350 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:44,350 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.425
2025-10-15 12:57:44,351 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:44,351 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:44,352 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:44,353 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:44,354 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:44,356 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:44,381 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,381 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:44,382 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,382 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,383 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:44,383 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,384 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:44,384 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:44,384 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:44,385 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:44,387 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:44,387 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:44,387 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:44,388 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:44,412 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:44,412 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:44,413 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:44,414 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:44,414 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:44,414 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:44,415 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:44,415 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:44,416 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:44,416 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:44,417 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:44,417 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:44,418 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:44,440 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:44,441 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:44,441 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:44,442 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,442 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:44,442 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,443 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:44,443 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:44,444 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:44,444 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:44,444 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:44,445 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:44,446 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:44,446 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:44,473 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:44,475 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:44,475 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:44,476 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:44,476 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,476 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:44,477 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,479 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:44,480 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:44,481 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:44,482 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,505 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.464, 'ask': 4190.501, 'last': 0.0, 'time': 1760533063}
2025-10-15 12:57:44,506 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:44,506 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:44,507 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:44,507 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.79s
2025-10-15 12:57:44,507 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:44,509 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:44,511 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:44,512 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:44,513 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:44,513 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,534 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:44,535 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.425, 'ask': 4190.462, 'last': 0.0, 'time': 1760533063}
2025-10-15 12:57:44,536 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:44,536 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:44,537 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:44,537 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,537 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,538 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:44,538 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 440, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:44,538 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,539 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,539 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,540 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,540 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,542 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,542 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,543 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,544 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:44,551 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:44,563 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:44,564 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:44,564 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,565 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,565 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:44,566 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:44,566 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:44,566 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:44,567 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10619.99999999989}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99821.00000000036}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4314.000000000306}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28788.99999999976}]
2025-10-15 12:57:44,567 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:43+07:00
2025-10-15 12:57:44,568 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:44,569 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:44,570 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:44,571 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.86s
2025-10-15 12:57:44,614 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:44,754 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:44,755 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:44,756 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:44,757 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:44,758 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:44,763 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:44,764 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:44,765 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:44,767 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:44,918 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:44,919 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:44,919 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:44,920 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:44,921 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:44,921 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:44,922 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:44,923 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:44,923 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:44,924 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:44,925 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:44,926 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:44,926 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:44,927 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:44,928 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:45,429 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:45,431 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:45,431 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:45,933 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:45,934 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:45,935 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:45,935 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:45,936 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.609
2025-10-15 12:57:45,936 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.643
2025-10-15 12:57:45,941 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 352, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:45,946 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 352, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:46,058 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 440, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:46,061 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 440, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:46,061 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:46,062 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:46,063 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:46,063 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:46,065 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:46,067 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:46,067 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:46,067 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:46,068 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:46,068 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:46,069 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:46,069 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:46,072 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:46,081 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:46,095 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:46,097 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:46,097 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:46,098 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:46,098 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:46,099 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:46,101 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:46,103 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:46,104 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:46,105 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:46,105 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:46,106 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:46,107 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:46,128 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:46,131 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:46,133 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:46,133 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:46,134 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:46,135 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:46,135 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:46,136 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:46,136 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:46,141 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:46,164 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:46,164 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:46,165 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:46,165 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:46,166 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:46,167 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:45+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:46,167 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:46,168 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:45+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:46,168 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:46,169 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:45+07:00
2025-10-15 12:57:46,169 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:45+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:46,169 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:45+07:00 trong DST: True
2025-10-15 12:57:46,193 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:45+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:46,193 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:46,194 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:45+07:00
2025-10-15 12:57:46,194 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:46,194 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:45+07:00 trong DST: True
2025-10-15 12:57:46,195 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:46,195 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:46,197 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:46,199 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:46,200 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:46,200 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:46,220 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:46,222 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:46,223 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:46,224 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:46,224 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:46,228 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:46,230 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:46,231 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:46,231 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:46,232 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:46,253 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:46,255 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:46,255 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:46,256 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:46,256 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:46,257 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:46,257 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:46,257 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:46,258 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:46,258 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:46,259 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:46,259 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:46,259 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:46,260 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:46,261 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:46,262 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:46,262 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:46,263 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:46,263 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:46,287 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:46,287 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:46,288 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:46,288 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:46,289 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:46,289 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:46,289 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:46,290 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:46,291 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:46,293 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:46,293 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:46,293 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:46,294 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:46,295 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:46,317 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:46,318 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:46,319 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:46,320 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:46,321 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:46,321 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:46,322 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:46,323 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:46,324 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:46,325 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:46,325 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:46,346 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:46,348 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:46,348 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.609, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:46,349 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:46,349 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:46,349 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:46,350 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:46,350 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.643, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:46,351 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:46,351 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:46,351 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:46,352 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:46,352 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10804.000000000087
2025-10-15 12:57:46,353 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:46,353 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100005.00000000057
2025-10-15 12:57:46,353 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:46,354 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4498.000000000502
2025-10-15 12:57:46,355 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10837.999999999738
2025-10-15 12:57:46,356 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28972.999999999956
2025-10-15 12:57:46,356 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100039.00000000022
2025-10-15 12:57:46,357 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:46,357 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4532.000000000153
2025-10-15 12:57:46,357 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10804.000000000087}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100005.00000000057}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4498.000000000502}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28972.999999999956}]
2025-10-15 12:57:46,379 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29006.999999999607
2025-10-15 12:57:46,380 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:46,381 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:46,382 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:46,382 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10837.999999999738}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100039.00000000022}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4532.000000000153}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29006.999999999607}]
2025-10-15 12:57:46,383 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:46,383 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:46,384 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:46,385 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:46,386 - APP.services.mt5_service - DEBUG - Position in day range: 0.5698447204969026
2025-10-15 12:57:46,387 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:45+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:46,395 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:46,404 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:45+07:00
2025-10-15 12:57:46,405 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:46,406 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:45+07:00 trong DST: True
2025-10-15 12:57:46,406 - APP.services.mt5_service - DEBUG - Position in day range: 0.5703726708074562
2025-10-15 12:57:46,407 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:46,407 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:45+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:46,407 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:46,408 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:45+07:00
2025-10-15 12:57:46,408 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:46,409 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:45+07:00 trong DST: True
2025-10-15 12:57:46,409 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,410 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:46,410 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,411 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:46,411 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6000', 'price': 4190.6, 'distance_pips': 0.9}, {'level': '6025', 'price': 4190.602, 'distance_pips': 0.65}, {'level': '6050', 'price': 4190.605, 'distance_pips': 0.4}, {'level': '6075', 'price': 4190.608, 'distance_pips': 0.15}]
2025-10-15 12:57:46,412 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:46,412 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6602150381420353}
2025-10-15 12:57:46,413 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,413 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,414 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,414 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,415 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6400', 'price': 4190.64, 'distance_pips': 0.3}, {'level': '6425', 'price': 4190.642, 'distance_pips': 0.05}, {'level': '6450', 'price': 4190.645, 'distance_pips': 0.2}, {'level': '6475', 'price': 4190.648, 'distance_pips': 0.45}]
2025-10-15 12:57:46,415 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:46,416 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:46,417 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.609
2025-10-15 12:57:46,418 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,419 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,441 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:46,442 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:46,443 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:46,444 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.643
2025-10-15 12:57:46,445 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:46,445 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:46,446 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:46,446 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:46,447 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:46,449 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:46,457 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.609
2025-10-15 12:57:46,473 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:46,474 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:46,474 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:46,475 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:46,476 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.643
2025-10-15 12:57:46,476 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:46,477 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:46,478 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:46,478 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:46,479 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:46,481 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:46,482 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.609
2025-10-15 12:57:46,506 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:46,507 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:46,508 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:46,508 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:46,509 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.643
2025-10-15 12:57:46,510 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:46,511 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:46,512 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:46,513 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:46,513 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:46,521 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:46,534 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:46,536 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.609
2025-10-15 12:57:46,536 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:46,537 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:46,538 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.643
2025-10-15 12:57:46,538 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:46,539 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:46,540 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:46,540 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:46,541 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:46,542 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:46,542 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,543 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:46,544 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,545 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:46,545 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:46,545 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,568 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:46,569 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,570 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:46,570 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:46,570 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:46,571 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:46,571 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:46,572 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:46,572 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:46,573 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:46,573 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:46,574 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:46,574 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:46,574 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:46,575 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:46,596 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:46,597 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:46,597 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:46,599 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:46,599 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:46,600 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:46,600 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:46,600 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:46,601 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:46,601 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,601 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:46,602 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,602 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:46,603 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:46,603 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:46,605 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:46,606 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:46,606 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:46,629 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:46,630 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:46,631 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:46,631 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:46,632 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:46,633 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,633 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:46,634 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,634 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:46,635 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:46,637 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:46,637 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:46,638 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:46,647 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:46,660 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,660 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:46,661 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.609, 'ask': 4190.646, 'last': 0.0, 'time': 1760533065}
2025-10-15 12:57:46,662 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:46,662 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:46,663 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.90s
2025-10-15 12:57:46,664 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:46,665 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,666 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:46,666 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:46,666 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.643, 'ask': 4190.68, 'last': 0.0, 'time': 1760533065}
2025-10-15 12:57:46,673 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:46,689 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:46,690 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:46,690 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:46,691 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,691 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,692 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 352, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:46,692 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 440, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:46,693 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,693 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,694 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,694 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,695 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,695 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,696 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,697 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,698 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:46,699 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:46,712 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:46,722 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:46,723 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,723 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,724 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:46,724 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:46,725 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:46,725 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:46,725 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10837.999999999738}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100039.00000000022}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4532.000000000153}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29006.999999999607}]
2025-10-15 12:57:46,726 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:45+07:00
2025-10-15 12:57:46,726 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:46,727 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:46,729 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:46,730 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:46,731 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.97s
2025-10-15 12:57:46,899 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:46,900 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:46,901 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:46,902 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:46,902 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:46,906 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:46,907 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:46,908 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:46,910 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:47,079 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:47,080 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:47,092 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:47,094 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:47,095 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:47,095 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:47,096 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:47,097 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:47,098 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:47,098 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:47,099 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:47,100 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:47,100 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:47,103 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:47,104 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:47,104 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.02s
2025-10-15 12:57:47,105 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:47,106 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:47,181 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:47,608 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:47,610 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:47,610 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:48,111 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:48,113 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:48,113 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:48,114 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:48,114 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.617
2025-10-15 12:57:48,115 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.772
2025-10-15 12:57:48,121 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:48,127 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:48,225 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:48,226 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:48,227 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:48,227 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:48,228 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:48,229 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:48,231 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:48,234 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:48,235 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:48,235 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:48,236 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:48,236 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:48,237 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:48,237 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:48,241 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:48,246 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:48,246 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:48,247 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:48,247 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:48,248 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:48,248 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:48,249 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:48,250 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:48,252 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:48,252 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:48,253 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:48,253 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:48,254 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:48,254 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:48,255 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:48,257 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:48,259 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:48,261 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:48,261 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:48,262 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:48,262 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:48,263 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:48,263 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:48,280 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:48,289 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:48,289 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:48,290 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:48,290 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:48,291 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:48,293 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:47+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:48,294 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:47+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:48,318 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:48,319 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:47+07:00
2025-10-15 12:57:48,320 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:48,320 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:47+07:00 trong DST: True
2025-10-15 12:57:48,320 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:47+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:48,321 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:48,321 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:47+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:48,322 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:48,322 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:47+07:00
2025-10-15 12:57:48,323 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:48,323 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:47+07:00 trong DST: True
2025-10-15 12:57:48,325 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:48,326 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:48,327 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:48,348 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:48,352 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:48,352 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:48,353 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:48,355 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:48,355 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:48,356 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:48,356 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:48,382 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:48,383 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:48,383 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:48,384 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:48,385 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:48,385 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:48,385 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:48,386 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:48,388 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:48,388 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:48,407 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:48,408 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:48,409 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:48,409 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:48,410 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:48,410 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:48,411 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:48,411 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:48,411 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:48,412 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:48,413 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:48,413 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:48,414 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:48,414 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:48,415 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:48,415 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:48,415 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:48,416 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:48,417 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:48,418 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:48,440 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:48,441 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:48,442 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:48,442 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:48,443 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:48,443 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:48,444 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:48,444 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:48,445 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:48,446 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:48,447 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:48,447 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:48,448 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:48,448 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:48,449 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:48,450 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:48,473 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:48,474 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:48,475 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:48,476 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:48,476 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.772, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:48,477 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:48,477 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:48,477 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:48,478 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:48,479 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.617, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:48,479 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:48,479 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:48,480 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:48,480 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:48,481 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10966.999999999643
2025-10-15 12:57:48,482 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:48,483 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100168.00000000012
2025-10-15 12:57:48,483 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:48,508 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4661.000000000058
2025-10-15 12:57:48,509 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10811.999999999898
2025-10-15 12:57:48,509 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29135.999999999513
2025-10-15 12:57:48,510 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100013.00000000038
2025-10-15 12:57:48,511 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:48,511 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4506.000000000313
2025-10-15 12:57:48,512 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10966.999999999643}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100168.00000000012}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4661.000000000058}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29135.999999999513}]
2025-10-15 12:57:48,513 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28980.999999999767
2025-10-15 12:57:48,513 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:48,514 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:48,529 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:48,530 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10811.999999999898}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100013.00000000038}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4506.000000000313}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28980.999999999767}]
2025-10-15 12:57:48,531 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:48,532 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:48,532 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:48,533 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:48,533 - APP.services.mt5_service - DEBUG - Position in day range: 0.5723757763975168
2025-10-15 12:57:48,534 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:48,534 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:47+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:48,534 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:48,535 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:47+07:00
2025-10-15 12:57:48,535 - APP.services.mt5_service - DEBUG - Position in day range: 0.5699689440993841
2025-10-15 12:57:48,536 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:47+07:00 trong DST: True
2025-10-15 12:57:48,536 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:47+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:48,537 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:48,537 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:47+07:00
2025-10-15 12:57:48,538 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:48,538 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:47+07:00 trong DST: True
2025-10-15 12:57:48,538 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:48,539 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:48,539 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,540 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:48,540 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,541 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:48,541 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7700', 'price': 4190.77, 'distance_pips': 0.2}, {'level': '7725', 'price': 4190.773, 'distance_pips': 0.05}, {'level': '7750', 'price': 4190.775, 'distance_pips': 0.3}, {'level': '7775', 'price': 4190.778, 'distance_pips': 0.55}]
2025-10-15 12:57:48,541 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,542 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:48,543 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,543 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,544 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6100', 'price': 4190.61, 'distance_pips': 0.7}, {'level': '6125', 'price': 4190.612, 'distance_pips': 0.45}, {'level': '6150', 'price': 4190.615, 'distance_pips': 0.2}, {'level': '6175', 'price': 4190.617, 'distance_pips': 0.05}]
2025-10-15 12:57:48,544 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,544 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:48,553 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:48,557 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.772
2025-10-15 12:57:48,558 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:48,561 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:48,565 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,567 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:48,567 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,567 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:48,568 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:48,568 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:48,569 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.617
2025-10-15 12:57:48,569 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.772
2025-10-15 12:57:48,570 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:48,570 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:48,571 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:48,571 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:48,573 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:48,574 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:48,575 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:48,575 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:48,576 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:48,579 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.772
2025-10-15 12:57:48,585 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:48,588 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:48,590 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:48,593 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:48,595 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:48,597 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.772
2025-10-15 12:57:48,599 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:48,599 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:48,600 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:48,601 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:48,601 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:48,602 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.617
2025-10-15 12:57:48,602 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,603 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:48,603 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,605 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:48,605 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:48,606 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:48,613 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:48,615 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:48,617 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:48,619 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:48,622 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:48,624 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:48,629 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:48,629 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:48,630 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:48,630 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:48,631 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:48,631 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:48,632 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.617
2025-10-15 12:57:48,633 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:48,633 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:48,634 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:48,634 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:48,635 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:48,637 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:48,637 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:48,637 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:48,638 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:48,639 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:48,659 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,661 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,663 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.617
2025-10-15 12:57:48,663 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:48,664 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:48,664 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:48,665 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:48,665 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:48,667 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:48,667 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:48,668 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:48,668 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,674 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:48,689 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,691 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:48,691 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:48,692 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:48,693 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:48,693 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:48,694 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:48,694 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:48,695 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:48,695 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:48,695 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:48,696 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:48,696 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:48,698 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:48,699 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:48,700 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:48,700 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:48,701 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,701 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:48,715 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.772, 'ask': 4190.809, 'last': 0.0, 'time': 1760533067}
2025-10-15 12:57:48,722 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:48,724 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.81s
2025-10-15 12:57:48,725 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:48,725 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:48,726 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:48,726 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,726 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,727 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:48,727 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:48,728 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:48,728 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:48,730 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:48,731 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:48,755 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,755 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:48,755 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:48,756 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.617, 'ask': 4190.654, 'last': 0.0, 'time': 1760533067}
2025-10-15 12:57:48,759 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:48,759 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:48,760 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:48,760 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:48,762 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,762 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:48,763 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,788 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 353, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:48,814 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 439, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:48,836 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,851 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,905 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,912 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:48,945 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:48,983 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:49,005 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:49,007 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:49,007 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:49,008 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:49,010 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:49,031 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:49,101 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:49,107 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:49,113 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:49,115 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:49,116 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:49,117 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:49,118 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:49,119 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:49,121 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10811.999999999898}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100013.00000000038}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4506.000000000313}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28980.999999999767}]
2025-10-15 12:57:49,122 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:47+07:00
2025-10-15 12:57:49,123 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:49,125 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:49,127 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:49,131 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.22s
2025-10-15 12:57:49,261 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:49,262 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:49,263 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:49,264 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:49,264 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:49,273 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:49,274 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:49,274 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:49,275 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:49,276 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:49,277 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:49,278 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:49,279 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:49,780 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:49,782 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:49,782 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:49,783 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.772
2025-10-15 12:57:49,788 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:49,859 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:49,883 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:49,884 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:49,890 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:49,891 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:49,892 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:49,892 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:49,896 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:49,896 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:49,897 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:49,897 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:49,900 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:49,900 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:49,901 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:49,901 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:49,904 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:49,904 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:49,904 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:49,905 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:49,908 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:49,908 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:49,909 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:49,909 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:49,910 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:49+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:49,911 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:49+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:49,970 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:49+07:00
2025-10-15 12:57:50,051 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:49+07:00 trong DST: True
2025-10-15 12:57:50,052 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:50,114 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:50,120 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:50,121 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:50,128 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:50,131 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:50,211 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:50,211 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:50,213 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:50,214 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:50,219 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:50,220 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:50,221 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:50,222 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:50,223 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:50,224 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:50,273 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:50,275 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:50,276 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:50,276 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:50,277 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:50,280 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:50,280 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:50,281 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:50,283 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:50,283 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:50,284 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:50,285 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:50,285 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:50,286 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:50,286 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:50,289 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:50,289 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:50,290 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:50,290 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:50,292 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:50,293 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:50,293 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:50,294 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:50,294 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:50,295 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:50,316 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:50,317 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:50,317 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.772, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:50,318 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:50,318 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:50,319 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:50,319 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:50,320 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10966.999999999643
2025-10-15 12:57:50,320 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100168.00000000012
2025-10-15 12:57:50,321 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4661.000000000058
2025-10-15 12:57:50,321 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29135.999999999513
2025-10-15 12:57:50,322 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:50,324 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10966.999999999643}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100168.00000000012}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4661.000000000058}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29135.999999999513}]
2025-10-15 12:57:50,325 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:50,778 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:50,780 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:50,781 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:50,781 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:50,782 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:50,782 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.731
2025-10-15 12:57:50,783 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:50,790 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 354, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:50,790 - APP.services.mt5_service - DEBUG - Position in day range: 0.5723757763975168
2025-10-15 12:57:50,825 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:49+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:50,852 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:49+07:00
2025-10-15 12:57:50,881 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:50,881 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:49+07:00 trong DST: True
2025-10-15 12:57:50,882 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:50,883 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:50,884 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:50,884 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:50,887 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:50,888 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:50,906 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:50,908 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:50,909 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:50,909 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:50,910 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:50,910 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7700', 'price': 4190.77, 'distance_pips': 0.2}, {'level': '7725', 'price': 4190.773, 'distance_pips': 0.05}, {'level': '7750', 'price': 4190.775, 'distance_pips': 0.3}, {'level': '7775', 'price': 4190.778, 'distance_pips': 0.55}]
2025-10-15 12:57:50,914 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:50,914 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:50,915 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:50,915 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:50,916 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:50,917 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:50,918 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:50,918 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:50,920 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:50,944 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.772
2025-10-15 12:57:50,945 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:50,946 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:50,946 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:50,947 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:50,947 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:50,949 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:50,952 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:50,975 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:50,976 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:50,976 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:50,977 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:50,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.772
2025-10-15 12:57:50,978 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:50,978 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:50,982 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:51,002 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:51,003 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:51,004 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:51,005 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:51,006 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:51,006 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:51,007 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:51,007 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:49+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:51,008 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.772
2025-10-15 12:57:51,009 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:49+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:51,009 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:51,010 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:49+07:00
2025-10-15 12:57:51,010 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:51,011 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:49+07:00 trong DST: True
2025-10-15 12:57:51,013 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:51,014 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:51,038 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:51,039 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:51,039 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:51,040 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:51,040 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.772
2025-10-15 12:57:51,043 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:51,045 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:51,066 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.319026246782
2025-10-15 12:57:51,067 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:51,071 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.319026246782, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:51,073 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:51,075 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:51,075 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:51,076 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.080744539864
2025-10-15 12:57:51,098 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:51,098 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:51,099 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:51,099 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.821965460701
2025-10-15 12:57:51,100 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:51,100 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:51,101 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:51,101 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.741852160103
2025-10-15 12:57:51,102 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:51,102 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:51,102 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:51,103 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.86213584918
2025-10-15 12:57:51,103 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:51,104 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:51,104 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:51,105 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.367672362451
2025-10-15 12:57:51,106 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:51,106 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:51,107 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.306599948716
2025-10-15 12:57:51,108 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:51,116 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:51,130 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.522238362507
2025-10-15 12:57:51,132 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:51,132 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:51,133 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:51,133 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.2985387121266
2025-10-15 12:57:51,134 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:51,134 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.080744539864, 'ema200': 4194.821965460701}, 'M5': {'ema50': 4194.741852160103, 'ema200': 4182.86213584918}, 'M15': {'ema50': 4187.367672362451, 'ema200': 4157.306599948716}, 'H1': {'ema50': 4140.522238362507, 'ema200': 4073.2985387121266}}
2025-10-15 12:57:51,135 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:51,136 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:51,137 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:51,137 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:51,145 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.604234660191495, TRs count: 179
2025-10-15 12:57:51,163 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:51,164 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:51,164 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:51,165 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3222761474465354, TRs count: 119
2025-10-15 12:57:51,165 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:51,166 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:51,169 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:51,193 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:51,194 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.620964431630863, TRs count: 95
2025-10-15 12:57:51,195 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:51,195 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:51,196 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:51,196 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:51,197 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:51,198 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.604234660191495, 'M1': 2.3222761474465354, 'M15': 9.620964431630863, 'H1': 19.294144483387498}
2025-10-15 12:57:51,200 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:51,222 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:51,223 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:51,224 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.731, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:51,224 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:51,224 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:51,226 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:51,226 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:51,226 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:51,227 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:51,227 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:51,228 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:51,228 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.772, 'ask': 4190.809, 'last': 0.0, 'time': 1760533069}
2025-10-15 12:57:51,229 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10925.999999999476
2025-10-15 12:57:51,230 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:51,230 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100126.99999999996
2025-10-15 12:57:51,231 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.22s
2025-10-15 12:57:51,231 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4619.999999999891
2025-10-15 12:57:51,232 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29094.999999999345
2025-10-15 12:57:51,233 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:51,253 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10925.999999999476}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100126.99999999996}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4619.999999999891}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29094.999999999345}]
2025-10-15 12:57:51,255 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:51,256 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:51,256 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:51,257 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:51,257 - APP.services.mt5_service - DEBUG - Position in day range: 0.5717391304347813
2025-10-15 12:57:51,258 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:49+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:51,258 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:49+07:00
2025-10-15 12:57:51,258 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:49+07:00 trong DST: True
2025-10-15 12:57:51,259 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:51,259 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:51,260 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:51,261 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:51,264 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:51,286 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7300', 'price': 4190.73, 'distance_pips': 0.1}, {'level': '7325', 'price': 4190.733, 'distance_pips': 0.15}, {'level': '7350', 'price': 4190.735, 'distance_pips': 0.4}, {'level': '7375', 'price': 4190.738, 'distance_pips': 0.65}]
2025-10-15 12:57:51,288 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:51,289 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:51,289 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:51,289 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:51,290 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.731
2025-10-15 12:57:51,291 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:51,292 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:51,294 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:51,294 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:51,294 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:51,326 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:51,360 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.731
2025-10-15 12:57:51,388 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:51,432 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:51,446 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:51,479 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:51,512 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:51,535 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.731
2025-10-15 12:57:51,585 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:51,600 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:51,629 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:51,632 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:51,634 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:51,635 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.731
2025-10-15 12:57:51,636 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:57:51,636 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:51,637 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:57:51,641 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.00s
2025-10-15 12:57:51,643 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:51,678 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:51,700 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:51,726 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:51,731 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:51,753 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:51,759 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:51,762 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:51,786 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:51,788 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:51,790 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:51,819 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:51,821 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:51,825 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:51,847 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:51,848 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:51,850 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:51,851 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:51,853 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:51,855 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:51,857 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:51,884 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:51,911 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:51,919 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:51,949 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:51,973 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:51,976 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:51,981 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:52,009 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:52,032 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:52,061 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:52,062 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.731, 'ask': 4190.768, 'last': 0.0, 'time': 1760533069}
2025-10-15 12:57:52,066 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:52,069 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:52,072 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:52,075 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:52,095 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:52,095 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:52,096 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:52,101 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 354, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:52,105 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:52,107 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:52,131 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:52,132 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:52,133 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:52,135 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:52,136 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:52,137 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:52,160 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:52,162 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.660215038158264}
2025-10-15 12:57:52,165 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:52,191 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:52,195 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:52,224 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:52,227 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:52,228 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:52,228 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:52,229 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:52,230 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:52,231 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10925.999999999476}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100126.99999999996}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4619.999999999891}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29094.999999999345}]
2025-10-15 12:57:52,232 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:49+07:00
2025-10-15 12:57:52,252 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:52,253 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:57:52,254 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:52,255 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:52,256 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:52,257 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.14s
2025-10-15 12:57:52,259 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:52,259 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:52,261 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:52,319 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:52,320 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.06s
2025-10-15 12:57:52,320 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:52,321 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:52,322 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:52,322 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:52,350 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:52,351 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:52,351 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:52,356 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:52,357 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:52,358 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:52,382 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:52,383 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:52,387 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:52,853 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:52,855 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:52,856 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:52,856 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.508
2025-10-15 12:57:52,861 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 351, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:52,908 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:52,909 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:52,909 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:52,911 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:52,911 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:52,912 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:52,912 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:52,915 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:52,916 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:52,916 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:52,917 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:52,920 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:52,921 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:52,940 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:52,941 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:52,945 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:52,946 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:52,946 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:52,947 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:52,951 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:52,973 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:52,975 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:52,975 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:52,976 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:52+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:52,976 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:52+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:52,977 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:52+07:00
2025-10-15 12:57:52,977 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:52+07:00 trong DST: True
2025-10-15 12:57:52,978 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:52,978 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:52,981 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:52,985 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:53,003 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.303097331717
2025-10-15 12:57:53,007 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.303097331717, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:53,007 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:53,008 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.210038657511
2025-10-15 12:57:53,009 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:53,010 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.85477143085
2025-10-15 12:57:53,011 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:53,014 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.87114627775
2025-10-15 12:57:53,014 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:53,015 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.89494181933
2025-10-15 12:57:53,035 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:53,036 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.496966480098
2025-10-15 12:57:53,037 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:53,037 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.339405918865
2025-10-15 12:57:53,038 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:53,038 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.651532480154
2025-10-15 12:57:53,039 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:53,040 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.331344682276
2025-10-15 12:57:53,040 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.210038657511, 'ema200': 4194.85477143085}, 'M5': {'ema50': 4194.87114627775, 'ema200': 4182.89494181933}, 'M15': {'ema50': 4187.496966480098, 'ema200': 4157.339405918865}, 'H1': {'ema50': 4140.651532480154, 'ema200': 4073.331344682276}}
2025-10-15 12:57:53,040 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:53,041 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.732806088762937, TRs count: 179
2025-10-15 12:57:53,042 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:53,043 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.5355618617322406, TRs count: 119
2025-10-15 12:57:53,046 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:53,064 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.694035860202302, TRs count: 95
2025-10-15 12:57:53,066 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:53,067 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:53,067 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.732806088762937, 'M1': 2.5355618617322406, 'M15': 9.694035860202302, 'H1': 19.294144483387498}
2025-10-15 12:57:53,068 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:53,068 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.508, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:53,069 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:53,069 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:53,070 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:53,070 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:53,070 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10702.99999999952
2025-10-15 12:57:53,071 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 99904.0
2025-10-15 12:57:53,071 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4396.9999999999345
2025-10-15 12:57:53,072 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 28871.99999999939
2025-10-15 12:57:53,072 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:53,072 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10702.99999999952}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 99904.0}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4396.9999999999345}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 28871.99999999939}]
2025-10-15 12:57:53,077 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:53,099 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:53,100 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:53,101 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:53,102 - APP.services.mt5_service - DEBUG - Position in day range: 0.5682763975155273
2025-10-15 12:57:53,102 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:52+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:53,103 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:52+07:00
2025-10-15 12:57:53,103 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:52+07:00 trong DST: True
2025-10-15 12:57:53,104 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:53,107 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:53,108 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:53,108 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:53,128 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:53,129 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '5000', 'price': 4190.5, 'distance_pips': 0.8}, {'level': '5025', 'price': 4190.502, 'distance_pips': 0.55}, {'level': '5050', 'price': 4190.505, 'distance_pips': 0.3}, {'level': '5075', 'price': 4190.507, 'distance_pips': 0.05}]
2025-10-15 12:57:53,129 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6454081897656868}
2025-10-15 12:57:53,130 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:53,130 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:53,131 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:53,132 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.508
2025-10-15 12:57:53,133 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:53,133 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:53,135 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:53,165 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:53,169 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:53,171 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.508
2025-10-15 12:57:53,171 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:53,172 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:53,172 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:53,173 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:53,173 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:53,174 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.508
2025-10-15 12:57:53,174 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:53,175 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:53,175 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:53,176 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:53,177 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:53,177 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.508
2025-10-15 12:57:53,178 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:53,178 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:53,179 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:53,180 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:53,180 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:53,181 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:53,182 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:53,182 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:53,183 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:53,183 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:53,184 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:53,184 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:53,184 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:53,185 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:53,185 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:53,185 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:53,186 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:53,186 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:53,186 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:53,187 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:53,187 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:53,187 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:53,188 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:53,188 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:53,188 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:53,189 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:53,189 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:53,190 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:53,190 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:53,191 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:53,191 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:53,193 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:53,193 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:53,193 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:53,194 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.508, 'ask': 4190.545, 'last': 0.0, 'time': 1760533072}
2025-10-15 12:57:53,194 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:53,195 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 0.94s
2025-10-15 12:57:53,227 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:53,370 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:53,371 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:53,372 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:53,374 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:53,530 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:53,531 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:53,531 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:53,531 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:53,532 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:53,533 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:53,533 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:53,534 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:53,534 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:53,535 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:53,535 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:53,536 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:53,537 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:53,537 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:53,538 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:54,039 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:54,041 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:54,043 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:54,546 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:54,547 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:54,548 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:54,548 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:54,549 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.676
2025-10-15 12:57:54,549 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.017
2025-10-15 12:57:54,554 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 352, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:54,561 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 352, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:54,662 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:54,665 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:54,665 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:54,666 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:54,666 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:54,668 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:54,671 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:54,674 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:54,674 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:54,674 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:54,675 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:54,675 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:54,676 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:54,676 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:54,680 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:54,684 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:54,684 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:54,685 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:54,685 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:54,686 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:54,686 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:54,686 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:54,688 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:54,690 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:54,690 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:54,690 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:54,691 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:54,691 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:54,692 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:54,692 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:54,694 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:54,696 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:54,696 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:54,697 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:54,697 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:54,699 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:54,699 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:54,700 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:54,726 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:54,760 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:54,818 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:54,819 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:54,820 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:54,820 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:54,821 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:54,821 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:54+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:54,822 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:54,823 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:54+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:54,823 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:53+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:54,824 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:54+07:00
2025-10-15 12:57:54,825 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:53+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:54,825 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:54+07:00 trong DST: True
2025-10-15 12:57:54,826 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:53+07:00
2025-10-15 12:57:54,849 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:54,852 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:53+07:00 trong DST: True
2025-10-15 12:57:54,852 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:54,852 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:54,853 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:54,853 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:54,857 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:54,881 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:54,881 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.303630816937
2025-10-15 12:57:54,884 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:54,902 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.303630816937, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:54,913 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.303630816937
2025-10-15 12:57:54,913 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:54,917 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.303630816937, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:54,921 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.222940618296
2025-10-15 12:57:54,940 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:54,942 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:54,942 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.858045062691
2025-10-15 12:57:54,943 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.222940618296
2025-10-15 12:57:54,944 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:54,945 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:54,945 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.884048238535
2025-10-15 12:57:54,946 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.858045062691
2025-10-15 12:57:54,946 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:54,947 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:54,947 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.8982154511705
2025-10-15 12:57:54,960 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.884048238535
2025-10-15 12:57:54,974 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:54,975 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:54,976 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.8982154511705
2025-10-15 12:57:54,976 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.509868440882
2025-10-15 12:57:54,977 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:54,978 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:54,978 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.509868440882
2025-10-15 12:57:54,978 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.342679550707
2025-10-15 12:57:54,979 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:54,982 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:54,983 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.664434440939
2025-10-15 12:57:55,001 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:55,004 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.342679550707
2025-10-15 12:57:55,005 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3346183141166
2025-10-15 12:57:55,005 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:55,006 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.222940618296, 'ema200': 4194.858045062691}, 'M5': {'ema50': 4194.884048238535, 'ema200': 4182.8982154511705}, 'M15': {'ema50': 4187.509868440882, 'ema200': 4157.342679550707}, 'H1': {'ema50': 4140.664434440939, 'ema200': 4073.3346183141166}}
2025-10-15 12:57:55,006 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.664434440939
2025-10-15 12:57:55,007 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:55,007 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:55,008 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.734591803048625, TRs count: 179
2025-10-15 12:57:55,009 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3346183141166
2025-10-15 12:57:55,009 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:55,010 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.222940618296, 'ema200': 4194.858045062691}, 'M5': {'ema50': 4194.884048238535, 'ema200': 4182.8982154511705}, 'M15': {'ema50': 4187.509868440882, 'ema200': 4157.342679550707}, 'H1': {'ema50': 4140.664434440939, 'ema200': 4073.3346183141166}}
2025-10-15 12:57:55,029 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.537347576017929, TRs count: 119
2025-10-15 12:57:55,036 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:55,038 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:55,039 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.734591803048625, TRs count: 179
2025-10-15 12:57:55,040 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.69582157448799, TRs count: 95
2025-10-15 12:57:55,040 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:55,041 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:55,046 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.537347576017929, TRs count: 119
2025-10-15 12:57:55,070 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:55,071 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:55,071 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.69582157448799, TRs count: 95
2025-10-15 12:57:55,072 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.734591803048625, 'M1': 2.537347576017929, 'M15': 9.69582157448799, 'H1': 19.294144483387498}
2025-10-15 12:57:55,072 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:55,074 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:55,074 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:55,075 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.017, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:55,075 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.734591803048625, 'M1': 2.537347576017929, 'M15': 9.69582157448799, 'H1': 19.294144483387498}
2025-10-15 12:57:55,080 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:55,095 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:55,095 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:55,096 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:55,096 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.676, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:55,097 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:55,097 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:55,097 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11211.999999999534
2025-10-15 12:57:55,098 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:55,098 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100413.00000000001
2025-10-15 12:57:55,098 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:55,099 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4905.999999999949
2025-10-15 12:57:55,099 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:55,100 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29380.999999999403
2025-10-15 12:57:55,100 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10871.000000000095
2025-10-15 12:57:55,100 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:55,101 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100072.00000000057
2025-10-15 12:57:55,101 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11211.999999999534}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100413.00000000001}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4905.999999999949}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29380.999999999403}]
2025-10-15 12:57:55,102 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4565.000000000509
2025-10-15 12:57:55,102 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:55,102 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29039.999999999964
2025-10-15 12:57:55,103 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:55,103 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:55,104 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:55,105 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10871.000000000095}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100072.00000000057}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4565.000000000509}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29039.999999999964}]
2025-10-15 12:57:55,106 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:55,107 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:55,107 - APP.services.mt5_service - DEBUG - Position in day range: 0.5761801242236021
2025-10-15 12:57:55,108 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:55,126 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:54+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:55,127 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:55,128 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:54+07:00
2025-10-15 12:57:55,128 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:55,128 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:54+07:00 trong DST: True
2025-10-15 12:57:55,129 - APP.services.mt5_service - DEBUG - Position in day range: 0.5708850931677102
2025-10-15 12:57:55,129 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:55,130 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:53+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:55,130 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:55,130 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:53+07:00
2025-10-15 12:57:55,131 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:55,132 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:53+07:00 trong DST: True
2025-10-15 12:57:55,133 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,133 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:55,134 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,134 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:55,135 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '100', 'price': 4191.01, 'distance_pips': 0.7}, {'level': '125', 'price': 4191.012, 'distance_pips': 0.45}, {'level': '150', 'price': 4191.015, 'distance_pips': 0.2}, {'level': '175', 'price': 4191.017, 'distance_pips': 0.05}]
2025-10-15 12:57:55,135 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:55,136 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6452072138873421}
2025-10-15 12:57:55,137 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,138 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,139 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,139 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,161 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6700', 'price': 4190.67, 'distance_pips': 0.6}, {'level': '6725', 'price': 4190.672, 'distance_pips': 0.35}, {'level': '6750', 'price': 4190.675, 'distance_pips': 0.1}, {'level': '6775', 'price': 4190.677, 'distance_pips': 0.15}]
2025-10-15 12:57:55,161 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:55,162 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6452072138714824}
2025-10-15 12:57:55,163 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.017
2025-10-15 12:57:55,163 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,164 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:55,164 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,164 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:55,165 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:55,166 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:55,167 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.676
2025-10-15 12:57:55,168 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:55,168 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:55,169 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:55,176 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.017
2025-10-15 12:57:55,192 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:55,193 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:55,194 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:55,194 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:55,195 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:55,196 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:55,196 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:55,197 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:55,197 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.676
2025-10-15 12:57:55,200 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:55,225 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.017
2025-10-15 12:57:55,226 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:55,227 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:55,227 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:55,228 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:55,229 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:55,257 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:55,257 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:55,258 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:55,258 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:55,259 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:55,260 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.676
2025-10-15 12:57:55,261 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.017
2025-10-15 12:57:55,263 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:55,263 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:55,286 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:55,287 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:55,287 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:55,288 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:55,289 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:55,289 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:55,290 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,290 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:55,291 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,291 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.676
2025-10-15 12:57:55,292 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:55,293 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:55,294 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:55,294 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:55,296 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:55,318 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:55,319 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:55,319 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:55,320 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,320 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:55,321 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,321 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:55,321 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:55,322 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:55,323 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:55,324 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:55,324 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:55,325 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:55,325 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:55,326 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:55,326 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:55,327 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:55,327 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:55,353 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:55,353 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:55,355 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:55,355 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:55,357 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:55,358 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:55,382 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:55,382 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:55,383 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,384 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:55,384 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,384 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:55,385 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:55,385 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:55,386 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:55,387 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:55,387 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:55,387 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:55,388 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:55,409 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:55,410 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:55,411 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:55,411 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:55,412 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,412 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:55,412 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,413 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:55,414 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:55,414 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:55,415 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:55,415 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,416 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:55,418 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.017, 'ask': 4191.054, 'last': 0.0, 'time': 1760533074}
2025-10-15 12:57:55,419 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:55,419 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:55,429 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:55,442 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.07s
2025-10-15 12:57:55,443 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:55,444 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,445 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:55,445 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:55,445 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.676, 'ask': 4190.713, 'last': 0.0, 'time': 1760533073}
2025-10-15 12:57:55,449 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:55,452 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:55,473 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:55,474 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:55,474 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,475 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,475 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 352, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:55,475 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:55,476 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,476 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,476 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,477 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,477 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,477 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,478 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,479 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,480 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6452072138714824}
2025-10-15 12:57:55,481 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:55,481 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:55,482 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:55,482 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,504 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,504 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:55,505 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:55,543 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:55,616 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:55,629 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:55,660 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10871.000000000095}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100072.00000000057}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4565.000000000509}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29039.999999999964}]
2025-10-15 12:57:55,661 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:53+07:00
2025-10-15 12:57:55,693 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:55,729 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:55,764 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:55,768 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.40s
2025-10-15 12:57:55,858 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:55,859 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:55,860 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:55,861 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:55,861 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:56,384 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:56,385 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:56,387 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:56,388 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:56,394 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:56,394 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:56,395 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:56,395 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:56,396 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:56,396 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:56,397 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:56,397 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:56,398 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:56,398 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:56,399 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:56,399 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:56,400 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:56,401 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:56,401 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:56,902 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:56,904 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:56,905 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:57,391 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:57,392 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:57:57,401 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.01s
2025-10-15 12:57:57,406 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:57,407 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:57,408 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:57,408 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:57,408 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.7
2025-10-15 12:57:57,409 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.87
2025-10-15 12:57:57,415 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:57,416 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:57,426 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:57,538 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:57,541 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:57,542 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:57,542 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:57,543 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:57,544 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:57,546 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:57,549 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:57,549 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:57,550 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:57,550 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:57,551 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:57,551 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:57,552 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:57,555 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:57,559 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:57,560 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:57,560 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:57,561 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:57,561 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:57,562 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:57,563 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:57,565 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:57,566 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:57,567 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:57,567 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:57,568 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:57,568 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:57,569 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:57,569 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:57,571 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:57,574 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:57,575 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:57,575 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:57,576 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:57,576 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:57,579 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:57,597 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:57,601 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:57,605 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:57,606 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:57,606 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:57,607 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:57,607 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:57,607 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:57,629 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:57,630 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:56+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:57,631 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:57+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:57,631 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:56+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:57,632 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:57+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:57,632 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:56+07:00
2025-10-15 12:57:57,633 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:57+07:00
2025-10-15 12:57:57,633 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:56+07:00 trong DST: True
2025-10-15 12:57:57,633 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:57+07:00 trong DST: True
2025-10-15 12:57:57,634 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:57,634 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:57,634 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:57,636 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:57,637 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:57,637 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:57,639 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:57,662 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:57,662 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.303488356373
2025-10-15 12:57:57,663 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.303488356373
2025-10-15 12:57:57,667 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.303488356373, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:57,675 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.303488356373, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:57,696 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:57,696 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:57,697 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.224234735942
2025-10-15 12:57:57,697 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.224234735942
2025-10-15 12:57:57,698 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:57,699 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:57,699 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8583734209
2025-10-15 12:57:57,699 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8583734209
2025-10-15 12:57:57,700 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:57,701 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:57,721 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.885342356181
2025-10-15 12:57:57,722 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.885342356181
2025-10-15 12:57:57,723 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:57,723 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:57,724 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.898543809379
2025-10-15 12:57:57,724 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.898543809379
2025-10-15 12:57:57,725 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:57,726 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:57,726 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.51116255853
2025-10-15 12:57:57,727 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.51116255853
2025-10-15 12:57:57,727 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:57,727 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:57,728 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.343007908915
2025-10-15 12:57:57,728 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.343007908915
2025-10-15 12:57:57,728 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:57,729 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:57,730 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.665728558585
2025-10-15 12:57:57,731 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.665728558585
2025-10-15 12:57:57,731 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:57,732 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:57,732 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3349466723257
2025-10-15 12:57:57,755 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3349466723257
2025-10-15 12:57:57,756 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.224234735942, 'ema200': 4194.8583734209}, 'M5': {'ema50': 4194.885342356181, 'ema200': 4182.898543809379}, 'M15': {'ema50': 4187.51116255853, 'ema200': 4157.343007908915}, 'H1': {'ema50': 4140.665728558585, 'ema200': 4073.3349466723257}}
2025-10-15 12:57:57,757 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.224234735942, 'ema200': 4194.8583734209}, 'M5': {'ema50': 4194.885342356181, 'ema200': 4182.898543809379}, 'M15': {'ema50': 4187.51116255853, 'ema200': 4157.343007908915}, 'H1': {'ema50': 4140.665728558585, 'ema200': 4073.3349466723257}}
2025-10-15 12:57:57,757 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:57,758 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:57,759 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.734591803048625, TRs count: 179
2025-10-15 12:57:57,760 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.734591803048625, TRs count: 179
2025-10-15 12:57:57,760 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:57,761 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:57,762 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.537347576017929, TRs count: 119
2025-10-15 12:57:57,763 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.537347576017929, TRs count: 119
2025-10-15 12:57:57,763 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:57,764 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:57,787 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.69582157448799, TRs count: 95
2025-10-15 12:57:57,788 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.69582157448799, TRs count: 95
2025-10-15 12:57:57,789 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:57,789 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:57,790 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:57,791 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:57,791 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.734591803048625, 'M1': 2.537347576017929, 'M15': 9.69582157448799, 'H1': 19.294144483387498}
2025-10-15 12:57:57,792 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.734591803048625, 'M1': 2.537347576017929, 'M15': 9.69582157448799, 'H1': 19.294144483387498}
2025-10-15 12:57:57,793 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:57,794 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.87, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:57,794 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:57,795 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:57,795 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.7, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:57,819 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:57,822 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:57,822 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:57,823 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:57,824 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:57,825 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:57,825 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11064.9999999996
2025-10-15 12:57:57,826 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:57,834 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100266.00000000007
2025-10-15 12:57:57,848 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 10894.999999999527
2025-10-15 12:57:57,848 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4759.000000000015
2025-10-15 12:57:57,849 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100096.0
2025-10-15 12:57:57,850 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29233.99999999947
2025-10-15 12:57:57,851 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4588.999999999942
2025-10-15 12:57:57,852 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:57,853 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11064.9999999996}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100266.00000000007}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4759.000000000015}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29233.99999999947}]
2025-10-15 12:57:57,854 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29063.999999999396
2025-10-15 12:57:57,854 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:57,855 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:57,856 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:57,856 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10894.999999999527}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100096.0}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4588.999999999942}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29063.999999999396}]
2025-10-15 12:57:57,857 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:57,879 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:57:57,880 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:57,881 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:57,882 - APP.services.mt5_service - DEBUG - Position in day range: 0.573897515527951
2025-10-15 12:57:57,882 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:57:57,883 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:57+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:57,883 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:57:57,884 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:57+07:00
2025-10-15 12:57:57,887 - APP.services.mt5_service - DEBUG - Position in day range: 0.5712577639751548
2025-10-15 12:57:57,888 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:56+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:57,889 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:56+07:00
2025-10-15 12:57:57,911 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:56+07:00 trong DST: True
2025-10-15 12:57:57,912 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:57+07:00 trong DST: True
2025-10-15 12:57:57,913 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:57,913 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:57,914 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:57,914 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:57,915 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:57,915 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:57:57,916 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:57,917 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:57,918 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:57,919 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7000', 'price': 4190.7, 'distance_pips': 0.0}, {'level': '7025', 'price': 4190.702, 'distance_pips': 0.25}, {'level': '7050', 'price': 4190.705, 'distance_pips': 0.5}, {'level': '7075', 'price': 4190.707, 'distance_pips': 0.75}]
2025-10-15 12:57:57,919 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:57,920 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6452072138873421}
2025-10-15 12:57:57,920 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8700', 'price': 4190.87, 'distance_pips': 0.0}, {'level': '8725', 'price': 4190.872, 'distance_pips': 0.25}, {'level': '8750', 'price': 4190.875, 'distance_pips': 0.5}, {'level': '8775', 'price': 4190.877, 'distance_pips': 0.75}]
2025-10-15 12:57:57,921 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:57,929 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6452072138873421}
2025-10-15 12:57:57,947 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:57,951 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:57,973 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:57,974 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:57,975 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.7
2025-10-15 12:57:57,976 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:57,976 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:57,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.87
2025-10-15 12:57:57,978 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:57,978 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:57,979 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:57,979 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:57,982 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:57,982 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:57,989 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:58,009 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.7
2025-10-15 12:57:58,010 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:57:58,011 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:58,012 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:57:58,013 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.87
2025-10-15 12:57:58,013 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:58,014 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:58,022 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:58,036 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:57:58,038 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:58,038 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:58,039 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:58,039 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:57:58,040 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.7
2025-10-15 12:57:58,040 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:57:58,041 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:58,044 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.87
2025-10-15 12:57:58,045 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:58,070 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:58,072 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:58,072 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:57:58,073 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:58,074 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:58,076 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:58,076 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:57:58,100 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.7
2025-10-15 12:57:58,101 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:57:58,101 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:58,102 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.87
2025-10-15 12:57:58,103 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:58,104 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:57:58,121 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:58,134 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:57:58,136 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:58,149 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:57:58,164 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,166 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:57:58,166 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,169 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,170 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:58,196 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,197 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:58,198 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:58,201 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:58,224 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:58,226 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:58,226 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:58,227 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:58,227 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:58,228 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:58,228 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:58,229 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:58,232 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:58,233 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:58,241 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:58,257 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:58,259 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:58,260 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:57:58,260 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:58,262 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:58,264 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:58,273 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:58,287 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:58,288 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:58,289 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:58,289 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,289 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:58,290 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,290 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:57:58,291 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:58,291 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:57:58,292 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:58,292 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:57:58,294 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:57:58,294 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:58,295 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:57:58,295 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:58,318 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:57:58,320 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:58,320 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,321 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:58,322 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,322 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,323 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:57:58,324 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:57:58,325 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:57:58,325 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.7, 'ask': 4190.737, 'last': 0.0, 'time': 1760533076}
2025-10-15 12:57:58,349 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:57:58,349 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:57:58,349 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:57:58,350 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:57:58,351 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:57:58,351 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:57:58,352 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:57:58,352 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,353 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:58,354 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,355 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:57:58,357 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:58,357 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 353, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:58,361 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:57:58,380 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:58,381 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:58,381 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,381 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,382 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,382 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.87, 'ask': 4190.907, 'last': 0.0, 'time': 1760533077}
2025-10-15 12:57:58,382 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,383 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:58,383 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,384 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.00s
2025-10-15 12:57:58,384 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,385 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,385 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,385 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,386 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6452072138873421}
2025-10-15 12:57:58,386 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:57:58,386 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:58,388 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:58,389 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,389 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,389 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:58,396 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:57:58,410 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:57:58,413 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:58,414 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:57:58,414 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:58,415 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:57:58,476 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 10894.999999999527}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100096.0}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4588.999999999942}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29063.999999999396}]
2025-10-15 12:57:58,510 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:56+07:00
2025-10-15 12:57:58,541 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:57:58,567 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:58,607 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:57:58,652 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.27s
2025-10-15 12:57:58,693 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:57:58,694 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:57:58,694 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:57:58,696 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:57:58,697 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:57:58,825 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:58,825 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:58,826 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:58,827 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:58,827 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:58,828 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:58,828 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:58,829 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:59,330 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:57:59,331 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:57:59,332 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:57:59,333 - APP.services.mt5_service - DEBUG - Current price (cp): 4190.816
2025-10-15 12:57:59,337 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:57:59,392 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:57:59,393 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:57:59,394 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:57:59,397 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:57:59,397 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:59,398 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:57:59,398 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:57:59,401 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:57:59,401 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:59,402 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:57:59,402 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:57:59,405 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:57:59,405 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:59,405 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:57:59,406 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:57:59,408 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:57:59,408 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:57:59,408 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:57:59,409 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:57:59,411 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:59,412 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:57:59,412 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:57:59,412 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:57:59,413 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:59+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:57:59,413 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:59+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:57:59,414 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:59+07:00
2025-10-15 12:57:59,414 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:57:59,414 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:59+07:00 trong DST: True
2025-10-15 12:57:59,416 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:57:59,416 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:57:59,417 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:57:59,419 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:57:59,422 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:57:59,443 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.303162468251
2025-10-15 12:57:59,447 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.303162468251, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:57:59,447 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:59,451 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.226273951629
2025-10-15 12:57:59,471 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:59,472 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:59,474 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:59,474 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.858890833835
2025-10-15 12:57:59,475 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:59,476 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:57:59,476 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:57:59,477 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.887381571868
2025-10-15 12:57:59,478 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:57:59,478 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:57:59,482 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:57:59,482 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.899061222314
2025-10-15 12:57:59,483 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:57:59,484 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:57:59,510 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:57:59,513 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.513201774215
2025-10-15 12:57:59,514 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:57:59,514 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.34352532185
2025-10-15 12:57:59,515 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:57:59,539 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.667767774272
2025-10-15 12:57:59,540 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:57:59,541 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.335464085261
2025-10-15 12:57:59,542 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.226273951629, 'ema200': 4194.858890833835}, 'M5': {'ema50': 4194.887381571868, 'ema200': 4182.899061222314}, 'M15': {'ema50': 4187.513201774215, 'ema200': 4157.34352532185}, 'H1': {'ema50': 4140.667767774272, 'ema200': 4073.335464085261}}
2025-10-15 12:57:59,545 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:57:59,545 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.734591803048625, TRs count: 179
2025-10-15 12:57:59,566 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:59,568 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.537347576017929, TRs count: 119
2025-10-15 12:57:59,568 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:57:59,569 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.69582157448799, TRs count: 95
2025-10-15 12:57:59,569 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:57:59,570 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:57:59,570 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.734591803048625, 'M1': 2.537347576017929, 'M15': 9.69582157448799, 'H1': 19.294144483387498}
2025-10-15 12:57:59,570 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:57:59,571 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4190.816, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:57:59,572 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:57:59,572 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:57:59,573 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:57:59,575 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:57:59,576 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11010.999999999513
2025-10-15 12:57:59,577 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100211.99999999999
2025-10-15 12:57:59,600 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4704.999999999927
2025-10-15 12:57:59,601 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29179.99999999938
2025-10-15 12:57:59,601 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:57:59,602 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11010.999999999513}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100211.99999999999}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4704.999999999927}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29179.99999999938}]
2025-10-15 12:57:59,602 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:00,014 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:00,016 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:00,017 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:00,017 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:00,018 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:00,018 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.046
2025-10-15 12:58:00,019 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:00,024 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:00,025 - APP.services.mt5_service - DEBUG - Position in day range: 0.5730590062111794
2025-10-15 12:58:00,035 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:59+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:00,073 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:59+07:00
2025-10-15 12:58:00,085 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:59+07:00 trong DST: True
2025-10-15 12:58:00,099 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:00,099 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:00,100 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:00,101 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:00,101 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:00,102 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:00,106 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:00,107 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:00,108 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:00,108 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:00,129 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:00,131 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8100', 'price': 4190.81, 'distance_pips': 0.6}, {'level': '8125', 'price': 4190.812, 'distance_pips': 0.35}, {'level': '8150', 'price': 4190.815, 'distance_pips': 0.1}, {'level': '8175', 'price': 4190.818, 'distance_pips': 0.15}]
2025-10-15 12:58:00,132 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:00,132 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6452072138873421}
2025-10-15 12:58:00,136 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:00,139 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:00,139 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:00,139 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:00,161 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:00,163 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:00,164 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:00,164 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.816
2025-10-15 12:58:00,167 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:00,168 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:00,170 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:00,170 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:00,173 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:00,196 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:00,196 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:00,197 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:00,197 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:00,201 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:00,203 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4190.816
2025-10-15 12:58:00,203 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:00,226 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:00,227 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:00,228 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:00,228 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:00,229 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:00,251 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:00,257 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:00,258 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:00,258 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:00,259 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:00,260 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4190.816
2025-10-15 12:58:00,261 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:00,264 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:00,288 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:57:59+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:00,289 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:00,290 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:59+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:00,291 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:00,291 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:59+07:00
2025-10-15 12:58:00,292 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:00,292 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:59+07:00 trong DST: True
2025-10-15 12:58:00,294 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:00,295 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:00,295 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4190.816
2025-10-15 12:58:00,296 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:00,317 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:00,318 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:00,319 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:00,320 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:00,321 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:00,321 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.303514889553
2025-10-15 12:58:00,322 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:00,327 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.303514889553, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:00,352 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:00,352 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:00,352 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:00,353 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.231136696727
2025-10-15 12:58:00,353 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:00,354 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:00,354 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:00,354 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.860124664681
2025-10-15 12:58:00,355 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:00,355 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:00,358 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:00,359 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.892244316966
2025-10-15 12:58:00,359 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:00,380 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:00,382 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:00,383 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.90029505316
2025-10-15 12:58:00,383 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:00,383 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:00,384 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:00,386 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.518064519314
2025-10-15 12:58:00,389 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:00,390 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:00,403 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:00,412 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:00,414 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:00,416 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.3447591526965
2025-10-15 12:58:00,416 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:00,417 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:00,425 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:00,446 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.67263051937
2025-10-15 12:58:00,447 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:00,448 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:00,451 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3366979161065
2025-10-15 12:58:00,452 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:00,452 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.231136696727, 'ema200': 4194.860124664681}, 'M5': {'ema50': 4194.892244316966, 'ema200': 4182.90029505316}, 'M15': {'ema50': 4187.518064519314, 'ema200': 4157.3447591526965}, 'H1': {'ema50': 4140.67263051937, 'ema200': 4073.3366979161065}}
2025-10-15 12:58:00,453 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:00,471 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:00,472 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:00,473 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.734591803048625, TRs count: 179
2025-10-15 12:58:00,474 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:00,474 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:00,474 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:00,475 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.537347576017929, TRs count: 119
2025-10-15 12:58:00,475 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:00,476 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:00,477 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:00,477 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.69582157448799, TRs count: 95
2025-10-15 12:58:00,482 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:00,484 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:00,508 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:00,511 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:00,516 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:00,540 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.734591803048625, 'M1': 2.537347576017929, 'M15': 9.69582157448799, 'H1': 19.294144483387498}
2025-10-15 12:58:00,544 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:00,568 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:00,569 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:00,569 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.046, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:00,570 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:00,570 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:00,571 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4190.816, 'ask': 4190.853, 'last': 0.0, 'time': 1760533079}
2025-10-15 12:58:00,571 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:00,572 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:00,572 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:00,572 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.16s
2025-10-15 12:58:00,573 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:00,577 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11240.999999999985
2025-10-15 12:58:00,598 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100442.00000000047
2025-10-15 12:58:00,599 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 4935.0000000004
2025-10-15 12:58:00,599 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29409.999999999854
2025-10-15 12:58:00,599 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:00,600 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11240.999999999985}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100442.00000000047}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4935.0000000004}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29409.999999999854}]
2025-10-15 12:58:00,600 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:00,601 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:00,601 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:00,602 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:00,602 - APP.services.mt5_service - DEBUG - Position in day range: 0.5766304347826153
2025-10-15 12:58:00,602 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:57:59+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:00,603 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:57:59+07:00
2025-10-15 12:58:00,604 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:57:59+07:00 trong DST: True
2025-10-15 12:58:00,604 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:00,607 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:00,608 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:00,628 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:00,628 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:00,640 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:00,671 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '400', 'price': 4191.04, 'distance_pips': 0.6}, {'level': '425', 'price': 4191.042, 'distance_pips': 0.35}, {'level': '450', 'price': 4191.045, 'distance_pips': 0.1}, {'level': '475', 'price': 4191.047, 'distance_pips': 0.15}]
2025-10-15 12:58:00,696 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6452072138714824}
2025-10-15 12:58:00,734 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:00,764 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:00,831 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:00,858 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.046
2025-10-15 12:58:00,860 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:00,873 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:00,914 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:00,945 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:00,947 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:00,974 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.046
2025-10-15 12:58:00,976 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:00,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:00,984 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:01,068 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:01,149 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:01,157 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.046
2025-10-15 12:58:01,204 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:01,206 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:01,208 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:01,214 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:01,217 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:01,221 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.046
2025-10-15 12:58:01,222 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:01,224 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:01,227 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:01,228 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:01,262 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:01,264 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:01,289 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:01,290 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:01,291 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:01,291 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:01,292 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:01,295 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:01,297 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:01,318 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:01,320 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:01,321 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:01,322 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:01,322 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:01,323 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:01,323 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:01,325 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:01,326 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:01,327 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:01,327 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:01,353 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:01,353 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:01,354 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:01,354 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:01,356 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:01,358 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:01,384 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:01,385 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:01,386 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:01,388 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.046, 'ask': 4191.083, 'last': 0.0, 'time': 1760533079}
2025-10-15 12:58:01,413 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:01,442 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:01,443 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:01,445 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:01,447 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:01,447 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:01,474 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:01,475 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:01,476 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:01,477 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:01,477 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:01,478 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 353, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:01,479 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:01,479 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:01,480 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:01,481 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:01,482 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:01,483 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:01,484 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:01,508 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:01,514 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:01,540 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:01,566 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:01,567 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:01,567 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:01,568 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:01,568 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6452072138714824}
2025-10-15 12:58:01,569 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:01,569 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:01,569 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:01,570 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:01,570 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:01,571 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:01,571 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:01,571 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:01,572 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:01,573 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11240.999999999985}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100442.00000000047}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 4935.0000000004}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29409.999999999854}]
2025-10-15 12:58:01,573 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:57:59+07:00
2025-10-15 12:58:01,576 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:01,577 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:01,602 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:01,603 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.19s
2025-10-15 12:58:01,646 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:01,662 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:01,663 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:01,663 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:01,664 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:02,040 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:02,042 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:02,043 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:02,044 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.126
2025-10-15 12:58:02,050 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 351, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:02,118 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:02,119 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:02,119 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:02,121 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:02,122 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:02,122 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:02,123 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:02,126 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:02,126 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:02,127 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:02,127 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:02,129 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:02,129 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:02,130 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:02,131 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:02,133 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:02,133 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:02,133 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:02,134 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:02,138 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:02,140 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:02,140 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:02,163 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:02,163 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:01+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:02,164 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:01+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:02,165 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:01+07:00
2025-10-15 12:58:02,165 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:01+07:00 trong DST: True
2025-10-15 12:58:02,165 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:02,166 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:02,166 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:02,169 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:02,170 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:02,200 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:02,210 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:02,223 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:02,225 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:02,226 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:02,226 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:02,227 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:02,227 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:02,228 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:02,228 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:02,229 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:02,229 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:02,232 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:02,241 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:02,254 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:02,256 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:02,256 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:02,257 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:02,257 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:02,258 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:02,258 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:02,259 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:02,259 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:02,260 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:02,260 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:02,261 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:02,264 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:02,264 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:02,267 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.126, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:02,288 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:02,290 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:02,291 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:02,292 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:02,292 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11320.999999999913
2025-10-15 12:58:02,294 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100522.0000000004
2025-10-15 12:58:02,294 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5015.000000000327
2025-10-15 12:58:02,296 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29489.99999999978
2025-10-15 12:58:02,319 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:02,320 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11320.999999999913}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100522.0000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5015.000000000327}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29489.99999999978}]
2025-10-15 12:58:02,320 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:02,321 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:02,321 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:02,322 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:02,322 - APP.services.mt5_service - DEBUG - Position in day range: 0.577872670807459
2025-10-15 12:58:02,323 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:01+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:02,323 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:01+07:00
2025-10-15 12:58:02,326 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:01+07:00 trong DST: True
2025-10-15 12:58:02,327 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:02,342 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:02,343 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:02,344 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:02,344 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:02,345 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '1200', 'price': 4191.12, 'distance_pips': 0.6}, {'level': '1225', 'price': 4191.122, 'distance_pips': 0.35}, {'level': '1250', 'price': 4191.125, 'distance_pips': 0.1}, {'level': '1275', 'price': 4191.127, 'distance_pips': 0.15}]
2025-10-15 12:58:02,345 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884125193}
2025-10-15 12:58:02,346 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:02,346 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:02,347 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:02,347 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.126
2025-10-15 12:58:02,348 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:02,348 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:02,349 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:02,350 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:02,350 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:02,351 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.126
2025-10-15 12:58:02,351 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:02,351 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:02,352 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:02,353 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:02,353 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:02,355 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.126
2025-10-15 12:58:02,357 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:02,357 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:02,358 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:02,383 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:02,384 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:02,387 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.126
2025-10-15 12:58:02,389 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:02,415 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:02,418 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:02,444 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:02,449 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:02,452 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:02,484 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:02,488 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:02,490 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:02,494 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:02,494 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:02,495 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.04s
2025-10-15 12:58:02,495 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:02,497 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:02,497 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:02,498 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:02,498 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:02,499 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:02,500 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:02,500 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:02,501 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:02,502 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:02,503 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:02,503 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:02,504 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:02,504 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:02,505 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:02,506 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:02,506 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:02,507 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:02,508 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:02,508 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:02,509 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:02,509 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:02,510 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:02,514 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:02,523 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:02,537 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:02,539 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:02,540 - APP.ui.app_ui - INFO - Phát hiện thư mục ảnh thay đổi, thực hiện quét lại và đoán symbol.
2025-10-15 12:58:02,541 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:02,543 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:02,545 - APP.ui.app_ui - DEBUG - Bắt đầu quá trình tải file từ thư mục: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots.
2025-10-15 12:58:02,545 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:02,591 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:02,598 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.scan_folder' vào nhóm 'ui.io.scan' (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 12:58:02,598 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:02,599 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:02,599 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.scan_folder vào group ui.io.scan (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 12:58:02,600 - APP.ui.app_ui - DEBUG - Luồng quét thư mục bắt đầu cho: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots.
2025-10-15 12:58:02,600 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:02,601 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:02,630 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:02,632 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.126, 'ask': 4191.163, 'last': 0.0, 'time': 1760533081}
2025-10-15 12:58:02,634 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:02,640 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.19s
2025-10-15 12:58:02,659 - APP.ui.app_ui - INFO - Luồng quét đã hoàn tất, tìm thấy 4 file.
2025-10-15 12:58:02,665 - APP.utils.threading_utils - DEBUG - Task 'ui.io.scan_folder' (group=ui.io.scan) hoàn tất sau 0.07s
2025-10-15 12:58:02,743 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:58:02,756 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:58:02,772 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:58:02,821 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 12:58:02,876 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:02,885 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:03,097 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: refresh_all_lists
2025-10-15 12:58:03,097 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 12:58:03,098 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 12:58:03,099 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:58:03,100 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:58:03,100 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 12:58:03,100 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 12:58:03,102 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:58:03,103 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:58:03,103 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 12:58:03,104 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:03,106 - APP.ui.app_ui - INFO - Phát hiện symbol XAUUSD từ ảnh (auto=True, giữ symbol hiện tại XAUUSD).
2025-10-15 12:58:03,106 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:03,133 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 12:58:03,133 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.03s
2025-10-15 12:58:03,134 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:03,135 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 12:58:03,139 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:03,161 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.06s
2025-10-15 12:58:03,170 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:03,260 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.16
2025-10-15 12:58:03,273 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:03,339 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:03,341 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:03,342 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:03,345 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:03,346 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:03,347 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:03,348 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:03,352 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:03,353 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:03,354 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:03,355 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:03,358 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:03,381 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:03,382 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:03,383 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:03,387 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:03,389 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:03,413 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:03,415 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:03,421 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:03,448 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:03,479 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:03,483 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:03,507 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:02+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:03,508 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:02+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:03,509 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:02+07:00
2025-10-15 12:58:03,511 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:02+07:00 trong DST: True
2025-10-15 12:58:03,537 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:03,538 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:03,538 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:03,566 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:03,597 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:03,604 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:03,604 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:03,607 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:03,631 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:03,661 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:03,663 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:03,666 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:03,670 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:03,692 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:03,694 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:03,695 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:03,697 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:03,698 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:03,726 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:03,727 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:03,728 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:03,728 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:03,729 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:03,729 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:03,732 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:03,754 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:03,756 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:03,756 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:03,757 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:03,760 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:03,779 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:03,788 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:03,789 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:03,790 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:03,791 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.16, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:03,791 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:03,792 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:03,793 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:03,795 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:03,795 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:03,811 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:03,819 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11354.999999999563
2025-10-15 12:58:03,821 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:03,822 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100556.00000000004
2025-10-15 12:58:03,823 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5048.999999999978
2025-10-15 12:58:03,826 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29523.999999999432
2025-10-15 12:58:03,826 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:03,846 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11354.999999999563}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100556.00000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5048.999999999978}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29523.999999999432}]
2025-10-15 12:58:03,847 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:03,848 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:03,849 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:03,849 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:03,850 - APP.services.mt5_service - DEBUG - Position in day range: 0.5784006211180125
2025-10-15 12:58:03,850 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:02+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:03,851 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:02+07:00
2025-10-15 12:58:03,851 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:02+07:00 trong DST: True
2025-10-15 12:58:03,853 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:03,854 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:03,854 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:03,854 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:03,855 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:03,857 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '1600', 'price': 4191.16, 'distance_pips': 0.0}, {'level': '1625', 'price': 4191.162, 'distance_pips': 0.25}, {'level': '1650', 'price': 4191.165, 'distance_pips': 0.5}, {'level': '1675', 'price': 4191.167, 'distance_pips': 0.75}]
2025-10-15 12:58:03,880 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:03,882 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:03,883 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:03,884 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:03,888 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.16
2025-10-15 12:58:03,914 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:03,916 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:03,920 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:03,945 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:03,945 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:03,946 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:03,947 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:03,947 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:03,949 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.16
2025-10-15 12:58:03,951 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:03,952 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:03,953 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:03,953 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:03,979 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:04,008 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:04,010 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:04,013 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:04,014 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:04,014 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:04,040 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.16
2025-10-15 12:58:04,043 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:04,044 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:04,056 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:04,067 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:04,068 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:04,069 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.16
2025-10-15 12:58:04,069 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:04,070 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:04,070 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:04,071 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:04,071 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,072 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,072 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:04,542 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:04,544 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:04,545 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:04,545 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:04,546 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:04,546 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:04,547 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:04,547 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:04,547 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:04,548 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:04,548 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:04,548 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:04,549 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.159
2025-10-15 12:58:04,549 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:04,550 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:04,550 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:04,551 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:04,551 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:04,552 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:04,552 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,558 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:04,558 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,575 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:04,602 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:04,627 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:04,633 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:04,649 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:04,660 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:04,661 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:04,662 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:04,662 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:04,664 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,664 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:04,664 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:04,666 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:04,667 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.16, 'ask': 4191.197, 'last': 0.0, 'time': 1760533082}
2025-10-15 12:58:04,674 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:04,690 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:04,692 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:04,693 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:04,693 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:04,694 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:04,695 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:04,696 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,699 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:04,700 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,700 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:04,701 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:04,702 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:04,722 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:04,723 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,724 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:04,724 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,726 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:04,726 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,726 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:04,727 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,727 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:04,728 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,729 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:04,729 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,732 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:04,733 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,733 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:04,740 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,755 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:04,756 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:04,756 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:04,757 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:04,759 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:04,760 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:04,760 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:04,761 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:04,763 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:04,763 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,764 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:04,764 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,765 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:04+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:04,765 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:04,787 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:04+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:04,788 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:04,788 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:04+07:00
2025-10-15 12:58:04,789 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,789 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:04+07:00 trong DST: True
2025-10-15 12:58:04,790 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,790 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:04,791 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11354.999999999563}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100556.00000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5048.999999999978}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29523.999999999432}]
2025-10-15 12:58:04,791 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:04,792 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:02+07:00
2025-10-15 12:58:04,792 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:04,793 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:04,794 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:04,796 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:04,797 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:04,807 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:04,821 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:04,823 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.33s
2025-10-15 12:58:04,823 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:04,824 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:04,825 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:04,825 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:04,825 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:04,826 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:04,826 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:04,827 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:04,846 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:04,849 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:04,849 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:04,850 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:04,850 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:04,851 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:04,851 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:04,851 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:04,852 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:04,852 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:04,853 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:04,853 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:04,854 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:04,854 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:04,856 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:04,857 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:04,857 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:04,858 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:04,880 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:04,880 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:04,881 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:04,882 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:04,882 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.159, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:04,883 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:04,883 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:04,883 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:04,884 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:04,884 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:04,885 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:04,885 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11353.99999999936
2025-10-15 12:58:04,887 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100554.99999999984
2025-10-15 12:58:04,888 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5047.999999999774
2025-10-15 12:58:04,889 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29522.99999999923
2025-10-15 12:58:04,911 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:04,912 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11353.99999999936}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100554.99999999984}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5047.999999999774}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29522.99999999923}]
2025-10-15 12:58:04,912 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:04,913 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:04,913 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:04,914 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:04,914 - APP.services.mt5_service - DEBUG - Position in day range: 0.5783850931676988
2025-10-15 12:58:04,915 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:04+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:04,915 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:04+07:00
2025-10-15 12:58:04,916 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:04+07:00 trong DST: True
2025-10-15 12:58:04,916 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:04,917 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:04,917 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:04,918 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,918 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,919 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '1500', 'price': 4191.15, 'distance_pips': 0.9}, {'level': '1525', 'price': 4191.152, 'distance_pips': 0.65}, {'level': '1550', 'price': 4191.155, 'distance_pips': 0.4}, {'level': '1575', 'price': 4191.157, 'distance_pips': 0.15}]
2025-10-15 12:58:04,920 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:04,920 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:04,921 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:04,942 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:04,944 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.159
2025-10-15 12:58:04,945 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:04,945 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:04,946 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:04,946 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:04,947 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:04,948 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.159
2025-10-15 12:58:04,948 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:04,950 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:04,950 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:04,951 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:04,951 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:04,955 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.159
2025-10-15 12:58:04,977 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:04,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:04,979 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:04,979 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:04,979 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:04,981 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.159
2025-10-15 12:58:04,982 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:04,983 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:05,004 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:05,006 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:05,007 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:05,007 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:05,008 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:05,008 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:05,009 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:05,009 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:05,009 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:05,010 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:05,010 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:05,013 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:05,013 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:05,014 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:05,036 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:05,037 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:05,038 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:05,038 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:05,039 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:05,039 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:05,040 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:05,040 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:05,041 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:05,041 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:05,041 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:05,042 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:05,042 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:05,043 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:05,043 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:05,045 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:05,045 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:05,067 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:05,070 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.159, 'ask': 4191.196, 'last': 0.0, 'time': 1760533084}
2025-10-15 12:58:05,072 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:05,073 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.25s
2025-10-15 12:58:05,106 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:05,822 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:05,823 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:05,824 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:05,827 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:05,834 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:05,835 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:05,836 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:05,837 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:05,838 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:05,839 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:05,839 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:05,840 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:05,840 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:05,841 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:05,842 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:05,842 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:05,843 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:05,844 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:05,845 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:06,346 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:06,348 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:06,348 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:06,662 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:58:06,664 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:58:06,850 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:06,852 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:06,852 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:06,853 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.19s
2025-10-15 12:58:06,854 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:06,854 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.626
2025-10-15 12:58:06,855 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.3
2025-10-15 12:58:06,865 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:06,872 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:06,943 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:58:06,967 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:06,983 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:06,997 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:07,000 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:07,000 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:07,003 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:07,004 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:07,004 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:07,007 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:07,007 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:07,008 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:07,008 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:07,008 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:07,015 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:07,038 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:07,039 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:07,043 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:07,045 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:07,045 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:07,046 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:07,069 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:07,073 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:07,075 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:07,077 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:07,082 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:07,101 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:07,102 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:07,103 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:07,103 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:07,106 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:07,130 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:07,132 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:07,135 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:07,136 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:07,136 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:07,138 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:07,138 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:07,162 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:07,164 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:07,164 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:07,170 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:07,171 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:07,172 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:07,175 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:07,196 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:07,197 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:07,198 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:06+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:07,198 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:06+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:07,199 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:06+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:07,199 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:06+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:07,200 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:06+07:00
2025-10-15 12:58:07,200 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:06+07:00
2025-10-15 12:58:07,201 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:06+07:00 trong DST: True
2025-10-15 12:58:07,201 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:06+07:00 trong DST: True
2025-10-15 12:58:07,202 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:07,223 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:07,225 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:07,226 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:07,226 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:07,227 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:07,229 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:07,231 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:07,233 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:07,240 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:07,261 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:07,289 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:07,289 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:07,290 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:07,291 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:07,292 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:07,292 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:07,292 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:07,295 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:07,296 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:07,296 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:07,297 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:07,314 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:07,318 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:07,320 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:07,320 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:07,321 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:07,322 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:07,322 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:07,323 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:07,324 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:07,325 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:07,326 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:07,326 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:07,327 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:07,348 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:07,350 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:07,351 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:07,351 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:07,352 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:07,352 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:07,353 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:07,353 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:07,353 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:07,354 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:07,354 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:07,355 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:07,357 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:07,357 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:07,358 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:07,376 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:07,377 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:07,378 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:07,378 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:07,379 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:07,380 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:07,380 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:07,380 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:07,381 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:07,382 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:07,382 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:07,383 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:07,383 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:07,384 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:07,384 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:07,384 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.3, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:07,385 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:07,385 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:07,386 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.626, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:07,388 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:07,389 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:07,406 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:07,413 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:07,414 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:07,415 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:07,415 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:07,416 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11820.999999999913
2025-10-15 12:58:07,416 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11494.99999999989
2025-10-15 12:58:07,417 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101022.0000000004
2025-10-15 12:58:07,417 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100696.00000000036
2025-10-15 12:58:07,418 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5515.000000000327
2025-10-15 12:58:07,418 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5189.000000000306
2025-10-15 12:58:07,419 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29663.99999999976
2025-10-15 12:58:07,420 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:07,420 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29989.99999999978
2025-10-15 12:58:07,421 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11494.99999999989}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100696.00000000036}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5189.000000000306}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29663.99999999976}]
2025-10-15 12:58:07,421 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:07,422 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:07,443 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11820.999999999913}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101022.0000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5515.000000000327}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29989.99999999978}]
2025-10-15 12:58:07,444 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:07,445 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:07,446 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:07,446 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:07,447 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:07,447 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:07,448 - APP.services.mt5_service - DEBUG - Position in day range: 0.5856366459627385
2025-10-15 12:58:07,448 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:07,448 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:06+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:07,449 - APP.services.mt5_service - DEBUG - Position in day range: 0.5805745341614958
2025-10-15 12:58:07,450 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:06+07:00
2025-10-15 12:58:07,450 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:06+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:07,451 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:06+07:00 trong DST: True
2025-10-15 12:58:07,451 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:06+07:00
2025-10-15 12:58:07,452 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:07,463 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:06+07:00 trong DST: True
2025-10-15 12:58:07,473 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:07,475 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:07,476 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:07,476 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:07,477 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,477 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:07,478 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,478 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,478 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6200', 'price': 4191.62, 'distance_pips': 0.6}, {'level': '6225', 'price': 4191.622, 'distance_pips': 0.35}, {'level': '6250', 'price': 4191.625, 'distance_pips': 0.1}, {'level': '6275', 'price': 4191.627, 'distance_pips': 0.15}]
2025-10-15 12:58:07,479 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,479 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884125193}
2025-10-15 12:58:07,480 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3000', 'price': 4191.3, 'distance_pips': 0.0}, {'level': '3025', 'price': 4191.302, 'distance_pips': 0.25}, {'level': '3050', 'price': 4191.305, 'distance_pips': 0.5}, {'level': '3075', 'price': 4191.307, 'distance_pips': 0.75}]
2025-10-15 12:58:07,481 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,482 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,483 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:07,483 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.626
2025-10-15 12:58:07,503 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:07,504 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:07,505 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,506 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:07,506 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,507 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:07,507 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:07,508 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:07,509 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.3
2025-10-15 12:58:07,509 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:07,510 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:07,510 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.626
2025-10-15 12:58:07,511 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:07,512 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:07,512 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:07,513 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:07,513 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:07,514 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:07,515 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:07,515 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:07,531 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.3
2025-10-15 12:58:07,538 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:07,538 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:07,539 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.626
2025-10-15 12:58:07,540 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:07,541 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:07,541 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:07,542 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:07,543 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:07,544 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:07,544 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:07,545 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.3
2025-10-15 12:58:07,562 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:07,567 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:07,568 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:07,569 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.626
2025-10-15 12:58:07,570 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:07,571 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:07,571 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:07,572 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:07,572 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:07,573 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:07,575 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:07,575 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:07,576 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.3
2025-10-15 12:58:07,577 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,590 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:07,599 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:07,600 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,601 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:07,602 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:07,602 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:07,603 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:07,603 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,604 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:07,604 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,604 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:07,605 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:07,606 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:07,607 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:07,607 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:07,607 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:07,608 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:07,608 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:07,609 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:07,609 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:07,627 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:07,632 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:07,633 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:07,634 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:07,634 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:07,634 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:07,635 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:07,636 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:07,636 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:07,637 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:07,637 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:07,638 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:07,638 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,638 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:07,639 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,639 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:07,640 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:07,640 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:07,653 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:07,664 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:07,664 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:07,665 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:07,665 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:07,667 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:07,667 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:07,668 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:07,668 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:07,670 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,670 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:07,671 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,683 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:07,689 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:07,691 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:07,692 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:07,694 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:07,695 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:07,695 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:07,696 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,696 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.626, 'ask': 4191.663, 'last': 0.0, 'time': 1760533086}
2025-10-15 12:58:07,697 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:07,697 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:07,698 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,699 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:07,699 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.87s
2025-10-15 12:58:07,700 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:07,700 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.3, 'ask': 4191.337, 'last': 0.0, 'time': 1760533086}
2025-10-15 12:58:07,707 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:07,720 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:07,723 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:07,723 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:07,724 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,724 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,725 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:07,725 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:07,725 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,726 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,726 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,727 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,727 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,727 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,728 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,728 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,729 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:07,729 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:07,730 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:07,730 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:07,731 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,732 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,732 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:07,733 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:07,733 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:07,734 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:07,755 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11494.99999999989}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100696.00000000036}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5189.000000000306}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29663.99999999976}]
2025-10-15 12:58:07,757 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:06+07:00
2025-10-15 12:58:07,758 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:07,759 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:07,761 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:07,763 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.94s
2025-10-15 12:58:07,792 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:07,940 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:07,941 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:07,941 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:07,943 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:07,943 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:07,947 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:07,948 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:07,950 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:07,952 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:08,126 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:08,126 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:08,160 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:08,161 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.03s
2025-10-15 12:58:08,161 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:08,162 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:08,163 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:08,163 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:08,164 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:08,165 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:08,165 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:08,166 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:08,167 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:08,169 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:08,170 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:08,171 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:08,181 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:08,198 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:08,227 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:08,698 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:08,700 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:08,700 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:09,202 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:09,203 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:09,204 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:09,204 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:09,205 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.362
2025-10-15 12:58:09,205 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.666
2025-10-15 12:58:09,210 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 354, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:09,217 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 354, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:09,320 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:09,328 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:09,329 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:09,330 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:09,330 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:09,331 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:09,333 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:09,336 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:09,336 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:09,336 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:09,337 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:09,337 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:09,338 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:09,338 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:09,343 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:09,346 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:09,347 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:09,347 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:09,348 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:09,348 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:09,349 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:09,349 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:09,351 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:09,353 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:09,355 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:09,355 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:09,357 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:09,358 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:09,358 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:09,359 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:09,364 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:09,383 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:09,383 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:09,384 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:09,384 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:09,385 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:09,385 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:09,386 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:09,390 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:09,416 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:09,416 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:09,417 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:09,418 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:09,418 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:09,419 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:09,419 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:09,420 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:09+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:09,420 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:08+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:09,421 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:09+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:09,442 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:08+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:09,443 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:09+07:00
2025-10-15 12:58:09,444 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:08+07:00
2025-10-15 12:58:09,444 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:09+07:00 trong DST: True
2025-10-15 12:58:09,444 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:08+07:00 trong DST: True
2025-10-15 12:58:09,445 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:09,445 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:09,445 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:09,446 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:09,446 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:09,447 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:09,448 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:09,450 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:09,452 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:09,473 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:09,477 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:09,492 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:09,496 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:09,508 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:09,508 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:09,509 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:09,509 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:09,510 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:09,510 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:09,511 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:09,512 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:09,513 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:09,514 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:09,514 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:09,515 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:09,515 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:09,516 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:09,536 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:09,538 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:09,539 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:09,539 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:09,540 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:09,541 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:09,541 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:09,542 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:09,542 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:09,543 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:09,544 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:09,545 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:09,545 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:09,546 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:09,570 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:09,571 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:09,571 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:09,572 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:09,572 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:09,573 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:09,574 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:09,575 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:09,575 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:09,576 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:09,578 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:09,601 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:09,602 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:09,602 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:09,603 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:09,604 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:09,604 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:09,605 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:09,608 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:09,609 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:09,630 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:09,631 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:09,632 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:09,633 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.666, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:09,633 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:09,634 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:09,634 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:09,634 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:09,635 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.362, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:09,635 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:09,636 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:09,636 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:09,637 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:09,638 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11860.999999999876
2025-10-15 12:58:09,638 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:09,639 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101062.00000000035
2025-10-15 12:58:09,640 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:09,663 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11556.999999999789
2025-10-15 12:58:09,664 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5555.000000000291
2025-10-15 12:58:09,664 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100758.00000000026
2025-10-15 12:58:09,665 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30029.999999999745
2025-10-15 12:58:09,665 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5251.000000000204
2025-10-15 12:58:09,666 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:09,666 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29725.999999999658
2025-10-15 12:58:09,666 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11860.999999999876}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101062.00000000035}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5555.000000000291}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30029.999999999745}]
2025-10-15 12:58:09,667 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:09,667 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:09,669 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11556.999999999789}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100758.00000000026}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5251.000000000204}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29725.999999999658}]
2025-10-15 12:58:09,670 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:09,670 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:09,671 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:09,689 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:09,690 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:09,691 - APP.services.mt5_service - DEBUG - Position in day range: 0.5862577639751603
2025-10-15 12:58:09,691 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:09,692 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:09+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:09,692 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:09,692 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:09+07:00
2025-10-15 12:58:09,693 - APP.services.mt5_service - DEBUG - Position in day range: 0.5815372670807489
2025-10-15 12:58:09,693 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:09+07:00 trong DST: True
2025-10-15 12:58:09,694 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:08+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:09,694 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:09,694 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:08+07:00
2025-10-15 12:58:09,695 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:09,695 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:08+07:00 trong DST: True
2025-10-15 12:58:09,696 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:09,696 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:09,697 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:09,697 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:09,698 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:09,698 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:09,700 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6600', 'price': 4191.66, 'distance_pips': 0.6}, {'level': '6625', 'price': 4191.662, 'distance_pips': 0.35}, {'level': '6650', 'price': 4191.665, 'distance_pips': 0.1}, {'level': '6675', 'price': 4191.667, 'distance_pips': 0.15}]
2025-10-15 12:58:09,700 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:09,701 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:09,701 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:09,702 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:09,702 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3600', 'price': 4191.36, 'distance_pips': 0.2}, {'level': '3625', 'price': 4191.362, 'distance_pips': 0.05}, {'level': '3650', 'price': 4191.365, 'distance_pips': 0.3}, {'level': '3675', 'price': 4191.367, 'distance_pips': 0.55}]
2025-10-15 12:58:09,726 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:09,727 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:09,727 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:09,728 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:09,728 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.666
2025-10-15 12:58:09,729 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:09,730 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:09,730 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:09,732 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:09,733 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.362
2025-10-15 12:58:09,734 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:09,752 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:09,757 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:09,758 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:09,759 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:09,760 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:09,760 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:09,762 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.666
2025-10-15 12:58:09,763 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:09,764 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.362
2025-10-15 12:58:09,765 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:09,774 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:09,787 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:09,789 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:09,790 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:09,791 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:09,792 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:09,792 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:09,793 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:09,795 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.666
2025-10-15 12:58:09,795 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:09,796 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:09,806 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.362
2025-10-15 12:58:09,819 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:09,821 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:09,823 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:09,824 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:09,826 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:09,826 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:09,839 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:09,849 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.666
2025-10-15 12:58:09,850 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:09,851 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:09,851 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:09,852 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:09,853 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.362
2025-10-15 12:58:09,854 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:09,855 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:09,859 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:09,880 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:09,883 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:09,884 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:09,885 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:09,886 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:09,886 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:09,887 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:09,887 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:09,887 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:09,888 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:09,888 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:09,890 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:09,891 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:09,891 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:09,892 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:09,911 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:09,912 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:09,913 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:09,914 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:09,914 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:09,915 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:09,915 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:09,916 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:09,916 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:09,917 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:09,917 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:09,918 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:09,918 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:09,920 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:09,920 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:09,921 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:09,921 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:09,922 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:09,922 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:09,932 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:09,944 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:09,945 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:09,946 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:09,947 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:09,947 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:09,948 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:09,948 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:09,949 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:09,951 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:09,952 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:09,952 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:09,953 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:09,976 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:09,976 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:09,977 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:09,979 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:09,980 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:09,980 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:09,981 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:09,982 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:09,983 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.666, 'ask': 4191.703, 'last': 0.0, 'time': 1760533089}
2025-10-15 12:58:09,984 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:10,003 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.05s
2025-10-15 12:58:10,010 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:10,010 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:10,011 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:10,013 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:10,014 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:10,031 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:10,032 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.362, 'ask': 4191.399, 'last': 0.0, 'time': 1760533088}
2025-10-15 12:58:10,032 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:10,035 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:10,035 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:10,036 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:10,242 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:10,291 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:10,304 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:10,307 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:10,308 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 354, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:10,309 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 439, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:10,321 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:10,391 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:10,422 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:10,424 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:10,425 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:10,427 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:10,430 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:10,431 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:10,431 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:10,433 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:10,433 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:10,433 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:10,435 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:10,437 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:10,438 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:10,439 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:10,440 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:10,440 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:10,454 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11556.999999999789}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100758.00000000026}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5251.000000000204}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29725.999999999658}]
2025-10-15 12:58:10,504 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:08+07:00
2025-10-15 12:58:10,507 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:10,509 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:10,512 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:10,573 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.62s
2025-10-15 12:58:10,704 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:10,711 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:10,718 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:10,727 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:10,729 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:10,977 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:10,978 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:10,980 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:10,983 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:10,992 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:10,993 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:10,993 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:10,994 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:10,995 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:10,995 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:10,996 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:10,996 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:10,997 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:10,997 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:10,998 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:10,998 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:10,999 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:10,999 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:11,000 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:11,501 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:11,503 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:11,503 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:12,005 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:12,006 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:12,007 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:12,007 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:12,008 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.295
2025-10-15 12:58:12,008 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.413
2025-10-15 12:58:12,021 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:12,062 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 353, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:12,187 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:12,199 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:12,199 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:12,202 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:12,202 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:12,203 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:12,207 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:12,210 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:12,211 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:12,212 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:12,212 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:12,212 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:12,213 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:12,214 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:12,217 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:12,222 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:12,222 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:12,223 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:12,223 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:12,224 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:12,224 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:12,225 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:12,227 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:12,229 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:12,230 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:12,233 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:12,234 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:12,256 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:12,258 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:12,261 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:12,264 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:12,293 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:12,321 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:12,322 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:12,322 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:12,323 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:12,323 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:12,324 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:12,342 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:12,354 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:12,355 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:12,357 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:12,358 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:12,359 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:12,379 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:11+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:12,382 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:12,383 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:11+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:12,383 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:12,384 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:11+07:00
2025-10-15 12:58:12,385 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:11+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:12,385 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:11+07:00 trong DST: True
2025-10-15 12:58:12,386 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:11+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:12,386 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:12,387 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:11+07:00
2025-10-15 12:58:12,387 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:12,390 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:11+07:00 trong DST: True
2025-10-15 12:58:12,413 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:12,414 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:12,415 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:12,416 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:12,417 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:12,418 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:12,448 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:12,468 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:12,496 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:12,508 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:12,515 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:12,537 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:12,539 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:12,540 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:12,540 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:12,541 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:12,541 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:12,541 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:12,542 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:12,542 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:12,543 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:12,546 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:12,547 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:12,571 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:12,571 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:12,572 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:12,572 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:12,572 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:12,573 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:12,573 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:12,574 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:12,574 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:12,600 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:12,601 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:12,602 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:12,602 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:12,602 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:12,603 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:12,603 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:12,604 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:12,604 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:12,604 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:12,605 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:12,606 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:12,633 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:12,634 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:12,634 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:12,635 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:12,635 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:12,636 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:12,675 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:12,678 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:12,678 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:12,678 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:12,679 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:12,680 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:12,680 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:12,681 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:12,681 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:12,682 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:12,682 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.413, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:12,683 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:12,684 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:12,684 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:12,685 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:12,685 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:12,685 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:12,686 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:12,686 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:12,687 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.295, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:12,687 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11607.999999999265
2025-10-15 12:58:12,688 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:12,689 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:12,689 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100808.99999999974
2025-10-15 12:58:12,691 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:12,692 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5301.99999999968
2025-10-15 12:58:12,692 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:12,692 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29776.999999999134
2025-10-15 12:58:12,693 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11489.999999999782
2025-10-15 12:58:12,725 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:12,726 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 100691.00000000026
2025-10-15 12:58:12,727 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11607.999999999265}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100808.99999999974}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5301.99999999968}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29776.999999999134}]
2025-10-15 12:58:12,727 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5184.000000000196
2025-10-15 12:58:12,728 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:12,728 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 29658.99999999965
2025-10-15 12:58:12,729 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:12,729 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:12,755 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:12,756 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11489.999999999782}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100691.00000000026}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5184.000000000196}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29658.99999999965}]
2025-10-15 12:58:12,756 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:12,757 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:12,757 - APP.services.mt5_service - DEBUG - Position in day range: 0.5823291925465793
2025-10-15 12:58:12,758 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:12,759 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:11+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:12,759 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:12,760 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:11+07:00
2025-10-15 12:58:12,761 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:12,761 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:11+07:00 trong DST: True
2025-10-15 12:58:12,764 - APP.services.mt5_service - DEBUG - Position in day range: 0.5804968944099413
2025-10-15 12:58:12,764 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:11+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:12,765 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:12,765 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:11+07:00
2025-10-15 12:58:12,766 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:12,783 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:11+07:00 trong DST: True
2025-10-15 12:58:12,784 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:12,785 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:12,786 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:12,786 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:12,787 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:12,787 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:12,788 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:12,789 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4100', 'price': 4191.41, 'distance_pips': 0.3}, {'level': '4125', 'price': 4191.412, 'distance_pips': 0.05}, {'level': '4150', 'price': 4191.415, 'distance_pips': 0.2}, {'level': '4175', 'price': 4191.417, 'distance_pips': 0.45}]
2025-10-15 12:58:12,789 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:12,790 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:12,790 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2900', 'price': 4191.29, 'distance_pips': 0.5}, {'level': '2925', 'price': 4191.292, 'distance_pips': 0.25}, {'level': '2950', 'price': 4191.295, 'distance_pips': 0.0}, {'level': '2975', 'price': 4191.297, 'distance_pips': 0.25}]
2025-10-15 12:58:12,791 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:12,792 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:12,792 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:12,793 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:12,823 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:12,824 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:12,826 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.413
2025-10-15 12:58:12,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:12,849 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.295
2025-10-15 12:58:12,850 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:12,851 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:12,851 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:12,852 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:12,852 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:12,853 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:12,854 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:12,854 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:12,855 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:12,857 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:12,858 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.295
2025-10-15 12:58:12,859 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.413
2025-10-15 12:58:12,882 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:12,883 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:12,883 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:12,883 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:12,884 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:12,885 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:12,885 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:12,886 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:12,886 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:12,887 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:12,889 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.295
2025-10-15 12:58:12,890 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.413
2025-10-15 12:58:12,902 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:12,914 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:12,915 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:12,915 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:12,916 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:12,917 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:12,917 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:12,920 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:12,921 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:12,921 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:12,946 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.295
2025-10-15 12:58:12,947 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.413
2025-10-15 12:58:12,948 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:12,948 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:12,949 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:12,952 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:12,959 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:12,977 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:12,978 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:12,979 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:12,979 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:12,980 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:12,980 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:12,981 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:12,984 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:12,985 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:13,006 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:13,007 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:13,007 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:13,008 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:13,008 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:13,009 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:13,009 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:13,009 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:13,010 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:13,010 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:13,011 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:13,012 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:13,013 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:13,013 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:13,014 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:13,014 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:13,014 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:13,015 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:13,023 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:13,039 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:13,039 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:13,040 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:13,040 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:13,041 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,041 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:13,041 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:13,042 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:13,042 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:13,042 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:13,043 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:13,045 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:13,046 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:13,046 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:13,070 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:13,071 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:13,072 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:13,072 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:13,073 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,073 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:13,074 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:13,076 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,076 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:13,076 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:13,077 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:13,077 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.295, 'ask': 4191.332, 'last': 0.0, 'time': 1760533091}
2025-10-15 12:58:13,078 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:13,084 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:13,101 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:13,103 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:13,104 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:13,104 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:13,104 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,105 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:13,105 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:13,109 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:13,128 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 353, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:13,129 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:13,129 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:13,130 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:13,130 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,132 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:13,132 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:13,132 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:13,133 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,133 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,134 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:13,134 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.413, 'ask': 4191.45, 'last': 0.0, 'time': 1760533091}
2025-10-15 12:58:13,135 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,135 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:13,135 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:13,136 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.15s
2025-10-15 12:58:13,136 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,138 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:13,139 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:13,140 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:13,140 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:13,140 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:13,141 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,161 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:13,162 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:13,162 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:13,163 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:13,164 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:13,164 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11489.999999999782}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 100691.00000000026}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5184.000000000196}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 29658.99999999965}]
2025-10-15 12:58:13,165 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:11+07:00
2025-10-15 12:58:13,165 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:13,166 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:13,167 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:13,170 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.19s
2025-10-15 12:58:13,192 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:13,309 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:13,310 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:13,311 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:13,311 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:13,312 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:13,317 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:13,318 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:13,478 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.16s
2025-10-15 12:58:13,509 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:13,984 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:13,985 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:13,986 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:13,989 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:13,997 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:13,998 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:13,998 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:13,999 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:14,000 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:14,001 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:14,002 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:14,002 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:14,002 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:14,003 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:14,004 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:14,004 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:14,005 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:14,005 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:14,006 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:14,507 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:14,509 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:14,509 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:14,662 - APP.services.gemini_service - INFO - Lần thử 1: Kết nối stream tới Gemini API thành công.
2025-10-15 12:58:14,820 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:15,011 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:15,013 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:15,014 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:15,014 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:15,015 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.767
2025-10-15 12:58:15,015 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.8
2025-10-15 12:58:15,021 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:15,025 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 352, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:15,031 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:15,115 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:15,133 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:15,133 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:15,134 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:15,135 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:15,138 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:15,141 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:15,141 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:15,144 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:15,144 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:15,146 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:15,147 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:15,147 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:15,151 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:15,152 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:15,153 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:15,156 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:15,157 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:15,157 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:15,158 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:15,158 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:15,161 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:15,161 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:15,162 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:15,164 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:15,164 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:15,165 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:15,165 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:15,166 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:15,168 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:15,168 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:15,170 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:15,180 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:15,196 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:15,198 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:15,199 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:15,200 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:15,200 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:15,207 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:15,230 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:15,231 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:15,233 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:15,234 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:15,234 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:15,237 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:15,239 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:15,257 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:15,258 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:14+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:15,259 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:14+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:15,260 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:14+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:15,260 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:14+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:15,260 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:14+07:00
2025-10-15 12:58:15,261 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:14+07:00
2025-10-15 12:58:15,261 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:14+07:00 trong DST: True
2025-10-15 12:58:15,290 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:14+07:00 trong DST: True
2025-10-15 12:58:15,292 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:15,315 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:15,316 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:15,316 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:15,317 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:15,317 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:15,318 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:15,320 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:15,320 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:15,321 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:15,327 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:15,350 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:15,353 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:15,354 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:15,355 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:15,355 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:15,356 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:15,356 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:15,357 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:15,357 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:15,358 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:15,359 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:15,359 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:15,360 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:15,379 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:15,380 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:15,381 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:15,382 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:15,382 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:15,382 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:15,383 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:15,384 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:15,384 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:15,385 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:15,385 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:15,386 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:15,386 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:15,387 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:15,387 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:15,388 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:15,389 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:15,390 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:15,391 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:15,414 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:15,414 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:15,415 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:15,416 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:15,416 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:15,417 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:15,418 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:15,418 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:15,419 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:15,420 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:15,421 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:15,421 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:15,422 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:15,442 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:15,443 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:15,444 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:15,444 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:15,445 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:15,446 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:15,446 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:15,446 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:15,447 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:15,447 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:15,448 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.8, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:15,448 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.767, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:15,449 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:15,449 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:15,450 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:15,451 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:15,451 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:15,452 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:15,452 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:15,475 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:15,476 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11994.99999999989
2025-10-15 12:58:15,476 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 11961.999999999534
2025-10-15 12:58:15,477 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101196.00000000036
2025-10-15 12:58:15,477 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101163.00000000001
2025-10-15 12:58:15,478 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5689.000000000306
2025-10-15 12:58:15,478 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5655.999999999949
2025-10-15 12:58:15,479 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30163.99999999976
2025-10-15 12:58:15,479 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30130.999999999403
2025-10-15 12:58:15,479 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:15,480 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:15,482 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11994.99999999989}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101196.00000000036}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5689.000000000306}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30163.99999999976}]
2025-10-15 12:58:15,483 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11961.999999999534}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101163.00000000001}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5655.999999999949}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30130.999999999403}]
2025-10-15 12:58:15,484 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:15,492 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:15,502 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:15,503 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:15,504 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:15,504 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:15,505 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:15,505 - APP.services.mt5_service - DEBUG - Position in day range: 0.5878260869565215
2025-10-15 12:58:15,505 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:15,506 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:14+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:15,506 - APP.services.mt5_service - DEBUG - Position in day range: 0.5883385093167754
2025-10-15 12:58:15,507 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:14+07:00
2025-10-15 12:58:15,507 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:14+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:15,508 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:14+07:00 trong DST: True
2025-10-15 12:58:15,508 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:14+07:00
2025-10-15 12:58:15,508 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:15,509 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:14+07:00 trong DST: True
2025-10-15 12:58:15,509 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:15,509 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:15,510 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:15,510 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:15,511 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,511 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:15,512 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,513 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,513 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7600', 'price': 4191.76, 'distance_pips': 0.7}, {'level': '7625', 'price': 4191.762, 'distance_pips': 0.45}, {'level': '7650', 'price': 4191.765, 'distance_pips': 0.2}, {'level': '7675', 'price': 4191.767, 'distance_pips': 0.05}]
2025-10-15 12:58:15,514 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,514 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:15,515 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8000', 'price': 4191.8, 'distance_pips': 0.0}, {'level': '8025', 'price': 4191.802, 'distance_pips': 0.25}, {'level': '8050', 'price': 4191.805, 'distance_pips': 0.5}, {'level': '8075', 'price': 4191.807, 'distance_pips': 0.75}]
2025-10-15 12:58:15,515 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,516 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:15,518 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,536 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:15,537 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,538 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.767
2025-10-15 12:58:15,538 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,539 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:15,539 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:15,540 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:15,540 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.8
2025-10-15 12:58:15,541 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:15,542 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:15,542 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:15,543 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:15,544 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:15,545 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:15,546 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.767
2025-10-15 12:58:15,547 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:15,567 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:15,568 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:15,569 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:15,569 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.8
2025-10-15 12:58:15,570 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:15,570 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:15,571 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:15,571 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:15,572 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:15,572 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:15,573 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.767
2025-10-15 12:58:15,574 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:15,574 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:15,575 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:15,576 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:15,577 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.8
2025-10-15 12:58:15,578 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:15,603 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:15,605 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:15,606 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:15,607 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:15,608 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:15,610 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.767
2025-10-15 12:58:15,631 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:15,632 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:15,632 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:15,633 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:15,633 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.8
2025-10-15 12:58:15,634 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:15,635 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:15,635 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:15,636 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:15,637 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,639 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:15,640 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,641 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:15,663 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:15,664 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,665 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:15,665 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,666 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:15,666 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:15,667 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:15,667 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:15,668 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:15,668 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:15,669 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:15,670 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:15,670 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:15,671 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:15,671 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:15,671 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:15,672 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:15,694 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:15,695 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:15,696 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:15,696 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:15,697 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:15,697 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:15,697 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:15,698 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:15,698 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:15,698 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:15,699 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,699 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:15,701 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,701 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:15,702 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:15,702 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:15,703 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:15,723 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:15,724 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:15,724 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:15,725 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:15,726 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:15,726 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:15,727 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:15,727 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:15,728 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,728 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,729 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:15,729 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,729 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:15,730 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.767, 'ask': 4191.804, 'last': 0.0, 'time': 1760533094}
2025-10-15 12:58:15,731 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:15,737 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:15,756 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:15,757 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:15,758 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:15,758 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:15,758 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:15,759 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,759 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:15,760 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,760 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:15,761 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 351, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:15,761 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:15,764 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:15,765 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,765 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,787 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:15,787 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:15,788 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,789 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:15,790 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,790 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:15,790 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,791 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,792 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,792 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.8, 'ask': 4191.837, 'last': 0.0, 'time': 1760533094}
2025-10-15 12:58:15,792 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,793 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:15,795 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,796 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.81s
2025-10-15 12:58:15,819 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:15,820 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:15,820 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:15,821 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:15,821 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,822 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,822 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:15,823 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:15,823 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:15,823 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:15,824 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 11961.999999999534}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101163.00000000001}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5655.999999999949}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30130.999999999403}]
2025-10-15 12:58:15,847 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:14+07:00
2025-10-15 12:58:15,847 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:15,848 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:15,849 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:15,851 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.87s
2025-10-15 12:58:15,907 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:16,030 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:16,031 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:16,032 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:16,033 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:16,034 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:16,038 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:16,039 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:16,040 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:16,042 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:16,197 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:16,204 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:16,265 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:16,266 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:16,267 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:16,268 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:16,269 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:16,270 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:16,271 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:16,271 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:16,273 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:16,274 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:16,275 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:16,276 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:16,276 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:16,276 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:16,277 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:16,413 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:16,624 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:16,778 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:16,780 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:16,780 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:16,941 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:17,062 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:17,282 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:17,284 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:17,284 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:17,285 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:17,285 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.981
2025-10-15 12:58:17,286 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.955
2025-10-15 12:58:17,290 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 349, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:17,296 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 349, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:17,379 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:17,403 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:17,433 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:17,483 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:17,484 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:17,500 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:17,502 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:17,503 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:17,506 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:17,507 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:17,507 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:17,508 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:17,508 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:17,509 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:17,515 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:17,524 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:17,540 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:17,591 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:17,591 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:17,602 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:17,604 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:17,605 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:17,608 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:17,610 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:17,611 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:17,614 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:17,614 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:17,616 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:17,616 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:17,617 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:17,617 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:17,618 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:17,621 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:17,623 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:17,663 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:17,664 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:17,665 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:17,701 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:17,756 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:17,756 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:17,757 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:17,757 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:17,758 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:17,761 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:17,763 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:17,764 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:17,765 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:16+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:17,765 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:17,766 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:16+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:17,789 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:17,791 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:16+07:00
2025-10-15 12:58:17,791 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:17+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:17,792 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:16+07:00 trong DST: True
2025-10-15 12:58:17,792 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:17+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:17,793 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:17,793 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:17+07:00
2025-10-15 12:58:17,796 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:17,796 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:17+07:00 trong DST: True
2025-10-15 12:58:17,796 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:17,797 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:17,801 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:17,820 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:17,822 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:17,822 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:17,827 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:17,829 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:17,851 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:17,853 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:17,853 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:17,857 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:17,859 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:17,859 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:17,880 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:17,880 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:17,881 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:17,882 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:17,882 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:17,883 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:17,883 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:17,884 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:17,884 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:17,884 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:17,885 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:17,885 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:17,886 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:17,887 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:17,887 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:17,888 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:17,889 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:17,889 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:17,890 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:17,911 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:17,912 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:17,913 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:17,913 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:17,913 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:17,914 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:17,914 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:17,915 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:17,915 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:17,916 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:17,916 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:17,917 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:17,917 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:17,918 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:17,918 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:17,920 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:17,921 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:17,922 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:17,930 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:17,945 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:17,946 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:17,946 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:17,947 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:17,947 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:17,948 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:17,948 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:17,949 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:17,950 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:17,952 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:17,952 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.981, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:17,952 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:17,953 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:17,974 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:17,975 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:17,976 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:17,977 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.955, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:17,977 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:17,977 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:17,978 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:17,978 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:17,980 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12175.999999999476
2025-10-15 12:58:17,980 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:17,983 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101376.99999999996
2025-10-15 12:58:17,984 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5869.999999999891
2025-10-15 12:58:18,006 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30344.999999999345
2025-10-15 12:58:18,007 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:18,007 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:18,008 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12149.999999999636
2025-10-15 12:58:18,008 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12175.999999999476}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101376.99999999996}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5869.999999999891}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30344.999999999345}]
2025-10-15 12:58:18,008 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101351.00000000012
2025-10-15 12:58:18,009 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:18,010 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5844.000000000051
2025-10-15 12:58:18,010 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:18,011 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30318.999999999505
2025-10-15 12:58:18,012 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:18,015 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:18,037 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:18,037 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12149.999999999636}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101351.00000000012}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5844.000000000051}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30318.999999999505}]
2025-10-15 12:58:18,038 - APP.services.mt5_service - DEBUG - Position in day range: 0.5911490683229802
2025-10-15 12:58:18,039 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:18,039 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:16+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:18,040 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:18,040 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:16+07:00
2025-10-15 12:58:18,041 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:18,041 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:16+07:00 trong DST: True
2025-10-15 12:58:18,041 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:18,043 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:18,044 - APP.services.mt5_service - DEBUG - Position in day range: 0.5907453416149081
2025-10-15 12:58:18,045 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:18,069 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:17+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:18,070 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:18,071 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:17+07:00
2025-10-15 12:58:18,071 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,072 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:17+07:00 trong DST: True
2025-10-15 12:58:18,072 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,073 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:18,073 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9800', 'price': 4191.98, 'distance_pips': 0.1}, {'level': '9825', 'price': 4191.983, 'distance_pips': 0.15}, {'level': '9850', 'price': 4191.985, 'distance_pips': 0.4}, {'level': '9875', 'price': 4191.988, 'distance_pips': 0.65}]
2025-10-15 12:58:18,074 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:18,075 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:18,104 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:18,105 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,105 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,106 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,108 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:18,108 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,118 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.981
2025-10-15 12:58:18,129 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9500', 'price': 4191.95, 'distance_pips': 0.5}, {'level': '9525', 'price': 4191.952, 'distance_pips': 0.25}, {'level': '9550', 'price': 4191.955, 'distance_pips': 0.0}, {'level': '9575', 'price': 4191.957, 'distance_pips': 0.25}]
2025-10-15 12:58:18,130 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:18,131 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:18,131 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:18,132 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,132 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:18,133 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,133 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:18,134 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:18,134 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:18,135 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.955
2025-10-15 12:58:18,136 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.981
2025-10-15 12:58:18,136 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:18,138 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:18,139 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:18,140 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:18,149 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:18,163 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:18,164 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:18,164 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:18,165 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:18,166 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:18,166 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:18,167 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.955
2025-10-15 12:58:18,168 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.981
2025-10-15 12:58:18,169 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:18,171 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:18,173 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:18,187 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:18,197 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:18,198 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:18,199 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:18,201 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:18,202 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.955
2025-10-15 12:58:18,228 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:18,229 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:18,230 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:18,230 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:18,231 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:18,232 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.981
2025-10-15 12:58:18,235 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:18,259 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:18,260 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:18,261 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.955
2025-10-15 12:58:18,262 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:18,263 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:18,265 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:18,266 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:18,353 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:18,355 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:18,355 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,356 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:18,356 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,359 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,381 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,381 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:18,382 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:18,383 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:18,383 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:18,384 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:18,384 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:18,384 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:18,385 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:18,385 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:18,386 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:18,386 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:18,386 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:18,387 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:18,387 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:18,389 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:18,389 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:18,389 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:18,390 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:18,390 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:18,415 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:18,416 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:18,417 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:18,417 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:18,418 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:18,418 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:18,419 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,419 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:18,421 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,422 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:18,423 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:18,445 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:18,446 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:18,447 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:18,447 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:18,448 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:18,448 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:18,448 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:18,449 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:18,450 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:18,451 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:18,452 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,453 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:18,453 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,453 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:18,475 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,477 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.981, 'ask': 4192.018, 'last': 0.0, 'time': 1760533096}
2025-10-15 12:58:18,480 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:18,480 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:18,481 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:18,482 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:18,484 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:18,484 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:18,485 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:18,487 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:18,508 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,508 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:18,509 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,510 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:18,511 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 349, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:18,511 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:18,511 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:18,515 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:18,516 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,549 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:18,550 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,550 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:18,551 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,551 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:18,552 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,552 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,553 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:18,555 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.955, 'ask': 4191.992, 'last': 0.0, 'time': 1760533097}
2025-10-15 12:58:18,555 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,556 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:18,557 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,557 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.52s
2025-10-15 12:58:18,558 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,559 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,561 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:18,563 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:18,564 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:18,564 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:18,565 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,565 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,566 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:18,567 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:18,568 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:18,569 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:18,570 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12175.999999999476}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101376.99999999996}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5869.999999999891}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30344.999999999345}]
2025-10-15 12:58:18,571 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:16+07:00
2025-10-15 12:58:18,571 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:18,573 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:18,574 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:18,602 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.05s
2025-10-15 12:58:18,604 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.56s
2025-10-15 12:58:18,653 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:18,778 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:18,778 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:18,779 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:18,780 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:18,781 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:18,782 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:18,786 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:19,064 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:19,065 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:19,067 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:19,069 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:19,077 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:19,077 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:19,078 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:19,079 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:19,085 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:19,100 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:19,101 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:19,102 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:19,103 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:19,103 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:19,104 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:19,105 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:19,106 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:19,141 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:19,144 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:19,146 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:19,264 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:19,519 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:19,645 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:19,647 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:19,648 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:19,671 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:20,042 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:20,149 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:20,151 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:20,152 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:20,153 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:20,153 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.005
2025-10-15 12:58:20,153 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.005
2025-10-15 12:58:20,161 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 349, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:20,166 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 349, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:20,282 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 437, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:20,283 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:20,293 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:20,304 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 437, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:20,315 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:20,316 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:20,319 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:20,320 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:20,321 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:20,324 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:20,324 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:20,325 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:20,352 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:20,354 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:20,355 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:20,364 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:20,389 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:20,412 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:20,414 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:20,415 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:20,415 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:20,416 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:20,416 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:20,418 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:20,424 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:20,441 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:20,442 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:20,442 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:20,443 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:20,443 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:20,444 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:20,447 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:20,449 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:20,450 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:20,450 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:20,451 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:20,451 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:20,451 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:20,452 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:20,458 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:20,472 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:20,475 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:20,476 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:20,476 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:20,477 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:20,477 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:20,478 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:19+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:20,478 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:20,479 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:19+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:20,479 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:19+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:20,479 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:19+07:00
2025-10-15 12:58:20,480 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:19+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:20,480 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:19+07:00 trong DST: True
2025-10-15 12:58:20,480 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:19+07:00
2025-10-15 12:58:20,481 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:20,482 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:19+07:00 trong DST: True
2025-10-15 12:58:20,483 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:20,483 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:20,484 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:20,490 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:20,494 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:20,496 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:20,498 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:20,501 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:20,509 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:20,510 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:20,510 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:20,515 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:20,515 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:20,525 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:20,527 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:20,528 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:20,531 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:20,535 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:20,536 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:20,539 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:20,540 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:20,540 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:20,541 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:20,541 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:20,541 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:20,542 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:20,542 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:20,542 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:20,543 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:20,543 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:20,544 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:20,545 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:20,545 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:20,546 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:20,546 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:20,547 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:20,550 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:20,555 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:20,557 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:20,571 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:20,573 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:20,574 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:20,574 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:20,575 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:20,575 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:20,576 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:20,577 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:20,577 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:20,578 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:20,581 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:20,595 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:20,597 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:20,600 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:20,602 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:20,605 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:20,605 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:20,606 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:20,644 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:20,645 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:20,646 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:20,646 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:20,647 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:20,647 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:20,648 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:20,648 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:20,649 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:20,649 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.005, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:20,650 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.005, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:20,650 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:20,651 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:20,652 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:20,652 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:20,652 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:20,653 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:20,653 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:20,653 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:20,654 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12199.999999999818
2025-10-15 12:58:20,654 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12199.999999999818
2025-10-15 12:58:20,654 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101401.00000000029
2025-10-15 12:58:20,655 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101401.00000000029
2025-10-15 12:58:20,655 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5894.000000000233
2025-10-15 12:58:20,656 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5894.000000000233
2025-10-15 12:58:20,656 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30368.999999999687
2025-10-15 12:58:20,657 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30368.999999999687
2025-10-15 12:58:20,657 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:20,657 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:20,658 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12199.999999999818}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101401.00000000029}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5894.000000000233}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30368.999999999687}]
2025-10-15 12:58:20,658 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12199.999999999818}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101401.00000000029}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5894.000000000233}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30368.999999999687}]
2025-10-15 12:58:20,659 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:20,659 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:20,660 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:20,661 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:20,661 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:20,662 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:20,663 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:20,663 - APP.services.mt5_service - DEBUG - Position in day range: 0.5915217391304389
2025-10-15 12:58:20,663 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:20,664 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:19+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:20,664 - APP.services.mt5_service - DEBUG - Position in day range: 0.5915217391304389
2025-10-15 12:58:20,664 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:19+07:00
2025-10-15 12:58:20,665 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:19+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:20,665 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:19+07:00 trong DST: True
2025-10-15 12:58:20,665 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:19+07:00
2025-10-15 12:58:20,666 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:20,666 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:19+07:00 trong DST: True
2025-10-15 12:58:20,667 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:20,667 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:20,668 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:20,668 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:20,668 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,669 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:20,669 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,670 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,670 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '00', 'price': 4192.0, 'distance_pips': 0.5}, {'level': '25', 'price': 4192.002, 'distance_pips': 0.25}, {'level': '50', 'price': 4192.005, 'distance_pips': 0.0}, {'level': '75', 'price': 4192.007, 'distance_pips': 0.25}]
2025-10-15 12:58:20,671 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,672 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:20,672 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '00', 'price': 4192.0, 'distance_pips': 0.5}, {'level': '25', 'price': 4192.002, 'distance_pips': 0.25}, {'level': '50', 'price': 4192.005, 'distance_pips': 0.0}, {'level': '75', 'price': 4192.007, 'distance_pips': 0.25}]
2025-10-15 12:58:20,673 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,675 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:20,680 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,683 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,683 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:20,690 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,692 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.005
2025-10-15 12:58:20,693 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:20,695 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:20,695 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.005
2025-10-15 12:58:20,696 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:20,696 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:20,697 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:20,697 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:20,698 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:20,699 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:20,699 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:20,700 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:20,701 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.005
2025-10-15 12:58:20,701 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:20,702 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:20,703 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.005
2025-10-15 12:58:20,703 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:20,704 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:20,707 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:20,717 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:20,726 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:20,728 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:20,729 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:20,729 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:20,730 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.005
2025-10-15 12:58:20,730 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:20,732 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:20,732 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:20,733 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.005
2025-10-15 12:58:20,734 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:20,741 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:20,745 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:20,748 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:20,750 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:20,754 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:20,757 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.005
2025-10-15 12:58:20,759 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:20,759 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:20,760 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:20,760 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:20,761 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.005
2025-10-15 12:58:20,762 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:20,762 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:20,765 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:20,766 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,772 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,773 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:20,775 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:20,778 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:20,780 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:20,783 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:20,789 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:20,789 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,790 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:20,791 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,791 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:20,791 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:20,792 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:20,793 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:20,794 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:20,794 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:20,794 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:20,798 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:20,811 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:20,813 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:20,818 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:20,824 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:20,827 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:20,828 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:20,841 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:20,855 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:20,871 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:20,882 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:20,886 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:20,887 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:20,888 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:20,890 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:20,920 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,922 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:20,922 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,923 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:20,924 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:20,924 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:20,925 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:20,925 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:20,926 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:20,926 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:20,928 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:20,928 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:20,929 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:20,929 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:20,930 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:20,930 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,931 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:20,931 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,933 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:20,933 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:20,934 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:20,935 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:20,935 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,935 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:20,936 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.005, 'ask': 4192.042, 'last': 0.0, 'time': 1760533099}
2025-10-15 12:58:20,936 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:20,937 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:20,938 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:20,938 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.87s
2025-10-15 12:58:20,940 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:20,940 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,941 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:20,941 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:20,942 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.005, 'ask': 4192.042, 'last': 0.0, 'time': 1760533099}
2025-10-15 12:58:20,945 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:20,945 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:20,946 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:20,946 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:20,947 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,948 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,948 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 349, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:20,948 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 437, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:20,949 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,949 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,949 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,950 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,954 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,978 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,979 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:20,980 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:20,981 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:20,981 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:20,988 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:20,992 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:20,997 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:21,000 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:21,002 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:21,004 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:21,006 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:21,007 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:21,008 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12199.999999999818}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101401.00000000029}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5894.000000000233}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30368.999999999687}]
2025-10-15 12:58:21,008 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:19+07:00
2025-10-15 12:58:21,009 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:21,010 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:21,011 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:21,015 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.95s
2025-10-15 12:58:21,035 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:21,180 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:21,181 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:21,181 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:21,182 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:21,183 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:21,186 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:21,187 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:21,189 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:21,191 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:21,339 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:21,417 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:21,418 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:21,418 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:21,419 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:21,423 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:21,425 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:21,426 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:21,426 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:21,427 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:21,428 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:21,429 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:21,431 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:21,432 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:21,432 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:21,433 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:21,666 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:58:21,666 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 12:58:21,777 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:21,935 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:21,937 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:21,937 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:22,023 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:22,439 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:22,440 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:22,443 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.78s
2025-10-15 12:58:22,443 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:22,444 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:22,445 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.372
2025-10-15 12:58:22,445 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.973
2025-10-15 12:58:22,450 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 347, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:22,460 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 347, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:22,479 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:22,576 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 437, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:22,592 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 437, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:22,593 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:22,593 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:22,594 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:22,595 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:22,597 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:22,600 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:22,601 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:22,601 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:22,602 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:22,602 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:22,603 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:22,603 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:22,609 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:22,624 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 12:58:22,632 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:22,633 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:22,634 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:22,635 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:22,635 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:22,636 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:22,636 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:22,639 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:22,671 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:22,673 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:22,674 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:22,675 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:22,675 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:22,676 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:22,676 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:22,678 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:22,681 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:22,682 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:22,682 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:22,682 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:22,683 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:22,683 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:22,684 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:22,687 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:22,690 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:22,691 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:22,691 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:22,692 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:22,692 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:22,692 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:21+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:22,693 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:22,693 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:21+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:22,694 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:22,694 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:21+07:00
2025-10-15 12:58:22,694 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:22+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:22,695 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:21+07:00 trong DST: True
2025-10-15 12:58:22,695 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:22+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:22,696 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:22,697 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:22+07:00
2025-10-15 12:58:22,697 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:22,698 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:22+07:00 trong DST: True
2025-10-15 12:58:22,698 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:22,698 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:22,700 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:22,700 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:22,701 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:22,703 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:22,711 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:22,727 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:22,727 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:22,728 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:22,728 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:22,733 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:22,734 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:22,734 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:22,735 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:22,735 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:22,755 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:22,756 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:22,758 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:22,758 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:22,759 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:22,759 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:22,760 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:22,760 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:22,761 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:22,762 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:22,762 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:22,763 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:22,789 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:22,790 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:22,790 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:22,791 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:22,791 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:22,791 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:22,792 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:22,792 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:22,793 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:22,795 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:22,797 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:22,820 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:22,821 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:22,821 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:22,822 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:22,822 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:22,823 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:22,823 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:22,824 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:22,826 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:22,853 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:22,854 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:22,854 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:22,855 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:22,856 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:22,856 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:22,859 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:22,860 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:22,914 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:22,916 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:22,916 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:22,917 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:22,918 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:22,918 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:22,919 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:22,946 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:22,947 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:22,948 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.372, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:22,948 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.973, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:22,949 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:22,949 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:22,950 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:22,950 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:22,950 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:22,978 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:22,978 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:22,979 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:22,980 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12567.000000000007
2025-10-15 12:58:22,980 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12167.999999999665
2025-10-15 12:58:22,981 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101768.00000000048
2025-10-15 12:58:22,982 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101369.00000000015
2025-10-15 12:58:22,983 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 6261.000000000422
2025-10-15 12:58:22,983 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5862.00000000008
2025-10-15 12:58:22,984 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30735.999999999876
2025-10-15 12:58:22,984 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30336.999999999534
2025-10-15 12:58:23,004 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:23,004 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:23,005 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12567.000000000007}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101768.00000000048}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6261.000000000422}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30735.999999999876}]
2025-10-15 12:58:23,006 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12167.999999999665}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101369.00000000015}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5862.00000000008}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30336.999999999534}]
2025-10-15 12:58:23,006 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:23,006 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:23,007 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:23,008 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:23,008 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:23,009 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:23,009 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:23,010 - APP.services.mt5_service - DEBUG - Position in day range: 0.597220496894417
2025-10-15 12:58:23,010 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:23,011 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:21+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:23,011 - APP.services.mt5_service - DEBUG - Position in day range: 0.5910248447204987
2025-10-15 12:58:23,014 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:21+07:00
2025-10-15 12:58:23,014 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:22+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:23,015 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:21+07:00 trong DST: True
2025-10-15 12:58:23,037 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:22+07:00
2025-10-15 12:58:23,038 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:23,039 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:22+07:00 trong DST: True
2025-10-15 12:58:23,039 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:23,039 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:23,040 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:23,040 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:23,041 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,041 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:23,042 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,042 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,042 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3700', 'price': 4192.37, 'distance_pips': 0.2}, {'level': '3725', 'price': 4192.372, 'distance_pips': 0.05}, {'level': '3750', 'price': 4192.375, 'distance_pips': 0.3}, {'level': '3775', 'price': 4192.377, 'distance_pips': 0.55}]
2025-10-15 12:58:23,043 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,043 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884125193}
2025-10-15 12:58:23,044 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9700', 'price': 4191.97, 'distance_pips': 0.3}, {'level': '9725', 'price': 4191.972, 'distance_pips': 0.05}, {'level': '9750', 'price': 4191.975, 'distance_pips': 0.2}, {'level': '9775', 'price': 4191.977, 'distance_pips': 0.45}]
2025-10-15 12:58:23,046 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,047 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:23,047 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,055 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,068 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:23,069 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,070 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.372
2025-10-15 12:58:23,070 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:23,071 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:23,071 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.973
2025-10-15 12:58:23,072 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:23,072 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:23,073 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:23,074 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:23,074 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:23,075 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:23,075 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:23,076 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:23,078 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.372
2025-10-15 12:58:23,079 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:23,082 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:23,102 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:23,103 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:23,104 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.973
2025-10-15 12:58:23,104 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:23,106 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:23,108 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:23,109 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:23,110 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.372
2025-10-15 12:58:23,134 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:23,134 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:23,135 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:23,136 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:23,137 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:23,137 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:23,138 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:23,140 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:23,141 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.372
2025-10-15 12:58:23,144 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:23,166 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:23,167 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:23,168 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:23,170 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.973
2025-10-15 12:58:23,171 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:23,197 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,199 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:23,199 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,200 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:23,203 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:23,215 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:23,230 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:23,231 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:23,233 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:23,247 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.973
2025-10-15 12:58:23,262 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:23,265 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:23,281 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:23,291 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:23,294 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:23,295 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:23,297 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:23,318 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:23,319 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,319 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:23,320 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,320 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:23,321 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:23,321 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:23,321 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:23,322 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:23,322 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:23,323 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:23,323 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:23,324 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:23,324 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:23,325 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:23,325 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:23,327 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:23,327 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:23,327 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:23,328 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:23,353 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:23,353 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:23,355 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:23,355 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,355 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:23,356 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,369 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:23,386 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:23,387 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:23,387 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:23,389 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:23,389 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:23,414 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:23,415 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:23,416 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:23,416 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:23,418 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:23,418 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:23,420 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,421 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:23,421 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:23,445 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.372, 'ask': 4192.409, 'last': 0.0, 'time': 1760533101}
2025-10-15 12:58:23,446 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:23,447 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,450 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:23,450 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:23,461 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,478 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:23,479 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,479 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:23,480 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,481 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:23,481 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 347, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:23,511 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:23,512 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 437, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:23,513 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:23,597 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,666 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:23,716 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,720 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:23,721 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,789 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:23,791 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,792 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:23,793 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:23,794 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,797 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:23,798 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:23,799 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,801 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:23,804 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,805 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,806 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.973, 'ask': 4192.01, 'last': 0.0, 'time': 1760533102}
2025-10-15 12:58:23,807 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,807 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:23,824 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.03s
2025-10-15 12:58:23,838 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6450866884125193}
2025-10-15 12:58:23,873 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:23,874 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.68s
2025-10-15 12:58:23,876 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:23,877 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:23,878 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:23,878 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,879 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,879 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:23,880 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:23,880 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:23,882 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:23,882 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12567.000000000007}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101768.00000000048}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6261.000000000422}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30735.999999999876}]
2025-10-15 12:58:23,883 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:21+07:00
2025-10-15 12:58:23,883 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:23,884 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:23,885 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:23,886 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.70s
2025-10-15 12:58:23,977 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:24,092 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:24,093 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:24,093 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:24,094 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:24,095 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:24,098 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:24,312 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:24,313 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:24,314 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:24,316 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:24,317 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:24,428 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:24,429 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:24,429 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:24,430 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:24,430 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:24,431 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:24,432 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:24,432 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:24,433 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:24,433 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:24,434 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:24,436 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:24,436 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:24,437 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:24,438 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:24,576 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:24,745 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:24,939 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:24,940 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:24,941 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:25,001 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:25,273 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:25,442 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:25,444 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:25,444 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:25,445 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:25,445 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.011
2025-10-15 12:58:25,446 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.97
2025-10-15 12:58:25,453 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 346, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:25,462 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 346, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:25,564 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 436, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:25,572 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 436, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:25,573 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:25,577 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:25,578 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:25,578 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:25,580 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:25,583 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:25,583 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:25,584 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:25,584 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:25,585 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:25,585 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:25,586 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:25,590 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:25,594 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:25,595 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:25,595 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:25,595 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:25,596 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:25,596 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:25,597 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:25,599 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:25,601 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:25,601 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:25,601 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:25,602 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:25,602 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:25,603 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:25,604 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:25,605 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:25,609 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:25,610 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:25,610 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:25,611 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:25,611 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:25,612 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:25,614 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:25,635 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:25,639 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:25,640 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:25,640 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:25,641 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:25,641 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:25,641 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:25,660 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:25,661 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:25,662 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:24+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:25,663 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:25+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:25,663 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:24+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:25,664 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:25+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:25,665 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:24+07:00
2025-10-15 12:58:25,665 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:25+07:00
2025-10-15 12:58:25,666 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:24+07:00 trong DST: True
2025-10-15 12:58:25,667 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:25+07:00 trong DST: True
2025-10-15 12:58:25,667 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:25,668 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:25,669 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:25,670 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:25,672 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:25,694 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:25,694 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:25,695 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:25,697 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:25,703 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:25,727 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:25,728 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:25,731 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:25,757 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:25,758 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:25,758 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:25,759 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:25,759 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:25,759 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:25,760 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:25,760 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:25,761 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:25,761 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:25,762 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:25,762 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:25,798 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:25,798 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:25,799 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:25,799 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:25,800 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:25,800 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:25,801 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:25,801 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:25,802 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:25,802 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:25,803 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:25,803 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:25,804 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:25,804 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:25,805 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:25,805 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:25,806 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:25,806 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:25,807 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:25,807 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:25,808 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:25,808 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:25,809 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:25,810 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:25,810 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:25,811 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:25,812 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:25,812 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:25,813 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:25,813 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:25,814 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:25,815 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:25,815 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:25,816 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:25,816 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:25,817 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:25,817 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:25,818 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:25,819 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:25,819 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:25,820 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.011, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:25,820 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:25,820 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:25,821 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.97, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:25,821 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:25,822 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:25,822 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:25,822 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:25,823 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:25,823 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:25,824 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12206.000000000131
2025-10-15 12:58:25,825 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:25,825 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101407.00000000061
2025-10-15 12:58:25,825 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12164.999999999964
2025-10-15 12:58:25,853 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5900.000000000546
2025-10-15 12:58:25,853 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101366.00000000044
2025-10-15 12:58:25,854 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30375.0
2025-10-15 12:58:25,854 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5859.000000000378
2025-10-15 12:58:25,855 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:25,855 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30333.999999999833
2025-10-15 12:58:25,855 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12206.000000000131}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101407.00000000061}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5900.000000000546}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30375.0}]
2025-10-15 12:58:25,856 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:25,856 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:25,857 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12164.999999999964}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101366.00000000044}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5859.000000000378}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30333.999999999833}]
2025-10-15 12:58:25,858 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:25,860 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:25,860 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:25,861 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:25,861 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:25,861 - APP.services.mt5_service - DEBUG - Position in day range: 0.5916149068323071
2025-10-15 12:58:25,881 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:25,882 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:24+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:25,882 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:25,883 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:24+07:00
2025-10-15 12:58:25,883 - APP.services.mt5_service - DEBUG - Position in day range: 0.5909782608695716
2025-10-15 12:58:25,884 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:24+07:00 trong DST: True
2025-10-15 12:58:25,884 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:25+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:25,884 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:25,885 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:25+07:00
2025-10-15 12:58:25,885 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:25,886 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:25+07:00 trong DST: True
2025-10-15 12:58:25,886 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:25,886 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:25,887 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:25,887 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:25,887 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:25,888 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:25,890 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '100', 'price': 4192.01, 'distance_pips': 0.1}, {'level': '125', 'price': 4192.012, 'distance_pips': 0.15}, {'level': '150', 'price': 4192.015, 'distance_pips': 0.4}, {'level': '175', 'price': 4192.017, 'distance_pips': 0.65}]
2025-10-15 12:58:25,890 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:25,891 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884125193}
2025-10-15 12:58:25,892 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:25,912 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:25,913 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:25,913 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9700', 'price': 4191.97, 'distance_pips': 0.0}, {'level': '9725', 'price': 4191.972, 'distance_pips': 0.25}, {'level': '9750', 'price': 4191.975, 'distance_pips': 0.5}, {'level': '9775', 'price': 4191.977, 'distance_pips': 0.75}]
2025-10-15 12:58:25,914 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:25,915 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884125193}
2025-10-15 12:58:25,915 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:25,916 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:25,916 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.011
2025-10-15 12:58:25,917 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:25,918 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:25,918 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:25,919 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:25,920 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.97
2025-10-15 12:58:25,922 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:25,923 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:25,948 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:25,949 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:25,950 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:25,950 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:25,951 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:25,952 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.011
2025-10-15 12:58:25,953 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:25,954 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.97
2025-10-15 12:58:25,979 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:25,981 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:25,981 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:25,982 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:25,986 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:26,010 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:26,012 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:26,012 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:26,013 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:26,015 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.011
2025-10-15 12:58:26,015 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:26,025 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:26,043 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.97
2025-10-15 12:58:26,045 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:26,047 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:26,075 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:26,078 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:26,118 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:26,119 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:26,120 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.011
2025-10-15 12:58:26,121 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:26,121 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:26,122 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:26,122 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:26,123 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:26,124 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:26,125 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.97
2025-10-15 12:58:26,125 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:26,126 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:26,127 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,127 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:26,127 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,128 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:26,129 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:26,129 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:26,130 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:26,130 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,131 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:26,131 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,132 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:26,132 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:26,132 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:26,133 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:26,134 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:26,134 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:26,135 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:26,135 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:26,135 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:26,136 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:26,136 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:26,137 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:26,137 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:26,137 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:26,139 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:26,139 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:26,140 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:26,141 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:26,141 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:26,142 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:26,169 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:26,173 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:26,173 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,173 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:26,174 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,174 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:26,175 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:26,175 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:26,177 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:26,178 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:26,179 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:26,179 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:26,180 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:26,180 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:26,181 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:26,181 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:26,182 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:26,182 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,183 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:26,183 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,185 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:26,186 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:26,186 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:26,186 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:26,187 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,187 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:26,188 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.011, 'ask': 4192.048, 'last': 0.0, 'time': 1760533104}
2025-10-15 12:58:26,188 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:26,188 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:26,189 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:26,190 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.87s
2025-10-15 12:58:26,191 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:26,193 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:26,193 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,193 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:26,194 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.97, 'ask': 4192.007, 'last': 0.0, 'time': 1760533105}
2025-10-15 12:58:26,196 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:26,197 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:26,198 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:26,198 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:26,199 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,199 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,200 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 346, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:26,200 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 436, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 12:58:26,201 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,202 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,202 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,204 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,204 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,229 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,230 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,231 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,231 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6450866884125193}
2025-10-15 12:58:26,234 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:26,257 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:26,258 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:26,258 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,259 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,260 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:26,260 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:26,261 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:26,262 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:26,262 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12164.999999999964}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101366.00000000044}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5859.000000000378}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30333.999999999833}]
2025-10-15 12:58:26,264 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:25+07:00
2025-10-15 12:58:26,266 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:26,290 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:26,290 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:26,292 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:26,293 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.98s
2025-10-15 12:58:26,395 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:26,521 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:26,522 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:26,523 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:26,525 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:26,525 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:26,532 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:26,533 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:26,534 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:26,536 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:26,695 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:26,828 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:26,828 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:26,829 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:26,829 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:26,830 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:26,831 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:26,831 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:26,832 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:26,832 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:26,833 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:26,835 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:26,836 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:26,836 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:26,837 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:26,837 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:26,972 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:27,246 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:27,339 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:27,340 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:27,341 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:27,512 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:27,842 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:27,844 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:27,845 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:27,845 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:27,846 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.914
2025-10-15 12:58:27,846 - APP.services.mt5_service - DEBUG - Current price (cp): 4191.914
2025-10-15 12:58:27,853 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 347, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:27,860 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 347, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:27,951 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 436, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:27,983 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:27,994 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 436, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:27,995 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:27,995 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:27,995 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:27,996 - APP.services.gemini_service - DEBUG - Stream từ Gemini API hoàn tất.
2025-10-15 12:58:27,999 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:27,999 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:28,000 - APP.core.analysis_worker - DEBUG - GIAI ĐOẠN 5: Thực thi hoặc quản lý giao dịch.
2025-10-15 12:58:28,001 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:28,004 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 12:58:28,004 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:28,005 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:28,005 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:28,006 - APP.core.analysis_worker - INFO - Không có lệnh. Tìm kiếm cơ hội vào lệnh mới.
2025-10-15 12:58:28,006 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:28,007 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:28,007 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất khối JSON ưu tiên.
2025-10-15 12:58:28,011 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:28,012 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 12:58:28,014 - APP.analysis.report_parser - DEBUG - Bắt đầu sửa chuỗi JSON.
2025-10-15 12:58:28,015 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:28,016 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:28,018 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:28,031 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 12:58:28,053 - APP.analysis.report_parser - DEBUG - Chuỗi JSON hợp lệ sau khi sửa.
2025-10-15 12:58:28,056 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:28,056 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:28,057 - APP.analysis.report_parser - INFO - Đã tìm thấy và chọn khối JSON tốt nhất với 8 khóa.
2025-10-15 12:58:28,057 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:28,057 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:28,059 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 12:58:28,060 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:28,060 - APP.core.trading.actions - DEBUG - Không có setup chất lượng cao (Grade: Không có). Bỏ qua.
2025-10-15 12:58:28,062 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 12:58:28,063 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:28,063 - APP.core.analysis_worker - DEBUG - GIAI ĐOẠN 6: Hoàn tất và dọn dẹp.
2025-10-15 12:58:28,064 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:28,067 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:28,068 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:28,068 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:28,069 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 12:58:28,069 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:28,069 - APP.persistence.json_handler - DEBUG - JsonSaver được khởi tạo cho workspace: C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots
2025-10-15 12:58:28,072 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 12:58:28,073 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:28,073 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu tạo map timeframe với 4 tên file.
2025-10-15 12:58:28,074 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:28,078 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:28,078 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,079 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_H1.png
2025-10-15 12:58:28,080 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:28,083 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:28,105 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'H1' cho 'XAUUSD_H1.png' bằng pattern đã biên dịch.
2025-10-15 12:58:28,106 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:28,106 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:28,107 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M1.png
2025-10-15 12:58:28,110 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:28,135 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:28,136 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M1' cho 'XAUUSD_M1.png' bằng pattern đã biên dịch.
2025-10-15 12:58:28,137 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 12:58:28,138 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:26+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:28,138 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M15.png
2025-10-15 12:58:28,139 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:28,141 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:26+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:28,142 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M15' cho 'XAUUSD_M15.png' bằng pattern đã biên dịch.
2025-10-15 12:58:28,143 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 12:58:28,176 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 19:58:26+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 12:58:28,200 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M5.png
2025-10-15 12:58:28,204 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,226 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:26+07:00
2025-10-15 12:58:28,227 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:26+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:28,227 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M5' cho 'XAUUSD_M5.png' bằng pattern đã biên dịch.
2025-10-15 12:58:28,228 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,228 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:26+07:00 trong DST: True
2025-10-15 12:58:28,229 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:26+07:00
2025-10-15 12:58:28,229 - APP.ui.utils.timeframe_detector - DEBUG - Kết thúc tạo map timeframe. Map: {'XAUUSD_H1.png': 'H1', 'XAUUSD_M1.png': 'M1', 'XAUUSD_M15.png': 'M15', 'XAUUSD_M5.png': 'M5'}
2025-10-15 12:58:28,230 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,230 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:28,231 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:26+07:00 trong DST: True
2025-10-15 12:58:28,232 - APP.persistence.md_handler - DEBUG - Bắt đầu lưu báo cáo Markdown.
2025-10-15 12:58:28,234 - APP.persistence.json_handler - DEBUG - Bắt đầu quá trình lưu báo cáo JSON.
2025-10-15 12:58:28,255 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:28,256 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:28,257 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất khối JSON ưu tiên.
2025-10-15 12:58:28,257 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:28,258 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:28,258 - APP.analysis.report_parser - DEBUG - Bắt đầu sửa chuỗi JSON.
2025-10-15 12:58:28,259 - APP.persistence.md_handler - DEBUG - Đường dẫn file báo cáo Markdown: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots\XAUUSD\Reports\report_20251015_125828.md
2025-10-15 12:58:28,261 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:28,261 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 12:58:28,262 - APP.analysis.report_parser - DEBUG - Chuỗi JSON hợp lệ sau khi sửa.
2025-10-15 12:58:28,262 - APP.persistence.md_handler - DEBUG - Bắt đầu trích xuất báo cáo human-readable.
2025-10-15 12:58:28,263 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:28,291 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 12:58:28,291 - APP.analysis.report_parser - INFO - Đã tìm thấy và chọn khối JSON tốt nhất với 8 khóa.
2025-10-15 12:58:28,292 - APP.persistence.md_handler - WARNING - Không tìm thấy điểm bắt đầu báo cáo hợp lệ, trả về toàn bộ nội dung.
2025-10-15 12:58:28,322 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:28,323 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4191.2578668744445
2025-10-15 12:58:28,324 - APP.persistence.json_handler - DEBUG - Đã thêm 8 khối JSON vào data_to_save.
2025-10-15 12:58:28,325 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:28,330 - APP.persistence.md_handler - INFO - Đã lưu báo cáo Markdown thành công tại: report_20251015_125828.md
2025-10-15 12:58:28,338 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4191.2578668744445, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:28,339 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,340 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất tóm tắt và chữ ký.
2025-10-15 12:58:28,340 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:28,341 - APP.utils.general_utils - DEBUG - Bắt đầu cleanup_old_files trong thư mục: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots\XAUUSD\Reports, pattern: *.md, giữ lại: 10 file.
2025-10-15 12:58:28,341 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:28,343 - APP.analysis.report_parser - DEBUG - Hoàn tất trích xuất. High Prob: False
2025-10-15 12:58:28,343 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:28,344 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4188.362167308706
2025-10-15 12:58:28,346 - APP.utils.general_utils - DEBUG - Đã xóa file cũ: report_20251015_075024.md
2025-10-15 12:58:28,347 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất cài đặt giao dịch từ báo cáo.
2025-10-15 12:58:28,348 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:28,348 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:28,349 - APP.utils.general_utils - DEBUG - Kết thúc cleanup_old_files.
2025-10-15 12:58:28,350 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất khối JSON ưu tiên.
2025-10-15 12:58:28,350 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:28,350 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4195.535391253205
2025-10-15 12:58:28,351 - APP.persistence.md_handler - DEBUG - Kết thúc việc lưu báo cáo Markdown.
2025-10-15 12:58:28,351 - APP.analysis.report_parser - DEBUG - Bắt đầu sửa chuỗi JSON.
2025-10-15 12:58:28,352 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:28,353 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 12:58:28,353 - APP.utils.threading_utils - DEBUG - Task song song 'save_report' hoàn tất thành công.
2025-10-15 12:58:28,354 - APP.analysis.report_parser - DEBUG - Chuỗi JSON hợp lệ sau khi sửa.
2025-10-15 12:58:28,354 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:28,355 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.8934207875545
2025-10-15 12:58:28,356 - APP.analysis.report_parser - INFO - Đã tìm thấy và chọn khối JSON tốt nhất với 8 khóa.
2025-10-15 12:58:28,356 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:28,356 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 12:58:28,358 - APP.analysis.report_parser - INFO - Trích xuất cài đặt thành công từ khối JSON.
2025-10-15 12:58:28,360 - APP.persistence.json_handler - DEBUG - Đã parse và lưu plan: {'direction': 'null', 'entry': 0.0, 'sl': 0.0, 'tp1': 0.0, 'tp2': 0.0, 'risk_multiplier': 0.0}
2025-10-15 12:58:28,362 - APP.persistence.json_handler - INFO - Đã lưu file JSON báo cáo thành công tại: ctx_20251015_125828.json
2025-10-15 12:58:28,363 - APP.utils.general_utils - DEBUG - Bắt đầu cleanup_old_files trong thư mục: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots\XAUUSD\Reports, pattern: ctx_*.json, giữ lại: 10 file.
2025-10-15 12:58:28,383 - APP.utils.general_utils - DEBUG - Đã xóa file cũ: ctx_20251015_075024.json
2025-10-15 12:58:28,398 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:28,399 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4182.900593560623
2025-10-15 12:58:28,400 - APP.utils.general_utils - DEBUG - Kết thúc cleanup_old_files.
2025-10-15 12:58:28,400 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:28,401 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 12:58:28,401 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất cài đặt giao dịch từ báo cáo.
2025-10-15 12:58:28,401 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:28,402 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.519240989902
2025-10-15 12:58:28,402 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất khối JSON ưu tiên.
2025-10-15 12:58:28,403 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:28,404 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 12:58:28,405 - APP.analysis.report_parser - DEBUG - Bắt đầu sửa chuỗi JSON.
2025-10-15 12:58:28,405 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:28,406 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4157.345057660159
2025-10-15 12:58:28,407 - APP.analysis.report_parser - DEBUG - Chuỗi JSON hợp lệ sau khi sửa.
2025-10-15 12:58:28,407 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:28,408 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 12:58:28,408 - APP.analysis.report_parser - INFO - Đã tìm thấy và chọn khối JSON tốt nhất với 8 khóa.
2025-10-15 12:58:28,409 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:28,409 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4140.673806989958
2025-10-15 12:58:28,409 - APP.analysis.report_parser - INFO - Trích xuất cài đặt thành công từ khối JSON.
2025-10-15 12:58:28,410 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:28,411 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 12:58:28,411 - APP.persistence.json_handler - DEBUG - Kết thúc quá trình lưu báo cáo JSON.
2025-10-15 12:58:28,412 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:28,412 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4073.3369964235694
2025-10-15 12:58:28,413 - APP.utils.threading_utils - DEBUG - Task song song 'save_report' hoàn tất thành công.
2025-10-15 12:58:28,413 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:28,413 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4188.362167308706, 'ema200': 4195.535391253205}, 'M5': {'ema50': 4194.8934207875545, 'ema200': 4182.900593560623}, 'M15': {'ema50': 4187.519240989902, 'ema200': 4157.345057660159}, 'H1': {'ema50': 4140.673806989958, 'ema200': 4073.3369964235694}}
2025-10-15 12:58:28,415 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:28,415 - APP.core.analysis_worker - INFO - Đã lưu báo cáo MD và JSON song song.
2025-10-15 12:58:28,416 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 12:58:28,416 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:28,417 - APP.core.analysis_worker - DEBUG - Kết thúc AnalysisWorker.run.
2025-10-15 12:58:28,417 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.735663231620077, TRs count: 179
2025-10-15 12:58:28,418 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:28,418 - APP.utils.threading_utils - DEBUG - Task 'analysis.session.autorun-20251015-125721' (group=analysis.session) hoàn tất sau 67.13s
2025-10-15 12:58:28,419 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:28,420 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:28,422 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.3610054148909114, TRs count: 119
2025-10-15 12:58:28,423 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:28,444 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,445 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 12:58:28,446 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:28,447 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 9.696893003059442, TRs count: 95
2025-10-15 12:58:28,448 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:28,449 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 12:58:28,449 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:28,450 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 19.294144483387498, TRs count: 119
2025-10-15 12:58:28,450 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:28,453 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.735663231620077, 'M1': 2.3610054148909114, 'M15': 9.696893003059442, 'H1': 19.294144483387498}
2025-10-15 12:58:28,453 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.914, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:28,453 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:28,454 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 12:58:28,460 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:28,477 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:28,478 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4191.914, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 12:58:28,478 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:28,479 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 12:58:28,480 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12108.999999999469
2025-10-15 12:58:28,480 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 12:58:28,481 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101309.99999999994
2025-10-15 12:58:28,481 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 12:58:28,482 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5802.999999999884
2025-10-15 12:58:28,484 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 12:58:28,484 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12108.999999999469
2025-10-15 12:58:28,485 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 101309.99999999994
2025-10-15 12:58:28,486 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 5802.999999999884
2025-10-15 12:58:28,507 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30277.999999999338
2025-10-15 12:58:28,509 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 30277.999999999338
2025-10-15 12:58:28,510 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:28,510 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 12:58:28,511 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12108.999999999469}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101309.99999999994}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5802.999999999884}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30277.999999999338}]
2025-10-15 12:58:28,511 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12108.999999999469}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101309.99999999994}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5802.999999999884}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30277.999999999338}]
2025-10-15 12:58:28,512 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:28,512 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:28,513 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:28,514 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:28,516 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:28,517 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:28,520 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 12:58:28,536 - APP.services.mt5_service - DEBUG - Position in day range: 0.5901086956521726
2025-10-15 12:58:28,536 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 12:58:28,537 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:26+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:28,538 - APP.services.mt5_service - DEBUG - Position in day range: 0.5901086956521726
2025-10-15 12:58:28,538 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:26+07:00
2025-10-15 12:58:28,539 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:26+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:28,539 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:26+07:00 trong DST: True
2025-10-15 12:58:28,539 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:26+07:00
2025-10-15 12:58:28,540 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:28,540 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:26+07:00 trong DST: True
2025-10-15 12:58:28,541 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:28,541 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:28,542 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:28,542 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:28,542 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:28,543 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:28,543 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:28,544 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:28,544 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9100', 'price': 4191.91, 'distance_pips': 0.4}, {'level': '9125', 'price': 4191.912, 'distance_pips': 0.15}, {'level': '9150', 'price': 4191.915, 'distance_pips': 0.1}, {'level': '9175', 'price': 4191.917, 'distance_pips': 0.35}]
2025-10-15 12:58:28,544 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:28,548 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,570 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:28,571 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9100', 'price': 4191.91, 'distance_pips': 0.4}, {'level': '9125', 'price': 4191.912, 'distance_pips': 0.15}, {'level': '9150', 'price': 4191.915, 'distance_pips': 0.1}, {'level': '9175', 'price': 4191.917, 'distance_pips': 0.35}]
2025-10-15 12:58:28,571 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:28,572 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:28,572 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:28,573 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:28,573 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:28,574 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:28,574 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.914
2025-10-15 12:58:28,575 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:28,577 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:28,579 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.914
2025-10-15 12:58:28,587 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:28,602 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:28,604 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:28,604 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:28,605 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:28,605 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:28,606 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:28,607 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.914
2025-10-15 12:58:28,608 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 12:58:28,609 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:28,610 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 12:58:28,610 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:28,632 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4191.914
2025-10-15 12:58:28,633 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:28,633 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:28,634 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:28,634 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 12:58:28,635 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:28,636 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:28,637 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.914
2025-10-15 12:58:28,638 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 12:58:28,638 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:28,639 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 12:58:28,641 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4191.914
2025-10-15 12:58:28,642 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:28,667 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:28,668 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:28,668 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 12:58:28,669 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:28,672 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:28,672 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,699 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:28,700 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 12:58:28,700 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: refresh_all_lists
2025-10-15 12:58:28,701 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.914
2025-10-15 12:58:28,702 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 12:58:28,702 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 12:58:28,703 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:28,724 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:28,725 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 12:58:28,726 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4191.914
2025-10-15 12:58:28,727 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:28,728 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 12:58:28,729 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:58:28,729 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:28,730 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 12:58:28,730 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:58:28,731 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 12:58:28,732 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:28,734 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 12:58:28,734 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 12:58:28,735 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:28,765 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 12:58:28,766 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:58:28,767 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:28,786 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:28,787 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 12:58:28,788 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 12:58:28,788 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:28,789 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:28,789 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,790 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:28,790 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:28,791 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: _finalize_done
2025-10-15 12:58:28,792 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:28,792 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:28,793 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:28,793 - APP.ui.utils.ui_builder - DEBUG - Đã thay đổi trạng thái nút Start/Stop thành 'normal'. Các điều khiển khác không bị ảnh hưởng.
2025-10-15 12:58:28,794 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:28,794 - APP.ui.app_ui - DEBUG - Lên lịch chạy tự động tiếp theo sau 60000ms.
2025-10-15 12:58:28,795 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:28,796 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:28,796 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:28,798 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,821 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:28,821 - APP.core.analysis_controller - INFO - Kết thúc session autorun-20251015-125721: {'status': 'completed', 'early_exit': False}
2025-10-15 12:58:28,822 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:28,822 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:28,824 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:28,825 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:28,842 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 12:58:28,854 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:28,855 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.12s
2025-10-15 12:58:28,856 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 12:58:28,857 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:28,859 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:28,883 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:28,887 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.10s
2025-10-15 12:58:28,887 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:28,888 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 12:58:28,918 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:28,919 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:28,920 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:28,920 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:28,947 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,948 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:28,949 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:28,949 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:28,950 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:28,950 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:28,954 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:28,970 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.08s
2025-10-15 12:58:28,978 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:28,979 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:28,980 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:28,980 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:28,981 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:28,981 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:28,982 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:28,986 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:29,007 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:29,009 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:29,010 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:29,012 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:29,013 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:29,014 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:29,014 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:29,016 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:29,042 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.914, 'ask': 4191.951, 'last': 0.0, 'time': 1760533106}
2025-10-15 12:58:29,047 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 12:58:29,073 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:29,075 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:29,076 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:29,101 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:29,102 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:29,103 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:29,103 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:29,104 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:29,104 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:29,105 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:29,105 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 347, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:29,106 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:29,106 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 436, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 12:58:29,124 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 12:58:29,130 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 12:58:29,131 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:29,133 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 12:58:29,133 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:29,133 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:29,134 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:29,134 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:29,135 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:29,135 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4191.914, 'ask': 4191.951, 'last': 0.0, 'time': 1760533106}
2025-10-15 12:58:29,136 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:29,136 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:29,136 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:29,137 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.60s
2025-10-15 12:58:29,138 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:29,139 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:29,140 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6450866884283761}
2025-10-15 12:58:29,141 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 12:58:29,141 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:29,161 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:29,162 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:29,164 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:29,164 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:29,165 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 12:58:29,165 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:29,166 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:29,167 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12108.999999999469}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 101309.99999999994}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 5802.999999999884}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 30277.999999999338}]
2025-10-15 12:58:29,167 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:26+07:00
2025-10-15 12:58:29,168 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:29,169 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:29,172 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:29,179 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.64s
2025-10-15 12:58:29,211 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:29,333 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 12:58:29,334 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:29,334 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 12:58:29,336 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:29,337 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 12:58:29,582 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:29,583 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 12:58:29,585 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:29,586 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 12:58:29,594 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:29,595 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:29,595 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:29,596 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:29,597 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:29,598 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:29,599 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:29,599 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 12:58:29,600 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:29,600 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 12:58:29,601 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:29,602 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 12:58:29,602 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:29,603 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 12:58:29,603 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:30,105 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:30,106 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:30,107 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 12:58:30,465 - APP.ui.app_ui - INFO - Bắt đầu quy trình tắt ứng dụng an toàn.
2025-10-15 12:58:30,480 - APP.ui.controllers.chart_controller - INFO - Dừng ChartController stream hiện tại.
2025-10-15 12:58:30,481 - APP.utils.threading_utils - INFO - Cancel group 'chart.refresh' → task 'chart.info'
2025-10-15 12:58:30,481 - APP.utils.threading_utils - INFO - Cancel group 'chart.refresh' → task 'chart.draw'
2025-10-15 12:58:30,482 - APP.ui.components.chart_tab - INFO - ChartTab đã dừng stream dữ liệu.
2025-10-15 12:58:30,500 - APP.ui.app_ui - DEBUG - Bắt đầu thu thập dữ liệu cấu hình từ UI.
2025-10-15 12:58:30,508 - APP.configs.workspace_config - DEBUG - Bắt đầu lưu cấu hình vào file.
2025-10-15 12:58:30,508 - APP.utils.general_utils - DEBUG - Bắt đầu obfuscate text với salt.
2025-10-15 12:58:30,509 - APP.utils.general_utils - DEBUG - Tạo machine key.
2025-10-15 12:58:30,509 - APP.utils.general_utils - DEBUG - Đã tạo machine key. Độ dài: 32 bytes.
2025-10-15 12:58:30,510 - APP.utils.general_utils - DEBUG - Thực hiện XOR bytes.
2025-10-15 12:58:30,510 - APP.utils.general_utils - DEBUG - Đã obfuscate text thành công.
2025-10-15 12:58:30,510 - APP.configs.workspace_config - DEBUG - Đã mã hóa thành công trường 'api_key' trong nhóm 'te'.
2025-10-15 12:58:30,511 - APP.utils.general_utils - DEBUG - Bắt đầu obfuscate text với salt.
2025-10-15 12:58:30,511 - APP.utils.general_utils - DEBUG - Tạo machine key.
2025-10-15 12:58:30,511 - APP.utils.general_utils - DEBUG - Đã tạo machine key. Độ dài: 32 bytes.
2025-10-15 12:58:30,512 - APP.utils.general_utils - DEBUG - Thực hiện XOR bytes.
2025-10-15 12:58:30,513 - APP.utils.general_utils - DEBUG - Đã obfuscate text thành công.
2025-10-15 12:58:30,513 - APP.configs.workspace_config - DEBUG - Đã mã hóa thành công trường 'api_key' trong nhóm 'fmp'.
2025-10-15 12:58:30,514 - APP.utils.general_utils - DEBUG - Bắt đầu obfuscate text với salt.
2025-10-15 12:58:30,515 - APP.utils.general_utils - DEBUG - Tạo machine key.
2025-10-15 12:58:30,516 - APP.utils.general_utils - DEBUG - Đã tạo machine key. Độ dài: 32 bytes.
2025-10-15 12:58:30,518 - APP.utils.general_utils - DEBUG - Thực hiện XOR bytes.
2025-10-15 12:58:30,518 - APP.utils.general_utils - DEBUG - Đã obfuscate text thành công.
2025-10-15 12:58:30,537 - APP.configs.workspace_config - DEBUG - Đã mã hóa thành công trường 'token' trong nhóm 'telegram'.
2025-10-15 12:58:30,539 - APP.configs.workspace_config - INFO - Cấu hình đã được lưu thành công vào C:\Users\leanhchi\.gemini_folder_analyze\workspace.json
2025-10-15 12:58:30,540 - APP.configs.workspace_config - DEBUG - Kết thúc lưu cấu hình vào file.
2025-10-15 12:58:30,540 - APP.ui.app_ui - INFO - Đã lưu cấu hình workspace thành công.
2025-10-15 12:58:30,540 - APP.services.mt5_service - INFO - Đang ngắt kết nối khỏi MetaTrader 5.
2025-10-15 12:58:30,608 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 12:58:30,610 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 12:58:30,611 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:30,612 - APP.services.mt5_service - INFO - Đã ngắt kết nối MT5 thành công.
2025-10-15 12:58:30,612 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.12
2025-10-15 12:58:30,613 - APP.ui.app_ui - INFO - UI queue backlog khi shutdown: 0
2025-10-15 12:58:30,613 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 12:58:30,613 - APP.services.mt5_service - WARNING - Không đủ dữ liệu tick cho 5m để tính tick stats.
2025-10-15 12:58:30,614 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.08
2025-10-15 12:58:30,615 - APP.services.mt5_service - WARNING - Không đủ dữ liệu tick cho 30m để tính tick stats.
2025-10-15 12:58:30,615 - APP.services.mt5_service - WARNING - Không đủ dữ liệu tick cho 5m để tính tick stats.
2025-10-15 12:58:30,616 - APP.services.mt5_service - WARNING - Không đủ dữ liệu tick cho 30m để tính tick stats.
2025-10-15 12:58:30,618 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:30,619 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 12:58:30,620 - APP.services.mt5_service - WARNING - Lần thử 1/3: Không lấy được rates từ MT5 cho XAUUSD 1. Chờ 0.2s...
2025-10-15 12:58:30,620 - APP.services.mt5_service - WARNING - Lần thử 1/3: Không lấy được rates từ MT5 cho XAUUSD 1. Chờ 0.2s...
2025-10-15 12:58:30,821 - APP.services.mt5_service - WARNING - Lần thử 2/3: Không lấy được rates từ MT5 cho XAUUSD 1. Chờ 0.2s...
2025-10-15 12:58:30,821 - APP.services.mt5_service - WARNING - Lần thử 2/3: Không lấy được rates từ MT5 cho XAUUSD 1. Chờ 0.2s...
2025-10-15 12:58:31,024 - APP.services.mt5_service - WARNING - Lần thử 3/3: Không lấy được rates từ MT5 cho XAUUSD 1. Chờ 0.2s...
2025-10-15 12:58:31,024 - APP.services.mt5_service - WARNING - Lần thử 3/3: Không lấy được rates từ MT5 cho XAUUSD 1. Chờ 0.2s...
2025-10-15 12:58:31,225 - APP.services.mt5_service - WARNING - Không lấy được rates từ MT5 cho XAUUSD 1.
2025-10-15 12:58:31,226 - APP.services.mt5_service - WARNING - Không lấy được rates từ MT5 cho XAUUSD 1.
2025-10-15 12:58:31,226 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:31,226 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:31,227 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:31,227 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 12:58:31,228 - APP.services.mt5_service - WARNING - Lần thử 1/3: Không lấy được rates từ MT5 cho XAUUSD 5. Chờ 0.2s...
2025-10-15 12:58:31,228 - APP.services.mt5_service - WARNING - Lần thử 1/3: Không lấy được rates từ MT5 cho XAUUSD 5. Chờ 0.2s...
2025-10-15 12:58:31,429 - APP.services.mt5_service - WARNING - Lần thử 2/3: Không lấy được rates từ MT5 cho XAUUSD 5. Chờ 0.2s...
2025-10-15 12:58:31,429 - APP.services.mt5_service - WARNING - Lần thử 2/3: Không lấy được rates từ MT5 cho XAUUSD 5. Chờ 0.2s...
2025-10-15 12:58:31,630 - APP.services.mt5_service - WARNING - Lần thử 3/3: Không lấy được rates từ MT5 cho XAUUSD 5. Chờ 0.2s...
2025-10-15 12:58:31,631 - APP.services.mt5_service - WARNING - Lần thử 3/3: Không lấy được rates từ MT5 cho XAUUSD 5. Chờ 0.2s...
2025-10-15 12:58:31,832 - APP.services.mt5_service - WARNING - Không lấy được rates từ MT5 cho XAUUSD 5.
2025-10-15 12:58:31,832 - APP.services.mt5_service - WARNING - Không lấy được rates từ MT5 cho XAUUSD 5.
2025-10-15 12:58:31,833 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:31,833 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:31,834 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:31,835 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 12:58:31,835 - APP.services.mt5_service - WARNING - Lần thử 1/3: Không lấy được rates từ MT5 cho XAUUSD 15. Chờ 0.2s...
2025-10-15 12:58:31,835 - APP.services.mt5_service - WARNING - Lần thử 1/3: Không lấy được rates từ MT5 cho XAUUSD 15. Chờ 0.2s...
2025-10-15 12:58:32,036 - APP.services.mt5_service - WARNING - Lần thử 2/3: Không lấy được rates từ MT5 cho XAUUSD 15. Chờ 0.2s...
2025-10-15 12:58:32,037 - APP.services.mt5_service - WARNING - Lần thử 2/3: Không lấy được rates từ MT5 cho XAUUSD 15. Chờ 0.2s...
2025-10-15 12:58:32,237 - APP.services.mt5_service - WARNING - Lần thử 3/3: Không lấy được rates từ MT5 cho XAUUSD 15. Chờ 0.2s...
2025-10-15 12:58:32,238 - APP.services.mt5_service - WARNING - Lần thử 3/3: Không lấy được rates từ MT5 cho XAUUSD 15. Chờ 0.2s...
2025-10-15 12:58:32,439 - APP.services.mt5_service - WARNING - Không lấy được rates từ MT5 cho XAUUSD 15.
2025-10-15 12:58:32,439 - APP.services.mt5_service - WARNING - Không lấy được rates từ MT5 cho XAUUSD 15.
2025-10-15 12:58:32,439 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:32,440 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:32,440 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:32,441 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 12:58:32,441 - APP.services.mt5_service - WARNING - Lần thử 1/3: Không lấy được rates từ MT5 cho XAUUSD 16385. Chờ 0.2s...
2025-10-15 12:58:32,442 - APP.services.mt5_service - WARNING - Lần thử 1/3: Không lấy được rates từ MT5 cho XAUUSD 16385. Chờ 0.2s...
2025-10-15 12:58:32,642 - APP.services.mt5_service - WARNING - Lần thử 2/3: Không lấy được rates từ MT5 cho XAUUSD 16385. Chờ 0.2s...
2025-10-15 12:58:32,643 - APP.services.mt5_service - WARNING - Lần thử 2/3: Không lấy được rates từ MT5 cho XAUUSD 16385. Chờ 0.2s...
2025-10-15 12:58:32,844 - APP.services.mt5_service - WARNING - Lần thử 3/3: Không lấy được rates từ MT5 cho XAUUSD 16385. Chờ 0.2s...
2025-10-15 12:58:32,844 - APP.services.mt5_service - WARNING - Lần thử 3/3: Không lấy được rates từ MT5 cho XAUUSD 16385. Chờ 0.2s...
2025-10-15 12:58:33,045 - APP.services.mt5_service - WARNING - Không lấy được rates từ MT5 cho XAUUSD 16385.
2025-10-15 12:58:33,045 - APP.services.mt5_service - WARNING - Không lấy được rates từ MT5 cho XAUUSD 16385.
2025-10-15 12:58:33,046 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:33,047 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 12:58:33,047 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:33,048 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 12:58:33,048 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:33,048 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 12:58:33,049 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:33,049 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 12:58:33,050 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 0 rates.
2025-10-15 12:58:33,050 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 0 rates.
2025-10-15 12:58:33,050 - APP.services.mt5_service - DEBUG - Rates trống, không thể tính VWAP.
2025-10-15 12:58:33,051 - APP.services.mt5_service - DEBUG - Rates trống, không thể tính VWAP.
2025-10-15 12:58:33,051 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': None, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:33,052 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': None, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 12:58:33,052 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': None, 'ema200': None}, 'M5': {'ema50': None, 'ema200': None}, 'M15': {'ema50': None, 'ema200': None}, 'H1': {'ema50': None, 'ema200': None}}
2025-10-15 12:58:33,053 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': None, 'ema200': None}, 'M5': {'ema50': None, 'ema200': None}, 'M15': {'ema50': None, 'ema200': None}, 'H1': {'ema50': None, 'ema200': None}}
2025-10-15 12:58:33,053 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 0 rates, period: 14
2025-10-15 12:58:33,053 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 0 rates, period: 14
2025-10-15 12:58:33,054 - APP.services.mt5_service - DEBUG - Không đủ rates để tính ATR.
2025-10-15 12:58:33,054 - APP.services.mt5_service - DEBUG - Không đủ rates để tính ATR.
2025-10-15 12:58:33,054 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 0 rates, period: 14
2025-10-15 12:58:33,055 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 0 rates, period: 14
2025-10-15 12:58:33,055 - APP.services.mt5_service - DEBUG - Không đủ rates để tính ATR.
2025-10-15 12:58:33,056 - APP.services.mt5_service - DEBUG - Không đủ rates để tính ATR.
2025-10-15 12:58:33,056 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 0 rates, period: 14
2025-10-15 12:58:33,057 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 0 rates, period: 14
2025-10-15 12:58:33,057 - APP.services.mt5_service - DEBUG - Không đủ rates để tính ATR.
2025-10-15 12:58:33,058 - APP.services.mt5_service - DEBUG - Không đủ rates để tính ATR.
2025-10-15 12:58:33,058 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 0 rates, period: 14
2025-10-15 12:58:33,059 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 0 rates, period: 14
2025-10-15 12:58:33,059 - APP.services.mt5_service - DEBUG - Không đủ rates để tính ATR.
2025-10-15 12:58:33,060 - APP.services.mt5_service - DEBUG - Không đủ rates để tính ATR.
2025-10-15 12:58:33,060 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': None, 'M1': None, 'M15': None, 'H1': None}
2025-10-15 12:58:33,061 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': None, 'M1': None, 'M15': None, 'H1': None}
2025-10-15 12:58:33,061 - APP.services.mt5_service - DEBUG - Volatility regime: None
2025-10-15 12:58:33,062 - APP.services.mt5_service - DEBUG - Volatility regime: None
2025-10-15 12:58:33,062 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.12, daily: {}, prev_day: None
2025-10-15 12:58:33,063 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.08, daily: {}, prev_day: None
2025-10-15 12:58:33,063 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 0
2025-10-15 12:58:33,063 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 0
2025-10-15 12:58:33,064 - APP.services.mt5_service - DEBUG - Key levels nearby: []
2025-10-15 12:58:33,064 - APP.services.mt5_service - DEBUG - Key levels nearby: []
2025-10-15 12:58:33,065 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:33,065 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 12:58:33,065 - APP.services.mt5_service - WARNING - Không đủ dữ liệu D1 để tính adr_stats cho XAUUSD.
2025-10-15 12:58:33,066 - APP.services.mt5_service - WARNING - Không đủ dữ liệu D1 để tính adr_stats cho XAUUSD.
2025-10-15 12:58:33,066 - APP.services.mt5_service - DEBUG - Position in day range: None
2025-10-15 12:58:33,067 - APP.services.mt5_service - DEBUG - Position in day range: None
2025-10-15 12:58:33,067 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:30+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:33,068 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 19:58:30+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 12:58:33,068 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:30+07:00
2025-10-15 12:58:33,069 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 19:58:30+07:00
2025-10-15 12:58:33,069 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:30+07:00 trong DST: True
2025-10-15 12:58:33,069 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 19:58:30+07:00 trong DST: True
2025-10-15 12:58:33,070 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:33,070 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 12:58:33,070 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:33,071 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 12:58:33,071 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:33,072 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 12:58:33,073 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:33,073 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:33,073 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:33,074 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:33,074 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '1200', 'price': 4192.12, 'distance_pips': 0.0}, {'level': '1225', 'price': 4192.122, 'distance_pips': 0.25}, {'level': '1250', 'price': 4192.125, 'distance_pips': 0.5}, {'level': '1275', 'price': 4192.127, 'distance_pips': 0.75}]
2025-10-15 12:58:33,075 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '800', 'price': 4192.08, 'distance_pips': 0.0}, {'level': '825', 'price': 4192.082, 'distance_pips': 0.25}, {'level': '850', 'price': 4192.085, 'distance_pips': 0.5}, {'level': '875', 'price': 4192.087, 'distance_pips': 0.75}]
2025-10-15 12:58:33,075 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': None}
2025-10-15 12:58:33,076 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': None}
2025-10-15 12:58:33,077 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:33,077 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:33,078 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:33,078 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:33,079 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:33,079 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:33,080 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:33,100 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:33,100 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:33,101 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:33,102 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:33,102 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:33,103 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:33,103 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:33,103 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:33,104 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:33,104 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:33,105 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:33,105 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:33,105 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:33,106 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:33,106 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:33,106 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:33,106 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:33,107 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:33,108 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 12:58:33,108 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:33,109 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:33,110 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:33,110 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:33,111 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:33,118 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:33,132 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:33,133 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:33,134 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 12:58:33,134 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:33,135 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 12:58:33,135 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:33,135 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 12:58:33,136 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:33,136 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 12:58:33,137 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 12:58:33,137 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:33,138 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 12:58:33,139 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:33,140 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 12:58:33,142 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:33,143 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:33,166 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 12:58:33,167 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:33,167 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 12:58:33,168 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 12:58:33,169 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 12:58:33,169 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 12:58:33,170 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 12:58:33,170 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 12:58:33,171 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:33,172 - APP.utils.threading_utils - INFO - Task 'chart.draw' (group=chart.refresh) bị hủy sau 3.59s
2025-10-15 12:58:33,173 - APP.ui.controllers.chart_controller - DEBUG - Future chart.draw bị cancel, không cập nhật UI.
2025-10-15 12:58:33,196 - APP.services.mt5_service - WARNING - MT5 chưa kết nối, không thể lấy lịch sử deals.
2025-10-15 12:58:33,198 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.12, 'ask': 4192.157, 'last': 0.0, 'time': 1760533110}
2025-10-15 12:58:33,199 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 12:58:33,199 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 12:58:33,200 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 12:58:33,200 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 12:58:33,201 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 12:58:33,202 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {}
2025-10-15 12:58:33,202 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {}
2025-10-15 12:58:33,202 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': None}
2025-10-15 12:58:33,203 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {}
2025-10-15 12:58:33,203 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': []
2025-10-15 12:58:33,204 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T19:58:30+07:00
2025-10-15 12:58:33,205 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 12:58:33,227 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 12:58:33,228 - APP.core.trading.conditions - INFO - Điều kiện NO-TRADE được kích hoạt: ⛔ [atr] Không có dữ liệu ATR M5 để kiểm tra biến động., ⚠️ [key_level] Không có mức giá quan trọng nào quanh thị trường hiện tại để đối chiếu.
2025-10-15 12:58:33,229 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 12:58:33,231 - APP.utils.threading_utils - INFO - Task 'chart.info' (group=chart.refresh) bị hủy sau 3.65s
2025-10-15 12:58:33,231 - APP.ui.controllers.chart_controller - DEBUG - Future chart.info bị cancel, không cập nhật UI.
2025-10-15 12:58:33,232 - APP.utils.threading_utils - INFO - ThreadingManager.shutdown(wait=True, timeout=5.0, force=False)
2025-10-15 12:58:33,663 - APP.ui.app_ui - INFO - Ứng dụng đã đóng thành công.
2025-10-15 12:58:33,666 - __main__ - INFO - Ứng dụng đã đóng thành công.
2025-10-15 13:26:44,808 - APP.persistence.log_handler - INFO - Đã cấu hình logging xoay vòng. File log: Log\app_debug.log, Size: 5MB, Backups: 5
2025-10-15 13:26:44,808 - APP.persistence.log_handler - DEBUG - Hoàn tất thiết lập logging cho ứng dụng.
2025-10-15 13:26:44,809 - __main__ - INFO - Ứng dụng đang khởi động...
2025-10-15 13:26:44,967 - APP.ui.app_ui - DEBUG - Bắt đầu khởi tạo AppUI.
2025-10-15 13:26:44,968 - APP.utils.threading_utils - INFO - Khởi tạo ThreadPoolExecutor với tối đa 10 luồng.
2025-10-15 13:26:44,969 - APP.ui.app_ui - DEBUG - Khởi tạo các biến Tkinter.
2025-10-15 13:26:44,970 - APP.utils.general_utils - DEBUG - Bắt đầu deobfuscate text với salt.
2025-10-15 13:26:44,970 - APP.utils.general_utils - DEBUG - Tạo machine key.
2025-10-15 13:26:44,971 - APP.utils.general_utils - DEBUG - Đã tạo machine key. Độ dài: 32 bytes.
2025-10-15 13:26:44,971 - APP.utils.general_utils - DEBUG - Thực hiện XOR bytes.
2025-10-15 13:26:44,971 - APP.utils.general_utils - DEBUG - Đã deobfuscate text thành công.
2025-10-15 13:26:44,973 - APP.ui.app_ui - DEBUG - Các biến Tkinter đã được khởi tạo.
2025-10-15 13:26:44,976 - APP.ui.utils.timeframe_detector - DEBUG - TimeframeDetector đã được khởi tạo và biên dịch 9 mẫu regex.
2025-10-15 13:26:44,976 - APP.ui.utils.ui_builder - DEBUG - Bắt đầu build_ui.
2025-10-15 13:26:45,075 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.symbols' vào nhóm 'chart.init' (metadata={'component': 'chart'})
2025-10-15 13:26:45,077 - APP.services.mt5_service - DEBUG - Bắt đầu get_all_symbols.
2025-10-15 13:26:45,084 - APP.services.mt5_service - DEBUG - Bắt đầu ensure_initialized. Path: None
2025-10-15 13:26:45,086 - APP.services.mt5_service - DEBUG - Bắt đầu connect MT5. Path: None
2025-10-15 13:26:45,102 - APP.services.mt5_service - INFO - Kết nối MT5 thành công.
2025-10-15 13:26:45,103 - APP.services.mt5_service - DEBUG - Kết thúc connect MT5.
2025-10-15 13:26:45,103 - APP.services.mt5_service - DEBUG - Kết thúc ensure_initialized. Kết quả: True
2025-10-15 13:26:45,113 - APP.services.mt5_service - DEBUG - Đã lấy được 357 symbols.
2025-10-15 13:26:45,115 - APP.utils.threading_utils - DEBUG - Task 'chart.symbols' (group=chart.init) hoàn tất sau 0.04s
2025-10-15 13:26:45,307 - APP.ui.components.chart_tab - DEBUG - ChartTab UI đã được khởi tạo hoàn chỉnh.
2025-10-15 13:26:45,545 - APP.ui.utils.ui_builder - DEBUG - Kết thúc build_ui.
2025-10-15 13:26:45,545 - APP.ui.components.history_manager - DEBUG - Bắt đầu liên kết các widget UI cho HistoryManager.
2025-10-15 13:26:45,546 - APP.ui.components.history_manager - DEBUG - Đã tạo md_manager cho history_list.
2025-10-15 13:26:45,546 - APP.ui.components.history_manager - DEBUG - Đã tạo json_manager cho json_list.
2025-10-15 13:26:45,547 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.update_models' vào nhóm 'ui.io.models' (metadata={'component': 'ui', 'operation': 'update_models'})
2025-10-15 13:26:45,548 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.update_models vào group ui.io.models (metadata={'component': 'ui', 'operation': 'update_models'})
2025-10-15 13:26:45,548 - APP.ui.app_ui - DEBUG - Bắt đầu worker cập nhật danh sách mô hình AI.
2025-10-15 13:26:45,549 - APP.ui.app_ui - DEBUG - Bắt đầu áp dụng cấu hình lên UI.
2025-10-15 13:26:45,550 - APP.ui.app_ui - DEBUG - Bắt đầu quá trình tải file từ thư mục: C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots.
2025-10-15 13:26:45,562 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.scan_folder' vào nhóm 'ui.io.scan' (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 13:26:45,564 - APP.ui.app_ui - DEBUG - Luồng quét thư mục bắt đầu cho: C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots.
2025-10-15 13:26:45,564 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.scan_folder vào group ui.io.scan (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 13:26:45,566 - APP.ui.app_ui - DEBUG - Symbol đã thay đổi thành: XAUUSD, đang đồng bộ hóa các thành phần.
2025-10-15 13:26:45,566 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 13:26:45,567 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 13:26:45,567 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,575 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 13:26:45,575 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,587 - APP.ui.app_ui - INFO - Luồng quét đã hoàn tất, tìm thấy 4 file.
2025-10-15 13:26:45,589 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 13:26:45,590 - APP.utils.threading_utils - DEBUG - Task 'ui.io.scan_folder' (group=ui.io.scan) hoàn tất sau 0.03s
2025-10-15 13:26:45,591 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,597 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,597 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 13:26:45,598 - APP.ui.app_ui - DEBUG - Thông báo cho ChartTab để vẽ lại biểu đồ.
2025-10-15 13:26:45,624 - APP.ui.components.chart_tab - DEBUG - Resetting chart stream due to config change (event=None)
2025-10-15 13:26:45,626 - APP.ui.components.chart_tab - INFO - ChartTab đã dừng stream dữ liệu.
2025-10-15 13:26:45,627 - APP.ui.controllers.chart_controller - INFO - Khởi động ChartController cho symbol=XAUUSD
2025-10-15 13:26:45,628 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M15', 'candles': 150, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:45,631 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:45,633 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M15', 'candles': 150, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:45,635 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:45,636 - APP.ui.components.chart_tab - INFO - ChartTab đã bắt đầu stream dữ liệu.
2025-10-15 13:26:45,675 - APP.ui.components.chart_tab - DEBUG - Resetting chart stream due to config change (event=None)
2025-10-15 13:26:45,678 - APP.ui.controllers.chart_controller - INFO - Dừng ChartController stream hiện tại.
2025-10-15 13:26:45,701 - APP.utils.threading_utils - INFO - Cancel group 'chart.refresh' → task 'chart.info'
2025-10-15 13:26:45,711 - APP.utils.threading_utils - INFO - Cancel group 'chart.refresh' → task 'chart.draw'
2025-10-15 13:26:45,731 - APP.ui.components.chart_tab - INFO - ChartTab đã dừng stream dữ liệu.
2025-10-15 13:26:45,732 - APP.ui.controllers.chart_controller - INFO - Khởi động ChartController cho symbol=XAUUSD
2025-10-15 13:26:45,733 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:45,766 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:45,776 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:45,781 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:45,784 - APP.ui.components.chart_tab - INFO - ChartTab đã bắt đầu stream dữ liệu.
2025-10-15 13:26:45,792 - APP.services.gemini_service - INFO - Đã tìm thấy 41 model khả dụng.
2025-10-15 13:26:45,805 - APP.utils.threading_utils - DEBUG - Task 'ui.io.update_models' (group=ui.io.models) hoàn tất sau 0.26s
2025-10-15 13:26:45,806 - APP.ui.app_ui - INFO - Chuyển đổi Autorun sang: Bật
2025-10-15 13:26:45,807 - APP.ui.app_ui - DEBUG - Lên lịch chạy tự động tiếp theo sau 60000ms.
2025-10-15 13:26:45,808 - APP.ui.components.prompt_manager - DEBUG - Yêu cầu tải prompts từ đĩa. Silent: True
2025-10-15 13:26:45,808 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._load_prompts_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_load_prompts_worker'})
2025-10-15 13:26:45,809 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._load_prompts_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_load_prompts_worker'})
2025-10-15 13:26:45,809 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 13:26:45,810 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 13:26:45,811 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,811 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,811 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 13:26:45,812 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,812 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,815 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:45,816 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:45,818 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:45,819 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:45,820 - APP.services.te_service - INFO - Đăng nhập thành công vào Trading Economics API với định dạng key username/password.
2025-10-15 13:26:45,820 - APP.services.news_service - DEBUG - Cấu hình NewsService đã được cập nhật.
2025-10-15 13:26:45,820 - APP.utils.threading_utils - DEBUG - Gửi task 'news.refresh.autorun' vào nhóm 'news.polling' (metadata={'component': 'news', 'priority': 'autorun', 'timeout_sec': 20})
2025-10-15 13:26:45,821 - APP.ui.app_ui - INFO - Đã áp dụng cấu hình lên UI thành công.
2025-10-15 13:26:45,821 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:45,823 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:45,824 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 13:26:45,824 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 13:26:45,824 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 13:26:45,825 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 13:26:45,825 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:45,826 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: refresh_all_lists
2025-10-15 13:26:45,826 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 13:26:45,827 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 13:26:45,829 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,830 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,830 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 13:26:45,831 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,832 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:26:45,833 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:45,851 - APP.ui.app_ui - INFO - Phát hiện symbol XAUUSD từ ảnh (auto=True, giữ symbol hiện tại XAUUSD).
2025-10-15 13:26:45,852 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:45,852 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui_success
2025-10-15 13:26:45,853 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 13:26:45,854 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 13:26:45,855 - APP.ui.components.prompt_manager - DEBUG - Yêu cầu tải prompts từ đĩa. Silent: False
2025-10-15 13:26:45,855 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._load_prompts_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_load_prompts_worker'})
2025-10-15 13:26:45,856 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._load_prompts_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_load_prompts_worker'})
2025-10-15 13:26:45,856 - APP.ui.app_ui - DEBUG - AppUI đã khởi tạo xong.
2025-10-15 13:26:46,041 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 13:26:46,052 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 13:26:46,055 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.46s
2025-10-15 13:26:46,059 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.48s
2025-10-15 13:26:46,064 - APP.ui.components.prompt_manager - DEBUG - Worker bắt đầu đọc các file prompt.
2025-10-15 13:26:46,066 - APP.ui.components.prompt_manager - DEBUG - Bắt đầu chuẩn hóa prompt. Độ dài raw: 4058
2025-10-15 13:26:46,067 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 13:26:46,130 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành JSON.
2025-10-15 13:26:46,136 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành Python literal.
2025-10-15 13:26:46,136 - APP.ui.components.prompt_manager - DEBUG - Không thể chuẩn hóa, trả về văn bản thô.
2025-10-15 13:26:46,138 - APP.ui.components.prompt_manager - DEBUG - Bắt đầu chuẩn hóa prompt. Độ dài raw: 4058
2025-10-15 13:26:46,138 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành JSON.
2025-10-15 13:26:46,139 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành Python literal.
2025-10-15 13:26:46,143 - APP.ui.components.prompt_manager - DEBUG - Không thể chuẩn hóa, trả về văn bản thô.
2025-10-15 13:26:46,178 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:46,188 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 13:26:46,188 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._load_prompts_worker' (group=ui.misc) hoàn tất sau 0.13s
2025-10-15 13:26:46,191 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.12s
2025-10-15 13:26:46,192 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:46,193 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 13:26:46,194 - APP.utils.threading_utils - DEBUG - Gửi task 'news.provider.fmp' vào nhóm 'news.polling' (metadata={'component': 'news', 'provider': 'fmp', 'priority': 'autorun'})
2025-10-15 13:26:46,195 - APP.utils.threading_utils - DEBUG - Gửi task 'news.provider.te' vào nhóm 'news.polling' (metadata={'component': 'news', 'provider': 'te', 'priority': 'autorun'})
2025-10-15 13:26:46,198 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:46,199 - APP.ui.components.prompt_manager - DEBUG - Cập nhật UI với nội dung prompt đã tải.
2025-10-15 13:26:46,206 - APP.ui.components.prompt_manager - DEBUG - Kết thúc cập nhật UI cho prompts.
2025-10-15 13:26:46,232 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:46,268 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 13:26:46,293 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.10s
2025-10-15 13:26:46,402 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,403 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,404 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:46,404 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:46,404 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:46,405 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,406 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,407 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,407 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,408 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:46,408 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M15', num_candles=150, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:46,409 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,410 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,411 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,411 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:46,412 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:46,412 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,412 - APP.utils.threading_utils - INFO - Task 'chart.info' (group=chart.refresh) bị hủy sau 0.78s
2025-10-15 13:26:46,417 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,418 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,421 - APP.ui.controllers.chart_controller - DEBUG - Future chart.info bị cancel, không cập nhật UI.
2025-10-15 13:26:46,422 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:46,424 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:46,427 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:46,471 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 13:26:46,472 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 13:26:46,474 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,477 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,478 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:46,478 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,480 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M15', num_candles=150, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:46,481 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:46,481 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:46,521 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 13:26:46,525 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.05s
2025-10-15 13:26:46,526 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 13:26:46,527 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.06s
2025-10-15 13:26:46,610 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:46,613 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:46,974 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:46,976 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:46,977 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:47,478 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:47,480 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:47,480 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:47,982 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:47,984 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:47,985 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 1.46s
2025-10-15 13:26:47,986 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:47,986 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:47,986 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:47,987 - APP.ui.components.prompt_manager - DEBUG - Worker bắt đầu đọc các file prompt.
2025-10-15 13:26:47,987 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.789
2025-10-15 13:26:47,988 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.789
2025-10-15 13:26:47,988 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.704
2025-10-15 13:26:47,989 - APP.ui.components.prompt_manager - DEBUG - Bắt đầu chuẩn hóa prompt. Độ dài raw: 4058
2025-10-15 13:26:48,000 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 464, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:48,018 - APP.services.fmp_service - DEBUG - Đang lấy dữ liệu lịch kinh tế từ investpy...
2025-10-15 13:26:48,024 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 463, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:48,034 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 463, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:48,040 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 13:26:48,160 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:48,165 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:48,189 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành JSON.
2025-10-15 13:26:48,242 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:48,256 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 13:26:48,279 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:48,316 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:48,365 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành Python literal.
2025-10-15 13:26:48,369 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:48,426 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:48,427 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:48,432 - APP.ui.components.prompt_manager - DEBUG - Không thể chuẩn hóa, trả về văn bản thô.
2025-10-15 13:26:48,434 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:48,437 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:48,439 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:48,442 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:48,442 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,443 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,443 - APP.ui.components.prompt_manager - DEBUG - Bắt đầu chuẩn hóa prompt. Độ dài raw: 4058
2025-10-15 13:26:48,443 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,444 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:48,444 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:48,445 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành JSON.
2025-10-15 13:26:48,445 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:48,446 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:48,446 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:48,447 - APP.ui.components.prompt_manager - DEBUG - Không thể phân tích raw text thành Python literal.
2025-10-15 13:26:48,447 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:48,451 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:48,500 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:48,503 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,506 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:48,507 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:48,509 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:48,514 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:48,515 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,535 - APP.ui.components.prompt_manager - DEBUG - Không thể chuẩn hóa, trả về văn bản thô.
2025-10-15 13:26:48,583 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._load_prompts_worker' (group=ui.misc) hoàn tất sau 0.60s
2025-10-15 13:26:48,584 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,584 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:48,585 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,585 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:48,586 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:48,586 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:48,587 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:48,589 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:48,590 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:48,592 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:48,592 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,595 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:48,597 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,598 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:48,598 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,599 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:48,599 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:48,599 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:48,600 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:48,602 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:48,602 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:48,606 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:48,606 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,612 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:48,620 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:48,621 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:48,624 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:48,626 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:48,628 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:48,629 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:48,631 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:48,636 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:48,637 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:48,637 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:46+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:48,638 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:48,643 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:46+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:48,644 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:46+07:00
2025-10-15 13:26:48,645 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:46+07:00 trong DST: True
2025-10-15 13:26:48,645 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:48,646 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:48,646 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:48,673 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:48,674 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:48,674 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.924257640183
2025-10-15 13:26:48,676 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:48,680 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.924257640183, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:48,680 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:48,681 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:48,681 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:48,682 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:48,682 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:48,683 - APP.ui.components.prompt_manager - DEBUG - Cập nhật UI với nội dung prompt đã tải.
2025-10-15 13:26:48,683 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:46+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:48,683 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.7209127952465
2025-10-15 13:26:48,684 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:48,684 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:46+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:48,685 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:48,685 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:47+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:48,685 - APP.ui.components.prompt_manager - DEBUG - Kết thúc cập nhật UI cho prompts.
2025-10-15 13:26:48,686 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:46+07:00
2025-10-15 13:26:48,686 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.775866179408
2025-10-15 13:26:48,687 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:47+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:48,688 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:46+07:00 trong DST: True
2025-10-15 13:26:48,688 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:48,689 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:48,689 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:47+07:00
2025-10-15 13:26:48,690 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:48,690 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.203267412267
2025-10-15 13:26:48,691 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:47+07:00 trong DST: True
2025-10-15 13:26:48,691 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:48,691 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:48,692 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:48,693 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:48,693 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.4769618142045
2025-10-15 13:26:48,693 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:48,694 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:48,694 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:48,695 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.924257640183
2025-10-15 13:26:48,697 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:48,698 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.60919614953
2025-10-15 13:26:48,703 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.924257640183, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:48,706 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.924257640183
2025-10-15 13:26:48,707 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:48,708 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:48,716 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.924257640183, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:48,725 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.30019462574
2025-10-15 13:26:48,726 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.7209127952465
2025-10-15 13:26:48,728 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:48,732 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:48,763 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.8410673901
2025-10-15 13:26:48,764 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.7209127952465
2025-10-15 13:26:48,764 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:48,768 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:48,776 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.443031178948
2025-10-15 13:26:48,815 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.7209127952465, 'ema200': 4194.775866179408}, 'M5': {'ema50': 4194.203267412267, 'ema200': 4185.4769618142045}, 'M15': {'ema50': 4187.60919614953, 'ema200': 4150.30019462574}, 'H1': {'ema50': 4142.8410673901, 'ema200': 4078.443031178948}}
2025-10-15 13:26:48,824 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:48,825 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.775866179408
2025-10-15 13:26:48,825 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:48,826 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.900577551661706, TRs count: 179
2025-10-15 13:26:48,827 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:48,827 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.775866179408
2025-10-15 13:26:48,828 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:48,862 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.203267412267
2025-10-15 13:26:48,863 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:48,888 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.612433907935187, TRs count: 119
2025-10-15 13:26:48,889 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:48,890 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.4769618142045
2025-10-15 13:26:48,924 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:48,926 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.203267412267
2025-10-15 13:26:48,927 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:48,928 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:48,929 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:48,930 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.60919614953
2025-10-15 13:26:48,930 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:48,930 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.4769618142045
2025-10-15 13:26:48,931 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:48,931 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:48,931 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:48,932 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.30019462574
2025-10-15 13:26:48,932 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.900577551661706, 'M1': 2.612433907935187, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:48,933 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:48,934 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:48,935 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.60919614953
2025-10-15 13:26:48,935 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.789, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:48,936 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.8410673901
2025-10-15 13:26:48,936 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:48,937 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:48,937 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:48,938 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.30019462574
2025-10-15 13:26:48,938 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:48,938 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.443031178948
2025-10-15 13:26:48,939 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:48,940 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:48,940 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.7209127952465, 'ema200': 4194.775866179408}, 'M5': {'ema50': 4194.203267412267, 'ema200': 4185.4769618142045}, 'M15': {'ema50': 4187.60919614953, 'ema200': 4150.30019462574}, 'H1': {'ema50': 4142.8410673901, 'ema200': 4078.443031178948}}
2025-10-15 13:26:48,941 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.8410673901
2025-10-15 13:26:48,943 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:48,943 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:48,944 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:48,945 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13983.999999999469
2025-10-15 13:26:48,945 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.900577551661706, TRs count: 179
2025-10-15 13:26:48,946 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.443031178948
2025-10-15 13:26:48,946 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 103184.99999999994
2025-10-15 13:26:48,947 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:48,947 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.7209127952465, 'ema200': 4194.775866179408}, 'M5': {'ema50': 4194.203267412267, 'ema200': 4185.4769618142045}, 'M15': {'ema50': 4187.60919614953, 'ema200': 4150.30019462574}, 'H1': {'ema50': 4142.8410673901, 'ema200': 4078.443031178948}}
2025-10-15 13:26:48,948 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7677.999999999884
2025-10-15 13:26:48,948 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.612433907935187, TRs count: 119
2025-10-15 13:26:48,948 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:48,949 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 32152.999999999338
2025-10-15 13:26:48,951 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:48,951 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:48,952 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:48,953 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.900577551661706, TRs count: 179
2025-10-15 13:26:48,957 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:48,958 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13983.999999999469}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 103184.99999999994}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7677.999999999884}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 32152.999999999338}]
2025-10-15 13:26:48,982 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:48,983 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.612433907935187, TRs count: 119
2025-10-15 13:26:48,984 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:49,025 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:49,052 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:49,053 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:49,054 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:49,054 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:49,055 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.900577551661706, 'M1': 2.612433907935187, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:49,055 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:49,056 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:49,056 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:49,057 - APP.services.mt5_service - DEBUG - Position in day range: 0.619223602484471
2025-10-15 13:26:49,057 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:49,058 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.789, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:49,058 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:46+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:49,059 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.900577551661706, 'M1': 2.612433907935187, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:49,059 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:49,060 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:46+07:00
2025-10-15 13:26:49,060 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:49,061 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:49,061 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:46+07:00 trong DST: True
2025-10-15 13:26:49,062 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.704, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:49,062 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:49,063 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:49,063 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:49,063 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:49,064 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:49,064 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:49,065 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13983.999999999469
2025-10-15 13:26:49,065 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:49,066 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,066 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 103184.99999999994
2025-10-15 13:26:49,066 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:49,067 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,067 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7677.999999999884
2025-10-15 13:26:49,067 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:49,068 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7800', 'price': 4193.78, 'distance_pips': 0.9}, {'level': '7825', 'price': 4193.782, 'distance_pips': 0.65}, {'level': '7850', 'price': 4193.785, 'distance_pips': 0.4}, {'level': '7875', 'price': 4193.787, 'distance_pips': 0.15}]
2025-10-15 13:26:49,068 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 32152.999999999338
2025-10-15 13:26:49,069 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13898.999999999432
2025-10-15 13:26:49,069 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6270572613665943}
2025-10-15 13:26:49,069 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:49,070 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 103099.99999999991
2025-10-15 13:26:49,070 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,071 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13983.999999999469}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 103184.99999999994}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7677.999999999884}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 32152.999999999338}]
2025-10-15 13:26:49,071 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7592.999999999847
2025-10-15 13:26:49,071 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,072 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:49,072 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 32067.9999999993
2025-10-15 13:26:49,072 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:49,073 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:49,073 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:49,074 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.789
2025-10-15 13:26:49,075 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:49,075 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13898.999999999432}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 103099.99999999991}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7592.999999999847}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 32067.9999999993}]
2025-10-15 13:26:49,075 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,076 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:49,076 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:49,077 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:49,077 - APP.services.mt5_service - DEBUG - Position in day range: 0.619223602484471
2025-10-15 13:26:49,080 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:49,083 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,108 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:46+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:49,109 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:46+07:00
2025-10-15 13:26:49,111 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:49,111 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:49,112 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:46+07:00 trong DST: True
2025-10-15 13:26:49,112 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:49,112 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:49,113 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:49,116 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.789
2025-10-15 13:26:49,118 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,125 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:49,137 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,138 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:49,139 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,140 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,144 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:49,145 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:49,148 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.789
2025-10-15 13:26:49,161 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7800', 'price': 4193.78, 'distance_pips': 0.9}, {'level': '7825', 'price': 4193.782, 'distance_pips': 0.65}, {'level': '7850', 'price': 4193.785, 'distance_pips': 0.4}, {'level': '7875', 'price': 4193.787, 'distance_pips': 0.15}]
2025-10-15 13:26:49,162 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,164 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6270572613665943}
2025-10-15 13:26:49,166 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:49,168 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,169 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,169 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,170 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:49,171 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:49,172 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:49,173 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.789
2025-10-15 13:26:49,176 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,177 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.789
2025-10-15 13:26:49,178 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:49,178 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:49,178 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,179 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,180 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:49,180 - APP.services.mt5_service - DEBUG - Position in day range: 0.6179037267080728
2025-10-15 13:26:49,180 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:49,181 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,183 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:47+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:49,183 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:49,184 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.789
2025-10-15 13:26:49,184 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,185 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:49,186 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:49,186 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,187 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,188 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,188 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:49,189 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:47+07:00
2025-10-15 13:26:49,189 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:49,190 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:49,190 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:49,191 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:49,191 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:47+07:00 trong DST: True
2025-10-15 13:26:49,192 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:49,192 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.789
2025-10-15 13:26:49,193 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:49,193 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:49,194 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,194 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:49,195 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:49,195 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:49,196 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:49,196 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:49,197 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,197 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,198 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:49,198 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:49,199 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,199 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:49,200 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:49,200 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7000', 'price': 4193.7, 'distance_pips': 0.4}, {'level': '7025', 'price': 4193.702, 'distance_pips': 0.15}, {'level': '7050', 'price': 4193.705, 'distance_pips': 0.1}, {'level': '7075', 'price': 4193.707, 'distance_pips': 0.35}]
2025-10-15 13:26:49,201 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:49,201 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.789
2025-10-15 13:26:49,202 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6270572613665943}
2025-10-15 13:26:49,202 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:49,203 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,206 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:49,207 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:49,207 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,212 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,213 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:49,216 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:49,218 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:49,219 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:49,223 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,234 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:49,236 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,238 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,238 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:49,240 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:49,240 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:49,257 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:49,260 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,265 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:49,267 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:49,267 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:49,268 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:49,269 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:49,269 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:49,270 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:49,272 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:49,273 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:49,274 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:49,274 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:49,276 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,277 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:26:49,277 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:49,278 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,279 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:49,280 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:49,280 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.789, 'ask': 4193.826, 'last': 0.0, 'time': 1760534806}
2025-10-15 13:26:49,281 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.704
2025-10-15 13:26:49,282 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:49,282 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:26:49,283 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,283 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:49,284 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:26:49,285 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:49,287 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:49,288 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,289 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,290 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:49,291 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,292 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:49,293 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 463, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:49,294 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:49,294 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:49,294 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 492, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:49,295 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,299 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:26:49,301 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.704
2025-10-15 13:26:49,330 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,333 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,334 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:49,335 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,335 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,336 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:26:49,336 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,337 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,337 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:49,339 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:49,342 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:49,343 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,345 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:49,346 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:49,346 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,347 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:49,348 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:49,348 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,350 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.704
2025-10-15 13:26:49,351 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:26:49,352 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,353 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,353 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:49,354 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,355 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:49,356 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:26:49,357 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6270572613665943}
2025-10-15 13:26:49,358 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,362 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:49,401 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:49,402 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:49,403 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,404 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:49,406 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:49,406 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.789, 'ask': 4193.826, 'last': 0.0, 'time': 1760534806}
2025-10-15 13:26:49,407 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:26:49,408 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.704
2025-10-15 13:26:49,408 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,409 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:26:49,410 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:49,410 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,411 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 3.63s
2025-10-15 13:26:49,411 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:49,412 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:49,412 - APP.services.te_service - DEBUG - Đang thực hiện cuộc gọi API đến Trading Economics...
2025-10-15 13:26:49,414 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:49,414 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:26:49,415 - APP.services.te_service - WARNING - Bỏ qua xác minh SSL cho Trading Economics API.
2025-10-15 13:26:49,415 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:49,416 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,419 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,456 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,462 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,463 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13983.999999999469}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 103184.99999999994}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7677.999999999884}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 32152.999999999338}]
2025-10-15 13:26:49,463 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:49,464 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:26:46+07:00
2025-10-15 13:26:49,465 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:49,466 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:26:49,466 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:49,467 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:49,470 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:49,471 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:49,472 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:49,472 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:49,472 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:49,473 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:49,483 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:49,528 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:49,599 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:49,601 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:49,604 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:49,606 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:49,644 - APP.services.te_service - WARNING - Trading Economics trả về lỗi 403 - có thể do API key không hợp lệ hoặc hết hạn. Trả về danh sách rỗng để tránh dừng hệ thống.
2025-10-15 13:26:49,648 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:49,650 - APP.services.te_service - DEBUG - Đã khôi phục context SSL mặc định.
2025-10-15 13:26:49,650 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:49,651 - APP.utils.threading_utils - DEBUG - Task 'news.provider.te' (group=news.polling) hoàn tất sau 0.24s
2025-10-15 13:26:49,651 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:49,652 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:49,652 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:49,653 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:49,655 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:49,656 - APP.utils.threading_utils - INFO - Task 'chart.draw' (group=chart.refresh) bị hủy sau 4.02s
2025-10-15 13:26:49,657 - APP.ui.controllers.chart_controller - DEBUG - Future chart.draw bị cancel, không cập nhật UI.
2025-10-15 13:26:49,659 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:26:49,660 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:26:49,661 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:26:49,662 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 3.90s
2025-10-15 13:26:50,006 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:50,007 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:50,008 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:26:50,008 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:26:50,009 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:26:50,058 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:50,059 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:50,060 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:50,063 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:50,149 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:50,150 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:50,151 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:50,151 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:50,152 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:50,153 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:50,153 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:50,154 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:50,156 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:50,157 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:50,158 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:50,187 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:50,193 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:50,195 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:50,196 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:50,393 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 13:26:50,464 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 13:26:50,655 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:50,657 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:50,658 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:50,852 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:26:50,853 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:26:50,866 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.01s
2025-10-15 13:26:50,962 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:51,159 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:51,161 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:51,161 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:51,162 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:51,162 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.806
2025-10-15 13:26:51,163 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.79
2025-10-15 13:26:51,170 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 458, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:51,186 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 458, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:51,289 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:51,292 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:51,293 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:51,294 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:51,294 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:51,295 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:51,298 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:51,300 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:51,301 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:51,301 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:51,302 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:51,302 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:51,303 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:51,323 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:51,328 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:51,350 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:51,351 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:51,352 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:51,353 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:51,353 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:51,354 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:51,354 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:51,357 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:51,359 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:51,359 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:51,361 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:51,361 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:51,362 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:51,364 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:51,383 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:51,386 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:51,389 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:51,390 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:51,390 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:51,391 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:51,392 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:51,392 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:51,398 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:51,404 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:51,406 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:51,415 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:51,416 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:51,417 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:51,417 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:51,418 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:51,418 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:49+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:51,419 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:51,419 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:49+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:51,420 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:50+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:51,420 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:49+07:00
2025-10-15 13:26:51,421 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:50+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:51,421 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:49+07:00 trong DST: True
2025-10-15 13:26:51,421 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:50+07:00
2025-10-15 13:26:51,422 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:51,422 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:50+07:00 trong DST: True
2025-10-15 13:26:51,423 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:51,424 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:51,424 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:51,425 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:51,428 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:51,438 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:51,444 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.92479689786
2025-10-15 13:26:51,446 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:51,449 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.92479689786, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:51,450 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.92479689786
2025-10-15 13:26:51,450 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:51,455 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.92479689786, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:51,456 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.724285344266
2025-10-15 13:26:51,456 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:51,463 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:51,465 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.724285344266
2025-10-15 13:26:51,466 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.776721900801
2025-10-15 13:26:51,468 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:51,471 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:51,476 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.776721900801
2025-10-15 13:26:51,477 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.206639961287
2025-10-15 13:26:51,478 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:51,479 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:51,480 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.206639961287
2025-10-15 13:26:51,480 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.477817535598
2025-10-15 13:26:51,481 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:51,481 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:51,482 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.477817535598
2025-10-15 13:26:51,482 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.61256869855
2025-10-15 13:26:51,482 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:51,483 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:51,483 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.61256869855
2025-10-15 13:26:51,484 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.301050347133
2025-10-15 13:26:51,484 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:51,485 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:51,486 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.301050347133
2025-10-15 13:26:51,486 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.844439939119
2025-10-15 13:26:51,487 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:51,487 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:51,487 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.844439939119
2025-10-15 13:26:51,488 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.443886900341
2025-10-15 13:26:51,495 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:51,498 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.724285344266, 'ema200': 4194.776721900801}, 'M5': {'ema50': 4194.206639961287, 'ema200': 4185.477817535598}, 'M15': {'ema50': 4187.61256869855, 'ema200': 4150.301050347133}, 'H1': {'ema50': 4142.844439939119, 'ema200': 4078.443886900341}}
2025-10-15 13:26:51,508 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.443886900341
2025-10-15 13:26:51,508 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:51,509 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.724285344266, 'ema200': 4194.776721900801}, 'M5': {'ema50': 4194.206639961287, 'ema200': 4185.477817535598}, 'M15': {'ema50': 4187.61256869855, 'ema200': 4150.301050347133}, 'H1': {'ema50': 4142.844439939119, 'ema200': 4078.443886900341}}
2025-10-15 13:26:51,510 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:26:51,510 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:51,511 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:51,511 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:26:51,512 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.61364819364946, TRs count: 119
2025-10-15 13:26:51,513 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:51,513 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:51,514 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.61364819364946, TRs count: 119
2025-10-15 13:26:51,515 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:51,515 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:51,516 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:51,517 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:51,518 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:51,525 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:51,527 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:51,529 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.61364819364946, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:51,532 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:51,533 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.61364819364946, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:51,539 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.79, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:51,540 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:51,541 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:51,542 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.806, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:51,543 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:51,543 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:51,544 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:51,544 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:51,544 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:51,544 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:51,545 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13984.999999999673
2025-10-15 13:26:51,545 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:51,545 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 103186.00000000015
2025-10-15 13:26:51,546 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 14000.999999999294
2025-10-15 13:26:51,546 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7679.000000000087
2025-10-15 13:26:51,546 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 103201.99999999977
2025-10-15 13:26:51,547 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 32153.99999999954
2025-10-15 13:26:51,547 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:51,548 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13984.999999999673}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 103186.00000000015}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7679.000000000087}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 32153.99999999954}]
2025-10-15 13:26:51,549 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7694.999999999709
2025-10-15 13:26:51,550 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:51,550 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 32169.999999999163
2025-10-15 13:26:51,553 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:51,559 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:51,565 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:51,569 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 14000.999999999294}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 103201.99999999977}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7694.999999999709}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 32169.999999999163}]
2025-10-15 13:26:51,570 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:51,571 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:51,572 - APP.services.mt5_service - DEBUG - Position in day range: 0.6192391304347846
2025-10-15 13:26:51,573 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:51,574 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:50+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:51,574 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:51,575 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:50+07:00
2025-10-15 13:26:51,576 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:51,576 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:50+07:00 trong DST: True
2025-10-15 13:26:51,577 - APP.services.mt5_service - DEBUG - Position in day range: 0.6194875776397477
2025-10-15 13:26:51,577 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:51,577 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:49+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:51,578 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:51,578 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:49+07:00
2025-10-15 13:26:51,578 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:51,579 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:49+07:00 trong DST: True
2025-10-15 13:26:51,579 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:51,580 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:51,580 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:51,580 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:51,581 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7900', 'price': 4193.79, 'distance_pips': 0.0}, {'level': '7925', 'price': 4193.792, 'distance_pips': 0.25}, {'level': '7950', 'price': 4193.795, 'distance_pips': 0.5}, {'level': '7975', 'price': 4193.797, 'distance_pips': 0.75}]
2025-10-15 13:26:51,584 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:51,586 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:26:51,589 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:51,599 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:51,600 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:51,601 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:51,601 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8000', 'price': 4193.8, 'distance_pips': 0.6}, {'level': '8025', 'price': 4193.802, 'distance_pips': 0.35}, {'level': '8050', 'price': 4193.805, 'distance_pips': 0.1}, {'level': '8075', 'price': 4193.807, 'distance_pips': 0.15}]
2025-10-15 13:26:51,602 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:51,603 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:26:51,604 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.79
2025-10-15 13:26:51,604 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:51,604 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:51,605 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:51,605 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:51,605 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:51,606 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:51,607 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.806
2025-10-15 13:26:51,607 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:51,608 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:51,608 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:51,609 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:51,610 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.79
2025-10-15 13:26:51,611 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:51,612 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:51,635 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:51,637 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:51,637 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:51,638 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:51,639 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.806
2025-10-15 13:26:51,639 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:51,640 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:51,643 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:51,659 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:51,666 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:51,667 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 13:26:51,668 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:51,668 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:51,671 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.79
2025-10-15 13:26:51,674 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.806
2025-10-15 13:26:51,701 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:51,703 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:51,704 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:51,704 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:51,705 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:51,706 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:51,707 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:51,707 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:51,708 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:51,729 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:51,730 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.79
2025-10-15 13:26:51,731 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.806
2025-10-15 13:26:51,732 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:51,733 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:51,733 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:51,733 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:51,767 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:51,769 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:51,770 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:51,771 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:51,771 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:51,772 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:51,773 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:51,773 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:51,774 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:51,775 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:51,776 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:51,777 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:51,777 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:51,778 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:51,779 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:51,779 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:51,780 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:51,781 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:51,781 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:51,782 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:51,783 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:51,784 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:51,784 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:51,784 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:51,785 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:51,786 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:51,786 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:51,787 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:51,787 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:51,788 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:51,789 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:51,790 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:51,790 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:51,791 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:51,791 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:51,792 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:51,793 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:51,794 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:51,794 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:51,796 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:51,796 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:51,797 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:51,800 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:51,803 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 13:26:51,822 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:51,824 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:51,826 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:51,826 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:51,827 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:26:51,827 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:51,828 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:51,828 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:51,831 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:26:51,893 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:51,894 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:51,916 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:51,917 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:51,917 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:51,918 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.79, 'ask': 4193.827, 'last': 0.0, 'time': 1760534810}
2025-10-15 13:26:51,918 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:51,918 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:26:51,919 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:51,920 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.86s
2025-10-15 13:26:51,921 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:51,948 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:51,949 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:51,949 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:26:51,950 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:26:52,010 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.806, 'ask': 4193.843, 'last': 0.0, 'time': 1760534809}
2025-10-15 13:26:52,144 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:26:52,159 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:26:52,189 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:52,196 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:26:52,198 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:26:52,201 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:52,236 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:52,308 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:52,322 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 458, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:52,322 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 492, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:52,323 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:52,325 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:52,327 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:52,327 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:52,363 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:52,400 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:52,401 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:52,402 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:52,403 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:26:52,404 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:52,407 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:52,408 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:26:52,412 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:52,414 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:52,416 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:52,420 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:26:52,420 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:52,423 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:52,450 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 14000.999999999294}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 103201.99999999977}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7694.999999999709}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 32169.999999999163}]
2025-10-15 13:26:52,451 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:26:49+07:00
2025-10-15 13:26:52,452 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:26:52,453 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:26:52,492 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:26:52,493 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.43s
2025-10-15 13:26:52,495 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:52,497 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:52,498 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:52,498 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:52,499 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:52,499 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:52,500 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:52,500 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:52,541 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:52,542 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:52,543 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:26:52,544 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:26:52,544 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:26:52,860 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 13:26:52,873 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 13:26:53,001 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:53,003 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:53,004 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:53,005 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.48
2025-10-15 13:26:53,011 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 458, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:53,080 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:53,081 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:53,082 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:53,087 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:53,104 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:53,104 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:53,105 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:53,108 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:53,109 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:53,111 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:53,112 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:53,116 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:53,138 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:53,139 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:53,139 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:53,143 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:53,146 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:53,169 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:53,171 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:53,176 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:53,201 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:53,204 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:53,209 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:53,210 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:53,211 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:53,212 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:52+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:53,212 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:52+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:53,213 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:52+07:00
2025-10-15 13:26:53,215 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:52+07:00 trong DST: True
2025-10-15 13:26:53,216 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:53,217 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:53,218 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:53,220 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:53,223 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:53,223 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.924513376039
2025-10-15 13:26:53,224 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:53,229 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.924513376039, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:53,230 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:53,230 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:53,231 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:53,231 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.7111480893645
2025-10-15 13:26:53,232 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:53,232 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:53,233 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:53,233 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.773388567468
2025-10-15 13:26:53,265 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:53,271 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:53,405 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:53,479 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.1935027063855
2025-10-15 13:26:53,543 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:53,545 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.474484202265
2025-10-15 13:26:53,550 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:53,551 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.5994314436475
2025-10-15 13:26:53,552 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:53,552 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.2977170138
2025-10-15 13:26:53,554 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:53,555 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.831302684218
2025-10-15 13:26:53,556 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:53,557 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4405535670076
2025-10-15 13:26:53,558 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.7111480893645, 'ema200': 4194.773388567468}, 'M5': {'ema50': 4194.1935027063855, 'ema200': 4185.474484202265}, 'M15': {'ema50': 4187.5994314436475, 'ema200': 4150.2977170138}, 'H1': {'ema50': 4142.831302684218, 'ema200': 4078.4405535670076}}
2025-10-15 13:26:53,558 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:53,559 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:26:53,559 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:53,560 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.61364819364946, TRs count: 119
2025-10-15 13:26:53,561 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:53,561 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:53,562 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:53,665 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:53,703 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.61364819364946, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:53,708 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:53,709 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.48, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:53,709 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:53,710 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:53,711 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:53,711 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:53,712 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13674.999999999272
2025-10-15 13:26:53,712 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102875.99999999975
2025-10-15 13:26:53,714 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7368.999999999687
2025-10-15 13:26:53,715 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31843.99999999914
2025-10-15 13:26:53,715 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:53,716 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13674.999999999272}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102875.99999999975}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7368.999999999687}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31843.99999999914}]
2025-10-15 13:26:53,716 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:53,888 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:53,890 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:53,890 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:53,891 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:53,891 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:53,892 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.353
2025-10-15 13:26:53,892 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:53,901 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 458, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:53,915 - APP.services.mt5_service - DEBUG - Position in day range: 0.6144254658385051
2025-10-15 13:26:53,930 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:52+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:53,954 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:52+07:00
2025-10-15 13:26:53,983 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:53,983 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:52+07:00 trong DST: True
2025-10-15 13:26:53,984 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 13:26:53,986 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:53,987 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:54,013 - APP.services.fmp_service - INFO - Lấy thành công 402 sự kiện từ investpy cho 7 ngày tới.
2025-10-15 13:26:54,014 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:54,014 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:54,015 - APP.utils.threading_utils - DEBUG - Task 'news.provider.fmp' (group=news.polling) hoàn tất sau 6.00s
2025-10-15 13:26:54,019 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:54,022 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:54,046 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:54,047 - APP.ui.app_ui - DEBUG - Callback nhận được 144 sự kiện tin tức mới.
2025-10-15 13:26:54,048 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,049 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:54,049 - APP.services.news_service - INFO - NewsService làm mới cache (144 sự kiện, priority=autorun, source=network, latency=7.85s)
2025-10-15 13:26:54,050 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,050 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:54,072 - APP.utils.threading_utils - DEBUG - Task 'news.refresh.autorun' (group=news.polling) hoàn tất sau 7.88s
2025-10-15 13:26:54,073 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4700', 'price': 4193.47, 'distance_pips': 1.0}, {'level': '4725', 'price': 4193.472, 'distance_pips': 0.75}, {'level': '4750', 'price': 4193.475, 'distance_pips': 0.5}, {'level': '4775', 'price': 4193.477, 'distance_pips': 0.25}]
2025-10-15 13:26:54,076 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:54,077 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:26:54,078 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:54,081 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,081 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:54,098 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 13:26:54,099 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,100 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:54,102 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:54,104 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:54,105 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.48
2025-10-15 13:26:54,105 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:54,106 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:54,106 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:54,107 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:54,107 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:54,108 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:54,109 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:54,112 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:54,133 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:54,133 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:54,134 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:54,134 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:54,135 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.48
2025-10-15 13:26:54,136 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:54,136 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:54,139 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:54,139 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:54,140 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:54,141 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:54,143 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:54,144 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:54,166 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:54,167 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:53+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:54,167 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:54,168 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:53+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:54,168 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.48
2025-10-15 13:26:54,169 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:53+07:00
2025-10-15 13:26:54,170 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:54,171 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:53+07:00 trong DST: True
2025-10-15 13:26:54,171 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:54,174 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:54,179 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:54,194 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:54,195 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:54,196 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:54,196 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:54,198 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:54,199 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.48
2025-10-15 13:26:54,200 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.924490483747
2025-10-15 13:26:54,200 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:54,205 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.924490483747, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:54,206 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:54,207 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:54,229 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:54,230 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:54,230 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.707148089365
2025-10-15 13:26:54,231 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,231 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:54,231 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,232 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.772373642095
2025-10-15 13:26:54,232 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:54,232 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:54,233 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:54,233 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.189502706386
2025-10-15 13:26:54,234 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:54,235 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:54,235 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:54,236 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.473469276892
2025-10-15 13:26:54,236 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:54,237 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:54,237 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:54,240 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.595431443648
2025-10-15 13:26:54,257 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:54,258 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:54,259 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:54,260 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.296702088427
2025-10-15 13:26:54,260 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:54,261 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:54,261 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:54,262 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.827302684218
2025-10-15 13:26:54,262 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:54,262 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:54,263 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:54,263 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4395386416345
2025-10-15 13:26:54,264 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:54,264 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.707148089365, 'ema200': 4194.772373642095}, 'M5': {'ema50': 4194.189502706386, 'ema200': 4185.473469276892}, 'M15': {'ema50': 4187.595431443648, 'ema200': 4150.296702088427}, 'H1': {'ema50': 4142.827302684218, 'ema200': 4078.4395386416345}}
2025-10-15 13:26:54,264 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:54,265 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:54,265 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:54,266 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:26:54,267 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:54,268 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:54,268 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,269 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.61364819364946, TRs count: 119
2025-10-15 13:26:54,290 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,291 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:54,292 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:54,292 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:54,292 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:54,293 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:54,293 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:54,294 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:54,294 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:54,295 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.61364819364946, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:54,296 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:54,296 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:54,297 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:26:54,299 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:54,300 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.353, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:54,303 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:26:54,321 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:54,322 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,323 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:54,323 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.48, 'ask': 4193.517, 'last': 0.0, 'time': 1760534812}
2025-10-15 13:26:54,323 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:54,324 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:26:54,324 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:54,325 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.13s
2025-10-15 13:26:54,325 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:54,326 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13547.999999999774
2025-10-15 13:26:54,326 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102749.00000000025
2025-10-15 13:26:54,327 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7242.000000000189
2025-10-15 13:26:54,327 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31716.999999999643
2025-10-15 13:26:54,327 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:54,328 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13547.999999999774}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102749.00000000025}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7242.000000000189}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31716.999999999643}]
2025-10-15 13:26:54,328 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:54,330 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:54,331 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:54,331 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:54,332 - APP.services.mt5_service - DEBUG - Position in day range: 0.6124534161490719
2025-10-15 13:26:54,332 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:53+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:54,348 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:53+07:00
2025-10-15 13:26:54,349 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:53+07:00 trong DST: True
2025-10-15 13:26:54,351 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:54,351 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:54,352 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:54,352 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,352 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,353 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3500', 'price': 4193.35, 'distance_pips': 0.3}, {'level': '3525', 'price': 4193.352, 'distance_pips': 0.05}, {'level': '3550', 'price': 4193.355, 'distance_pips': 0.2}, {'level': '3575', 'price': 4193.358, 'distance_pips': 0.45}]
2025-10-15 13:26:54,353 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:26:54,354 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,354 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,355 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:54,355 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.353
2025-10-15 13:26:54,356 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:54,356 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:54,357 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:54,357 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:54,358 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:54,358 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.353
2025-10-15 13:26:54,359 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:54,359 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:54,360 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:54,360 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:54,361 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:54,362 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.353
2025-10-15 13:26:54,362 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:54,363 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:54,385 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:54,386 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:54,387 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:54,388 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.353
2025-10-15 13:26:54,388 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:54,389 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:54,389 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:54,390 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:54,391 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,392 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,392 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:54,393 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:54,393 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:54,393 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:54,394 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:54,394 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:54,415 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:54,416 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:54,417 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:54,419 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:54,419 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:54,420 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:54,455 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:54,486 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:54,507 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:54,578 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:54,580 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:54,595 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,625 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,627 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:54,628 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:54,629 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:54,630 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:54,632 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:54,634 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:54,635 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,638 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:26:54,639 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:26:54,644 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.353, 'ask': 4193.39, 'last': 0.0, 'time': 1760534813}
2025-10-15 13:26:54,705 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:26:54,734 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:26:54,757 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:26:54,759 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:26:54,761 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,762 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,763 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 458, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:54,764 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 492, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:54,791 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,793 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,796 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,825 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,826 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,826 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,827 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,827 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,828 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:26:54,829 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:54,851 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:54,852 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:26:54,852 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,853 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,853 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:54,854 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:26:54,854 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:54,854 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:54,855 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13547.999999999774}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102749.00000000025}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7242.000000000189}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31716.999999999643}]
2025-10-15 13:26:54,855 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:26:53+07:00
2025-10-15 13:26:54,856 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:26:54,857 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:26:54,858 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:26:54,859 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.65s
2025-10-15 13:26:54,921 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:54,922 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:54,924 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:26:54,926 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:26:54,926 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:26:55,210 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:55,211 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:55,213 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:55,215 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:55,222 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:55,242 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:55,243 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:55,243 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:55,245 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:55,245 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:55,246 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:55,246 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:55,247 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:55,247 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:55,248 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:55,249 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:55,250 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:55,250 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:55,251 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:55,752 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:55,754 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:55,755 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:55,965 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:26:55,966 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:26:55,976 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.01s
2025-10-15 13:26:56,043 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:56,256 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:56,258 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:56,258 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:56,259 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:56,259 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.466
2025-10-15 13:26:56,260 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.466
2025-10-15 13:26:56,276 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 456, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:56,281 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 456, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:56,387 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:56,390 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:56,391 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:56,392 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:56,393 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:56,393 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:56,395 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:56,398 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:56,398 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:56,398 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:56,399 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:56,399 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:56,400 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:56,401 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:56,404 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:56,408 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:56,408 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:56,409 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:56,409 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:56,410 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:56,410 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:56,411 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:56,413 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:56,414 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:56,415 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:56,415 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:56,416 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:56,416 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:56,417 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:56,418 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:56,421 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:56,424 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:56,425 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:56,425 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:56,426 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:56,446 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:56,447 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:56,448 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:56,450 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:56,453 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:56,455 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:56,456 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:56,458 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:56,458 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:56,474 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:56,475 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:56,476 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:55+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:56,477 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:55+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:56,478 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:55+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:56,478 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:55+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:56,479 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:55+07:00
2025-10-15 13:26:56,479 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:55+07:00
2025-10-15 13:26:56,479 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:55+07:00 trong DST: True
2025-10-15 13:26:56,480 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:55+07:00 trong DST: True
2025-10-15 13:26:56,480 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:56,480 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:56,481 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:56,481 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:56,482 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:56,482 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:56,483 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:56,486 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:56,487 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.924998465768
2025-10-15 13:26:56,487 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.924998465768
2025-10-15 13:26:56,496 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.924998465768, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:56,509 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.924998465768, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:56,510 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:56,511 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:56,511 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.711579461913
2025-10-15 13:26:56,511 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.711579461913
2025-10-15 13:26:56,512 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:56,512 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:56,513 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.773498020204
2025-10-15 13:26:56,513 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.773498020204
2025-10-15 13:26:56,514 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:56,514 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:56,514 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.193934078934
2025-10-15 13:26:56,515 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.193934078934
2025-10-15 13:26:56,515 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:56,516 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:56,518 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.474593655001
2025-10-15 13:26:56,518 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.474593655001
2025-10-15 13:26:56,519 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:56,539 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:56,540 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.599862816197
2025-10-15 13:26:56,541 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.599862816197
2025-10-15 13:26:56,541 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:56,542 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:56,542 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.297826466536
2025-10-15 13:26:56,542 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.297826466536
2025-10-15 13:26:56,543 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:56,543 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:56,544 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.831734056766
2025-10-15 13:26:56,544 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.831734056766
2025-10-15 13:26:56,544 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:56,545 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:56,545 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.440663019744
2025-10-15 13:26:56,546 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.440663019744
2025-10-15 13:26:56,546 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.711579461913, 'ema200': 4194.773498020204}, 'M5': {'ema50': 4194.193934078934, 'ema200': 4185.474593655001}, 'M15': {'ema50': 4187.599862816197, 'ema200': 4150.297826466536}, 'H1': {'ema50': 4142.831734056766, 'ema200': 4078.440663019744}}
2025-10-15 13:26:56,547 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:56,549 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:26:56,571 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:56,572 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.711579461913, 'ema200': 4194.773498020204}, 'M5': {'ema50': 4194.193934078934, 'ema200': 4185.474593655001}, 'M15': {'ema50': 4187.599862816197, 'ema200': 4150.297826466536}, 'H1': {'ema50': 4142.831734056766, 'ema200': 4078.440663019744}}
2025-10-15 13:26:56,572 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.61364819364946, TRs count: 119
2025-10-15 13:26:56,573 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:56,573 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:56,575 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:26:56,575 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:56,576 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:56,576 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:56,577 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.61364819364946, TRs count: 119
2025-10-15 13:26:56,597 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:56,605 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:56,606 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.61364819364946, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:56,606 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:56,607 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:56,607 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:56,608 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.466, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:56,608 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:56,609 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:56,609 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.61364819364946, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:56,611 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:56,612 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:56,612 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:56,613 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.466, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:56,615 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:56,633 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:56,634 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:56,635 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13661.000000000058
2025-10-15 13:26:56,635 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:56,636 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102862.00000000054
2025-10-15 13:26:56,636 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:56,636 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7355.000000000473
2025-10-15 13:26:56,637 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13661.000000000058
2025-10-15 13:26:56,637 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31829.999999999927
2025-10-15 13:26:56,638 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102862.00000000054
2025-10-15 13:26:56,638 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:56,639 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7355.000000000473
2025-10-15 13:26:56,639 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13661.000000000058}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102862.00000000054}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7355.000000000473}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31829.999999999927}]
2025-10-15 13:26:56,639 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31829.999999999927
2025-10-15 13:26:56,640 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:56,640 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:56,642 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:56,642 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13661.000000000058}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102862.00000000054}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7355.000000000473}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31829.999999999927}]
2025-10-15 13:26:56,644 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:56,660 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:56,661 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:56,661 - APP.services.mt5_service - DEBUG - Position in day range: 0.6142080745341695
2025-10-15 13:26:56,662 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:55+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:56,663 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:56,663 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:55+07:00
2025-10-15 13:26:56,664 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:56,664 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:55+07:00 trong DST: True
2025-10-15 13:26:56,665 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:56,665 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:56,666 - APP.services.mt5_service - DEBUG - Position in day range: 0.6142080745341695
2025-10-15 13:26:56,666 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:56,667 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:55+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:56,667 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:56,668 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:55+07:00
2025-10-15 13:26:56,668 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,668 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:55+07:00 trong DST: True
2025-10-15 13:26:56,669 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:56,669 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:56,669 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4600', 'price': 4193.46, 'distance_pips': 0.6}, {'level': '4625', 'price': 4193.462, 'distance_pips': 0.35}, {'level': '4650', 'price': 4193.465, 'distance_pips': 0.1}, {'level': '4675', 'price': 4193.467, 'distance_pips': 0.15}]
2025-10-15 13:26:56,670 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:56,670 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:26:56,671 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:56,671 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,672 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,672 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:56,673 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:56,673 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:56,674 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4600', 'price': 4193.46, 'distance_pips': 0.6}, {'level': '4625', 'price': 4193.462, 'distance_pips': 0.35}, {'level': '4650', 'price': 4193.465, 'distance_pips': 0.1}, {'level': '4675', 'price': 4193.467, 'distance_pips': 0.15}]
2025-10-15 13:26:56,677 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.466
2025-10-15 13:26:56,696 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:26:56,697 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:56,698 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,699 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:56,699 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:56,700 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:56,700 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:56,701 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:56,702 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.466
2025-10-15 13:26:56,702 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:56,703 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:56,703 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.466
2025-10-15 13:26:56,705 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:56,706 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:56,707 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:56,729 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:56,730 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:56,731 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:56,731 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:56,731 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:56,732 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:56,733 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.466
2025-10-15 13:26:56,734 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.466
2025-10-15 13:26:56,736 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:56,739 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:56,761 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:56,762 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:56,763 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:56,763 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:56,764 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:56,764 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:56,765 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:56,765 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:56,768 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.466
2025-10-15 13:26:56,769 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.466
2025-10-15 13:26:56,794 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:56,795 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:56,795 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:56,796 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:56,796 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:56,797 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:56,798 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:56,800 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:56,800 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:56,801 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.466
2025-10-15 13:26:56,825 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,825 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:56,826 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:56,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:56,827 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:56,828 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:56,828 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:56,830 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:56,831 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:56,834 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,851 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:56,853 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:56,853 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:56,854 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:56,854 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:56,856 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:56,856 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:56,856 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:56,856 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:56,857 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:56,857 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:56,858 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:56,858 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:56,859 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:56,859 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:56,861 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:56,861 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:56,862 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:56,862 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:56,886 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:56,886 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:56,887 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:56,887 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:56,887 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,888 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:56,888 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:56,888 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:56,889 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:56,889 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:56,890 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:56,890 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:56,893 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:56,893 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:56,894 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:56,894 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:56,896 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:56,917 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:56,918 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,919 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:26:56,919 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:56,920 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:56,920 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:56,923 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:26:56,925 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:56,926 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:56,928 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:56,951 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:56,951 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,952 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:56,953 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.466, 'ask': 4193.503, 'last': 0.0, 'time': 1760534815}
2025-10-15 13:26:56,954 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:56,956 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:26:56,969 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:26:56,968 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:26:56,977 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,981 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:26:56,981 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.77s
2025-10-15 13:26:56,982 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.466, 'ask': 4193.503, 'last': 0.0, 'time': 1760534815}
2025-10-15 13:26:56,983 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:26:56,984 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:26:56,985 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:26:56,985 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:56,986 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:56,987 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 456, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:56,988 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 492, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:56,991 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:57,005 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:57,005 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:57,006 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:57,008 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:57,008 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:57,008 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:57,009 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:57,009 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:26:57,010 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:57,010 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:57,011 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:26:57,011 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:57,011 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:57,011 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:57,012 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:26:57,012 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:57,013 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:57,013 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13661.000000000058}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102862.00000000054}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7355.000000000473}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31829.999999999927}]
2025-10-15 13:26:57,014 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:26:55+07:00
2025-10-15 13:26:57,014 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:26:57,015 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:26:57,016 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:26:57,017 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.81s
2025-10-15 13:26:57,018 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:57,135 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:57,136 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:57,136 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:26:57,137 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:26:57,138 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:26:57,269 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:57,270 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:57,272 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:57,274 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:57,284 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:57,285 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:57,286 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:57,286 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:57,287 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:57,287 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:57,288 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:57,288 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:57,289 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:57,290 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:57,290 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:57,291 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:57,291 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:57,292 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:57,293 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:57,794 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:57,796 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:57,797 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:58,298 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:26:58,300 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:26:58,300 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:58,301 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:26:58,302 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.576
2025-10-15 13:26:58,302 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.576
2025-10-15 13:26:58,312 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 456, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:58,322 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 456, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:58,416 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:58,420 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 492, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:58,421 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:58,421 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:26:58,422 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:58,423 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:58,426 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:58,428 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:26:58,429 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:58,429 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:58,429 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:58,430 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:26:58,430 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:58,431 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:26:58,434 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:58,437 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:26:58,438 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:58,438 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:58,439 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:58,439 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:26:58,439 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:58,440 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:26:58,442 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:58,444 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:26:58,444 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:58,445 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:58,445 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:58,446 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:26:58,446 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:58,447 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:26:58,448 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:58,451 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:26:58,451 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:58,452 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:58,452 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:58,452 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:26:58,453 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:58,453 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:26:58,459 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:58,485 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:58,488 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:58,507 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:58,508 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:26:58,508 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:58,509 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:26:58,509 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:57+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:58,510 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:26:58,510 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:57+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:58,511 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:57+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:26:58,511 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:57+07:00
2025-10-15 13:26:58,512 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:57+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:58,512 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:57+07:00 trong DST: True
2025-10-15 13:26:58,513 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:57+07:00
2025-10-15 13:26:58,513 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:58,514 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:57+07:00 trong DST: True
2025-10-15 13:26:58,514 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:58,515 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:58,515 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:58,515 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:58,517 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:58,518 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:26:58,519 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.925794546928
2025-10-15 13:26:58,522 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:26:58,541 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.925794546928, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:58,542 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.925794546928
2025-10-15 13:26:58,543 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:58,546 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.925794546928, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:26:58,547 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.715893187404
2025-10-15 13:26:58,547 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:58,549 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:58,550 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.715893187404
2025-10-15 13:26:58,550 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.774592547567
2025-10-15 13:26:58,571 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:58,572 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:58,572 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.774592547567
2025-10-15 13:26:58,573 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.198247804425
2025-10-15 13:26:58,573 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:26:58,574 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:58,574 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.198247804425
2025-10-15 13:26:58,574 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.475688182364
2025-10-15 13:26:58,575 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:26:58,575 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.475688182364
2025-10-15 13:26:58,576 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:58,576 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:26:58,577 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.603156933844
2025-10-15 13:26:58,577 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.603156933844
2025-10-15 13:26:58,578 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:58,578 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:26:58,579 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.298662287431
2025-10-15 13:26:58,580 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.298662287431
2025-10-15 13:26:58,581 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:58,582 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:26:58,604 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.835028174413
2025-10-15 13:26:58,605 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.835028174413
2025-10-15 13:26:58,606 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:58,606 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:26:58,606 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4414988406397
2025-10-15 13:26:58,607 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4414988406397
2025-10-15 13:26:58,607 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.715893187404, 'ema200': 4194.774592547567}, 'M5': {'ema50': 4194.198247804425, 'ema200': 4185.475688182364}, 'M15': {'ema50': 4187.603156933844, 'ema200': 4150.298662287431}, 'H1': {'ema50': 4142.835028174413, 'ema200': 4078.4414988406397}}
2025-10-15 13:26:58,608 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.715893187404, 'ema200': 4194.774592547567}, 'M5': {'ema50': 4194.198247804425, 'ema200': 4185.475688182364}, 'M15': {'ema50': 4187.603156933844, 'ema200': 4150.298662287431}, 'H1': {'ema50': 4142.835028174413, 'ema200': 4078.4414988406397}}
2025-10-15 13:26:58,609 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:58,609 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:26:58,610 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:26:58,612 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:26:58,612 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:58,612 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:58,616 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.61364819364946, TRs count: 119
2025-10-15 13:26:58,627 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.61364819364946, TRs count: 119
2025-10-15 13:26:58,634 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:58,635 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:26:58,636 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:58,636 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:26:58,636 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:58,637 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:26:58,637 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:58,638 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:26:58,638 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.61364819364946, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:58,639 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.61364819364946, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:26:58,640 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:58,640 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:26:58,640 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.576, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:58,642 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.576, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:26:58,643 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:58,643 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:26:58,644 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:58,650 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:26:58,670 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:58,671 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:26:58,672 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:58,672 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:26:58,673 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13770.99999999973
2025-10-15 13:26:58,674 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13770.99999999973
2025-10-15 13:26:58,674 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102972.0000000002
2025-10-15 13:26:58,675 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102972.0000000002
2025-10-15 13:26:58,675 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7465.0000000001455
2025-10-15 13:26:58,676 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7465.0000000001455
2025-10-15 13:26:58,697 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31939.9999999996
2025-10-15 13:26:58,700 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31939.9999999996
2025-10-15 13:26:58,700 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:58,701 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:26:58,701 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13770.99999999973}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102972.0000000002}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7465.0000000001455}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31939.9999999996}]
2025-10-15 13:26:58,702 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13770.99999999973}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102972.0000000002}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7465.0000000001455}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31939.9999999996}]
2025-10-15 13:26:58,702 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:58,704 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:26:58,706 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:58,727 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:58,730 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:58,730 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:58,731 - APP.services.mt5_service - DEBUG - Position in day range: 0.6159161490683259
2025-10-15 13:26:58,731 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:26:58,732 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:57+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:58,732 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:26:58,733 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:57+07:00
2025-10-15 13:26:58,733 - APP.services.mt5_service - DEBUG - Position in day range: 0.6159161490683259
2025-10-15 13:26:58,733 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:57+07:00 trong DST: True
2025-10-15 13:26:58,734 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:57+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:26:58,734 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:58,735 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:57+07:00
2025-10-15 13:26:58,736 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:58,737 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:57+07:00 trong DST: True
2025-10-15 13:26:58,738 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:58,758 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:26:58,760 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:58,760 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:26:58,760 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:58,761 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:26:58,762 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '5700', 'price': 4193.57, 'distance_pips': 0.6}, {'level': '5725', 'price': 4193.572, 'distance_pips': 0.35}, {'level': '5750', 'price': 4193.575, 'distance_pips': 0.1}, {'level': '5775', 'price': 4193.577, 'distance_pips': 0.15}]
2025-10-15 13:26:58,762 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:58,763 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:58,764 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:26:58,764 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '5700', 'price': 4193.57, 'distance_pips': 0.6}, {'level': '5725', 'price': 4193.572, 'distance_pips': 0.35}, {'level': '5750', 'price': 4193.575, 'distance_pips': 0.1}, {'level': '5775', 'price': 4193.577, 'distance_pips': 0.15}]
2025-10-15 13:26:58,765 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:58,765 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:26:58,765 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:58,766 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:58,766 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:58,767 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:58,769 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.576
2025-10-15 13:26:58,791 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:58,793 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:58,794 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.576
2025-10-15 13:26:58,795 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:58,795 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:58,796 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:58,798 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:58,799 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:58,800 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:58,811 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:58,824 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.576
2025-10-15 13:26:58,826 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:26:58,826 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:58,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:26:58,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:58,828 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.576
2025-10-15 13:26:58,829 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:58,830 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:58,831 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:58,833 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:26:58,848 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:58,853 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:58,853 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:26:58,855 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.576
2025-10-15 13:26:58,856 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:26:58,856 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:58,857 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.576
2025-10-15 13:26:58,858 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:58,858 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:58,859 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:58,860 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:26:58,862 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:58,863 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:58,871 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:58,885 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.576
2025-10-15 13:26:58,885 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:26:58,886 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:58,887 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:26:58,887 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:58,888 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.576
2025-10-15 13:26:58,888 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:58,889 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:26:58,890 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:58,890 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:26:58,891 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:58,893 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:26:58,893 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:58,894 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:26:58,894 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:58,894 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:58,909 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:58,916 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:58,917 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:58,918 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:58,918 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:58,919 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:58,919 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:58,920 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:58,920 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:58,920 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:58,921 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:58,922 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:58,922 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:58,923 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:58,924 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:58,924 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:58,925 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:58,925 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:26:58,925 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:58,947 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:58,948 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:58,949 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:58,950 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:58,950 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:58,951 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:58,951 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:58,951 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:58,952 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:58,952 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:26:58,952 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:58,953 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:26:58,954 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:58,955 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:58,955 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:26:58,956 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:58,956 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:26:58,965 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:58,974 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:26:58,979 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:26:58,980 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:26:58,981 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:58,981 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:26:58,982 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:58,983 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:26:58,983 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:26:58,984 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:26:58,984 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:26:58,985 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:58,985 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:26:58,986 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.576, 'ask': 4193.613, 'last': 0.0, 'time': 1760534817}
2025-10-15 13:26:58,986 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:26:58,987 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.71s
2025-10-15 13:26:58,988 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:26:58,989 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:59,006 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:59,007 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:59,009 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.576, 'ask': 4193.613, 'last': 0.0, 'time': 1760534817}
2025-10-15 13:26:59,012 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:26:59,013 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:26:59,013 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:26:59,014 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:26:59,014 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:59,017 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:26:59,018 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:59,018 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:59,019 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:26:59,035 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 456, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:26:59,041 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 492, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:26:59,053 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:59,072 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:59,102 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:59,167 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:59,169 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:59,170 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:59,170 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:59,171 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:59,171 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:26:59,172 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:26:59,173 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:59,173 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:26:59,174 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:59,175 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:59,176 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:26:59,232 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:26:59,295 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:26:59,333 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:26:59,359 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13770.99999999973}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102972.0000000002}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7465.0000000001455}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31939.9999999996}]
2025-10-15 13:26:59,363 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:26:57+07:00
2025-10-15 13:26:59,365 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:26:59,367 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:26:59,369 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:26:59,371 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.10s
2025-10-15 13:26:59,443 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:26:59,443 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:26:59,444 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:26:59,444 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:26:59,445 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:26:59,447 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:59,448 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:26:59,449 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:59,451 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:26:59,530 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:59,531 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:59,531 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:59,532 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:59,532 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:59,533 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:59,533 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:59,534 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:26:59,534 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:59,535 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:26:59,536 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:59,536 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:26:59,537 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:26:59,538 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:26:59,538 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:00,039 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:00,041 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:00,042 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:00,543 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:00,545 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:00,545 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:00,546 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:00,547 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.63
2025-10-15 13:27:00,547 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.62
2025-10-15 13:27:00,569 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 456, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:00,571 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 456, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:00,677 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 491, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:00,697 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 491, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:00,712 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:00,729 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:00,731 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:00,754 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:00,789 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:00,805 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:00,810 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:00,811 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:00,832 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:00,882 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:00,883 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 13:27:00,883 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:00,884 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:00,885 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 13:27:00,886 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.00s
2025-10-15 13:27:00,891 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:00,896 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:00,897 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 13:27:00,898 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:00,899 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:00,899 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:00,900 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:00,900 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:00,903 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:00,915 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:00,918 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:00,919 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:00,920 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:00,920 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:00,921 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:00,921 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:00,951 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:00,953 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:00,956 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:00,957 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:00,958 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:00,958 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:00,976 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:00,977 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:00,978 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:00,980 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:00,983 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:00,984 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:00,984 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:00,987 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:01,011 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:01,012 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:00+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:01,013 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:01,013 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:00+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:01,014 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:01,014 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:00+07:00
2025-10-15 13:27:01,015 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:26:58+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:01,015 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:00+07:00 trong DST: True
2025-10-15 13:27:01,016 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:58+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:01,019 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:01,019 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:58+07:00
2025-10-15 13:27:01,020 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:01,041 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:58+07:00 trong DST: True
2025-10-15 13:27:01,042 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:01,043 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:01,044 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:01,045 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:01,045 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:01,046 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:01,046 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:01,071 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:01,075 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:01,078 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:01,102 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.06s
2025-10-15 13:27:01,104 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:01,105 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:01,106 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:01,111 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:01,113 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:01,114 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:01,133 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:01,134 - APP.ui.app_ui - INFO - Phát hiện thư mục ảnh thay đổi, thực hiện quét lại và đoán symbol.
2025-10-15 13:27:01,135 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:01,135 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:01,135 - APP.ui.app_ui - DEBUG - Bắt đầu quá trình tải file từ thư mục: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots.
2025-10-15 13:27:01,136 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:01,136 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:01,137 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:01,138 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:01,139 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:01,139 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:01,139 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.scan_folder' vào nhóm 'ui.io.scan' (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 13:27:01,140 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:01,140 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:01,141 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.scan_folder vào group ui.io.scan (metadata={'component': 'ui', 'operation': 'scan_folder'})
2025-10-15 13:27:01,141 - APP.ui.app_ui - DEBUG - Luồng quét thư mục bắt đầu cho: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots.
2025-10-15 13:27:01,144 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:01,164 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:01,168 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:01,168 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:01,169 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:01,170 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:01,171 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:01,171 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:01,199 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:01,201 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:01,202 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:01,203 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:01,205 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:01,228 - APP.ui.app_ui - INFO - Luồng quét đã hoàn tất, tìm thấy 4 file.
2025-10-15 13:27:01,229 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:01,230 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:01,230 - APP.utils.threading_utils - DEBUG - Task 'ui.io.scan_folder' (group=ui.io.scan) hoàn tất sau 0.09s
2025-10-15 13:27:01,230 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:01,231 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:01,232 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:01,232 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:01,233 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:01,233 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:01,234 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:01,235 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:01,235 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:01,238 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:01,247 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:01,264 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:01,265 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:01,266 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:01,267 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 13:27:01,269 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:01,269 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:01,270 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 13:27:01,293 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:01,295 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:01,295 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 13:27:01,296 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:01,296 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:01,297 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_tree
2025-10-15 13:27:01,297 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:01,300 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:01,308 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:01,320 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.62, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:01,321 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:01,322 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:01,323 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: refresh_all_lists
2025-10-15 13:27:01,323 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:01,324 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:01,324 - APP.ui.components.history_manager - INFO - Bắt đầu làm mới tất cả danh sách lịch sử.
2025-10-15 13:27:01,324 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:01,325 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:01,325 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'report_*.md'
2025-10-15 13:27:01,326 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.63, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:01,326 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:01,327 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:01,327 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:27:01,328 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13814.9999999996
2025-10-15 13:27:01,328 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:01,329 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:27:01,330 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'report_*.md'
2025-10-15 13:27:01,355 - APP.ui.components.history_manager.FileListView - DEBUG - Yêu cầu làm mới danh sách cho 'ctx_*.json'
2025-10-15 13:27:01,356 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:01,356 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 103016.00000000007
2025-10-15 13:27:01,357 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:01,357 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.misc._refresh_worker' vào nhóm 'ui.misc' (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:27:01,358 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7509.000000000015
2025-10-15 13:27:01,358 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13824.999999999818
2025-10-15 13:27:01,359 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.misc._refresh_worker vào group ui.misc (metadata={'component': 'ui', 'operation': '_refresh_worker'})
2025-10-15 13:27:01,359 - APP.ui.components.history_manager.FileListView - DEBUG - Worker bắt đầu quét tệp cho 'ctx_*.json'
2025-10-15 13:27:01,360 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31983.99999999947
2025-10-15 13:27:01,363 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 103026.00000000029
2025-10-15 13:27:01,364 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:01,383 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:01,384 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7519.000000000233
2025-10-15 13:27:01,385 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13814.9999999996}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 103016.00000000007}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7509.000000000015}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31983.99999999947}]
2025-10-15 13:27:01,386 - APP.ui.app_ui - INFO - Phát hiện symbol XAUUSD từ ảnh (auto=True, giữ symbol hiện tại XAUUSD).
2025-10-15 13:27:01,386 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31993.999999999687
2025-10-15 13:27:01,386 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:01,387 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:01,387 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:01,388 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:01,389 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13824.999999999818}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 103026.00000000029}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7519.000000000233}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31993.999999999687}]
2025-10-15 13:27:01,400 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 JSON.
2025-10-15 13:27:01,416 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:01,417 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:01,417 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.06s
2025-10-15 13:27:01,418 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:01,419 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:01,421 - APP.ui.components.history_manager.FileListView - INFO - Tìm thấy 30 Báo cáo.
2025-10-15 13:27:01,421 - APP.services.mt5_service - DEBUG - Position in day range: 0.6165993788819885
2025-10-15 13:27:01,423 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:01,426 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:01,427 - APP.services.mt5_service - DEBUG - Position in day range: 0.6167546583850975
2025-10-15 13:27:01,450 - APP.utils.threading_utils - DEBUG - Task 'ui.misc._refresh_worker' (group=ui.misc) hoàn tất sau 0.12s
2025-10-15 13:27:01,450 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:00+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:01,451 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:26:58+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:01,452 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:00+07:00
2025-10-15 13:27:01,452 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:26:58+07:00
2025-10-15 13:27:01,453 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:00+07:00 trong DST: True
2025-10-15 13:27:01,453 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:26:58+07:00 trong DST: True
2025-10-15 13:27:01,454 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:01,456 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:01,457 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:01,463 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:01,477 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:01,478 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:01,478 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,479 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,479 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,479 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,480 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6300', 'price': 4193.63, 'distance_pips': 0.0}, {'level': '6325', 'price': 4193.632, 'distance_pips': 0.25}, {'level': '6350', 'price': 4193.635, 'distance_pips': 0.5}, {'level': '6375', 'price': 4193.637, 'distance_pips': 0.75}]
2025-10-15 13:27:01,481 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6200', 'price': 4193.62, 'distance_pips': 0.0}, {'level': '6225', 'price': 4193.622, 'distance_pips': 0.25}, {'level': '6250', 'price': 4193.625, 'distance_pips': 0.5}, {'level': '6275', 'price': 4193.627, 'distance_pips': 0.75}]
2025-10-15 13:27:01,481 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:01,482 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:01,482 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,483 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,483 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,483 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,484 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:01,484 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:01,491 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:01,510 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.63
2025-10-15 13:27:01,511 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.62
2025-10-15 13:27:01,512 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:01,513 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:01,513 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:01,514 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:01,515 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:01,516 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:01,518 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:01,529 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:01,544 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:01,545 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:01,546 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:01,547 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.63
2025-10-15 13:27:01,559 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.62
2025-10-15 13:27:01,574 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:01,575 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:01,575 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:01,576 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:01,577 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:01,577 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:01,578 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:01,582 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:01,602 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:01,603 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:01,605 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.62
2025-10-15 13:27:01,606 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.63
2025-10-15 13:27:01,606 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:01,607 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:01,608 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:01,609 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:01,636 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:01,638 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:01,638 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:01,639 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:01,639 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:01,640 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:01,641 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.62
2025-10-15 13:27:01,644 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.63
2025-10-15 13:27:01,645 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:01,667 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:01,668 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:01,669 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:01,670 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:01,671 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:01,676 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:01,713 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,715 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:01,717 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,718 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,718 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:01,719 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,719 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:01,720 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:01,720 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:01,721 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:01,722 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:01,722 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:01,723 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:01,723 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:01,723 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:01,724 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:01,726 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:01,726 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:01,727 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:01,727 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:01,728 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:01,728 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:01,729 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:01,729 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:01,730 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:01,730 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:01,731 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:01,732 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:01,732 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:01,733 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:01,733 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,733 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:01,734 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,771 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:01,771 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:01,772 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:01,772 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:01,773 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:01,773 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:01,774 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:01,774 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:01,775 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:01,776 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:01,777 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:01,778 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,779 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:01,780 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,780 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:01,780 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:01,781 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,781 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:01,784 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:01,785 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.62, 'ask': 4193.657, 'last': 0.0, 'time': 1760534820}
2025-10-15 13:27:01,785 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:01,786 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:01,786 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:01,787 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:01,788 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:01,788 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:01,789 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,789 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:01,790 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,790 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 456, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:01,792 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 491, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:01,792 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:01,793 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,793 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:01,794 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,795 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:01,796 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,796 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:01,801 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,824 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,825 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,825 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.63, 'ask': 4193.667, 'last': 0.0, 'time': 1760534818}
2025-10-15 13:27:01,826 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,826 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:01,827 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:01,827 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.38s
2025-10-15 13:27:01,828 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:01,854 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:01,856 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:01,890 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:01,915 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:01,945 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:02,024 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:02,042 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:02,045 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:02,079 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:02,111 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:02,136 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:02,139 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13814.9999999996}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 103016.00000000007}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7509.000000000015}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31983.99999999947}]
2025-10-15 13:27:02,144 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:00+07:00
2025-10-15 13:27:02,206 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:02,209 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:02,211 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:02,216 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.77s
2025-10-15 13:27:02,268 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:02,270 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:02,270 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:02,271 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:02,272 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:02,451 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:02,452 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:02,453 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:02,456 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:02,479 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:02,480 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:02,482 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:02,483 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:02,484 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:02,485 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:02,486 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:02,487 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:02,488 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:02,489 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:02,489 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:02,507 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:02,509 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:02,510 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:02,510 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:03,011 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:03,013 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:03,014 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:03,517 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:03,519 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:03,519 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:03,520 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:03,520 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.251
2025-10-15 13:27:03,521 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.565
2025-10-15 13:27:03,529 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 450, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:03,541 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 450, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:03,651 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 491, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:03,655 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 491, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:03,656 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:03,657 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:03,657 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:03,658 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:03,660 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:03,662 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:03,663 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:03,665 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:03,665 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:03,666 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:03,666 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:03,667 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:03,672 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:03,677 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:03,697 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:03,698 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:03,698 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:03,699 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:03,699 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:03,700 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:03,702 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:03,705 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:03,707 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:03,707 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:03,708 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:03,728 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:03,730 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:03,730 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:03,733 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:03,736 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:03,738 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:03,738 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:03,761 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:03,762 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:03,763 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:03,763 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:03,766 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:03,795 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:03,796 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:03,796 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:03,797 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:03,797 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:03,798 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:03,799 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:03,800 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:02+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:03,802 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:03+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:03,818 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:02+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:03,821 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:03+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:03,822 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:02+07:00
2025-10-15 13:27:03,824 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:03+07:00
2025-10-15 13:27:03,824 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:02+07:00 trong DST: True
2025-10-15 13:27:03,825 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:03+07:00 trong DST: True
2025-10-15 13:27:03,825 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:03,826 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:03,826 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:03,827 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:03,827 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:03,827 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:03,829 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:03,832 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:03,835 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:03,852 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:03,857 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:03,862 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:03,863 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:03,884 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:03,887 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:03,888 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:03,888 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:03,889 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:03,890 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:03,890 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:03,891 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:03,894 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:03,894 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:03,897 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:03,907 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:03,912 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:03,914 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:03,917 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:03,917 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:03,918 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:03,919 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:03,920 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:03,921 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:03,921 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:03,921 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:03,922 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:03,923 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:03,923 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:03,925 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:03,926 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:03,944 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:03,946 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:03,946 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:03,947 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:03,947 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:03,948 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:03,949 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:03,949 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:03,950 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:03,951 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:03,951 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:03,952 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:03,953 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:03,953 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:03,954 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:03,956 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:03,956 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:03,960 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:03,981 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:03,983 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:03,985 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:03,988 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:03,992 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:04,011 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:04,015 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:04,015 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.251, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:04,016 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:04,019 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:04,043 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.565, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:04,044 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:04,045 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:04,045 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:04,046 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:04,046 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:04,046 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:04,048 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13445.999999999913
2025-10-15 13:27:04,048 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:04,049 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102647.0000000004
2025-10-15 13:27:04,050 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13759.999999999309
2025-10-15 13:27:04,051 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7140.000000000327
2025-10-15 13:27:04,052 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102960.99999999978
2025-10-15 13:27:04,073 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31614.99999999978
2025-10-15 13:27:04,074 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7453.9999999997235
2025-10-15 13:27:04,075 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:04,076 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31928.999999999178
2025-10-15 13:27:04,077 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13445.999999999913}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102647.0000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7140.000000000327}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31614.99999999978}]
2025-10-15 13:27:04,078 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:04,078 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:04,079 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13759.999999999309}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102960.99999999978}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7453.9999999997235}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31928.999999999178}]
2025-10-15 13:27:04,080 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:04,098 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:04,100 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:04,101 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:04,101 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:04,102 - APP.services.mt5_service - DEBUG - Position in day range: 0.610869565217397
2025-10-15 13:27:04,102 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:04,103 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:02+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:04,103 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:04,104 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:02+07:00
2025-10-15 13:27:04,104 - APP.services.mt5_service - DEBUG - Position in day range: 0.6157453416149032
2025-10-15 13:27:04,105 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:02+07:00 trong DST: True
2025-10-15 13:27:04,105 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:03+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:04,105 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:04,106 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:03+07:00
2025-10-15 13:27:04,106 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:04,107 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:03+07:00 trong DST: True
2025-10-15 13:27:04,107 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:04,108 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:04,108 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,109 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:04,109 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,109 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:04,110 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2500', 'price': 4193.25, 'distance_pips': 0.1}, {'level': '2525', 'price': 4193.252, 'distance_pips': 0.15}, {'level': '2550', 'price': 4193.255, 'distance_pips': 0.4}, {'level': '2575', 'price': 4193.257, 'distance_pips': 0.65}]
2025-10-15 13:27:04,110 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,111 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:04,112 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,113 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,114 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,128 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '5600', 'price': 4193.56, 'distance_pips': 0.5}, {'level': '5625', 'price': 4193.562, 'distance_pips': 0.25}, {'level': '5650', 'price': 4193.565, 'distance_pips': 0.0}, {'level': '5675', 'price': 4193.568, 'distance_pips': 0.25}]
2025-10-15 13:27:04,132 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:04,134 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:04,135 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.251
2025-10-15 13:27:04,138 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,139 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:04,139 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,140 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:04,140 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:04,141 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:04,142 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.565
2025-10-15 13:27:04,143 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:04,144 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:04,144 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:04,162 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:04,164 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.251
2025-10-15 13:27:04,165 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:04,165 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:04,166 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:04,167 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:04,167 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:04,168 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:04,169 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.565
2025-10-15 13:27:04,169 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:04,170 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:04,170 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:04,171 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:04,172 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.251
2025-10-15 13:27:04,173 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:04,174 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:04,176 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:04,176 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:04,198 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:04,199 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:04,200 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:04,201 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.565
2025-10-15 13:27:04,201 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:04,202 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:04,203 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.251
2025-10-15 13:27:04,203 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:04,204 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:04,206 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:04,207 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:04,207 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:04,213 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:04,227 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:04,228 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:04,229 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,230 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.565
2025-10-15 13:27:04,231 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,232 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:04,232 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:04,233 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:04,233 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:04,234 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:04,235 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:04,237 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:04,238 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:04,259 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,260 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:04,261 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,262 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:04,262 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:04,262 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:04,263 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:04,264 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:04,264 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:04,264 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:04,265 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:04,265 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:04,266 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:04,266 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:04,268 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:04,269 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:04,281 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:04,291 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:04,291 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:04,292 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:04,292 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:04,293 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:04,294 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:04,294 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,295 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:04,295 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,295 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:04,296 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:04,296 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:04,296 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:04,297 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:04,297 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:04,298 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:04,299 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:04,300 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:04,300 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:04,304 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:04,322 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,326 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:04,326 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,327 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:04,327 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:04,328 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,329 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:04,336 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:04,354 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.251, 'ask': 4193.288, 'last': 0.0, 'time': 1760534822}
2025-10-15 13:27:04,355 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:04,356 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:04,356 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:04,357 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:04,357 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:04,358 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:04,358 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,359 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:04,360 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,362 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:04,363 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 450, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:04,364 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:04,384 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 491, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:04,386 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:04,387 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,387 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:04,388 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,388 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,389 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,389 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.565, 'ask': 4193.602, 'last': 0.0, 'time': 1760534823}
2025-10-15 13:27:04,390 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,390 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:04,391 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,391 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.94s
2025-10-15 13:27:04,392 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,395 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,412 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,413 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:04,414 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:04,415 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:04,416 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:04,416 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,417 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,417 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:04,418 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:04,418 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:04,419 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:04,419 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13445.999999999913}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102647.0000000004}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7140.000000000327}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31614.99999999978}]
2025-10-15 13:27:04,419 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:02+07:00
2025-10-15 13:27:04,420 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:04,421 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:04,423 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:04,425 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.97s
2025-10-15 13:27:04,438 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:04,546 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:04,547 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:04,548 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:04,550 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:04,550 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:04,554 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:04,555 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:04,557 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:04,559 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:04,704 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:04,704 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:04,705 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:04,706 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:04,707 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:04,707 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:04,708 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:04,708 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:04,709 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:04,709 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:04,710 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:04,711 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:04,712 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:04,712 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:04,713 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:05,215 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:05,217 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:05,218 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:05,720 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:05,721 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:05,722 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:05,722 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:05,723 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.409
2025-10-15 13:27:05,723 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.409
2025-10-15 13:27:05,741 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 449, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:05,745 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 449, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:05,858 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 491, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:05,866 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 491, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:05,867 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:05,867 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:05,868 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:05,869 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:05,872 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:05,874 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:05,875 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:05,875 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:05,876 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:05,876 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:05,877 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:05,877 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:05,884 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:05,888 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:05,889 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:05,889 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:05,889 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:05,890 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:05,890 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:05,891 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:05,894 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:05,917 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:05,918 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:05,918 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:05,919 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:05,919 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:05,920 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:05,921 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:05,924 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:05,929 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:05,946 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:05,947 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:05,948 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:05,949 - APP.ui.app_ui - INFO - Yêu cầu bắt đầu phân tích từ UI (source=manual).
2025-10-15 13:27:05,949 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:05,949 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:05,950 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:05,951 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:05,954 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:05,967 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:05,978 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:05,979 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:05,980 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:05,981 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:05,981 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:05,982 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:05,983 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:05,983 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:05,984 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:05,984 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:05,985 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:05,985 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:04+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:05,986 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:05,987 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:04+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:05,988 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:04+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:05,989 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:06,012 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:04+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:06,013 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:04+07:00
2025-10-15 13:27:06,015 - APP.services.te_service - INFO - Đăng nhập thành công vào Trading Economics API với định dạng key username/password.
2025-10-15 13:27:06,015 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:04+07:00
2025-10-15 13:27:06,016 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:04+07:00 trong DST: True
2025-10-15 13:27:06,016 - APP.services.news_service - DEBUG - Cấu hình NewsService đã được cập nhật.
2025-10-15 13:27:06,017 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:04+07:00 trong DST: True
2025-10-15 13:27:06,017 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:06,018 - APP.utils.threading_utils - DEBUG - Gửi task 'news.refresh.autorun' vào nhóm 'news.polling' (metadata={'component': 'news', 'priority': 'autorun', 'timeout_sec': 20})
2025-10-15 13:27:06,018 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:06,019 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:06,020 - APP.utils.threading_utils - DEBUG - Gửi task 'news.provider.fmp' vào nhóm 'news.polling' (metadata={'component': 'news', 'provider': 'fmp', 'priority': 'autorun'})
2025-10-15 13:27:06,020 - APP.utils.threading_utils - DEBUG - Gửi task 'analysis.session.manual-20251015-132706' vào nhóm 'analysis.session' (metadata={'component': 'analysis', 'session_id': 'manual-20251015-132706', 'priority': 'user'})
2025-10-15 13:27:06,022 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:06,039 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:06,040 - APP.utils.threading_utils - DEBUG - Gửi task 'news.provider.te' vào nhóm 'news.polling' (metadata={'component': 'news', 'provider': 'te', 'priority': 'autorun'})
2025-10-15 13:27:06,040 - APP.services.fmp_service - DEBUG - Đang lấy dữ liệu lịch kinh tế từ investpy...
2025-10-15 13:27:06,041 - APP.core.analysis_controller - INFO - Đã submit phiên phân tích manual-20251015-132706 (priority=user)
2025-10-15 13:27:06,042 - APP.core.analysis_worker - DEBUG - Bắt đầu AnalysisWorker.run với model: models/gemini-2.5-flash
2025-10-15 13:27:06,042 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:06,043 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:06,044 - APP.services.te_service - DEBUG - Đang thực hiện cuộc gọi API đến Trading Economics...
2025-10-15 13:27:06,047 - APP.ui.app_ui - INFO - Đã gửi yêu cầu khởi động phiên manual-20251015-132706 (manual).
2025-10-15 13:27:06,048 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 13:27:06,048 - APP.core.analysis_worker - DEBUG - GIAI ĐOẠN 1: Khởi tạo và kiểm tra đầu vào.
2025-10-15 13:27:06,050 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:06,051 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:06,053 - APP.services.te_service - WARNING - Bỏ qua xác minh SSL cho Trading Economics API.
2025-10-15 13:27:06,076 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:06,081 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:06,081 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:06,105 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:06,112 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:06,131 - APP.ui.utils.ui_builder - DEBUG - Đã thay đổi trạng thái nút Start/Stop thành 'disabled'. Các điều khiển khác không bị ảnh hưởng.
2025-10-15 13:27:06,138 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:06,140 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:06,140 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:06,141 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:06,170 - APP.ui.app_ui - INFO - Phiên manual-20251015-132706 bắt đầu (priority=user, source=manual).
2025-10-15 13:27:06,170 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:06,171 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:06,172 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:06,174 - APP.services.gemini_service - INFO - Đã khởi tạo model 'models/gemini-2.5-flash' thành công.
2025-10-15 13:27:06,176 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:06,204 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:06,219 - APP.services.te_service - WARNING - Trading Economics trả về lỗi 403 - có thể do API key không hợp lệ hoặc hết hạn. Trả về danh sách rỗng để tránh dừng hệ thống.
2025-10-15 13:27:06,232 - APP.core.analysis_worker - DEBUG - BẮT ĐẦU GIAI ĐOẠN 2: Xây dựng ngữ cảnh và kiểm tra điều kiện.
2025-10-15 13:27:06,233 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:06,233 - APP.core.analysis_worker - DEBUG - BẮT ĐẦU GIAI ĐOẠN 3: Chuẩn bị và upload ảnh (TaskGroup analysis.upload).
2025-10-15 13:27:06,234 - APP.services.te_service - DEBUG - Đã khôi phục context SSL mặc định.
2025-10-15 13:27:06,234 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:06,235 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-RUN.
2025-10-15 13:27:06,270 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:06,271 - APP.analysis.image_processor - DEBUG - Đang thử tải cache upload.
2025-10-15 13:27:06,272 - APP.utils.threading_utils - DEBUG - Task 'news.provider.te' (group=news.polling) hoàn tất sau 0.23s
2025-10-15 13:27:06,273 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:06,278 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:06,314 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:06,314 - APP.analysis.image_processor - DEBUG - Đã tải cache upload với 13 mục.
2025-10-15 13:27:06,316 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:06,317 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:06,318 - APP.utils.threading_utils - DEBUG - Gửi task 'analysis.upload.manual-20251015-132706.0' vào nhóm 'analysis.upload' (metadata={'component': 'analysis', 'session_id': 'manual-20251015-132706', 'index': 0})
2025-10-15 13:27:06,319 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:06,319 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:06,321 - APP.utils.threading_utils - DEBUG - Gửi task 'analysis.upload.manual-20251015-132706.1' vào nhóm 'analysis.upload' (metadata={'component': 'analysis', 'session_id': 'manual-20251015-132706', 'index': 1})
2025-10-15 13:27:06,321 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:06,323 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:06,324 - APP.utils.threading_utils - DEBUG - Gửi task 'analysis.upload.manual-20251015-132706.2' vào nhóm 'analysis.upload' (metadata={'component': 'analysis', 'session_id': 'manual-20251015-132706', 'index': 2})
2025-10-15 13:27:06,326 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:06,326 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:06,328 - APP.utils.threading_utils - DEBUG - Gửi task 'analysis.upload.manual-20251015-132706.3' vào nhóm 'analysis.upload' (metadata={'component': 'analysis', 'session_id': 'manual-20251015-132706', 'index': 3})
2025-10-15 13:27:06,390 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:06,418 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:06,420 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:06,421 - APP.analysis.image_processor - DEBUG - Đã tính toán chữ ký cho XAUUSD_H1.png: 30220:1760534820:d00c0a1011d0c5e6
2025-10-15 13:27:06,422 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:06,422 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:06,426 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:06,429 - APP.analysis.image_processor - DEBUG - Cache hit cho XAUUSD_H1.png, nhưng chữ ký không khớp.
2025-10-15 13:27:06,430 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:06,431 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:06,431 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:06,434 - APP.analysis.image_processor - DEBUG - Đang chuẩn bị ảnh: XAUUSD_H1.png, Tối ưu hóa: False
2025-10-15 13:27:06,437 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:06,438 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:06,439 - APP.analysis.image_processor - DEBUG - Bỏ qua tối ưu hóa hình ảnh.
2025-10-15 13:27:06,440 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:06,444 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:06,446 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:06,446 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:06,447 - APP.analysis.image_processor - INFO - Dang tai 'XAUUSD_H1.png' len Gemini File API...
2025-10-15 13:27:06,448 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:06,449 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:06,493 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:06,499 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:06,500 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:06,501 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:06,503 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:06,505 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:06,507 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:06,514 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:06,516 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:06,567 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:06,571 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:06,661 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:06,667 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:06,730 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:06,733 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:06,734 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.409, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:06,735 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:06,781 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:06,783 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:06,788 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:06,791 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.409, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:06,792 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:06,794 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:06,794 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:06,796 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:06,828 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13603.99999999936
2025-10-15 13:27:06,840 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:06,841 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102804.99999999984
2025-10-15 13:27:06,842 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:06,843 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7297.999999999774
2025-10-15 13:27:06,843 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13603.99999999936
2025-10-15 13:27:06,846 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31772.99999999923
2025-10-15 13:27:06,848 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102804.99999999984
2025-10-15 13:27:06,849 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:06,850 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7297.999999999774
2025-10-15 13:27:06,850 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13603.99999999936}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102804.99999999984}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7297.999999999774}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31772.99999999923}]
2025-10-15 13:27:06,854 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31772.99999999923
2025-10-15 13:27:06,855 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:06,856 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:06,857 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:06,858 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13603.99999999936}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102804.99999999984}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7297.999999999774}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31772.99999999923}]
2025-10-15 13:27:06,859 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:07,085 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:07,280 - APP.core.trading.conditions - DEBUG - Điều kiện NO-RUN được thỏa mãn. Lý do: Các điều kiện cho phép.
2025-10-15 13:27:07,284 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:07,291 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:07,296 - APP.services.mt5_service - DEBUG - Position in day range: 0.6133229813664568
2025-10-15 13:27:07,297 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:07,297 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:07,298 - APP.analysis.context_builder - DEBUG - Bắt đầu xây dựng ngữ cảnh lịch sử với budget: 2000 chars.
2025-10-15 13:27:07,300 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:04+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:07,301 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:07,301 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:07,302 - APP.analysis.context_builder - DEBUG - Parsing last 20 context files from: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots\Reports
2025-10-15 13:27:07,302 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:04+07:00
2025-10-15 13:27:07,303 - APP.services.mt5_service - DEBUG - Position in day range: 0.6133229813664568
2025-10-15 13:27:07,304 - APP.analysis.context_builder - WARNING - Thư mục báo cáo không tồn tại: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots\Reports
2025-10-15 13:27:07,305 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:04+07:00 trong DST: True
2025-10-15 13:27:07,306 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:04+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:07,306 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:04+07:00
2025-10-15 13:27:07,307 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:04+07:00 trong DST: True
2025-10-15 13:27:07,367 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:07,369 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:07,371 - APP.analysis.context_builder - DEBUG - Bắt đầu tóm tắt xu hướng checklist từ 0 items.
2025-10-15 13:27:07,373 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:07,374 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:07,374 - APP.analysis.context_builder - DEBUG - Không có items, trả về trend 'unknown'.
2025-10-15 13:27:07,375 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:07,375 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:07,376 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu tạo map timeframe với 4 tên file.
2025-10-15 13:27:07,377 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:07,377 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:07,378 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_H1.png
2025-10-15 13:27:07,379 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:07,379 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4000', 'price': 4193.4, 'distance_pips': 0.9}, {'level': '4025', 'price': 4193.402, 'distance_pips': 0.65}, {'level': '4050', 'price': 4193.405, 'distance_pips': 0.4}, {'level': '4075', 'price': 4193.407, 'distance_pips': 0.15}]
2025-10-15 13:27:07,380 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'H1' cho 'XAUUSD_H1.png' bằng pattern đã biên dịch.
2025-10-15 13:27:07,380 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:07,381 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:07,381 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M1.png
2025-10-15 13:27:07,382 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4000', 'price': 4193.4, 'distance_pips': 0.9}, {'level': '4025', 'price': 4193.402, 'distance_pips': 0.65}, {'level': '4050', 'price': 4193.405, 'distance_pips': 0.4}, {'level': '4075', 'price': 4193.407, 'distance_pips': 0.15}]
2025-10-15 13:27:07,382 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:07,383 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M1' cho 'XAUUSD_M1.png' bằng pattern đã biên dịch.
2025-10-15 13:27:07,383 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:07,384 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:07,384 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M15.png
2025-10-15 13:27:07,385 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:07,385 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:07,386 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M15' cho 'XAUUSD_M15.png' bằng pattern đã biên dịch.
2025-10-15 13:27:07,386 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:07,387 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.409
2025-10-15 13:27:07,388 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M5.png
2025-10-15 13:27:07,388 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:07,389 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:07,389 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M5' cho 'XAUUSD_M5.png' bằng pattern đã biên dịch.
2025-10-15 13:27:07,390 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.409
2025-10-15 13:27:07,390 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:07,391 - APP.ui.utils.timeframe_detector - DEBUG - Kết thúc tạo map timeframe. Map: {'XAUUSD_H1.png': 'H1', 'XAUUSD_M1.png': 'M1', 'XAUUSD_M15.png': 'M15', 'XAUUSD_M5.png': 'M5'}
2025-10-15 13:27:07,392 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:07,393 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:07,395 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:07,426 - APP.analysis.context_builder - DEBUG - Ngữ cảnh lịch sử có kích thước 606 chars (trong budget).
2025-10-15 13:27:07,482 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:07,483 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:07,484 - APP.utils.threading_utils - DEBUG - Task song song 'build_historical_context_async' hoàn tất thành công.
2025-10-15 13:27:07,485 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:07,579 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 13:27:07,580 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:07,585 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:07,590 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.409
2025-10-15 13:27:07,591 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:07,595 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:07,596 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.409
2025-10-15 13:27:07,599 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:07,601 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:07,602 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:07,603 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:07,604 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:07,605 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:07,606 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:07,606 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:07,608 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.409
2025-10-15 13:27:07,608 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:07,609 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:07,609 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.409
2025-10-15 13:27:07,610 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:07,622 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:07,653 - APP.analysis.image_processor - ERROR - Da xay ra loi khong mong muon trong qua trinh tai tep len cho 'XAUUSD_H1.png': Missing required parameter "ragStoreName"
Traceback (most recent call last):
  File "C:\tool\app_gemini-1\APP\analysis\image_processor.py", line 259, in upload_image_to_gemini
    file_obj = upload_fn(**upload_kwargs)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
        path=path, mime_type=mime_type, name=name, display_name=display_name, resumable=resumable
    )
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\client.py", line 120, in create_file
    request = self._local.discovery_api.media().upload(body={"file": file}, media_body=media)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\googleapiclient\discovery.py", line 1114, in method
    raise TypeError('Missing required parameter "%s"' % name)
TypeError: Missing required parameter "ragStoreName"
2025-10-15 13:27:07,655 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:07,656 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:07,666 - APP.utils.threading_utils - DEBUG - Task 'analysis.upload.manual-20251015-132706.0' (group=analysis.upload) hoàn tất sau 1.34s
2025-10-15 13:27:07,667 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:07,668 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:07,670 - APP.core.analysis_worker - ERROR - Không thể xử lý ảnh tại index 0: Không thể upload ảnh: XAUUSD_H1.png
2025-10-15 13:27:07,671 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:07,671 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:07,690 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:07,695 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.409
2025-10-15 13:27:07,702 - APP.analysis.image_processor - DEBUG - Đã tính toán chữ ký cho XAUUSD_M1.png: 38129:1760534820:c2cc74ff68c6d76f
2025-10-15 13:27:07,703 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:07,704 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:07,734 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 13:27:07,805 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:07,805 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:07,809 - APP.analysis.image_processor - DEBUG - Cache hit cho XAUUSD_M1.png, nhưng chữ ký không khớp.
2025-10-15 13:27:07,818 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.409
2025-10-15 13:27:07,820 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:07,938 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:08,023 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:08,024 - APP.analysis.image_processor - DEBUG - Đang chuẩn bị ảnh: XAUUSD_M1.png, Tối ưu hóa: False
2025-10-15 13:27:08,024 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:08,025 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:08,025 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:08,026 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:08,027 - APP.analysis.image_processor - DEBUG - Bỏ qua tối ưu hóa hình ảnh.
2025-10-15 13:27:08,028 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:08,029 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:08,030 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.412
2025-10-15 13:27:08,031 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:08,032 - APP.analysis.image_processor - INFO - Dang tai 'XAUUSD_M1.png' len Gemini File API...
2025-10-15 13:27:08,152 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:08,161 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 446, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:08,162 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:08,163 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:08,231 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:08,265 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:08,268 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 489, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:08,304 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:08,305 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:08,306 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:08,307 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:08,308 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:08,308 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:08,309 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:08,309 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:08,310 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:08,311 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:08,311 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:08,311 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:08,312 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:08,312 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:08,313 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:08,313 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:08,313 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:08,315 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:08,316 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:08,316 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:08,317 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:08,320 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:08,321 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:08,322 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:08,322 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:08,322 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:08,323 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:08,323 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:08,324 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:08,324 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:08,325 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:08,325 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:08,327 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:08,328 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:08,329 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:08,369 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:08,370 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:08,370 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:08,371 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:08,371 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:08,372 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:08,373 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:08,374 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:08,374 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:08,376 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:08,376 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:08,377 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:08,377 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:08,378 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:08,382 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:08,384 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:08,384 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:08,385 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:08,385 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:08,386 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:08,386 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:08,387 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:08,387 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:08,388 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:08,389 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.409, 'ask': 4193.446, 'last': 0.0, 'time': 1760534824}
2025-10-15 13:27:08,389 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:08,392 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:08,434 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:08,435 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 3.88s
2025-10-15 13:27:08,436 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:08,437 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:08,441 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:08,442 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:08,443 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:08,444 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:08,445 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:08,445 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:08,448 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:08,493 - APP.analysis.image_processor - DEBUG - Đã tính toán chữ ký cho XAUUSD_M15.png: 33186:1760534820:5cd66e8dcebbb6fd
2025-10-15 13:27:08,497 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.409, 'ask': 4193.446, 'last': 0.0, 'time': 1760534824}
2025-10-15 13:27:08,500 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:08,501 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:08,504 - APP.analysis.image_processor - DEBUG - Cache hit cho XAUUSD_M15.png, nhưng chữ ký không khớp.
2025-10-15 13:27:08,505 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:08,506 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:08,506 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:08,507 - APP.analysis.image_processor - DEBUG - Đang chuẩn bị ảnh: XAUUSD_M15.png, Tối ưu hóa: False
2025-10-15 13:27:08,508 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:08,585 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:08,586 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:08,589 - APP.analysis.image_processor - DEBUG - Đã tính toán chữ ký cho XAUUSD_M5.png: 35197:1760534820:0144b79a172c6c4a
2025-10-15 13:27:08,590 - APP.analysis.image_processor - DEBUG - Bỏ qua tối ưu hóa hình ảnh.
2025-10-15 13:27:08,590 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:08,606 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:08,691 - APP.analysis.image_processor - DEBUG - Cache hit cho XAUUSD_M5.png, nhưng chữ ký không khớp.
2025-10-15 13:27:08,692 - APP.analysis.image_processor - INFO - Dang tai 'XAUUSD_M15.png' len Gemini File API...
2025-10-15 13:27:08,733 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:08,751 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:08,765 - APP.analysis.image_processor - DEBUG - Đang chuẩn bị ảnh: XAUUSD_M5.png, Tối ưu hóa: False
2025-10-15 13:27:08,836 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:08,870 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 449, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:08,871 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:08,872 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:08,873 - APP.analysis.image_processor - DEBUG - Bỏ qua tối ưu hóa hình ảnh.
2025-10-15 13:27:08,873 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 491, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:08,874 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:08,876 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:08,876 - APP.analysis.image_processor - INFO - Dang tai 'XAUUSD_M5.png' len Gemini File API...
2025-10-15 13:27:08,877 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:08,877 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:06+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:08,878 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:08,880 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:08,881 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:06+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:08,883 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:08,884 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:08,923 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:06+07:00
2025-10-15 13:27:09,026 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:09,039 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:09,210 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:06+07:00 trong DST: True
2025-10-15 13:27:09,214 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:09,314 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:09,318 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:09,319 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:09,321 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 13:27:09,322 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:09,328 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:09,400 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:09,410 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:09,417 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:09,459 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:09,461 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:09,477 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:09,480 - APP.analysis.image_processor - ERROR - Da xay ra loi khong mong muon trong qua trinh tai tep len cho 'XAUUSD_M1.png': Missing required parameter "ragStoreName"
Traceback (most recent call last):
  File "C:\tool\app_gemini-1\APP\analysis\image_processor.py", line 259, in upload_image_to_gemini
    file_obj = upload_fn(**upload_kwargs)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
        path=path, mime_type=mime_type, name=name, display_name=display_name, resumable=resumable
    )
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\client.py", line 120, in create_file
    request = self._local.discovery_api.media().upload(body={"file": file}, media_body=media)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\googleapiclient\discovery.py", line 1114, in method
    raise TypeError('Missing required parameter "%s"' % name)
TypeError: Missing required parameter "ragStoreName"
2025-10-15 13:27:09,527 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:09,537 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:09,540 - APP.utils.threading_utils - DEBUG - Task 'analysis.upload.manual-20251015-132706.1' (group=analysis.upload) hoàn tất sau 1.87s
2025-10-15 13:27:09,541 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:09,542 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:09,544 - APP.core.analysis_worker - ERROR - Không thể xử lý ảnh tại index 1: Không thể upload ảnh: XAUUSD_M1.png
2025-10-15 13:27:09,544 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:09,545 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:09,547 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:09,554 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 13:27:09,586 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:09,587 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:09,588 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:09,590 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:09,591 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:09,593 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:09,595 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.05s
2025-10-15 13:27:09,596 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:09,598 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13603.99999999936}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102804.99999999984}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7297.999999999774}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31772.99999999923}]
2025-10-15 13:27:09,601 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:09,687 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:09,691 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:04+07:00
2025-10-15 13:27:09,695 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:09,695 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:09,696 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:09,699 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:09,700 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:09,701 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:09,701 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:09,703 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:09,760 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:09,764 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:09,765 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:09,766 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:09,814 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:09,816 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:09,817 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:09,821 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:09,823 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:09,824 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:09,825 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:09,826 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:09,826 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:09,828 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:09,915 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:09,915 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:09,918 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 5.36s
2025-10-15 13:27:09,918 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:09,919 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:09,920 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:09,920 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:09,922 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:09,922 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:10,034 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:10,035 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:10,037 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:10,039 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:10,042 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:10,042 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:10,043 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:10,043 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.412, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:10,044 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:10,045 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:10,093 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:10,095 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:10,096 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:10,097 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:10,098 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13606.99999999997
2025-10-15 13:27:10,099 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102808.00000000045
2025-10-15 13:27:10,103 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7301.000000000386
2025-10-15 13:27:10,103 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31775.99999999984
2025-10-15 13:27:10,104 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:10,105 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13606.99999999997}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102808.00000000045}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7301.000000000386}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31775.99999999984}]
2025-10-15 13:27:10,106 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:10,263 - APP.analysis.image_processor - ERROR - Da xay ra loi khong mong muon trong qua trinh tai tep len cho 'XAUUSD_M15.png': Missing required parameter "ragStoreName"
Traceback (most recent call last):
  File "C:\tool\app_gemini-1\APP\analysis\image_processor.py", line 259, in upload_image_to_gemini
    file_obj = upload_fn(**upload_kwargs)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
        path=path, mime_type=mime_type, name=name, display_name=display_name, resumable=resumable
    )
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\client.py", line 120, in create_file
    request = self._local.discovery_api.media().upload(body={"file": file}, media_body=media)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\googleapiclient\discovery.py", line 1114, in method
    raise TypeError('Missing required parameter "%s"' % name)
TypeError: Missing required parameter "ragStoreName"
2025-10-15 13:27:10,266 - APP.utils.threading_utils - DEBUG - Task 'analysis.upload.manual-20251015-132706.2' (group=analysis.upload) hoàn tất sau 1.83s
2025-10-15 13:27:10,267 - APP.core.analysis_worker - ERROR - Không thể xử lý ảnh tại index 2: Không thể upload ảnh: XAUUSD_M15.png
2025-10-15 13:27:10,299 - APP.analysis.image_processor - ERROR - Da xay ra loi khong mong muon trong qua trinh tai tep len cho 'XAUUSD_M5.png': Missing required parameter "ragStoreName"
Traceback (most recent call last):
  File "C:\tool\app_gemini-1\APP\analysis\image_processor.py", line 259, in upload_image_to_gemini
    file_obj = upload_fn(**upload_kwargs)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
        path=path, mime_type=mime_type, name=name, display_name=display_name, resumable=resumable
    )
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\google\generativeai\client.py", line 120, in create_file
    request = self._local.discovery_api.media().upload(body={"file": file}, media_body=media)
  File "C:\tool\app_gemini-1\.venv\Lib\site-packages\googleapiclient\discovery.py", line 1114, in method
    raise TypeError('Missing required parameter "%s"' % name)
TypeError: Missing required parameter "ragStoreName"
2025-10-15 13:27:10,309 - APP.utils.threading_utils - DEBUG - Task 'analysis.upload.manual-20251015-132706.3' (group=analysis.upload) hoàn tất sau 1.82s
2025-10-15 13:27:10,310 - APP.core.analysis_worker - ERROR - Không thể xử lý ảnh tại index 3: Không thể upload ảnh: XAUUSD_M5.png
2025-10-15 13:27:10,310 - APP.analysis.image_processor - DEBUG - Đang lưu cache upload với 13 mục.
2025-10-15 13:27:10,312 - APP.analysis.image_processor - DEBUG - Đã lưu cache upload thành công.
2025-10-15 13:27:10,313 - APP.utils.threading_utils - DEBUG - Task song song '_execute_stage_3_logic' hoàn tất thành công.
2025-10-15 13:27:10,325 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:10,327 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:10,328 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:10,328 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:10,329 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:10,355 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:10,356 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.481
2025-10-15 13:27:10,357 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:10,381 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 446, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:10,384 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:10,386 - APP.services.mt5_service - DEBUG - Position in day range: 0.6133695652173979
2025-10-15 13:27:10,465 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:10,472 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:06+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:10,474 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 489, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:10,474 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:10,475 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:06+07:00
2025-10-15 13:27:10,475 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:10,476 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:10,476 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:06+07:00 trong DST: True
2025-10-15 13:27:10,477 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:10,477 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:10,478 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:10,481 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:10,482 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:10,483 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:10,484 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:10,485 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:10,486 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:10,516 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:10,551 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:10,574 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:10,575 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:10,575 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:10,576 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:10,576 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:10,577 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4100', 'price': 4193.41, 'distance_pips': 0.2}, {'level': '4125', 'price': 4193.412, 'distance_pips': 0.05}, {'level': '4150', 'price': 4193.415, 'distance_pips': 0.3}, {'level': '4175', 'price': 4193.417, 'distance_pips': 0.55}]
2025-10-15 13:27:10,578 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:10,578 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:10,608 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:10,612 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:10,651 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:10,654 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:10,654 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:10,655 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:10,655 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:10,656 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:10,657 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:10,657 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:10,657 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:10,658 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:10,659 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.412
2025-10-15 13:27:10,662 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:10,663 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:10,664 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:10,664 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:10,665 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:10,666 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:10,667 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:10,668 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:10,669 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:10,672 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:10,675 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.412
2025-10-15 13:27:10,690 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:10,702 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:10,703 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:10,741 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:10,742 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:10,744 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.412
2025-10-15 13:27:10,745 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:10,746 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:10,747 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:10,748 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:10,748 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:10,750 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.412
2025-10-15 13:27:10,750 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:10,751 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:10,752 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:10,753 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:10,754 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:10,755 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:10,755 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:11,165 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:11,167 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:11,167 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:11,168 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:11,168 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:11,169 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:11,169 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:11,169 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:11,170 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:11,170 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:11,171 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:11,171 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:11,172 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:11,172 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.595
2025-10-15 13:27:11,173 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:11,173 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:11,174 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:11,175 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:11,175 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:09+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:11,178 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:11,198 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:09+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:11,198 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:11,199 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:09+07:00
2025-10-15 13:27:11,200 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:11,201 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:09+07:00 trong DST: True
2025-10-15 13:27:11,202 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:11,202 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:11,203 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:11,203 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:11,204 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:11,204 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,226 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 444, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:11,228 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:11,234 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,266 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 13:27:11,302 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:11,307 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 489, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:11,308 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:11,315 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:11,316 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:11,319 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:11,320 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:11,321 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:11,327 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:11,328 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:11,332 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:11,333 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:11,352 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): www.investing.com:443
2025-10-15 13:27:11,352 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:11,353 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:11,354 - APP.utils.threading_utils - DEBUG - Task song song 'get_market_data_async' hoàn tất thành công.
2025-10-15 13:27:11,355 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:11,355 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:11,356 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:11,357 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:11,358 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:11,358 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:11,359 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 13:27:11,362 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:11,364 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:11,364 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 13:27:11,387 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:11,388 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:11,388 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 13:27:11,389 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:11,389 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:11,390 - APP.utils.safe_data - DEBUG - Get top-level key 'symbol': XAUUSD
2025-10-15 13:27:11,390 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:11,391 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:11,395 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:11,416 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:11,417 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:11,417 - APP.utils.safe_data - DEBUG - Get top-level key 'volatility_regime': trending
2025-10-15 13:27:11,418 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:11,418 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:11,419 - APP.utils.safe_data - DEBUG - Get top-level key 'ict_patterns': {'liquidity_h1': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': 34}, {'price': 4179.805, 'bar_index': 8}, {'price': 4155.378, 'bar_index': 19}, {'price': 4145.283, 'bar_index': 11}, {'price': 4117.165, 'bar_index': -4}], 'swing_lows_SSL': [{'price': 3944.632, 'bar_index': -49}, {'price': 3947.001, 'bar_index': -39}, {'price': 3952.655, 'bar_index': -36}, {'price': 3970.666, 'bar_index': -29}, {'price': 3975.036, 'bar_index': -26}]}, 'fvgs_h1': [{'type': 'Bullish', 'top': 4157.184, 'bottom': 4146.081}, {'type': 'Bearish', 'top': 4207.086, 'bottom': 4206.478}], 'order_blocks_h1': [{'type': 'Bullish', 'top': 4020.939, 'bottom': 4005.731, 'bar_index': 57}, {'type': 'Bearish', 'top': 4218.311, 'bottom': 4207.086, 'bar_index': 114}], 'liquidity_voids_h1': [{'type': 'Bullish', 'top': 4186.836, 'bottom': 4162.109, 'bar_index': 77}, {'type': 'Bullish', 'top': 4095.667, 'bottom': 4078.257, 'bar_index': 43}, {'type': 'Bullish', 'top': 4045.367, 'bottom': 4008.706, 'bar_index': 28}], 'premium_discount_h1': {'high': 4218.311, 'low': 3975.036, 'equilibrium': 4096.6735, 'status': 'Premium'}, 'mss_h1': {'type': 'Bearish', 'event': 'CHoCH', 'price_level': 3975.036, 'break_bar_index': 30}, 'liquidity_m15': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': -29}, {'price': 4206.478, 'bar_index': -21}, {'price': 4204.346, 'bar_index': -16}, {'price': 4193.778, 'bar_index': -40}, {'price': 4190.951, 'bar_index': -47}], 'swing_lows_SSL': [{'price': 4097.823, 'bar_index': -102}, {'price': 4126.254, 'bar_index': -94}, {'price': 4127.961, 'bar_index': -89}, {'price': 4134.418, 'bar_index': -76}, {'price': 4140.669, 'bar_index': -70}]}, 'fvgs_m15': [{'type': 'Bullish', 'top': 4186.166, 'bottom': 4180.028}, {'type': 'Bearish', 'top': 4207.767, 'bottom': 4203.85}], 'order_blocks_m15': [{'type': 'Bullish', 'top': 4168.145, 'bottom': 4159.337, 'bar_index': 41}, {'type': 'Bearish', 'top': 4217.003, 'bottom': 4210.519, 'bar_index': 72}], 'liquidity_voids_m15': [{'type': 'Bullish', 'top': 4203.231, 'bottom': 4191.561, 'bar_index': 31}, {'type': 'Bearish', 'top': 4217.002, 'bottom': 4207.767, 'bar_index': 23}, {'type': 'Bullish', 'top': 4200.41, 'bottom': 4193.415, 'bar_index': 15}], 'premium_discount_m15': {'high': 4204.346, 'low': 4140.669, 'equilibrium': 4172.5075, 'status': 'Premium'}, 'mss_m15': None, 'liquidity_m5': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': 97}, {'price': 4217.002, 'bar_index': 104}, {'price': 4207.942, 'bar_index': 89}, {'price': 4206.478, 'bar_index': 122}, {'price': 4204.346, 'bar_index': 138}], 'swing_lows_SSL': [{'price': 4153.911, 'bar_index': 3}, {'price': 4157.184, 'bar_index': -14}, {'price': 4158.095, 'bar_index': -2}, {'price': 4159.337, 'bar_index': 8}, {'price': 4164.832, 'bar_index': 110}]}, 'fvgs_m5': [{'type': 'Bullish', 'top': 4184.393, 'bottom': 4180.522}, {'type': 'Bearish', 'top': 4197.723, 'bottom': 4193.834}], 'order_blocks_m5': [{'type': 'Bearish', 'top': 4202.804, 'bottom': 4198.267, 'bar_index': 162}], 'liquidity_voids_m5': [{'type': 'Bullish', 'top': 4193.806, 'bottom': 4190.576, 'bar_index': 179}, {'type': 'Bullish', 'top': 4197.568, 'bottom': 4187.649, 'bar_index': 176}, {'type': 'Bullish', 'top': 4190.013, 'bottom': 4181.504, 'bar_index': 172}], 'premium_discount_m5': {'high': 4204.346, 'low': 4164.832, 'equilibrium': 4184.589, 'status': 'Premium'}, 'mss_m5': None, 'liquidity_m1': {'swing_highs_BSL': [{'price': 4204.346, 'bar_index': -67}, {'price': 4202.804, 'bar_index': -44}, {'price': 4200.59, 'bar_index': -51}, {'price': 4198.769, 'bar_index': -55}, {'price': 4197.84, 'bar_index': 29}], 'swing_lows_SSL': [{'price': 4176.248, 'bar_index': -18}, {'price': 4180.095, 'bar_index': -15}, {'price': 4180.184, 'bar_index': -24}, {'price': 4180.555, 'bar_index': -27}, {'price': 4181.314, 'bar_index': 1}]}, 'fvgs_m1': [{'type': 'Bullish', 'top': 4193.074, 'bottom': 4189.946}, {'type': 'Bearish', 'top': 4194.078, 'bottom': 4193.834}], 'order_blocks_m1': [{'type': 'Bullish', 'top': 4189.501, 'bottom': 4188.089, 'bar_index': 101}, {'type': 'Bearish', 'top': 4197.84, 'bottom': 4195.915, 'bar_index': 109}], 'liquidity_voids_m1': [{'type': 'Bullish', 'top': 4193.806, 'bottom': 4191.275, 'bar_index': 88}, {'type': 'Bullish', 'top': 4190.73, 'bottom': 4188.799, 'bar_index': 86}, {'type': 'Bearish', 'top': 4196.749, 'bottom': 4193.309, 'bar_index': 80}], 'premium_discount_m1': {'high': 4197.84, 'low': 4181.314, 'equilibrium': 4189.577, 'status': 'Premium'}, 'mss_m1': None}
2025-10-15 13:27:11,420 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:11,420 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:11,422 - APP.utils.safe_data - DEBUG - Get top-level key 'news_analysis': {'is_in_news_window': False, 'reason': None, 'upcoming_events': [{'id': 'investpy_16/10/2025_12:30_Philadelphia Fed Manufacturing Index  (Oct)', 'when_utc': datetime.datetime(2025, 10, 16, 12, 30, tzinfo=<UTC>), 'title': 'Philadelphia Fed Manufacturing Index  (Oct)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': 8.6, 'previous': 23.2, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 19, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '23h 2m'}, {'id': 'investpy_16/10/2025_12:30_PPI (MoM)  (Sep)', 'when_utc': datetime.datetime(2025, 10, 16, 12, 30, tzinfo=<UTC>), 'title': 'PPI (MoM)  (Sep)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': None, 'previous': -0.1, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 19, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '23h 2m'}, {'id': 'investpy_16/10/2025_12:30_Retail Sales (MoM)  (Sep)', 'when_utc': datetime.datetime(2025, 10, 16, 12, 30, tzinfo=<UTC>), 'title': 'Retail Sales (MoM)  (Sep)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': None, 'previous': 0.6, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 19, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '23h 2m'}], 'last_refresh_utc': datetime.datetime(2025, 10, 15, 13, 26, 46, 194312, tzinfo=<UTC>), 'latency_sec': 7.8527285999989545}
2025-10-15 13:27:11,422 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:11,423 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:11,424 - APP.utils.safe_data - DEBUG - Get top-level key 'news_analysis': {'is_in_news_window': False, 'reason': None, 'upcoming_events': [{'id': 'investpy_16/10/2025_12:30_Philadelphia Fed Manufacturing Index  (Oct)', 'when_utc': datetime.datetime(2025, 10, 16, 12, 30, tzinfo=<UTC>), 'title': 'Philadelphia Fed Manufacturing Index  (Oct)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': 8.6, 'previous': 23.2, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 19, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '23h 2m'}, {'id': 'investpy_16/10/2025_12:30_PPI (MoM)  (Sep)', 'when_utc': datetime.datetime(2025, 10, 16, 12, 30, tzinfo=<UTC>), 'title': 'PPI (MoM)  (Sep)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': None, 'previous': -0.1, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 19, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '23h 2m'}, {'id': 'investpy_16/10/2025_12:30_Retail Sales (MoM)  (Sep)', 'when_utc': datetime.datetime(2025, 10, 16, 12, 30, tzinfo=<UTC>), 'title': 'Retail Sales (MoM)  (Sep)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': None, 'previous': 0.6, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 19, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '23h 2m'}], 'last_refresh_utc': datetime.datetime(2025, 10, 15, 13, 26, 46, 194312, tzinfo=<UTC>), 'latency_sec': 7.8527285999989545}
2025-10-15 13:27:11,459 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:11,460 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:11,461 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 13:27:11,462 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:11,463 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:11,463 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 13:27:11,464 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:11,464 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:11,466 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:11,467 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:11,468 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:11,468 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,472 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:11,473 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:11,474 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.412, 'ask': 4193.449, 'last': 0.0, 'time': 1760534826}
2025-10-15 13:27:11,475 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:11,476 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:11,476 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:11,477 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:11,477 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:11,478 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:11,478 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:11,478 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:11,479 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,480 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:11+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:11,481 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:11,481 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,482 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:11+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:11,482 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:11,483 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 446, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:11,483 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:11+07:00
2025-10-15 13:27:11,484 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:11,485 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 489, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:11,485 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:11+07:00 trong DST: True
2025-10-15 13:27:11,486 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:11,488 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,489 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:11,489 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:11,509 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,510 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:11,511 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.481, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:11,511 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,512 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:11,513 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:11,513 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,514 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,514 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:11,516 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:11,516 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,517 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:11,519 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:11,553 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:11,554 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,555 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:11,560 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:11,561 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,563 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:11,564 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:11,566 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13675.999999999476
2025-10-15 13:27:11,566 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:11,567 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:11,568 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102876.99999999996
2025-10-15 13:27:11,568 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:11,569 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:11,569 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7369.999999999891
2025-10-15 13:27:11,570 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:11,570 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:11,571 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31844.999999999345
2025-10-15 13:27:11,573 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,574 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:11,574 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:11,575 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,576 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:11,576 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13675.999999999476}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102876.99999999996}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7369.999999999891}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31844.999999999345}]
2025-10-15 13:27:11,576 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:11,577 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:11,578 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:11,578 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:11,582 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:11,603 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:11,604 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,604 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:11,605 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:11,605 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,606 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:11,606 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:11,607 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13606.99999999997}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102808.00000000045}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7301.000000000386}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31775.99999999984}]
2025-10-15 13:27:11,608 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:11,608 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:11,609 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:06+07:00
2025-10-15 13:27:11,610 - APP.services.mt5_service - DEBUG - Position in day range: 0.6144409937888188
2025-10-15 13:27:11,611 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:11,611 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:11,617 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:09+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:11,642 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:09+07:00
2025-10-15 13:27:11,646 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:11,701 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:11,702 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:09+07:00 trong DST: True
2025-10-15 13:27:11,704 - APP.utils.safe_data - DEBUG - Truy cập raw data.
2025-10-15 13:27:11,734 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:11,734 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:11,739 - APP.utils.threading_utils - DEBUG - Task song song '_execute_stage_2_logic' hoàn tất thành công.
2025-10-15 13:27:11,763 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:11,764 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:11,765 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:11,765 - APP.core.analysis_worker - DEBUG - BẮT ĐẦU GIAI ĐOẠN 4: Gọi Model AI
2025-10-15 13:27:11,766 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:11,766 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:11,770 - APP.core.analysis_worker - WARNING - Khong co media nao duoc upload thanh cong; tiep tuc goi model voi prompt van ban.
2025-10-15 13:27:11,794 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:11,794 - APP.ui.components.prompt_manager - DEBUG - Đang lấy nội dung prompts từ UI.
2025-10-15 13:27:11,795 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:11,796 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,796 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:11,797 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:11,797 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,798 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:11,835 - APP.ui.components.prompt_manager - DEBUG - Đang lấy nội dung prompts từ UI.
2025-10-15 13:27:11,836 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '4800', 'price': 4193.48, 'distance_pips': 0.1}, {'level': '4825', 'price': 4193.483, 'distance_pips': 0.15}, {'level': '4850', 'price': 4193.485, 'distance_pips': 0.4}, {'level': '4875', 'price': 4193.488, 'distance_pips': 0.65}]
2025-10-15 13:27:11,837 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:11,838 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:11,839 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:11,840 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:11,840 - APP.analysis.prompt_builder - DEBUG - Không có vị thế, chọn prompt 'no_entry' để tìm kiếm setup.
2025-10-15 13:27:11,841 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,841 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:11,842 - APP.analysis.prompt_builder - DEBUG - Bắt đầu xây dựng prompt cuối cùng.
2025-10-15 13:27:11,842 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,843 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:11,844 - APP.analysis.prompt_builder - DEBUG - Đã xây dựng xong prompt cuối cùng.
2025-10-15 13:27:11,844 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:11,845 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:11,846 - APP.core.analysis_worker - DEBUG - --- PROMPT FINAL GỬI ĐẾN AI ---
VAI TRÒ & BỐI CẢNH
- Bạn là một nhà giao dịch ICT chuyên nghiệp và một nhà quản lý rủi ro.
- Nhiệm vụ của bạn là phân tích thị trường theo phương pháp Top-Down VÀ quản lý các lệnh đang mở một cách hiệu quả.
- Bạn phải suy luận logic, dựa trên bằng chứng từ dữ liệu thị trường.

---
### NHIỆM VỤ 1: XÁC ĐỊNH BỐI CẢNH VÀ HÀNH ĐỘNG CẦN THIẾT

**DỰA VÀO `CONTEXT.HAS_ACTIVE_POSITIONS`, HÃY CHỌN MỘT TRONG HAI LUỒNG SAU:**

---
#### LUỒNG A: CHƯA CÓ LỆNH (HAS_ACTIVE_POSITIONS = false)

**A1. QUY TRÌNH PHÂN TÍCH TOP-DOWN 4 BƯỚC**
   - Thực hiện phân tích Top-Down (H1 -> M15 -> M5) để tìm kiếm cơ hội giao dịch chất lượng cao.
   - **Bằng chứng**: Luôn trích dẫn dữ liệu cụ thể từ `EXTRACT_JSON` và `CONCEPT_VALUE_TABLE`.
   - **Kết quả**: Xây dựng một "câu chuyện thị trường", xếp hạng setup (`A+`, `B`, `C`), và lập kế hoạch giao dịch chi tiết nếu phù hợp.

**A2. TẠO ĐỐI TƯỢNG JSON - ĐÁNH GIÁ SETUP**
   - Tổng hợp kết quả phân tích vào đối tượng JSON sau. **Đây phải là phần đầu tiên trong phản hồi của bạn.**
   ```json
   {
     "cycle": "[ĐIỀN THỜI GIAN HIỆN TẠI]",
     "symbol": "[LẤY TỪ DỮ LIỆU]",
     "mode": "expert_setup_evaluation",
     "market_narrative": "[CÂU CHUYỆN THỊ TRƯỜNG TỪ BƯỚC A1]",
     "setup_grade": "[A+/B/C/Không có]",
     "reasoning_summary": "[GIẢI THÍCH NGẮN GỌN VÌ SAO XẾP HẠNG SETUP NHƯ VẬY]",
     "top_down_analysis": {
       "h1_context": { "order_flow": "[...]", "draw_on_liquidity": "[...]" },
       "m15_poi": { "type": "[...]", "price_zone": "[...]", "quality_assessment": "[...]" },
       "m5_m1_confirmation": { "status": "[...]", "signal": "[...]" }
     },
     "proposed_plan": {
       "direction": "[long/short hoặc null]",
       "entry": "[Giá hoặc 0.0]",
       "sl": "[Giá hoặc 0.0]",
       "tp1": "[Giá hoặc 0.0]",
       "tp2": "[Giá hoặc 0.0]",
       "risk_multiplier": "[1.0 cho A+, 0.5 cho B, 0.0 cho các trường hợp khác]"
     }
   }
   ```

---
#### LUỒNG B: ĐANG CÓ LỆNH (HAS_ACTIVE_POSITIONS = true)

**B1. PHÂN TÍCH BỐI CẢNH ĐỂ QUẢN LÝ LỆNH**
   - **Đánh giá lại Draw on Liquidity (H1)**: Mục tiêu giá ban đầu còn hợp lệ không? Có mục tiêu nào mới xuất hiện không?
   - **Phân tích cấu trúc M5/M1**: Cấu trúc thị trường gần nhất (`EXTRACT_JSON.tf.M5.mss_bos`) đang ủng hộ hay chống lại lệnh hiện tại?
   - **Tìm kiếm các vùng cản/hỗ trợ mới**: Có FVG hoặc Order Block nào mới hình thành có thể ảnh hưởng đến lệnh không?

**B2. TẠO ĐỐI TƯỢNG JSON - KẾ HOẠCH QUẢN LÝ**
   - Dựa trên phân tích ở B1, hãy tạo kế hoạch quản lý cho TỪNG lệnh đang mở.
   - **Đây phải là phần đầu tiên trong phản hồi của bạn.**
   ```json
   {
     "cycle": "[ĐIỀN THỜI GIAN HIỆN TẠI]",
     "symbol": "[LẤY TỪ DỮ LIỆU]",
     "mode": "trade_management",
     "market_narrative": "[TÓM TẮT BỐI CẢNH THỊ TRƯỜNG HIỆN TẠI ẢNH HƯỞNG ĐẾN LỆNH]",
     "reasoning_summary": "[GIẢI THÍCH NGẮN GỌN CHO CÁC HÀNH ĐỘNG QUẢN LÝ]",
     "management_plan": {
       "[TICKET_LỆNH_1]": {
         "action": "[HOLD/CLOSE_PARTIAL/MOVE_SL_TO_ENTRY/TRAIL_SL]",
         "percentage": "[50 nếu CLOSE_PARTIAL, ngược lại 0]",
         "sl": "[Giá SL mới, 'entry', 'last_swing_low_m5', 'last_swing_high_m5' hoặc null nếu không đổi]",
         "tp": "[Giá TP mới hoặc null nếu không đổi]",
         "reason": "[Lý do ngắn gọn cho hành động này]"
       },
       "[TICKET_LỆNH_2]": {
         "...": "..."
       },
       "ALL": {
         "action": "[HOLD/CLOSE_ALL]",
         "reason": "[Áp dụng nếu muốn thực hiện hành động cho tất cả lệnh]"
       }
     }
   }
   ```

---
### NHIỆM VỤ 2: VIẾT BÁO CÁO PHÂN TÍCH CHI TIẾT

Dựa vào đối tượng JSON bạn vừa tạo (từ Luồng A hoặc B), hãy viết một báo cáo chuyên nghiệp.

A) **TÓM TẮT NHANH (7 DÒNG):**
   - **(Luồng A)**: Trình bày tóm tắt về cơ hội giao dịch như prompt cũ.
   - **(Luồng B)**: Trình bày tóm tắt về các hành động quản lý được đề xuất cho mỗi lệnh.

B) **PHÂN TÍCH CHUYÊN SÂU:**
   - Diễn giải chi tiết về `market_narrative`.
   - Giải thích lý do đằng sau `setup_grade` (Luồng A) hoặc các quyết định trong `management_plan` (Luồng B), luôn sử dụng bằng chứng từ dữ liệu.

---
**Dữ liệu thị trường và tài khoản (MT5):**
```json
{'symbol': 'XAUUSD', 'generated_at': '2025-10-15 20:27:10', 'broker_time': '2025-10-15T20:27:06+07:00', 'timezone': 'Asia/Ho_Chi_Minh', 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}, 'positions': [], 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}, 'symbol_rules': {'volume_min': 0.01, 'volume_max': 200.0, 'volume_step': 0.01, 'trade_tick_value': 0.1, 'trade_tick_size': 0.001, 'stop_level_points': 0, 'freeze_level_points': 0, 'margin_initial': 0.0, 'margin_maintenance': 0.0}, 'pip': {'points_per_pip': 10, 'value_per_point': 0.1, 'pip_value_per_lot': 1.0}, 'tick': {'bid': 4193.412, 'ask': 4193.449, 'last': 0.0, 'time': 1760534826}, 'tick_stats_5m': {'ticks_per_min': 446, 'median_spread': 37.0, 'p90_spread': 37}, 'tick_stats_30m': {'ticks_per_min': 489, 'median_spread': 37.0, 'p90_spread': 37}, 'levels': {'daily': {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, 'prev_day': {'high': 4179.805, 'low': 4090.604}, 'weekly': {'open': 4035.257, 'high': 4218.311, 'low': 4024.361}, 'prev_week': {'high': 4059.382, 'low': 3884.095}, 'monthly': {'open': 3863.002, 'high': 4218.311, 'low': 3819.397}}, 'day_open': 4161.636, 'prev_day_close': 4161.674, 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}, 'day_range': 64.39999999999964, 'day_range_pct_of_adr20': 100.43699450091795, 'position_in_day_range': 0.6133695652173979, 'sessions_today': {'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, 'session_liquidity': {'asia_high': 4218.311, 'asia_low': 4184.27}, 'volatility': {'ATR': {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}}, 'volatility_regime': 'trending', 'trend_refs': {'EMA': {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}}, 'vwap': {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}, 'kills': {'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, 'is_silver_bullet_window': False, 'killzone_active': 'newyork_am', 'mins_to_next_killzone': None, 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13606.99999999997}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102808.00000000045}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7301.000000000386}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31775.99999999984}], 'round_levels': [{'level': '4100', 'price': 4193.41, 'distance_pips': 0.2}, {'level': '4125', 'price': 4193.412, 'distance_pips': 0.05}, {'level': '4150', 'price': 4193.415, 'distance_pips': 0.3}, {'level': '4175', 'price': 4193.417, 'distance_pips': 0.55}], 'atr_norm': {'spread_as_pct_of_atr_m5': 0.626928245165}, 'ict_patterns': {'liquidity_h1': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': 34}, {'price': 4179.805, 'bar_index': 8}, {'price': 4155.378, 'bar_index': 19}, {'price': 4145.283, 'bar_index': 11}, {'price': 4117.165, 'bar_index': -4}], 'swing_lows_SSL': [{'price': 3944.632, 'bar_index': -49}, {'price': 3947.001, 'bar_index': -39}, {'price': 3952.655, 'bar_index': -36}, {'price': 3970.666, 'bar_index': -29}, {'price': 3975.036, 'bar_index': -26}]}, 'fvgs_h1': [{'type': 'Bullish', 'top': 4157.184, 'bottom': 4146.081}, {'type': 'Bearish', 'top': 4207.086, 'bottom': 4206.478}], 'order_blocks_h1': [{'type': 'Bullish', 'top': 4020.939, 'bottom': 4005.731, 'bar_index': 57}, {'type': 'Bearish', 'top': 4218.311, 'bottom': 4207.086, 'bar_index': 114}], 'liquidity_voids_h1': [{'type': 'Bullish', 'top': 4186.836, 'bottom': 4162.109, 'bar_index': 77}, {'type': 'Bullish', 'top': 4095.667, 'bottom': 4078.257, 'bar_index': 43}, {'type': 'Bullish', 'top': 4045.367, 'bottom': 4008.706, 'bar_index': 28}], 'premium_discount_h1': {'high': 4218.311, 'low': 3975.036, 'equilibrium': 4096.6735, 'status': 'Premium'}, 'mss_h1': {'type': 'Bearish', 'event': 'CHoCH', 'price_level': 3975.036, 'break_bar_index': 30}, 'liquidity_m15': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': -29}, {'price': 4206.478, 'bar_index': -21}, {'price': 4204.346, 'bar_index': -16}, {'price': 4193.778, 'bar_index': -40}, {'price': 4190.951, 'bar_index': -47}], 'swing_lows_SSL': [{'price': 4097.823, 'bar_index': -102}, {'price': 4126.254, 'bar_index': -94}, {'price': 4127.961, 'bar_index': -89}, {'price': 4134.418, 'bar_index': -76}, {'price': 4140.669, 'bar_index': -70}]}, 'fvgs_m15': [{'type': 'Bullish', 'top': 4186.166, 'bottom': 4180.028}, {'type': 'Bearish', 'top': 4207.767, 'bottom': 4203.85}], 'order_blocks_m15': [{'type': 'Bullish', 'top': 4168.145, 'bottom': 4159.337, 'bar_index': 41}, {'type': 'Bearish', 'top': 4217.003, 'bottom': 4210.519, 'bar_index': 72}], 'liquidity_voids_m15': [{'type': 'Bullish', 'top': 4203.231, 'bottom': 4191.561, 'bar_index': 31}, {'type': 'Bearish', 'top': 4217.002, 'bottom': 4207.767, 'bar_index': 23}, {'type': 'Bullish', 'top': 4200.41, 'bottom': 4193.415, 'bar_index': 15}], 'premium_discount_m15': {'high': 4204.346, 'low': 4140.669, 'equilibrium': 4172.5075, 'status': 'Premium'}, 'mss_m15': None, 'liquidity_m5': {'swing_highs_BSL': [{'price': 4218.311, 'bar_index': 97}, {'price': 4217.002, 'bar_index': 104}, {'price': 4207.942, 'bar_index': 89}, {'price': 4206.478, 'bar_index': 122}, {'price': 4204.346, 'bar_index': 138}], 'swing_lows_SSL': [{'price': 4153.911, 'bar_index': 3}, {'price': 4157.184, 'bar_index': -14}, {'price': 4158.095, 'bar_index': -2}, {'price': 4159.337, 'bar_index': 8}, {'price': 4164.832, 'bar_index': 110}]}, 'fvgs_m5': [{'type': 'Bullish', 'top': 4184.393, 'bottom': 4180.522}, {'type': 'Bearish', 'top': 4197.723, 'bottom': 4193.834}], 'order_blocks_m5': [{'type': 'Bearish', 'top': 4202.804, 'bottom': 4198.267, 'bar_index': 162}], 'liquidity_voids_m5': [{'type': 'Bullish', 'top': 4193.806, 'bottom': 4190.576, 'bar_index': 179}, {'type': 'Bullish', 'top': 4197.568, 'bottom': 4187.649, 'bar_index': 176}, {'type': 'Bullish', 'top': 4190.013, 'bottom': 4181.504, 'bar_index': 172}], 'premium_discount_m5': {'high': 4204.346, 'low': 4164.832, 'equilibrium': 4184.589, 'status': 'Premium'}, 'mss_m5': None, 'liquidity_m1': {'swing_highs_BSL': [{'price': 4204.346, 'bar_index': -67}, {'price': 4202.804, 'bar_index': -44}, {'price': 4200.59, 'bar_index': -51}, {'price': 4198.769, 'bar_index': -55}, {'price': 4197.84, 'bar_index': 29}], 'swing_lows_SSL': [{'price': 4176.248, 'bar_index': -18}, {'price': 4180.095, 'bar_index': -15}, {'price': 4180.184, 'bar_index': -24}, {'price': 4180.555, 'bar_index': -27}, {'price': 4181.314, 'bar_index': 1}]}, 'fvgs_m1': [{'type': 'Bullish', 'top': 4193.074, 'bottom': 4189.946}, {'type': 'Bearish', 'top': 4194.078, 'bottom': 4193.834}], 'order_blocks_m1': [{'type': 'Bullish', 'top': 4189.501, 'bottom': 4188.089, 'bar_index': 101}, {'type': 'Bearish', 'top': 4197.84, 'bottom': 4195.915, 'bar_index': 109}], 'liquidity_voids_m1': [{'type': 'Bullish', 'top': 4193.806, 'bottom': 4191.275, 'bar_index': 88}, {'type': 'Bullish', 'top': 4190.73, 'bottom': 4188.799, 'bar_index': 86}, {'type': 'Bearish', 'top': 4196.749, 'bottom': 4193.309, 'bar_index': 80}], 'premium_discount_m1': {'high': 4197.84, 'low': 4181.314, 'equilibrium': 4189.577, 'status': 'Premium'}, 'mss_m1': None}, 'risk_model': {}, 'rr_projection': {}, 'news_analysis': {'is_in_news_window': False, 'reason': None, 'upcoming_events': [{'id': 'investpy_16/10/2025_12:30_Philadelphia Fed Manufacturing Index  (Oct)', 'when_utc': datetime.datetime(2025, 10, 16, 12, 30, tzinfo=<UTC>), 'title': 'Philadelphia Fed Manufacturing Index  (Oct)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': 8.6, 'previous': 23.2, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 19, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '23h 2m'}, {'id': 'investpy_16/10/2025_12:30_PPI (MoM)  (Sep)', 'when_utc': datetime.datetime(2025, 10, 16, 12, 30, tzinfo=<UTC>), 'title': 'PPI (MoM)  (Sep)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': None, 'previous': -0.1, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 19, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '23h 2m'}, {'id': 'investpy_16/10/2025_12:30_Retail Sales (MoM)  (Sep)', 'when_utc': datetime.datetime(2025, 10, 16, 12, 30, tzinfo=<UTC>), 'title': 'Retail Sales (MoM)  (Sep)', 'country': 'united states', 'impact': 'high', 'source': 'investpy', 'actual': None, 'forecast': None, 'previous': 0.6, 'unit': None, 'surprise_score': None, 'when_local': datetime.datetime(2025, 10, 16, 19, 30, tzinfo=<DstTzInfo 'Asia/Ho_Chi_Minh' +07+7:00:00 STD>), 'time_remaining': '23h 2m'}], 'last_refresh_utc': datetime.datetime(2025, 10, 15, 13, 26, 46, 194312, tzinfo=<UTC>), 'latency_sec': 7.8527285999989545}, 'concept_value_table': '| Khái niệm (Concept) | Giá trị (Value) |\n|---|---|\n| Symbol | XAUUSD |\n| Killzone Hiện tại | newyork_am |\n| Chế độ Biến động | trending |\n| H1 Order Flow | Bearish |\n| M15 Structure | Không rõ |\n| Trong Cửa sổ Tin tức | False |\n| Tin tức Sắp tới | 23h 2m - Philadelphia Fed Manufacturing Index  (Oct) |\n', 'evaluations': {'no_trade': {'blocking': [], 'warnings': [], 'metrics': {'spread': {'current_pips': 3.7, 'threshold_pips': 4.2, 'median_5m_pips': 3.7, 'p90_5m_pips': 3.7, 'median_30m_pips': 3.7, 'p90_30m_pips': 3.7, 'atr_pct': 0.626928245165}, 'atr': {'atr_m5_pips': 590.1791837375979, 'min_required_pips': 0.3, 'adr20_pips': 6411.980000000005, 'atr_pct_of_adr20': 9.204320408635045}, 'key_levels': {'nearest': {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7301.000000000386}, 'threshold_pips': 5.0, 'levels': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13606.99999999997}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102808.00000000045}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7301.000000000386}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31775.99999999984}]}, 'collected_at': '2025-10-15T20:27:06+07:00'}, 'messages': [], 'status': 'ok', 'evaluated_at': '2025-10-15T13:27:11.704433+00:00'}}}
```

---
**Bối cảnh bổ sung từ các báo cáo trước:**


[CONTEXT_COMPOSED]
{"CONTEXT_COMPOSED": {"cycle": "2025-10-15 13:27:07", "trend_checklist": {"trend": "unknown", "enough_ratio": null}, "latest_plan": null, "latest_summary_lines": null, "recent_history_summary": null, "run_meta": {"analysis_id": "2025-10-15T13:27:07Z", "folder_signature": "sha1:49c2e050742d71fcee49851b6f2172d1f5ebc9b1", "images_tf_map": {"XAUUSD_H1.png": "H1", "XAUUSD_M1.png": "M1", "XAUUSD_M15.png": "M15", "XAUUSD_M5.png": "M5"}}, "running_stats": {"backtest_results": {"status": "not_implemented"}}, "risk_rules": {"max_risk_per_trade_pct": 1.0, "daily_loss_limit_pct": 3.0, "max_trades_per_day": 3}}}

---
**Phân tích các hình ảnh được cung cấp.**
--- KẾT THÚC PROMPT ---
2025-10-15 13:27:11,847 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.481
2025-10-15 13:27:11,847 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:11,852 - APP.services.gemini_service - DEBUG - Bắt đầu stream tới Gemini API với 5 lần thử.
2025-10-15 13:27:11,853 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:11,854 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.595, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:11,861 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:11,879 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:11,881 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:11,883 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:11,883 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:11,884 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:11,884 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:11,885 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.481
2025-10-15 13:27:11,885 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:11,886 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:11,887 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13789.999999999964
2025-10-15 13:27:11,888 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:11,889 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:11,890 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102991.00000000044
2025-10-15 13:27:11,891 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:11,891 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7484.000000000378
2025-10-15 13:27:11,925 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:11,926 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:11,926 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31958.999999999833
2025-10-15 13:27:11,928 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.481
2025-10-15 13:27:11,928 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:11,930 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:11,930 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13789.999999999964}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102991.00000000044}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7484.000000000378}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31958.999999999833}]
2025-10-15 13:27:11,931 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:11,931 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:11,932 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:11,933 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:11,933 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:11,934 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:11,934 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:11,935 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:11,936 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.481
2025-10-15 13:27:11,936 - APP.services.mt5_service - DEBUG - Position in day range: 0.6162111801242302
2025-10-15 13:27:11,937 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:11,937 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:11+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:11,937 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:11,938 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:11+07:00
2025-10-15 13:27:11,939 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:11,939 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:11+07:00 trong DST: True
2025-10-15 13:27:11,940 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:11,941 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:11,942 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:11,942 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,943 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:11,943 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,943 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,944 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:11,944 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,945 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:11,946 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '5900', 'price': 4193.59, 'distance_pips': 0.5}, {'level': '5925', 'price': 4193.592, 'distance_pips': 0.25}, {'level': '5950', 'price': 4193.595, 'distance_pips': 0.0}, {'level': '5975', 'price': 4193.597, 'distance_pips': 0.25}]
2025-10-15 13:27:11,947 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:11,947 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:11,948 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:11,948 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:11,949 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:11,949 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:11,950 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:11,950 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:11,951 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.595
2025-10-15 13:27:11,951 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:11,952 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:11,952 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:11,953 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:11,953 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:11,954 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:11,954 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:11,955 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:11,983 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:11,984 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:11,984 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:11,985 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.595
2025-10-15 13:27:11,986 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:12,020 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:12,021 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:12,022 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:12,022 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:12,023 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:12,023 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:12,024 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:12,025 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,025 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:12,026 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:12,027 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.595
2025-10-15 13:27:12,027 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:12,028 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:12,028 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:12,029 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:12,029 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:12,030 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:12,031 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:12,031 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:12,032 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:12,033 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:12,033 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:12,034 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.595
2025-10-15 13:27:12,035 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:12,036 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:12,038 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:12,038 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:12,039 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:12,040 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:12,042 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,042 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:12,043 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.481, 'ask': 4193.518, 'last': 0.0, 'time': 1760534829}
2025-10-15 13:27:12,044 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,044 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:12,044 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:12,045 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.45s
2025-10-15 13:27:12,045 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:12,047 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:12,047 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:12,048 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:12,048 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:12,049 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:12,049 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:12,053 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:12,072 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:12,074 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:12,074 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:12,075 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:12,075 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:12,076 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:12,076 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:12,077 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:12,077 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,078 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:12,079 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:12,115 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:12,116 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:12,117 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:12,119 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:12,120 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:12,122 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:12,122 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,122 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:12,123 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.595, 'ask': 4193.632, 'last': 0.0, 'time': 1760534831}
2025-10-15 13:27:12,126 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:12,127 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:12,128 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:12,128 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:12,129 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,129 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:12,129 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:12,130 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 444, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:12,142 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 489, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:12,153 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,176 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:12,233 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,404 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:12,492 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,501 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:12,532 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,533 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:12,534 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:12,535 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:12,536 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:12,536 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:12,537 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,537 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:12,538 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:12,538 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:12,538 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:12,539 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:12,540 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13789.999999999964}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102991.00000000044}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7484.000000000378}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31958.999999999833}]
2025-10-15 13:27:12,540 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:11+07:00
2025-10-15 13:27:12,541 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:12,542 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:12,543 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:12,545 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.51s
2025-10-15 13:27:12,635 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:12,636 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:12,636 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:12,638 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:12,638 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:12,731 - urllib3.connectionpool - DEBUG - https://www.investing.com:443 "POST /economic-calendar/Service/getCalendarFilteredData HTTP/1.1" 200 None
2025-10-15 13:27:12,756 - APP.services.fmp_service - INFO - Lấy thành công 402 sự kiện từ investpy cho 7 ngày tới.
2025-10-15 13:27:12,762 - APP.utils.threading_utils - DEBUG - Task 'news.provider.fmp' (group=news.polling) hoàn tất sau 6.72s
2025-10-15 13:27:12,778 - APP.ui.app_ui - DEBUG - Callback nhận được 144 sự kiện tin tức mới.
2025-10-15 13:27:12,779 - APP.services.news_service - INFO - NewsService làm mới cache (144 sự kiện, priority=autorun, source=network, latency=6.76s)
2025-10-15 13:27:12,780 - APP.utils.threading_utils - DEBUG - Task 'news.refresh.autorun' (group=news.polling) hoàn tất sau 6.76s
2025-10-15 13:27:12,861 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 13:27:12,864 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:13,038 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:13,039 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:13,041 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:13,043 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:13,076 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:13,076 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:13,077 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:13,077 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:13,078 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:13,079 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:13,079 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:13,080 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:13,080 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:13,083 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:13,101 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:13,102 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:13,103 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:13,103 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:13,104 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:13,605 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:13,607 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:13,608 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:14,109 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:14,111 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:14,112 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:14,112 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:14,113 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.235
2025-10-15 13:27:14,113 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.279
2025-10-15 13:27:14,123 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:14,133 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:14,260 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 489, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:14,265 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:14,278 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:14,288 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 489, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:14,290 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:14,291 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:14,292 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:14,292 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:14,293 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:14,295 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:14,296 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:14,297 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:14,305 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:14,323 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:14,324 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:14,324 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:14,325 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:14,330 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:14,355 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:14,356 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:14,359 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:14,359 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:14,360 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:14,360 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:14,361 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:14,369 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:14,387 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:14,389 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:14,391 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:14,391 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:14,392 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:14,392 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:14,417 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:14,421 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:14,422 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:14,422 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:14,439 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:14,450 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:14,451 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:14,451 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:14,452 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:14,475 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:14,483 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:14,484 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:14,484 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:13+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:14,485 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:14,485 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:13+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:14,486 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:14,511 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:13+07:00
2025-10-15 13:27:14,511 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:13+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:14,512 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:13+07:00 trong DST: True
2025-10-15 13:27:14,513 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:13+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:14,513 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:14,514 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:13+07:00
2025-10-15 13:27:14,514 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:14,515 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:13+07:00 trong DST: True
2025-10-15 13:27:14,515 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:14,516 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:14,518 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:14,540 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:14,541 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:14,541 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:14,546 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:14,548 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:14,549 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:14,550 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:14,552 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:14,576 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:14,576 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:14,577 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:14,577 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:14,578 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:14,578 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:14,579 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:14,579 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:14,579 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:14,580 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:14,583 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:14,602 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:14,603 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:14,604 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:14,604 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:14,605 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:14,605 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:14,606 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:14,606 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:14,607 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:14,608 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:14,609 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:14,609 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:14,609 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:14,610 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:14,610 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:14,611 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:14,614 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:14,615 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:14,634 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:14,634 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:14,635 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:14,636 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:14,636 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:14,637 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:14,637 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:14,638 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:14,638 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:14,639 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:14,639 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:14,640 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:14,641 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:14,641 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:14,642 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:14,645 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:14,669 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:14,669 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:14,670 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:14,670 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:14,671 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.235, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:14,671 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:14,672 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:14,672 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:14,673 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:14,673 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:14,676 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:14,677 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:14,699 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.279, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:14,700 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:14,700 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:14,701 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13429.999999999382
2025-10-15 13:27:14,701 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:14,702 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102630.99999999985
2025-10-15 13:27:14,702 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:14,702 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7123.999999999796
2025-10-15 13:27:14,703 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:14,703 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:14,703 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31598.99999999925
2025-10-15 13:27:14,704 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:14,728 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13474.00000000016
2025-10-15 13:27:14,728 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:14,729 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102675.00000000064
2025-10-15 13:27:14,730 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13429.999999999382}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102630.99999999985}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7123.999999999796}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31598.99999999925}]
2025-10-15 13:27:14,730 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7168.000000000575
2025-10-15 13:27:14,731 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:14,732 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31643.00000000003
2025-10-15 13:27:14,733 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:14,734 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:14,734 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:14,735 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13474.00000000016}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102675.00000000064}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7168.000000000575}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31643.00000000003}]
2025-10-15 13:27:14,735 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:14,736 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:14,737 - APP.services.mt5_service - DEBUG - Position in day range: 0.6106211180124198
2025-10-15 13:27:14,757 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.05s
2025-10-15 13:27:14,760 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:14,760 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:13+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:14,761 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:14,762 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:13+07:00
2025-10-15 13:27:14,762 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:14,762 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:13+07:00 trong DST: True
2025-10-15 13:27:14,763 - APP.services.mt5_service - DEBUG - Position in day range: 0.6113043478260966
2025-10-15 13:27:14,763 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:14,764 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:13+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:14,764 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:14,764 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:13+07:00
2025-10-15 13:27:14,765 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:14,765 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:13+07:00 trong DST: True
2025-10-15 13:27:14,766 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:14,767 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:14,767 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:14,769 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:14,770 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:14,770 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:14,777 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2300', 'price': 4193.23, 'distance_pips': 0.5}, {'level': '2325', 'price': 4193.233, 'distance_pips': 0.25}, {'level': '2350', 'price': 4193.235, 'distance_pips': 0.0}, {'level': '2375', 'price': 4193.238, 'distance_pips': 0.25}]
2025-10-15 13:27:14,787 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:14,789 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2700', 'price': 4193.27, 'distance_pips': 0.9}, {'level': '2725', 'price': 4193.273, 'distance_pips': 0.65}, {'level': '2750', 'price': 4193.275, 'distance_pips': 0.4}, {'level': '2775', 'price': 4193.278, 'distance_pips': 0.15}]
2025-10-15 13:27:14,792 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:14,792 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:14,793 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:14,793 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:14,793 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:14,794 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:14,794 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:14,795 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:14,796 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.235
2025-10-15 13:27:14,796 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.279
2025-10-15 13:27:14,797 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:14,797 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:14,798 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:14,802 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:14,823 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:14,825 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:14,826 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:14,826 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:14,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:14,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:14,828 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.235
2025-10-15 13:27:14,829 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.279
2025-10-15 13:27:14,829 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:14,830 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:14,833 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:14,855 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:14,855 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:14,857 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:14,858 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:14,858 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:14,859 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:14,859 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:14,859 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:14,861 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.235
2025-10-15 13:27:14,862 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.279
2025-10-15 13:27:14,864 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:14,870 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:14,884 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:14,886 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:14,888 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:14,888 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:14,889 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:14,889 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:14,889 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:14,890 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:14,890 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.235
2025-10-15 13:27:14,891 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.279
2025-10-15 13:27:14,892 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:14,892 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:14,895 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:14,902 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:14,917 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:14,918 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:14,919 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:14,919 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:14,921 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:14,921 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:14,921 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:14,922 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:14,922 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:14,923 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:14,924 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:14,924 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:14,926 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:14,927 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:14,927 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:14,932 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:14,944 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:14,948 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:14,949 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:14,949 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:14,950 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:14,950 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:14,951 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:14,951 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:14,951 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:14,952 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:14,952 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:14,953 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:14,953 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:14,954 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:14,954 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:14,955 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:14,956 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:14,957 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:14,958 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:14,958 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:14,962 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:14,973 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:14,980 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:14,981 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:14,981 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:14,982 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:14,982 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:14,983 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:14,983 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:14,984 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:14,984 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:14,985 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:14,985 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:14,986 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:14,986 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:14,989 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:14,990 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:15,005 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:15,011 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:15,011 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:15,012 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:15,012 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:15,013 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:15,014 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.235, 'ask': 4193.272, 'last': 0.0, 'time': 1760534833}
2025-10-15 13:27:15,015 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:15,015 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:15,016 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:15,017 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.98s
2025-10-15 13:27:15,017 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:15,017 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:15,025 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:15,028 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.279, 'ask': 4193.316, 'last': 0.0, 'time': 1760534833}
2025-10-15 13:27:15,032 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:15,039 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:15,040 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:15,041 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:15,041 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:15,042 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 438, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:15,042 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 489, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:15,042 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:15,043 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:15,043 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:15,043 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:15,044 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:15,044 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:15,046 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:15,046 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:15,047 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:15,048 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:15,048 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:15,049 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:15,050 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:15,050 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:15,051 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:15,052 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:15,052 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:15,062 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:15,067 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:15,069 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:15,070 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13474.00000000016}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102675.00000000064}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7168.000000000575}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31643.00000000003}]
2025-10-15 13:27:15,072 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:13+07:00
2025-10-15 13:27:15,073 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:15,074 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:15,075 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:15,076 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.04s
2025-10-15 13:27:15,083 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:15,242 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:15,243 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:15,244 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:15,245 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:15,246 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:15,393 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:15,394 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:15,395 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:15,396 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:15,397 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:15,397 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:15,398 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:15,399 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:15,897 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 13:27:15,898 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 13:27:15,900 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:15,901 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:15,903 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.00s
2025-10-15 13:27:15,903 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:15,904 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.349
2025-10-15 13:27:15,914 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 437, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:15,975 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 488, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:15,977 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:15,978 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:15,980 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:15,980 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:15,981 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:15,981 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:15,984 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:15,985 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:15,985 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:15,986 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:15,991 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:16,000 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 13:27:16,008 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:16,010 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:16,011 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:16,014 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:16,014 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:16,016 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:16,017 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:16,032 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:16,043 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:16,044 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:16,045 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:16,046 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:16,048 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:16,048 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:15+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:16,073 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:15+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:16,074 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:15+07:00
2025-10-15 13:27:16,075 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:15+07:00 trong DST: True
2025-10-15 13:27:16,075 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:16,076 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:16,076 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:16,078 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:16,078 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:16,080 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:16,099 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:16,103 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:16,104 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:16,105 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:16,106 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:16,106 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:16,107 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:16,107 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:16,107 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:16,108 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:16,109 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:16,109 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:16,110 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:16,111 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:16,114 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:16,114 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:16,118 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:16,140 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:16,141 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:16,142 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:16,171 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:16,172 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:16,172 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:16,173 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:16,173 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:16,174 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:16,178 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:16,200 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:16,200 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:16,201 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:16,201 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:16,202 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:16,202 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:16,203 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:16,203 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:16,204 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.349, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:16,204 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:16,208 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:16,208 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:16,229 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:16,229 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13543.999999999869
2025-10-15 13:27:16,230 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102745.00000000035
2025-10-15 13:27:16,230 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7238.000000000284
2025-10-15 13:27:16,231 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31712.999999999738
2025-10-15 13:27:16,231 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:16,231 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13543.999999999869}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102745.00000000035}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7238.000000000284}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31712.999999999738}]
2025-10-15 13:27:16,232 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:16,615 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:16,616 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:16,617 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:16,617 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:16,618 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:16,618 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.286
2025-10-15 13:27:16,619 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:16,628 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 435, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:16,629 - APP.services.mt5_service - DEBUG - Position in day range: 0.6123913043478312
2025-10-15 13:27:16,656 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:15+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:16,668 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:15+07:00
2025-10-15 13:27:16,703 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:15+07:00 trong DST: True
2025-10-15 13:27:16,704 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 488, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:16,705 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:16,707 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:16,707 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:16,708 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:16,709 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:16,713 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:16,727 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:16,728 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:16,729 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:16,729 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:16,730 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3400', 'price': 4193.34, 'distance_pips': 0.9}, {'level': '3425', 'price': 4193.342, 'distance_pips': 0.65}, {'level': '3450', 'price': 4193.345, 'distance_pips': 0.4}, {'level': '3475', 'price': 4193.347, 'distance_pips': 0.15}]
2025-10-15 13:27:16,731 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:16,731 - APP.ui.app_ui - INFO - Yêu cầu dừng phân tích từ UI (session=manual-20251015-132706).
2025-10-15 13:27:16,731 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:16,735 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:16,759 - APP.utils.threading_utils - INFO - Cancel group 'analysis.session' → task 'analysis.session.manual-20251015-132706'
2025-10-15 13:27:16,761 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:16,761 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:16,762 - APP.core.analysis_controller - INFO - Đã gửi tín hiệu hủy cho session manual-20251015-132706
2025-10-15 13:27:16,762 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:16,763 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:16,764 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:16,764 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:16,765 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.349
2025-10-15 13:27:16,768 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:16,794 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:16,794 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:16,795 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:16,795 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:16,796 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:16,797 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:16,797 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:16,801 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:16,823 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:16,824 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:16,825 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.349
2025-10-15 13:27:16,825 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:16,826 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:16,826 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:16,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:16,830 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:16,857 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:16,858 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:16,859 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:16,859 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:16,859 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:16,860 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:16,861 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.349
2025-10-15 13:27:16,861 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:16+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:16,864 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:16+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:16,865 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:16,865 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:16+07:00
2025-10-15 13:27:16,888 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:16,889 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:16+07:00 trong DST: True
2025-10-15 13:27:16,890 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:16,890 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:16,891 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:16,891 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:16,891 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:16,892 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:16,893 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.349
2025-10-15 13:27:16,896 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:16,915 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:16,916 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:16,917 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:16,921 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:16,923 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:16,924 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:16,926 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:16,926 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:16,927 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:16,948 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:16,949 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:16,950 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:16,950 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:16,950 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:16,951 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:16,951 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:16,952 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:16,952 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:16,953 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:16,953 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:16,954 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:16,954 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:16,955 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:16,955 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:16,960 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:16,980 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:16,981 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:16,982 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:16,982 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:16,982 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:16,983 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:16,983 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:16,984 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:16,984 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:16,984 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:16,985 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:16,985 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:16,986 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:16,986 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:16,990 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:17,011 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:17,012 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:17,013 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:17,013 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:17,014 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:17,014 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,015 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:17,015 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,016 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:17,017 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:17,017 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:17,018 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:17,021 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:17,045 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:17,047 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:17,047 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:17,048 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:17,048 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:17,049 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:17,049 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:17,052 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.286, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:17,056 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:17,073 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:17,074 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:17,075 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:17,075 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,075 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:17,076 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.349, 'ask': 4193.386, 'last': 0.0, 'time': 1760534835}
2025-10-15 13:27:17,076 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:17,077 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:17,077 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13480.999999999767
2025-10-15 13:27:17,078 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.03s
2025-10-15 13:27:17,078 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102682.00000000025
2025-10-15 13:27:17,079 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7175.000000000182
2025-10-15 13:27:17,080 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31649.999999999636
2025-10-15 13:27:17,083 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:17,084 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13480.999999999767}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102682.00000000025}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7175.000000000182}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31649.999999999636}]
2025-10-15 13:27:17,100 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:17,101 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:17,101 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:17,102 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:17,102 - APP.services.mt5_service - DEBUG - Position in day range: 0.6114130434782643
2025-10-15 13:27:17,102 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:16+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:17,103 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:16+07:00
2025-10-15 13:27:17,103 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:16+07:00 trong DST: True
2025-10-15 13:27:17,104 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:17,104 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:17,105 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:17,105 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,106 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,106 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2800', 'price': 4193.28, 'distance_pips': 0.6}, {'level': '2825', 'price': 4193.282, 'distance_pips': 0.35}, {'level': '2850', 'price': 4193.285, 'distance_pips': 0.1}, {'level': '2875', 'price': 4193.287, 'distance_pips': 0.15}]
2025-10-15 13:27:17,107 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:17,107 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,108 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,108 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:17,109 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.286
2025-10-15 13:27:17,109 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:17,110 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:17,111 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:17,112 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:17,114 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:17,120 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.286
2025-10-15 13:27:17,136 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:17,138 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:17,138 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:17,139 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:17,139 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:17,140 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.286
2025-10-15 13:27:17,141 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:17,141 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:17,142 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:17,142 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:17,143 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:17,150 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:17,169 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.286
2025-10-15 13:27:17,300 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:17,305 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:17,317 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:17,318 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:17,319 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,326 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,363 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:17,374 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:17,377 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:17,378 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:17,381 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:17,382 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:17,384 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:17,387 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:17,390 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:17,391 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:17,426 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:17,449 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:17,453 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:17,455 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:17,462 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:17,463 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:17,477 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,479 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,479 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:17,481 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:17,482 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:17,484 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:17,485 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:17,491 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:17,518 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,542 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:17,543 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.286, 'ask': 4193.323, 'last': 0.0, 'time': 1760534836}
2025-10-15 13:27:17,543 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:17,544 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:17,547 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:17,547 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:17,552 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:17,580 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,605 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,605 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 435, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:17,606 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 488, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:17,607 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,607 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,608 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,608 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,609 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,609 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,610 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,610 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,610 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:17,611 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:17,612 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:17,640 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:17,640 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,641 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,641 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:17,642 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:17,643 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:17,671 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:17,672 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13480.999999999767}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102682.00000000025}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7175.000000000182}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31649.999999999636}]
2025-10-15 13:27:17,672 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:16+07:00
2025-10-15 13:27:17,673 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:17,674 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:17,676 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:17,704 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.66s
2025-10-15 13:27:17,771 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:17,772 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:17,773 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:17,774 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:17,775 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:18,050 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:18,051 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:18,052 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:18,055 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:18,084 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:18,085 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:18,086 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:18,086 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:18,087 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:18,087 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:18,088 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:18,088 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:18,089 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:18,089 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:18,090 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:18,091 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:18,091 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:18,092 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:18,092 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:18,594 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:18,596 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:18,596 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:19,098 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:19,099 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:19,100 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:19,100 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:19,101 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.301
2025-10-15 13:27:19,101 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.332
2025-10-15 13:27:19,111 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 437, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:19,134 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 437, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:19,253 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 488, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:19,265 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:19,294 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 488, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:19,308 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:19,310 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:19,321 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:19,321 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:19,323 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:19,328 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:19,329 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:19,336 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:19,349 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:19,387 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:19,463 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:19,475 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:19,477 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:19,502 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:19,566 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:19,569 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:19,570 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:19,572 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:19,608 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:19,624 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:19,626 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:19,633 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:19,634 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:19,635 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:19,636 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:19,717 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:19,723 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:19,819 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:19,829 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:19,848 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:19,924 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:19,976 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:20,015 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:20,025 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:20,104 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.06s
2025-10-15 13:27:20,126 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:20,226 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:20,281 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:20,286 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:20,290 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:20,299 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:20,302 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:20,303 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:20,303 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:20,304 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:20,305 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:20,305 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:18+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:20,306 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:20,306 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:18+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:20,307 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:17+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:20,307 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:18+07:00
2025-10-15 13:27:20,308 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:17+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:20,308 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:18+07:00 trong DST: True
2025-10-15 13:27:20,309 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:17+07:00
2025-10-15 13:27:20,309 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:20,310 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:17+07:00 trong DST: True
2025-10-15 13:27:20,310 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:20,311 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:20,311 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:20,311 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:20,312 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:20,313 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:20,313 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:20,315 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:20,320 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:20,368 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:20,397 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:20,402 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:20,405 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:20,406 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:20,408 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:20,409 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:20,411 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:20,411 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:20,412 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:20,413 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:20,413 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:20,414 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:20,414 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:20,415 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:20,415 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:20,416 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:20,416 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:20,417 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:20,417 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:20,418 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:20,418 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:20,419 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:20,419 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:20,420 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:20,420 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:20,421 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:20,421 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:20,422 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:20,422 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:20,422 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:20,423 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:20,423 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:20,424 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:20,425 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:20,427 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:20,427 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:20,428 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:20,447 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:20,448 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:20,450 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:20,450 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:20,451 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:20,451 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:20,452 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:20,452 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:20,453 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:20,453 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:20,454 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:20,454 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:20,454 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:20,455 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:20,456 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:20,456 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:20,458 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:20,459 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.332, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:20,460 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:20,482 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:20,483 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.301, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:20,483 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:20,484 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:20,484 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:20,485 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:20,485 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:20,485 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:20,486 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13527.000000000044
2025-10-15 13:27:20,486 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:20,487 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102728.00000000052
2025-10-15 13:27:20,487 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13496.000000000095
2025-10-15 13:27:20,489 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7221.000000000458
2025-10-15 13:27:20,489 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102697.00000000057
2025-10-15 13:27:20,490 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31695.999999999913
2025-10-15 13:27:20,511 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7190.000000000509
2025-10-15 13:27:20,512 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:20,513 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31664.999999999964
2025-10-15 13:27:20,513 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13527.000000000044}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102728.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7221.000000000458}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31695.999999999913}]
2025-10-15 13:27:20,514 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:20,514 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:20,514 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13496.000000000095}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102697.00000000057}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7190.000000000509}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31664.999999999964}]
2025-10-15 13:27:20,515 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:20,515 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:20,516 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:20,517 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:20,517 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:20,517 - APP.services.mt5_service - DEBUG - Position in day range: 0.6121273291925543
2025-10-15 13:27:20,518 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:20,521 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:18+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:20,543 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:20,544 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:18+07:00
2025-10-15 13:27:20,544 - APP.services.mt5_service - DEBUG - Position in day range: 0.6116459627329278
2025-10-15 13:27:20,545 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:18+07:00 trong DST: True
2025-10-15 13:27:20,545 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:17+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:20,546 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:20,546 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:17+07:00
2025-10-15 13:27:20,546 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:20,547 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:17+07:00 trong DST: True
2025-10-15 13:27:20,547 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:20,548 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:20,548 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,548 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:20,556 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,570 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:20,571 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3300', 'price': 4193.33, 'distance_pips': 0.2}, {'level': '3325', 'price': 4193.332, 'distance_pips': 0.05}, {'level': '3350', 'price': 4193.335, 'distance_pips': 0.3}, {'level': '3375', 'price': 4193.337, 'distance_pips': 0.55}]
2025-10-15 13:27:20,572 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,573 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:20,573 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,573 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,574 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3000', 'price': 4193.3, 'distance_pips': 0.1}, {'level': '3025', 'price': 4193.302, 'distance_pips': 0.15}, {'level': '3050', 'price': 4193.305, 'distance_pips': 0.4}, {'level': '3075', 'price': 4193.307, 'distance_pips': 0.65}]
2025-10-15 13:27:20,574 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,575 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:20,575 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:20,576 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,577 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.332
2025-10-15 13:27:20,577 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,578 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:20,579 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:20,579 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:20,580 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.301
2025-10-15 13:27:20,582 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:20,584 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:20,607 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:20,608 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:20,609 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:20,610 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.332
2025-10-15 13:27:20,611 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:20,612 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:20,614 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:20,614 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:20,615 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:20,616 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.301
2025-10-15 13:27:20,639 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:20,639 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:20,640 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:20,640 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:20,641 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:20,642 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:20,642 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.332
2025-10-15 13:27:20,643 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:20,646 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:20,647 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:20,649 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:20,670 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.301
2025-10-15 13:27:20,671 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:20,672 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:20,673 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:20,673 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:20,673 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:20,674 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:20,677 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.332
2025-10-15 13:27:20,697 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:20,699 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:20,699 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:20,700 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:20,700 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.301
2025-10-15 13:27:20,701 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:20,702 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:20,703 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:20,703 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:20,704 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,705 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:20,705 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,708 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:20,712 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:20,733 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:20,733 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:20,734 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:20,734 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,735 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:20,735 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,736 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:20,736 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:20,737 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:20,739 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:20,740 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:20,740 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:20,760 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:20,761 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:20,762 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:20,763 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:20,763 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:20,764 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:20,764 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:20,765 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:20,766 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:20,766 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:20,766 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:20,767 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:20,767 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:20,768 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:20,770 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,771 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:20,779 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,793 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:20,794 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:20,795 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:20,796 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:20,796 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:20,797 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:20,797 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:20,797 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:20,798 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:20,798 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:20,799 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:20,801 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:20,803 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,806 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.332, 'ask': 4193.369, 'last': 0.0, 'time': 1760534838}
2025-10-15 13:27:20,810 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:20,812 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:20,814 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,820 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:20,820 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,821 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:20,827 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 437, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:20,828 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,831 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:20,831 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 488, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:20,834 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,847 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,851 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,853 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,855 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:20,855 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,856 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:20,856 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,857 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:20,858 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,858 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:20,858 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,859 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:20,859 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,860 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:20,860 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:20,861 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:20,862 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:20,863 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:20,864 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:20,864 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,868 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,869 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:20,874 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:20,876 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,885 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:20,886 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:20,886 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13527.000000000044}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102728.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7221.000000000458}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31695.999999999913}]
2025-10-15 13:27:20,888 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:20,889 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:18+07:00
2025-10-15 13:27:20,889 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:20,889 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:20,890 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:20,891 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:20,891 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.301, 'ask': 4193.338, 'last': 0.0, 'time': 1760534837}
2025-10-15 13:27:20,892 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:20,893 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:20,896 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.84s
2025-10-15 13:27:20,896 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.84s
2025-10-15 13:27:20,957 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:20,959 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:20,960 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:20,962 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:20,962 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:20,967 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:21,292 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:21,293 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:21,294 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:21,296 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:21,326 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:21,327 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:21,327 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:21,328 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:21,329 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:21,329 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:21,330 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:21,330 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:21,331 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:21,332 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:21,333 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:21,351 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:21,353 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:21,354 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:21,355 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:21,856 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:21,858 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:21,859 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:22,360 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:22,362 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:22,363 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:22,363 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:22,364 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.297
2025-10-15 13:27:22,364 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.379
2025-10-15 13:27:22,375 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 434, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:22,395 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 434, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:22,489 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 488, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:22,500 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:22,513 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 488, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:22,513 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:22,514 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:22,516 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:22,517 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:22,517 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:22,523 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:22,532 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:22,535 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:22,536 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:22,536 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:22,540 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:22,541 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:22,541 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:22,545 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:22,545 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:22,546 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:22,546 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:22,546 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:22,548 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:22,549 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:22,549 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:22,552 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:22,553 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:22,555 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:22,572 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:22,573 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:22,576 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:22,577 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:22,577 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:22,580 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:22,580 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:22,581 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:22,582 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:22,583 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:22,583 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:22,588 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:22,602 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:22,606 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:22,606 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:22,607 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:22,607 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:22,608 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:22,608 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:20+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:22,608 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:22,609 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:20+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:22,609 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:21+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:22,610 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:20+07:00
2025-10-15 13:27:22,610 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:21+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:22,611 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:20+07:00 trong DST: True
2025-10-15 13:27:22,611 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:21+07:00
2025-10-15 13:27:22,611 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:22,612 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:21+07:00 trong DST: True
2025-10-15 13:27:22,613 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:22,614 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:22,614 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:22,617 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:22,620 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:22,627 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:22,630 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:22,633 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:22,636 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:22,641 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:22,647 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:22,647 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:22,662 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:22,666 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:22,667 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:22,669 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:22,670 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:22,670 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:22,671 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:22,671 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:22,671 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:22,672 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:22,672 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:22,673 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:22,673 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:22,673 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:22,674 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:22,674 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:22,675 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:22,676 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:22,677 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:22,677 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:22,678 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:22,678 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:22,695 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:22,696 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:22,698 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:22,698 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:22,699 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:22,700 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:22,700 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:22,700 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:22,701 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:22,701 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:22,702 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:22,703 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:22,703 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:22,703 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:22,704 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:22,705 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:22,705 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:22,706 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:22,707 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:22,708 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:22,708 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:22,714 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:22,721 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:22,723 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:22,726 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:22,728 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:22,730 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:22,730 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:22,731 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:22,732 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.379, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:22,732 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:22,733 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:22,733 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:22,733 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:22,734 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.297, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:22,734 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:22,734 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:22,735 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:22,735 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:22,736 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13573.999999999614
2025-10-15 13:27:22,736 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:22,736 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102775.00000000009
2025-10-15 13:27:22,737 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:22,739 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7268.000000000029
2025-10-15 13:27:22,740 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13491.99999999928
2025-10-15 13:27:22,740 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31742.999999999483
2025-10-15 13:27:22,742 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102692.99999999975
2025-10-15 13:27:22,744 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:22,748 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7185.999999999694
2025-10-15 13:27:22,750 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13573.999999999614}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102775.00000000009}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7268.000000000029}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31742.999999999483}]
2025-10-15 13:27:22,752 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31660.99999999915
2025-10-15 13:27:22,754 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:22,760 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:22,762 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:22,763 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13491.99999999928}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102692.99999999975}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7185.999999999694}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31660.99999999915}]
2025-10-15 13:27:22,764 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:22,765 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:22,765 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:22,766 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:22,767 - APP.services.mt5_service - DEBUG - Position in day range: 0.612857142857144
2025-10-15 13:27:22,768 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:22,768 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:21+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:22,769 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:22,769 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:21+07:00
2025-10-15 13:27:22,770 - APP.services.mt5_service - DEBUG - Position in day range: 0.6115838509316729
2025-10-15 13:27:22,770 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:21+07:00 trong DST: True
2025-10-15 13:27:22,771 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:20+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:22,771 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:22,771 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:20+07:00
2025-10-15 13:27:22,777 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:22,779 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:20+07:00 trong DST: True
2025-10-15 13:27:22,784 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:22,787 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:22,791 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,791 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:22,792 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,792 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:22,793 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '3700', 'price': 4193.37, 'distance_pips': 0.9}, {'level': '3725', 'price': 4193.372, 'distance_pips': 0.65}, {'level': '3750', 'price': 4193.375, 'distance_pips': 0.4}, {'level': '3775', 'price': 4193.377, 'distance_pips': 0.15}]
2025-10-15 13:27:22,794 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,794 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:22,795 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,795 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,796 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '2900', 'price': 4193.29, 'distance_pips': 0.7}, {'level': '2925', 'price': 4193.292, 'distance_pips': 0.45}, {'level': '2950', 'price': 4193.295, 'distance_pips': 0.2}, {'level': '2975', 'price': 4193.297, 'distance_pips': 0.05}]
2025-10-15 13:27:22,796 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,796 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:22,797 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:22,797 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,798 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.379
2025-10-15 13:27:22,798 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,799 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:22,799 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:22,801 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:22,802 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.297
2025-10-15 13:27:22,805 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:22,809 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:22,813 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:22,823 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:22,823 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:22,824 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:22,825 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.379
2025-10-15 13:27:22,825 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:22,826 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:22,826 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:22,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:22,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.297
2025-10-15 13:27:22,828 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:22,828 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:22,829 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:22,829 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:22,830 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:22,830 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:22,832 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.379
2025-10-15 13:27:22,832 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:22,834 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:22,838 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:22,840 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:22,842 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.297
2025-10-15 13:27:22,845 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:22,848 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:22,851 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:22,855 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:22,857 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:22,857 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:22,858 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.379
2025-10-15 13:27:22,859 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:22,859 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:22,859 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:22,860 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:22,860 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.297
2025-10-15 13:27:22,861 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:22,862 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:22,864 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:22,869 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:22,880 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:22,886 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,887 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:22,887 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,888 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,889 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:22,889 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,889 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:22,890 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:22,890 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:22,890 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:22,891 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:22,891 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:22,891 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:22,892 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:22,892 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:22,892 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:22,893 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:22,894 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:22,894 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:22,895 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:22,895 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:22,896 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:22,896 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:22,896 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:22,897 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:22,899 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:22,902 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:22,907 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:22,908 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:22,909 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:22,911 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,911 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:22,918 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,919 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:22,919 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:22,920 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:22,921 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:22,922 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:22,922 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:22,922 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:22,923 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:22,923 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:22,924 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:22,924 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:22,926 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,926 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:22,927 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,930 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:22,930 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:22,930 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,933 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:22,939 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:22,946 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.379, 'ask': 4193.416, 'last': 0.0, 'time': 1760534841}
2025-10-15 13:27:22,948 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:22,951 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:22,951 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:22,952 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:22,953 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:22,953 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:22,954 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,955 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:22,955 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,955 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:22,956 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 434, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:22,957 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:22,957 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 488, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:22,959 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:22,971 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,972 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:22,976 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,978 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,980 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,981 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.297, 'ask': 4193.334, 'last': 0.0, 'time': 1760534840}
2025-10-15 13:27:22,981 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,983 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:22,983 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,983 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.69s
2025-10-15 13:27:22,984 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,984 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,985 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,985 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:22,986 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:22,986 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:22,987 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:22,987 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,988 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,988 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:22,989 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:22,989 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:22,989 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:22,990 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13573.999999999614}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102775.00000000009}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7268.000000000029}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31742.999999999483}]
2025-10-15 13:27:22,990 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:21+07:00
2025-10-15 13:27:22,993 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:22,998 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:23,005 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:23,010 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.72s
2025-10-15 13:27:23,012 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:23,135 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:23,136 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:23,136 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:23,138 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:23,138 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:23,298 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:23,298 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:23,300 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:23,302 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:23,311 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:23,311 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:23,327 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:23,329 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:23,330 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:23,331 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:23,332 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:23,332 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:23,333 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:23,333 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:23,334 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:23,341 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:23,355 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:23,356 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:23,357 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:23,858 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:23,860 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:23,861 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:24,362 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:24,364 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:24,365 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:24,365 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:24,366 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.154
2025-10-15 13:27:24,366 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.02
2025-10-15 13:27:24,376 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 433, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:24,385 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 433, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:24,476 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 488, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:24,488 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:24,491 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 488, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:24,491 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:24,492 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:24,494 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:24,494 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:24,494 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:24,496 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:24,497 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:24,498 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:24,498 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:24,498 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:24,503 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:24,504 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:24,504 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:24,507 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:24,507 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:24,508 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:24,508 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:24,509 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:24,511 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:24,511 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:24,512 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:24,514 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:24,514 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:24,515 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:24,515 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:24,516 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:24,518 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:24,520 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:24,520 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:24,524 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:24,542 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:24,542 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:24,543 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:24,544 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:24,547 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:24,547 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:24,548 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:24,552 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:24,552 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:24,553 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:24,553 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:24,574 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:23+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:24,576 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:24,577 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:23+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:24,577 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:24,578 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:23+07:00
2025-10-15 13:27:24,579 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:24+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:24,579 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:23+07:00 trong DST: True
2025-10-15 13:27:24,580 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:24+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:24,580 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:24,580 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:24+07:00
2025-10-15 13:27:24,581 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:24,583 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:24+07:00 trong DST: True
2025-10-15 13:27:24,584 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:24,584 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:24,606 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:24,607 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:24,608 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:24,608 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:24,614 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:24,618 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:24,634 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:24,635 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:24,636 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:24,640 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:24,641 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:24,642 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:24,642 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:24,642 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:24,643 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:24,644 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:24,645 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:24,645 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:24,645 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:24,646 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:24,648 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:24,667 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:24,668 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:24,669 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:24,670 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:24,670 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:24,670 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:24,671 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:24,671 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:24,672 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:24,672 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:24,672 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:24,673 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:24,673 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:24,673 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:24,674 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:24,676 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:24,677 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:24,677 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:24,678 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:24,678 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:24,683 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:24,698 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:24,700 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:24,700 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:24,701 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:24,701 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:24,702 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:24,703 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:24,703 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:24,704 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:24,704 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:24,705 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:24,705 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:24,706 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:24,706 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:24,707 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:24,708 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:24,709 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:24,730 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:24,732 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.154, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:24,733 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:24,734 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:24,734 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:24,734 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:24,735 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.02, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:24,736 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:24,736 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:24,737 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:24,739 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:24,740 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13349.00000000016
2025-10-15 13:27:24,740 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:24,760 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102550.00000000064
2025-10-15 13:27:24,761 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:24,762 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 7043.000000000575
2025-10-15 13:27:24,763 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13215.000000000146
2025-10-15 13:27:24,763 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31518.00000000003
2025-10-15 13:27:24,764 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102416.00000000063
2025-10-15 13:27:24,764 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:24,765 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 6909.00000000056
2025-10-15 13:27:24,766 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13349.00000000016}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102550.00000000064}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7043.000000000575}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31518.00000000003}]
2025-10-15 13:27:24,766 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31384.000000000015
2025-10-15 13:27:24,767 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:24,767 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:24,768 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:24,769 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13215.000000000146}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102416.00000000063}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6909.00000000056}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31384.000000000015}]
2025-10-15 13:27:24,770 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:24,771 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:24,788 - APP.services.mt5_service - DEBUG - Position in day range: 0.6093633540372766
2025-10-15 13:27:24,789 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:23+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:24,790 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:24,790 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:23+07:00
2025-10-15 13:27:24,791 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:24,791 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:23+07:00 trong DST: True
2025-10-15 13:27:24,792 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:24,792 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:24,792 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:24,793 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:24,794 - APP.services.mt5_service - DEBUG - Position in day range: 0.6072826086956615
2025-10-15 13:27:24,794 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:24,795 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:24+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:24,795 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:24,796 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:24+07:00
2025-10-15 13:27:24,796 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:24,796 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:24+07:00 trong DST: True
2025-10-15 13:27:24,797 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '1500', 'price': 4193.15, 'distance_pips': 0.4}, {'level': '1525', 'price': 4193.152, 'distance_pips': 0.15}, {'level': '1550', 'price': 4193.155, 'distance_pips': 0.1}, {'level': '1575', 'price': 4193.157, 'distance_pips': 0.35}]
2025-10-15 13:27:24,797 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:24,798 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:24,798 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:24,798 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:24,799 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:24,799 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:24,800 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:24,801 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:24,802 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:24,802 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.154
2025-10-15 13:27:24,803 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '200', 'price': 4193.02, 'distance_pips': 0.0}, {'level': '225', 'price': 4193.023, 'distance_pips': 0.25}, {'level': '250', 'price': 4193.025, 'distance_pips': 0.5}, {'level': '275', 'price': 4193.028, 'distance_pips': 0.75}]
2025-10-15 13:27:24,805 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:24,824 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:24,824 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:24,825 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:24,826 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:24,826 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:24,827 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:24,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:24,827 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:24,828 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.02
2025-10-15 13:27:24,829 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.154
2025-10-15 13:27:24,829 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:24,830 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:24,830 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:24,832 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:24,833 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:24,834 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:24,836 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:24,857 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:24,859 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:24,859 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:24,860 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.02
2025-10-15 13:27:24,861 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.154
2025-10-15 13:27:24,861 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:24,862 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:24,862 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:24,863 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:24,864 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:24,865 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:24,885 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:24,886 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:24,887 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:24,887 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:24,888 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.02
2025-10-15 13:27:24,889 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.154
2025-10-15 13:27:24,890 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:24,891 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:24,891 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:24,892 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:24,893 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:24,894 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:24,895 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:24,896 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:24,918 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:24,919 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:24,920 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.02
2025-10-15 13:27:24,921 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:24,921 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:24,922 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:24,923 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:24,923 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:24,924 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:24,925 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:24,926 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:24,927 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:24,927 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:24,950 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:24,950 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:24,951 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:24,951 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:24,951 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:24,952 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:24,953 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:24,953 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:24,953 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:24,954 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:24,954 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:24,954 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:24,955 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:24,956 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:24,957 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:24,957 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:24,958 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:24,958 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:24,959 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:24,959 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:24,982 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:24,983 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:24,984 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:24,984 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:24,985 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:24,985 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:24,986 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:24,986 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:24,987 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:24,989 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:24,989 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:24,990 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:24,992 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:25,010 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:25,011 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:25,012 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:25,012 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:25,014 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:25,014 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:25,014 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:25,015 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:25,015 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.154, 'ask': 4193.191, 'last': 0.0, 'time': 1760534843}
2025-10-15 13:27:25,018 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:25,018 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:25,019 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:25,021 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:25,021 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:25,040 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:25,041 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:25,042 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:25,042 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:25,043 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:25,043 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:25,044 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 433, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:25,045 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:25,046 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 488, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:25,046 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:25,046 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:25,047 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:25,047 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:25,049 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:25,051 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:25,051 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:25,052 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:25,052 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:25,053 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:25,070 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.02, 'ask': 4193.057, 'last': 0.0, 'time': 1760534844}
2025-10-15 13:27:25,070 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:25,071 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:25,072 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:25,072 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.77s
2025-10-15 13:27:25,073 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:25,074 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:25,074 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:25,075 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:25,075 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:25,076 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:25,076 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:25,077 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:25,077 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:25,078 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:25,078 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:25,078 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13349.00000000016}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102550.00000000064}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 7043.000000000575}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31518.00000000003}]
2025-10-15 13:27:25,079 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:23+07:00
2025-10-15 13:27:25,079 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:25,081 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:25,083 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:25,091 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.79s
2025-10-15 13:27:25,149 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:25,260 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:25,261 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:25,261 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:25,262 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:25,263 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:25,431 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:25,431 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:25,433 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:25,433 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:25,435 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:25,436 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:25,450 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:25,454 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:25,465 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:25,466 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:25,467 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:25,468 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:25,468 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:25,469 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:25,470 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:25,471 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:25,472 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:25,473 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:25,473 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:25,473 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:25,474 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:25,478 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.05s
2025-10-15 13:27:25,538 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:25,976 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:25,978 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:25,979 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:26,480 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:26,482 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:26,482 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:26,483 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:26,483 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.924
2025-10-15 13:27:26,484 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.707
2025-10-15 13:27:26,491 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 431, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:26,502 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 431, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:26,636 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 487, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:26,639 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 487, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:26,639 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:26,640 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:26,640 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:26,641 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:26,643 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:26,648 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:26,649 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:26,655 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:26,667 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:26,668 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:26,670 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:26,670 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:26,675 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:26,732 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:26,733 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:26,812 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:26,815 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:26,816 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:26,819 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:26,821 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:26,822 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:26,823 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:26,824 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:26,826 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:26,827 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:26,828 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:26,829 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:26,834 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:26,861 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:26,913 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:26,919 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:26,922 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:26,923 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:26,953 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:26,955 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:26,960 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:26,961 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:26,963 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:26,965 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:24+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:26,965 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:24+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:26,966 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:26,967 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:24+07:00
2025-10-15 13:27:26,968 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:26,969 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:24+07:00 trong DST: True
2025-10-15 13:27:26,972 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:26,973 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:26,973 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:26,974 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:26,974 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:26,974 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:26,975 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:26,976 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:26,977 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:26+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:26,977 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:26,978 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:26+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:26,983 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:26,984 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:26+07:00
2025-10-15 13:27:26,984 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:26,987 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:26+07:00 trong DST: True
2025-10-15 13:27:27,022 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:27,023 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:27,024 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:27,025 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:27,044 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:27,045 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:27,046 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:27,047 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:27,047 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:27,048 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:27,049 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:27,054 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:27,057 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:27,058 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:27,059 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:27,062 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:27,062 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:27,063 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:27,064 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:27,065 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:27,065 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:27,066 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:27,070 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:27,071 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:27,071 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:27,072 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:27,072 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:27,073 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:27,073 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:27,074 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:27,074 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:27,075 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:27,075 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:27,076 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:27,076 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:27,077 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:27,077 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:27,078 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:27,078 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:27,079 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:27,079 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:27,080 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.924, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:27,080 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:27,080 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:27,081 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:27,083 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:27,084 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:27,084 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:27,110 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:27,110 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:27,111 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:27,111 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13118.999999999687
2025-10-15 13:27:27,114 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:27,115 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102320.00000000016
2025-10-15 13:27:27,134 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:27,136 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 6813.000000000102
2025-10-15 13:27:27,136 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:27,137 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31287.999999999556
2025-10-15 13:27:27,138 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:27,138 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:27,139 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:27,140 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13118.999999999687}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102320.00000000016}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6813.000000000102}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31287.999999999556}]
2025-10-15 13:27:27,140 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:27,141 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:27,142 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:27,143 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:27,143 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:27,145 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:27,145 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:27,146 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:27,150 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:27,164 - APP.services.mt5_service - DEBUG - Position in day range: 0.6057919254658407
2025-10-15 13:27:27,166 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:27,167 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:24+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:27,167 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:27,168 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:24+07:00
2025-10-15 13:27:27,168 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:27,169 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:24+07:00 trong DST: True
2025-10-15 13:27:27,169 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.707, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:27,169 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:27,170 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:27,170 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:27,171 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:27,171 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:27,172 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:27,172 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,173 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:27,173 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,174 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12902.000000000044
2025-10-15 13:27:27,174 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '9200', 'price': 4192.92, 'distance_pips': 0.4}, {'level': '9225', 'price': 4192.922, 'distance_pips': 0.15}, {'level': '9250', 'price': 4192.925, 'distance_pips': 0.1}, {'level': '9275', 'price': 4192.927, 'distance_pips': 0.35}]
2025-10-15 13:27:27,175 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102103.00000000052
2025-10-15 13:27:27,176 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:27,176 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 6596.000000000458
2025-10-15 13:27:27,177 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,177 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31070.999999999913
2025-10-15 13:27:27,199 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,199 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:27,201 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:27,202 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12902.000000000044}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102103.00000000052}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6596.000000000458}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31070.999999999913}]
2025-10-15 13:27:27,203 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.924
2025-10-15 13:27:27,204 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:27,205 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:27,208 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:27,211 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:27,228 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:27,230 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:27,230 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:27,231 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:27,231 - APP.services.mt5_service - DEBUG - Position in day range: 0.6024223602484549
2025-10-15 13:27:27,231 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:27,232 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:26+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:27,233 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.924
2025-10-15 13:27:27,234 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:26+07:00
2025-10-15 13:27:27,235 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:27,236 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:26+07:00 trong DST: True
2025-10-15 13:27:27,236 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:27,236 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:27,237 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:27,239 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:27,240 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:27,240 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:27,241 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:27,241 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,245 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.924
2025-10-15 13:27:27,262 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,263 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:27,264 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '7000', 'price': 4192.7, 'distance_pips': 0.7}, {'level': '7025', 'price': 4192.702, 'distance_pips': 0.45}, {'level': '7050', 'price': 4192.705, 'distance_pips': 0.2}, {'level': '7075', 'price': 4192.707, 'distance_pips': 0.05}]
2025-10-15 13:27:27,264 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:27,265 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:27,266 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:27,266 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,267 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:27,268 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,268 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:27,269 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:27,270 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.707
2025-10-15 13:27:27,271 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.924
2025-10-15 13:27:27,272 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:27,274 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:27,294 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:27,295 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:27,296 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:27,297 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:27,298 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:27,299 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:27,299 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:27,300 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,301 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.707
2025-10-15 13:27:27,302 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,303 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:27,303 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:27,304 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:27,326 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:27,327 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:27,328 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:27,329 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:27,329 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:27,329 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:27,330 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.707
2025-10-15 13:27:27,331 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:27,332 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:27,333 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:27,333 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:27,334 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:27,353 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:27,354 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:27,355 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:27,355 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:27,356 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:27,356 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:27,357 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.707
2025-10-15 13:27:27,357 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:27,358 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:27,358 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:27,359 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:27,359 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:27,360 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:27,361 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:27,361 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:27,362 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:27,362 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,363 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,365 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:27,365 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:27,370 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,380 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:27,386 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,387 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:27,388 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:27,389 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:27,389 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:27,390 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:27,390 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:27,391 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:27,391 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:27,392 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:27,393 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:27,394 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:27,396 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:27,396 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:27,417 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:27,417 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:27,417 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:27,418 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,419 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:27,420 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.924, 'ask': 4192.961, 'last': 0.0, 'time': 1760534844}
2025-10-15 13:27:27,420 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:27,421 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:27,421 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:27,422 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:27,423 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:27,423 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,423 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:27,424 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,424 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:27,425 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 431, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:27,426 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,431 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:27,432 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 487, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:27,448 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,449 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:27,449 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,450 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:27,450 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,451 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:27,451 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,452 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:27,452 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,453 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:27,453 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,454 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:27,454 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,455 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:27,455 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,456 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:27,456 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,458 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:27,459 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:27,459 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:27,459 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:27,460 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,480 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:27,481 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.707, 'ask': 4192.744, 'last': 0.0, 'time': 1760534846}
2025-10-15 13:27:27,481 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:27,482 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:27,482 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,483 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 2.05s
2025-10-15 13:27:27,483 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,484 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:27,484 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:27,485 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:27,485 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:27,486 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13118.999999999687}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102320.00000000016}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6813.000000000102}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31287.999999999556}]
2025-10-15 13:27:27,486 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:24+07:00
2025-10-15 13:27:27,487 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:27,489 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:27,490 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:27,512 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 2.08s
2025-10-15 13:27:27,580 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:27,701 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:27,702 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:27,703 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:27,704 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:27,704 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:28,448 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:28,449 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:28,451 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:28,453 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:28,480 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:28,481 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:28,481 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:28,482 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:28,483 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:28,483 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:28,484 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:28,485 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:28,485 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:28,488 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:28,490 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:28,490 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:28,491 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:28,494 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:28,516 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:29,019 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:29,020 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:29,021 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:29,522 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:29,524 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:29,524 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:29,525 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:29,525 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.671
2025-10-15 13:27:29,526 - APP.services.mt5_service - DEBUG - Current price (cp): 4193.038
2025-10-15 13:27:29,536 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 426, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:29,545 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 426, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:29,649 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 487, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:29,652 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 487, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:29,653 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:29,653 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:29,654 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:29,654 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:29,656 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:29,660 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:29,660 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:29,661 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:29,661 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:29,661 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:29,662 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:29,662 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:29,665 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:29,668 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:29,669 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:29,669 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:29,669 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:29,670 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:29,670 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:29,671 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:29,673 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:29,675 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:29,676 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:29,677 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:29,677 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:29,678 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:29,678 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:29,698 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:29,701 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:29,704 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:29,704 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:29,705 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:29,706 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:29,706 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:29,707 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:29,708 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:29,713 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:29,732 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:29,733 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:29,734 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:29,734 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:29,734 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:29,735 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:29,735 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:29,735 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:28+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:29,736 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:29+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:29,737 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:28+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:29,739 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:29+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:29,740 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:28+07:00
2025-10-15 13:27:29,742 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:29+07:00
2025-10-15 13:27:29,758 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:28+07:00 trong DST: True
2025-10-15 13:27:29,759 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:29+07:00 trong DST: True
2025-10-15 13:27:29,759 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:29,760 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:29,760 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:29,761 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:29,761 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:29,761 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:29,763 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:29,764 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:29,765 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:29,765 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:29,770 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:29,778 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:29,794 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:29,796 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:29,796 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:29,797 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:29,797 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:29,798 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:29,798 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:29,799 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:29,799 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:29,800 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:29,801 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:29,802 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:29,802 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:29,803 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:29,803 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:29,805 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:29,823 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:29,824 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:29,825 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:29,825 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:29,826 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:29,826 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:29,827 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:29,827 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:29,827 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:29,828 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:29,828 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:29,829 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:29,829 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:29,830 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:29,830 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:29,830 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:29,831 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:29,832 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:29,834 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:29,852 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:29,853 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:29,854 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:29,855 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:29,855 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:29,856 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:29,856 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:29,857 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:29,857 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:29,858 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:29,858 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:29,859 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:29,860 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:29,860 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:29,861 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:29,861 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:29,862 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:29,862 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:29,863 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:29,863 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.671, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:29,864 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4193.038, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:29,865 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:29,886 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:29,890 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:29,890 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:29,890 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:29,891 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:29,891 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:29,892 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:29,892 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12865.999999999985
2025-10-15 13:27:29,892 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13232.999999999265
2025-10-15 13:27:29,893 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102067.00000000047
2025-10-15 13:27:29,893 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102433.99999999974
2025-10-15 13:27:29,895 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 6560.0000000004
2025-10-15 13:27:29,896 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 6926.99999999968
2025-10-15 13:27:29,896 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31034.999999999854
2025-10-15 13:27:29,897 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31401.999999999134
2025-10-15 13:27:29,909 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:29,915 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12865.999999999985}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102067.00000000047}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6560.0000000004}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31034.999999999854}]
2025-10-15 13:27:29,916 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:29,917 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:29,917 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13232.999999999265}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102433.99999999974}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6926.99999999968}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31401.999999999134}]
2025-10-15 13:27:29,918 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:29,919 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:29,919 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:29,920 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:29,921 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:29,921 - APP.services.mt5_service - DEBUG - Position in day range: 0.6018633540372739
2025-10-15 13:27:29,922 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:29,922 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:28+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:29,923 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:29,923 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:28+07:00
2025-10-15 13:27:29,923 - APP.services.mt5_service - DEBUG - Position in day range: 0.6075621118012379
2025-10-15 13:27:29,924 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:28+07:00 trong DST: True
2025-10-15 13:27:29,924 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:29+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:29,924 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:29,925 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:29+07:00
2025-10-15 13:27:29,925 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:29,926 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:29+07:00 trong DST: True
2025-10-15 13:27:29,927 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:29,928 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:29,928 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:29,931 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:29,949 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:29,949 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:29,950 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6700', 'price': 4192.67, 'distance_pips': 0.1}, {'level': '6725', 'price': 4192.672, 'distance_pips': 0.15}, {'level': '6750', 'price': 4192.675, 'distance_pips': 0.4}, {'level': '6775', 'price': 4192.677, 'distance_pips': 0.65}]
2025-10-15 13:27:29,951 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:29,951 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:29,952 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:29,952 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:29,952 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '300', 'price': 4193.03, 'distance_pips': 0.8}, {'level': '325', 'price': 4193.032, 'distance_pips': 0.55}, {'level': '350', 'price': 4193.035, 'distance_pips': 0.3}, {'level': '375', 'price': 4193.037, 'distance_pips': 0.05}]
2025-10-15 13:27:29,953 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:29,954 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:29,954 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:29,954 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:29,955 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.671
2025-10-15 13:27:29,955 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:29,956 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:29,956 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:29,957 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:29,959 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.038
2025-10-15 13:27:29,960 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:29,960 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:29,963 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:29,981 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:29,981 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:29,982 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:29,983 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.671
2025-10-15 13:27:29,984 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:29,984 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:29,985 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:29,985 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:29,986 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4193.038
2025-10-15 13:27:29,987 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:29,988 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:29,989 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:29,990 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:29,990 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:30,012 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:30,013 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.671
2025-10-15 13:27:30,014 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:30,015 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:30,015 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:30,016 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:30,017 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4193.038
2025-10-15 13:27:30,018 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:30,018 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:30,019 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:30,021 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:30,021 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:30,024 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:30,044 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.671
2025-10-15 13:27:30,046 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:30,046 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:30,047 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:30,047 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:30,048 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4193.038
2025-10-15 13:27:30,049 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:30,049 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:30,050 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:30,050 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:30,052 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,052 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:30,053 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,053 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:30,054 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:30,054 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,057 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:30,077 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,078 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:30,078 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:30,079 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:30,079 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:30,080 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:30,080 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:30,080 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:30,081 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:30,082 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:30,083 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:30,083 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:30,083 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:30,084 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:30,084 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:30,086 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:30,106 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:30,107 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:30,108 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:30,109 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:30,109 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:30,110 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:30,111 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:30,111 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:30,112 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,112 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:30,112 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,113 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:30,114 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:30,114 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:30,115 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:30,115 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:30,116 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:30,141 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:30,141 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:30,143 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:30,144 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:30,146 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:30,168 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,169 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:30,171 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:30,171 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,171 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:30,172 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,173 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:30,177 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:30,178 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.671, 'ask': 4192.708, 'last': 0.0, 'time': 1760534848}
2025-10-15 13:27:30,199 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:30,201 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:30,201 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:30,202 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:30,203 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:30,203 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:30,203 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,204 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:30,205 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,205 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:30,206 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 426, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:30,209 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:30,210 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 487, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:30,213 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:30,231 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,232 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:30,233 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,233 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,234 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,234 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4193.038, 'ask': 4193.075, 'last': 0.0, 'time': 1760534849}
2025-10-15 13:27:30,234 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,235 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:30,235 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,236 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.78s
2025-10-15 13:27:30,236 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,238 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,239 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,240 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:30,240 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:30,261 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:30,262 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:30,263 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,263 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,264 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:30,265 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:30,265 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:30,266 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:30,266 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12865.999999999985}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102067.00000000047}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6560.0000000004}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31034.999999999854}]
2025-10-15 13:27:30,266 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:28+07:00
2025-10-15 13:27:30,267 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:30,268 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:30,271 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:30,295 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.85s
2025-10-15 13:27:30,309 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:30,470 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:30,471 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:30,472 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:30,473 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:30,473 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:30,477 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:30,478 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:30,480 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:30,482 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:30,644 - APP.utils.threading_utils - DEBUG - Gửi task 'ui.io.folder_watch.scan' vào nhóm 'ui.io.folder_watch' (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:30,645 - APP.ui.controllers.io_controller - INFO - Đã gửi worker I/O ui.io.folder_watch.scan vào group ui.io.folder_watch (metadata={'component': 'ui', 'operation': 'folder_watch'})
2025-10-15 13:27:30,682 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:30,682 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:30,683 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:30,684 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:30,685 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:30,686 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:30,687 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:30,687 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:30,688 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:30,688 - APP.utils.threading_utils - DEBUG - Task 'ui.io.folder_watch.scan' (group=ui.io.folder_watch) hoàn tất sau 0.04s
2025-10-15 13:27:30,689 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:30,690 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:30,691 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:30,692 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:30,692 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:30,693 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:30,748 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:30,900 - APP.utils.threading_utils - DEBUG - Gửi task 'mt5.check' vào nhóm 'mt5.check' (metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 13:27:30,901 - APP.ui.controllers.mt5_controller - INFO - Đã gửi tác vụ MT5 mt5.check (group=mt5.check, metadata={'component': 'mt5', 'operation': 'check'})
2025-10-15 13:27:31,194 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:31,196 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:31,197 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:31,698 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:31,700 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:31,701 - APP.utils.threading_utils - DEBUG - Task 'mt5.check' (group=mt5.check) hoàn tất sau 0.80s
2025-10-15 13:27:31,702 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:31,702 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:31,703 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.833
2025-10-15 13:27:31,703 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.833
2025-10-15 13:27:31,713 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 426, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:31,736 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 426, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:31,820 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: update_ui
2025-10-15 13:27:31,846 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 487, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:31,852 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:31,860 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 487, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:31,861 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:31,861 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:31,865 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:31,867 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:31,881 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:31,884 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:31,885 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:31,885 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:31,886 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:31,886 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:31,891 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:31,892 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:31,893 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:31,898 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:31,917 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:31,919 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:31,919 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:31,920 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:31,922 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:31,922 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:31,923 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:31,925 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:31,925 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:31,926 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:31,927 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:31,927 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:31,928 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:31,932 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:31,951 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:31,952 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:31,952 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:31,953 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:31,953 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:31,954 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:31,954 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:31,957 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:31,980 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:31,981 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:31,982 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:31,983 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:31,983 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:31,984 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:31,984 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:31,984 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:30+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:31,985 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:30+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:31,986 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:30+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:31,986 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:30+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:31,986 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:30+07:00
2025-10-15 13:27:31,987 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:30+07:00
2025-10-15 13:27:31,987 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:30+07:00 trong DST: True
2025-10-15 13:27:31,988 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:30+07:00 trong DST: True
2025-10-15 13:27:31,989 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:31,990 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:31,990 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:31,991 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:31,991 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:32,012 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:32,014 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:32,016 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:32,017 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:32,018 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:32,024 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:32,048 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:32,048 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:32,049 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:32,049 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:32,050 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:32,051 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:32,052 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:32,053 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:32,072 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:32,073 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:32,074 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:32,075 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:32,075 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:32,076 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:32,076 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:32,076 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:32,077 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:32,078 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:32,078 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:32,078 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:32,079 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:32,079 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:32,080 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:32,080 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:32,081 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:32,081 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:32,082 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:32,084 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:32,084 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:32,085 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:32,104 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:32,105 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:32,106 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:32,106 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:32,107 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:32,107 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:32,108 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:32,109 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:32,110 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:32,110 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:32,110 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:32,111 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:32,112 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:32,112 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:32,113 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:32,114 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:32,115 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:32,118 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:32,136 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:32,138 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:32,139 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:32,139 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:32,140 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:32,140 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:32,141 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.833, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:32,141 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:32,142 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:32,142 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.833, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:32,143 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:32,144 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:32,144 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:32,145 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:32,146 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13027.999999999338
2025-10-15 13:27:32,146 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:32,147 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102228.99999999981
2025-10-15 13:27:32,147 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:32,147 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 6721.999999999753
2025-10-15 13:27:32,148 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:32,150 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31196.999999999207
2025-10-15 13:27:32,153 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:32,156 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13027.999999999338}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102228.99999999981}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6721.999999999753}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31196.999999999207}]
2025-10-15 13:27:32,159 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:32,161 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:32,165 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:32,166 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:32,168 - APP.services.mt5_service - DEBUG - Position in day range: 0.6043788819875744
2025-10-15 13:27:32,169 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:30+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:32,170 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 13027.999999999338
2025-10-15 13:27:32,171 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:30+07:00
2025-10-15 13:27:32,171 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102228.99999999981
2025-10-15 13:27:32,171 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:30+07:00 trong DST: True
2025-10-15 13:27:32,172 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 6721.999999999753
2025-10-15 13:27:32,172 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:32,173 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31196.999999999207
2025-10-15 13:27:32,173 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:32,174 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:32,174 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:32,175 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13027.999999999338}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102228.99999999981}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6721.999999999753}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31196.999999999207}]
2025-10-15 13:27:32,176 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,177 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,178 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:32,178 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8300', 'price': 4192.83, 'distance_pips': 0.3}, {'level': '8325', 'price': 4192.832, 'distance_pips': 0.05}, {'level': '8350', 'price': 4192.835, 'distance_pips': 0.2}, {'level': '8375', 'price': 4192.837, 'distance_pips': 0.45}]
2025-10-15 13:27:32,179 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:32,179 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:32,185 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:32,186 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,188 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:32,192 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,194 - APP.services.mt5_service - DEBUG - Position in day range: 0.6043788819875744
2025-10-15 13:27:32,196 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:32,197 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:30+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:32,199 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.833
2025-10-15 13:27:32,199 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:30+07:00
2025-10-15 13:27:32,200 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:32,201 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:30+07:00 trong DST: True
2025-10-15 13:27:32,201 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:32,202 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:32,202 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:32,203 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:32,204 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:32,204 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:32,204 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:32,205 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,205 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.833
2025-10-15 13:27:32,206 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,207 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:32,208 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:32,209 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '8300', 'price': 4192.83, 'distance_pips': 0.3}, {'level': '8325', 'price': 4192.832, 'distance_pips': 0.05}, {'level': '8350', 'price': 4192.835, 'distance_pips': 0.2}, {'level': '8375', 'price': 4192.837, 'distance_pips': 0.45}]
2025-10-15 13:27:32,210 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:32,210 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:32,212 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:32,222 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,224 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:32,226 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,227 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.833
2025-10-15 13:27:32,231 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:32,232 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:32,233 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.833
2025-10-15 13:27:32,234 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:32,234 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:32,235 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:32,236 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:32,236 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:32,237 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:32,238 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:32,239 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:32,240 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.833
2025-10-15 13:27:32,240 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:32,243 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:32,246 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.833
2025-10-15 13:27:32,249 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:32,251 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:32,253 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:32,256 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:32,258 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:32,261 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:32,262 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:32,263 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:32,263 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,264 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.833
2025-10-15 13:27:32,265 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,265 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:32,266 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:32,266 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:32,266 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:32,267 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:32,267 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:32,268 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:32,268 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:32,268 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:32,269 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:32,270 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.833
2025-10-15 13:27:32,271 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:32,272 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:32,277 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:32,279 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:32,280 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:32,286 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:32,288 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:32,289 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:32,292 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:32,293 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,294 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,295 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:32,295 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:32,296 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:32,297 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:32,297 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:32,297 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:32,298 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:32,298 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,298 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:32,298 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,299 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:32,299 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:32,300 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:32,300 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:32,303 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:32,303 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:32,304 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:32,304 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:32,317 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:32,320 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:32,325 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:32,327 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:32,327 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:32,329 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:32,329 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:32,329 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:32,330 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,330 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:32,331 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.833, 'ask': 4192.87, 'last': 0.0, 'time': 1760534850}
2025-10-15 13:27:32,331 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:32,332 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:32,332 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:32,333 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:32,333 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:32,334 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,334 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:32,335 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,335 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:32,336 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 426, 'median_spread': 37, 'p90_spread': 37}
2025-10-15 13:27:32,336 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,338 - APP.services.mt5_service - DEBUG - Đã định dạng 64 deals cho XAUUSD.
2025-10-15 13:27:32,339 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 487, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:32,339 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,340 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:32,340 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,340 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:32,341 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,341 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:32,342 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,342 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:32,343 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,343 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:32,344 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,345 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:32,345 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,345 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 50
2025-10-15 13:27:32,346 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,346 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:32,347 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,348 - APP.services.mt5_service - DEBUG - Đã lấy 50 bars cho XAUUSD 1.
2025-10-15 13:27:32,349 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.6269282451804105}
2025-10-15 13:27:32,349 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:32,350 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:32,350 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,351 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:32,351 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.833, 'ask': 4192.87, 'last': 0.0, 'time': 1760534850}
2025-10-15 13:27:32,352 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:32,352 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:32,352 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,353 - APP.utils.threading_utils - DEBUG - Task 'chart.draw' (group=chart.refresh) hoàn tất sau 1.87s
2025-10-15 13:27:32,353 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,354 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:32,354 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:32,355 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:32,355 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:32,356 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 13027.999999999338}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102228.99999999981}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6721.999999999753}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31196.999999999207}]
2025-10-15 13:27:32,356 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:30+07:00
2025-10-15 13:27:32,357 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:32,357 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:32,358 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:32,359 - APP.utils.threading_utils - DEBUG - Task 'chart.info' (group=chart.refresh) hoàn tất sau 1.88s
2025-10-15 13:27:32,394 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:32,536 - APP.ui.utils.ui_builder - DEBUG - Executing UI callback: <lambda>
2025-10-15 13:27:32,537 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:32,538 - APP.utils.safe_data - DEBUG - Get top-level key 'account': {'balance': 106.07, 'equity': 106.07, 'free_margin': 106.07, 'currency': 'USD', 'leverage': 2000}
2025-10-15 13:27:32,540 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:32,540 - APP.utils.safe_data - DEBUG - Get top-level key 'positions': []
2025-10-15 13:27:32,544 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.info' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:32,545 - APP.utils.threading_utils - DEBUG - Gửi task 'chart.draw' vào nhóm 'chart.refresh' (metadata={'symbol': 'XAUUSD', 'timeframe': 'M1', 'candles': 50, 'chart_type': 'Nến', 'component': 'chart'})
2025-10-15 13:27:32,546 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:32,548 - APP.ui.app_ui - DEBUG - Bắt đầu chụp ảnh nhanh cấu hình từ UI.
2025-10-15 13:27:32,712 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:32,712 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:32,713 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:32,713 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:32,714 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:32,715 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:32,715 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:32,716 - APP.configs.app_config - DEBUG - Bắt đầu hàm __post_init__ của RunConfig.
2025-10-15 13:27:32,716 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:32,717 - APP.configs.app_config - DEBUG - RunConfig được khởi tạo: RunConfig(folder=FolderConfig(folder='C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots', delete_after=True, max_files=0, only_generate_if_changed=False), upload=UploadConfig(upload_workers=4, cache_enabled=True, optimize_lossless=False), image_processing=ImageProcessingConfig(max_width=1600, jpeg_quality=85), context=ContextConfig(ctx_limit=2000, create_ctx_json=True, prefer_ctx_json=True, ctx_json_n=5, remember_context=True, n_reports=1), telegram=TelegramConfig(enabled=True, token='8401224691:AAHu14vQxwnOlD9IBPsU1yp59nZ8Ta0mMYk', chat_id='907737980', skip_verify=True, ca_path='', notify_on_early_exit=False), mt5=MT5Config(enabled=True, symbol='XAUUSD', n_M1=120, n_M5=180, n_M15=96, n_H1=120), no_run=NoRunConfig(weekend_enabled=True, killzone_enabled=False, holiday_check_enabled=True, holiday_check_country='US', timezone='Asia/Ho_Chi_Minh', killzone_summer={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '14:00', 'end': '17:00'}, 'newyork_am': {'start': '19:30', 'end': '22:00'}, 'newyork_pm': {'start': '00:00', 'end': '03:00'}}, killzone_winter={'asia': {'start': '06:00', 'end': '09:00'}, 'london': {'start': '15:00', 'end': '18:00'}, 'newyork_am': {'start': '20:30', 'end': '23:00'}, 'newyork_pm': {'start': '01:00', 'end': '04:00'}}), no_trade=NoTradeConfig(enabled=True, spread_max_pips=4.2, min_atr_m5_pips=0.3, min_dist_keylvl_pips=5.0, allow_session_asia=True, allow_session_london=True, allow_session_ny=True), auto_trade=AutoTradeConfig(enabled=True, strict_bias=True, size_mode='risk_percent', risk_per_trade=1.0, split_tp_enabled=True, split_tp_ratio=50, deviation=20, magic_number=26092025, comment='AI-ICT', pending_ttl_min=90, min_rr_tp2=2.0, cooldown_min=10, dynamic_pending=True, dry_run=False, move_to_be_after_tp1=True, trailing_atr_mult=0.5, filling_type='IOC'), news=NewsConfig(block_enabled=True, block_before_min=5, block_after_min=5, cache_ttl_sec=600, provider_timeout_sec=20, priority_keywords=('business confidence', 'consumer confidence', 'consumer price index', 'cpi', 'gdp', 'gross domestic product', 'ifo', 'industrial production', 'inflation rate', 'interest rate', 'ism', 'nfp', 'non-farm payroll', 'pmi', 'purchasing managers', 'retail sales', 'trade balance', 'unemployment rate', 'zew'), provider_error_threshold=2, provider_error_backoff_sec=300, surprise_score_threshold=0.5, currency_country_overrides=None, symbol_country_overrides=None), fmp=FMPConfig(enabled=True, api_key='XL0taxDun2w72XyH70rVACj628PS0hxs'), te=TEConfig(enabled=True, api_key='2965e93128ff437:ovhzxu4u55gccrl', skip_ssl_verify=True), persistence=PersistenceConfig(max_md_reports=10, max_json_reports=10), chart=ChartConfig(timeframe='M1', num_candles=50, chart_type='Nến', refresh_interval_secs=1), api=ApiConfig(tries=5, delay=2.0), logging=LoggingConfig(log_dir='Log', log_file_name='app_debug.log', log_rotation_size_mb=5, log_rotation_backup_count=5))
2025-10-15 13:27:32,717 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:32,719 - APP.configs.app_config - DEBUG - Kết thúc hàm __post_init__ của RunConfig.
2025-10-15 13:27:32,719 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:32,720 - APP.services.mt5_service - DEBUG - Bắt đầu build_context cho symbol: XAUUSD
2025-10-15 13:27:32,720 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:33,222 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:33,223 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:33,224 - APP.services.mt5_service - DEBUG - Đã đảm bảo symbol 'XAUUSD' được chọn. Chờ 0.5s để đồng bộ.
2025-10-15 13:27:33,726 - APP.services.mt5_service - DEBUG - Đã lấy symbol info, account info, tick info.
2025-10-15 13:27:33,727 - APP.services.mt5_service - WARNING - Không thể xác định múi giờ từ TerminalInfo (thiếu thuộc tính hoặc rỗng), sử dụng Asia/Ho_Chi_Minh.
2025-10-15 13:27:33,728 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:33,728 - APP.services.mt5_service - DEBUG - Đã xây dựng info_obj, account_obj, rules_obj.
2025-10-15 13:27:33,729 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.694
2025-10-15 13:27:33,729 - APP.services.mt5_service - DEBUG - Current price (cp): 4192.694
2025-10-15 13:27:33,740 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 426, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:33,750 - APP.services.mt5_service - DEBUG - Tick stats 5m: {'ticks_per_min': 426, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:33,873 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 487, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:33,876 - APP.services.mt5_service - DEBUG - Tick stats 30m: {'ticks_per_min': 487, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:33,877 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:33,877 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 1, bars: 120
2025-10-15 13:27:33,878 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:33,878 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 1 ở lần thử 1.
2025-10-15 13:27:33,880 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:33,884 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 1.
2025-10-15 13:27:33,885 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:33,885 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:33,886 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:33,886 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 5, bars: 180
2025-10-15 13:27:33,887 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:33,887 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 5 ở lần thử 1.
2025-10-15 13:27:33,891 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:33,896 - APP.services.mt5_service - DEBUG - Đã lấy 180 bars cho XAUUSD 5.
2025-10-15 13:27:33,897 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:33,917 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:33,918 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:33,919 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 15, bars: 96
2025-10-15 13:27:33,920 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:33,921 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 15 ở lần thử 1.
2025-10-15 13:27:33,923 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:33,926 - APP.services.mt5_service - DEBUG - Đã lấy 96 bars cho XAUUSD 15.
2025-10-15 13:27:33,927 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:33,928 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:33,948 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:33,949 - APP.services.mt5_service - DEBUG - Bắt đầu _series_from_mt5 cho symbol: XAUUSD, tf_code: 16385, bars: 120
2025-10-15 13:27:33,950 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:33,951 - APP.services.mt5_service - DEBUG - Lấy rates thành công cho XAUUSD 16385 ở lần thử 1.
2025-10-15 13:27:33,953 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:33,956 - APP.services.mt5_service - DEBUG - Đã lấy 120 bars cho XAUUSD 16385.
2025-10-15 13:27:33,957 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:33,959 - APP.services.mt5_service - DEBUG - Kết thúc _series_from_mt5.
2025-10-15 13:27:33,959 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:33,959 - APP.services.mt5_service - DEBUG - Đã lấy OHLCV series cho các khung thời gian.
2025-10-15 13:27:33,960 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:33,981 - APP.services.mt5_service - DEBUG - Bắt đầu tính toán các mức khung thời gian lớn từ series H1.
2025-10-15 13:27:33,986 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:34,011 - APP.services.mt5_service - DEBUG - Đã lấy prev_day HL: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:34,011 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:34,012 - APP.services.mt5_service - DEBUG - Đã lấy prev_week HL: {'high': 4059.382, 'low': 3884.095}
2025-10-15 13:27:34,013 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:34,013 - APP.services.mt5_service - DEBUG - Đã tính toán xong các mức khung thời gian lớn.
2025-10-15 13:27:34,014 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:34,014 - APP.services.mt5_service - DEBUG - Đã enrich daily data: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}
2025-10-15 13:27:34,015 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:32+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:34,015 - APP.services.mt5_service - DEBUG - Bắt đầu session_ranges_today. M1 rates count: 120, reference_time: 2025-10-15 20:27:32+07:00, target_tz: Asia/Ho_Chi_Minh
2025-10-15 13:27:34,016 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:32+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:34,016 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:32+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:34,017 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:32+07:00
2025-10-15 13:27:34,017 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:32+07:00
2025-10-15 13:27:34,018 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:32+07:00 trong DST: True
2025-10-15 13:27:34,018 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:32+07:00 trong DST: True
2025-10-15 13:27:34,019 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:34,019 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:34,019 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:34,021 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:34,022 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:34,022 - APP.services.mt5_service - DEBUG - Kết thúc session_ranges_today.
2025-10-15 13:27:34,026 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:34,042 - APP.services.mt5_service - DEBUG - Bắt đầu vwap_from_rates cho 120 rates.
2025-10-15 13:27:34,043 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:34,044 - APP.services.mt5_service - DEBUG - Kết thúc vwap_from_rates. VWAP: 4189.881860960468
2025-10-15 13:27:34,048 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:34,056 - APP.services.mt5_service - DEBUG - Đã tính toán sessions, session liquidity và VWAPs: {'day': 4189.881860960468, 'asia': None, 'london': None, 'newyork_am': None, 'newyork_pm': None}
2025-10-15 13:27:34,074 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:34,075 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:34,076 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:34,076 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4190.823663871039
2025-10-15 13:27:34,076 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:34,077 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:34,077 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:34,078 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.465155552401
2025-10-15 13:27:34,078 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:34,079 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 50
2025-10-15 13:27:34,080 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:34,080 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4194.199973294621
2025-10-15 13:27:34,081 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:34,081 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 180 giá trị, period: 200
2025-10-15 13:27:34,082 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:34,082 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4185.476125993309
2025-10-15 13:27:34,083 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:34,084 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 50
2025-10-15 13:27:34,084 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:34,088 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4187.605902031883
2025-10-15 13:27:34,095 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:34,098 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 96 giá trị, period: 200
2025-10-15 13:27:34,100 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:34,103 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4150.299358804845
2025-10-15 13:27:34,104 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:34,104 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 50
2025-10-15 13:27:34,105 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:34,105 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4142.837773272453
2025-10-15 13:27:34,106 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:34,106 - APP.services.mt5_service - DEBUG - Bắt đầu ema cho 120 giá trị, period: 200
2025-10-15 13:27:34,107 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:34,107 - APP.services.mt5_service - DEBUG - Kết thúc ema. EMA: 4078.4421953580527
2025-10-15 13:27:34,107 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:34,108 - APP.services.mt5_service - DEBUG - Đã tính toán EMA: {'M1': {'ema50': 4190.823663871039, 'ema200': 4194.465155552401}, 'M5': {'ema50': 4194.199973294621, 'ema200': 4185.476125993309}, 'M15': {'ema50': 4187.605902031883, 'ema200': 4150.299358804845}, 'H1': {'ema50': 4142.837773272453, 'ema200': 4078.4421953580527}}
2025-10-15 13:27:34,108 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:34,108 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 180 rates, period: 14
2025-10-15 13:27:34,109 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:34,110 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 5.9017918373759795, TRs count: 179
2025-10-15 13:27:34,110 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:34,111 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:34,111 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:34,112 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 2.4277027084285354, TRs count: 119
2025-10-15 13:27:34,112 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:34,112 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 96 rates, period: 14
2025-10-15 13:27:34,113 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:34,114 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 10.079164679566075, TRs count: 95
2025-10-15 13:27:34,115 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:34,115 - APP.services.mt5_service - DEBUG - Bắt đầu atr_series cho 120 rates, period: 14
2025-10-15 13:27:34,116 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:34,116 - APP.services.mt5_service - DEBUG - Kết thúc atr_series. Last ATR: 18.98220715857078, TRs count: 119
2025-10-15 13:27:34,121 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:34,123 - APP.services.mt5_service - DEBUG - Đã tính toán ATR: {'M5': 5.9017918373759795, 'M1': 2.4277027084285354, 'M15': 10.079164679566075, 'H1': 18.98220715857078}
2025-10-15 13:27:34,125 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:34,138 - APP.services.mt5_service - DEBUG - Volatility regime: trending
2025-10-15 13:27:34,139 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.694, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:34,139 - APP.services.mt5_service - DEBUG - Bắt đầu _nearby_key_levels cho cp: 4192.694, daily: {'open': 4161.636, 'high': 4218.311, 'low': 4153.911, 'eq50': 4186.111, 'midnight_open': None}, prev_day: {'high': 4179.805, 'low': 4090.604}
2025-10-15 13:27:34,140 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:34,140 - APP.services.mt5_service - DEBUG - Thêm PDH: 4179.805
2025-10-15 13:27:34,141 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:34,141 - APP.services.mt5_service - DEBUG - Thêm PDL: 4090.604
2025-10-15 13:27:34,141 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:34,141 - APP.services.mt5_service - DEBUG - Thêm EQ50_D: 4186.111
2025-10-15 13:27:34,142 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:34,142 - APP.services.mt5_service - DEBUG - Thêm DO: 4161.636
2025-10-15 13:27:34,143 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12889.000000000124
2025-10-15 13:27:34,143 - APP.services.mt5_service - DEBUG - Key level: PDH, Price: 4179.805, Relation: BELOW, Distance: 12889.000000000124
2025-10-15 13:27:34,143 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102090.0000000006
2025-10-15 13:27:34,144 - APP.services.mt5_service - DEBUG - Key level: PDL, Price: 4090.604, Relation: BELOW, Distance: 102090.0000000006
2025-10-15 13:27:34,144 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 6583.000000000538
2025-10-15 13:27:34,144 - APP.services.mt5_service - DEBUG - Key level: EQ50_D, Price: 4186.111, Relation: BELOW, Distance: 6583.000000000538
2025-10-15 13:27:34,145 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31057.999999999993
2025-10-15 13:27:34,146 - APP.services.mt5_service - DEBUG - Key level: DO, Price: 4161.636, Relation: BELOW, Distance: 31057.999999999993
2025-10-15 13:27:34,147 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:34,148 - APP.services.mt5_service - DEBUG - Kết thúc _nearby_key_levels. Số key levels: 4
2025-10-15 13:27:34,148 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12889.000000000124}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102090.0000000006}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6583.000000000538}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31057.999999999993}]
2025-10-15 13:27:34,148 - APP.services.mt5_service - DEBUG - Key levels nearby: [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12889.000000000124}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102090.0000000006}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6583.000000000538}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31057.999999999993}]
2025-10-15 13:27:34,153 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:34,159 - APP.services.mt5_service - DEBUG - Bắt đầu adr_stats cho symbol: XAUUSD, n: 20
2025-10-15 13:27:34,163 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:34,169 - APP.services.mt5_service - DEBUG - Kết thúc adr_stats. Kết quả: {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:34,170 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:34,171 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:34,171 - APP.services.mt5_service - DEBUG - Prev day close: 4161.674
2025-10-15 13:27:34,171 - APP.services.mt5_service - DEBUG - Position in day range: 0.6022204968944189
2025-10-15 13:27:34,172 - APP.services.mt5_service - DEBUG - Day range: 64.39999999999964, Day range % of ADR20: 100.43699450091795
2025-10-15 13:27:34,172 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:32+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:34,173 - APP.services.mt5_service - DEBUG - Position in day range: 0.6022204968944189
2025-10-15 13:27:34,173 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:32+07:00
2025-10-15 13:27:34,173 - APP.services.mt5_service - DEBUG - Bắt đầu _killzone_ranges_vn. Date: 2025-10-15 20:27:32+07:00, Target TZ: Asia/Ho_Chi_Minh
2025-10-15 13:27:34,174 - APP.services.mt5_service - DEBUG - Bắt đầu _is_us_dst cho ngày: 2025-10-15 20:27:32+07:00
2025-10-15 13:27:34,175 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:32+07:00 trong DST: True
2025-10-15 13:27:34,176 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:34,177 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:34,177 - APP.services.mt5_service - DEBUG - Kết thúc _is_us_dst. Ngày 2025-10-15 20:27:32+07:00 trong DST: True
2025-10-15 13:27:34,178 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:34,179 - APP.services.mt5_service - DEBUG - Is US DST (summer): True
2025-10-15 13:27:34,189 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,192 - APP.services.mt5_service - DEBUG - Đã tạo killzone ranges cho mùa hè (có thể có điều chỉnh).
2025-10-15 13:27:34,195 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,197 - APP.services.mt5_service - DEBUG - Killzone active: newyork_am, Mins to next killzone: None
2025-10-15 13:27:34,198 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6900', 'price': 4192.69, 'distance_pips': 0.4}, {'level': '6925', 'price': 4192.693, 'distance_pips': 0.15}, {'level': '6950', 'price': 4192.695, 'distance_pips': 0.1}, {'level': '6975', 'price': 4192.698, 'distance_pips': 0.35}]
2025-10-15 13:27:34,199 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,199 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:34,200 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,200 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,201 - APP.services.mt5_service - DEBUG - Round levels: [{'level': '6900', 'price': 4192.69, 'distance_pips': 0.4}, {'level': '6925', 'price': 4192.693, 'distance_pips': 0.15}, {'level': '6950', 'price': 4192.695, 'distance_pips': 0.1}, {'level': '6975', 'price': 4192.698, 'distance_pips': 0.35}]
2025-10-15 13:27:34,201 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,202 - APP.services.mt5_service - DEBUG - ATR normalized spread: {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:34,202 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:34,202 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,203 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.694
2025-10-15 13:27:34,203 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,204 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:34,204 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:34,205 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:34,205 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.694
2025-10-15 13:27:34,206 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:34,207 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:34,207 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:34,209 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:34,209 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:34,210 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:34,211 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.694
2025-10-15 13:27:34,214 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe H1.
2025-10-15 13:27:34,216 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:34,217 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 96 rates, lookback: 200
2025-10-15 13:27:34,218 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:34,220 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 96 rates, current_price: 4192.694
2025-10-15 13:27:34,222 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:34,225 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:34,227 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:34,229 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 96 rates, lookback: 100
2025-10-15 13:27:34,230 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:34,232 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:34,233 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.694
2025-10-15 13:27:34,233 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M15.
2025-10-15 13:27:34,234 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:34,235 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 180 rates, lookback: 200
2025-10-15 13:27:34,236 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:34,236 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 180 rates, current_price: 4192.694
2025-10-15 13:27:34,245 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:34,294 - APP.ui.app_ui - INFO - Bắt đầu quy trình tắt ứng dụng an toàn.
2025-10-15 13:27:34,298 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:34,299 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:34,320 - APP.ui.app_ui - INFO - Yêu cầu hủy session phân tích manual-20251015-132706 trong quá trình shutdown.
2025-10-15 13:27:34,388 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 180 rates, lookback: 100
2025-10-15 13:27:34,393 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:34,402 - APP.utils.threading_utils - INFO - Cancel group 'analysis.session' → task 'analysis.session.manual-20251015-132706'
2025-10-15 13:27:34,403 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:34,425 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.694
2025-10-15 13:27:34,428 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:34,459 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:34,536 - APP.core.analysis_controller - INFO - Đã gửi tín hiệu hủy cho session manual-20251015-132706
2025-10-15 13:27:34,545 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M5.
2025-10-15 13:27:34,546 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:34,547 - APP.ui.controllers.chart_controller - INFO - Dừng ChartController stream hiện tại.
2025-10-15 13:27:34,547 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_liquidity_levels với 120 rates, lookback: 200
2025-10-15 13:27:34,548 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:34,548 - APP.utils.threading_utils - INFO - Cancel group 'chart.refresh' → task 'chart.info'
2025-10-15 13:27:34,550 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_fvgs với 120 rates, current_price: 4192.694
2025-10-15 13:27:34,550 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,551 - APP.utils.threading_utils - INFO - Cancel group 'chart.refresh' → task 'chart.draw'
2025-10-15 13:27:34,552 - APP.analysis.ict_analyzer - DEBUG - Kết thúc find_fvgs. Tìm thấy 2 FVG.
2025-10-15 13:27:34,553 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,553 - APP.ui.components.chart_tab - INFO - ChartTab đã dừng stream dữ liệu.
2025-10-15 13:27:34,554 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_order_blocks với 120 rates, lookback: 100
2025-10-15 13:27:34,554 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:34,556 - APP.analysis.ict_analyzer - DEBUG - Bắt đầu find_market_structure_shift với 5 highs, 5 lows.
2025-10-15 13:27:34,558 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:34,559 - APP.services.mt5_service - DEBUG - Đã hoàn thành phân tích ICT cho timeframe M1.
2025-10-15 13:27:34,560 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:34,562 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,562 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:34,563 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,596 - APP.ui.app_ui - DEBUG - Bắt đầu thu thập dữ liệu cấu hình từ UI.
2025-10-15 13:27:34,605 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:34,608 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:34,609 - APP.configs.workspace_config - DEBUG - Bắt đầu lưu cấu hình vào file.
2025-10-15 13:27:34,610 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:34,621 - APP.utils.general_utils - DEBUG - Bắt đầu obfuscate text với salt.
2025-10-15 13:27:34,637 - APP.utils.general_utils - DEBUG - Tạo machine key.
2025-10-15 13:27:34,638 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:34,644 - APP.utils.general_utils - DEBUG - Đã tạo machine key. Độ dài: 32 bytes.
2025-10-15 13:27:34,647 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:34,669 - APP.utils.general_utils - DEBUG - Thực hiện XOR bytes.
2025-10-15 13:27:34,670 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:34,670 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:34,670 - APP.utils.general_utils - DEBUG - Đã obfuscate text thành công.
2025-10-15 13:27:34,671 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:34,671 - APP.configs.workspace_config - DEBUG - Đã mã hóa thành công trường 'api_key' trong nhóm 'fmp'.
2025-10-15 13:27:34,672 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:34,672 - APP.utils.general_utils - DEBUG - Bắt đầu obfuscate text với salt.
2025-10-15 13:27:34,673 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:34,673 - APP.utils.general_utils - DEBUG - Tạo machine key.
2025-10-15 13:27:34,674 - APP.utils.general_utils - DEBUG - Đã tạo machine key. Độ dài: 32 bytes.
2025-10-15 13:27:34,674 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:34,675 - APP.utils.general_utils - DEBUG - Thực hiện XOR bytes.
2025-10-15 13:27:34,675 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:34,677 - APP.utils.general_utils - DEBUG - Đã obfuscate text thành công.
2025-10-15 13:27:34,679 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:34,700 - APP.configs.workspace_config - DEBUG - Đã mã hóa thành công trường 'api_key' trong nhóm 'te'.
2025-10-15 13:27:34,701 - APP.services.mt5_service - DEBUG - Bắt đầu value_per_point cho symbol: XAUUSD
2025-10-15 13:27:34,701 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:34,702 - APP.utils.general_utils - DEBUG - Bắt đầu obfuscate text với salt.
2025-10-15 13:27:34,702 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:34,703 - APP.utils.general_utils - DEBUG - Tạo machine key.
2025-10-15 13:27:34,703 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:34,703 - APP.utils.general_utils - DEBUG - Đã tạo machine key. Độ dài: 32 bytes.
2025-10-15 13:27:34,704 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:34,704 - APP.utils.general_utils - DEBUG - Thực hiện XOR bytes.
2025-10-15 13:27:34,705 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:34,705 - APP.utils.general_utils - DEBUG - Đã obfuscate text thành công.
2025-10-15 13:27:34,706 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:34,706 - APP.configs.workspace_config - DEBUG - Đã mã hóa thành công trường 'token' trong nhóm 'telegram'.
2025-10-15 13:27:34,730 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:34,732 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,732 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:34,732 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,733 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'point' trong object. Giá trị: 0.001
2025-10-15 13:27:34,733 - APP.configs.workspace_config - INFO - Cấu hình đã được lưu thành công vào C:\Users\leanhchi\.gemini_folder_analyze\workspace.json
2025-10-15 13:27:34,733 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:34,734 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_value, default: 0.0
2025-10-15 13:27:34,734 - APP.configs.workspace_config - DEBUG - Kết thúc lưu cấu hình vào file.
2025-10-15 13:27:34,735 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:34,735 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_value' trong object. Giá trị: 0.1
2025-10-15 13:27:34,736 - APP.ui.app_ui - INFO - Đã lưu cấu hình workspace thành công.
2025-10-15 13:27:34,736 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:34,737 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: trade_tick_size, default: 0.0
2025-10-15 13:27:34,737 - APP.services.mt5_service - INFO - Đang ngắt kết nối khỏi MetaTrader 5.
2025-10-15 13:27:34,738 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:34,739 - APP.services.mt5_service - DEBUG - Tìm thấy attribute 'trade_tick_size' trong object. Giá trị: 0.001
2025-10-15 13:27:34,761 - APP.services.mt5_service - DEBUG - Tính value_per_point từ tick_value/tick_size: 0.1
2025-10-15 13:27:34,762 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:34,763 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,765 - APP.services.mt5_service - INFO - Đã ngắt kết nối MT5 thành công.
2025-10-15 13:27:34,766 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,766 - APP.utils.safe_data - DEBUG - Kiểm tra is_valid: True
2025-10-15 13:27:34,767 - APP.ui.app_ui - INFO - UI queue backlog khi shutdown: 0
2025-10-15 13:27:34,768 - APP.services.mt5_service - DEBUG - Đã xây dựng payload MT5_DATA.
2025-10-15 13:27:34,768 - APP.utils.threading_utils - DEBUG - Task song song 'get_upcoming_events' hoàn tất thành công.
2025-10-15 13:27:34,768 - APP.services.mt5_service - DEBUG - Bắt đầu lấy lịch sử deals cho XAUUSD trong 7 ngày qua.
2025-10-15 13:27:34,768 - APP.utils.safe_data - DEBUG - Get top-level key 'info': {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,796 - APP.utils.safe_data - DEBUG - Khởi tạo SafeData với data có: True
2025-10-15 13:27:34,797 - APP.services.mt5_service - WARNING - MT5 chưa kết nối, không thể lấy lịch sử deals.
2025-10-15 13:27:34,798 - APP.utils.safe_data - DEBUG - Get top-level key 'tick': {'bid': 4192.694, 'ask': 4192.731, 'last': 0.0, 'time': 1760534852}
2025-10-15 13:27:34,798 - APP.services.mt5_service - DEBUG - Đã tạo SafeData object.
2025-10-15 13:27:34,799 - APP.utils.threading_utils - DEBUG - Task song song 'get_history_deals' hoàn tất thành công.
2025-10-15 13:27:34,799 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: spread_current, default: None
2025-10-15 13:27:34,799 - APP.services.mt5_service - DEBUG - Kết thúc build_context.
2025-10-15 13:27:34,800 - APP.services.mt5_service - DEBUG - Tìm thấy key 'spread_current' trong dict. Giá trị: 37
2025-10-15 13:27:34,821 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,823 - APP.utils.threading_utils - INFO - Task 'chart.draw' (group=chart.refresh) bị hủy sau 2.28s
2025-10-15 13:27:34,824 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,824 - APP.ui.controllers.chart_controller - DEBUG - Future chart.draw bị cancel, không cập nhật UI.
2025-10-15 13:27:34,824 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_5m': {'ticks_per_min': 426, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:34,825 - APP.utils.safe_data - DEBUG - Get top-level key 'tick_stats_30m': {'ticks_per_min': 487, 'median_spread': 37.0, 'p90_spread': 37}
2025-10-15 13:27:34,826 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,826 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,827 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,827 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,828 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,828 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,829 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,829 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,830 - APP.utils.safe_data - DEBUG - Get top-level key 'atr_norm': {'spread_as_pct_of_atr_m5': 0.626928245165}
2025-10-15 13:27:34,830 - APP.utils.safe_data - DEBUG - Get top-level key 'adr': {'d5': 87.56900000000005, 'd10': 73.56690000000008, 'd20': 64.11980000000005}
2025-10-15 13:27:34,830 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:34,831 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:34,831 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,832 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,833 - APP.services.mt5_service - DEBUG - Bắt đầu info_get cho key: point, default: 0.0
2025-10-15 13:27:34,835 - APP.services.mt5_service - DEBUG - Tìm thấy key 'point' trong dict. Giá trị: 0.001
2025-10-15 13:27:34,848 - APP.services.mt5_service - DEBUG - Bắt đầu points_per_pip_from_info cho info: {'digits': 3, 'point': 0.001, 'contract_size': 100.0, 'spread_current': 37, 'swap_long': -462.1, 'swap_short': 0.0}
2025-10-15 13:27:34,854 - APP.services.mt5_service - DEBUG - Kết thúc points_per_pip_from_info. Digits: 3, PPP: 10
2025-10-15 13:27:34,857 - APP.utils.safe_data - DEBUG - Get top-level key 'key_levels_nearby': [{'name': 'PDH', 'price': 4179.805, 'relation': 'BELOW', 'distance_pips': 12889.000000000124}, {'name': 'PDL', 'price': 4090.604, 'relation': 'BELOW', 'distance_pips': 102090.0000000006}, {'name': 'EQ50_D', 'price': 4186.111, 'relation': 'BELOW', 'distance_pips': 6583.000000000538}, {'name': 'DO', 'price': 4161.636, 'relation': 'BELOW', 'distance_pips': 31057.999999999993}]
2025-10-15 13:27:34,857 - APP.utils.safe_data - DEBUG - Get top-level key 'broker_time': 2025-10-15T20:27:32+07:00
2025-10-15 13:27:34,858 - APP.core.trading.conditions - DEBUG - Bắt đầu kiểm tra các điều kiện NO-TRADE.
2025-10-15 13:27:34,859 - APP.utils.safe_data - DEBUG - Get top-level key 'killzone_active': newyork_am
2025-10-15 13:27:34,860 - APP.utils.threading_utils - DEBUG - Task song song 'check_no_trade_conditions' hoàn tất thành công.
2025-10-15 13:27:34,861 - APP.utils.threading_utils - INFO - Task 'chart.info' (group=chart.refresh) bị hủy sau 2.32s
2025-10-15 13:27:34,862 - APP.ui.controllers.chart_controller - DEBUG - Future chart.info bị cancel, không cập nhật UI.
2025-10-15 13:27:44,799 - APP.utils.threading_utils - WARNING - await_idle hết thời gian cho group=analysis.session
2025-10-15 13:27:44,803 - APP.utils.threading_utils - INFO - ThreadingManager.shutdown(wait=True, timeout=5.0, force=False)
2025-10-15 13:27:49,497 - APP.services.gemini_service - INFO - Lần thử 1: Kết nối stream tới Gemini API thành công.
2025-10-15 13:27:49,768 - APP.core.analysis_worker - INFO - Worker đã thoát một cách có kiểm soát: Dừng bởi người dùng trong khi streaming.
2025-10-15 13:27:49,769 - APP.core.analysis_worker - DEBUG - GIAI ĐOẠN 6: Hoàn tất và dọn dẹp.
2025-10-15 13:27:49,770 - APP.persistence.json_handler - DEBUG - JsonSaver được khởi tạo cho workspace: C:/Users/leanhchi/AppData/Roaming/MetaQuotes/Terminal/D0E8209F77C8CF37AD8BF550E51FF075/MQL5/Files/Screenshots
2025-10-15 13:27:49,773 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu tạo map timeframe với 4 tên file.
2025-10-15 13:27:49,774 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_H1.png
2025-10-15 13:27:49,775 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'H1' cho 'XAUUSD_H1.png' bằng pattern đã biên dịch.
2025-10-15 13:27:49,777 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M1.png
2025-10-15 13:27:49,777 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M1' cho 'XAUUSD_M1.png' bằng pattern đã biên dịch.
2025-10-15 13:27:49,777 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M15.png
2025-10-15 13:27:49,778 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M15' cho 'XAUUSD_M15.png' bằng pattern đã biên dịch.
2025-10-15 13:27:49,778 - APP.ui.utils.timeframe_detector - DEBUG - Bắt đầu phát hiện timeframe cho tên file: XAUUSD_M5.png
2025-10-15 13:27:49,779 - APP.ui.utils.timeframe_detector - DEBUG - Đã phát hiện timeframe 'M5' cho 'XAUUSD_M5.png' bằng pattern đã biên dịch.
2025-10-15 13:27:49,779 - APP.ui.utils.timeframe_detector - DEBUG - Kết thúc tạo map timeframe. Map: {'XAUUSD_H1.png': 'H1', 'XAUUSD_M1.png': 'M1', 'XAUUSD_M15.png': 'M15', 'XAUUSD_M5.png': 'M5'}
2025-10-15 13:27:49,781 - APP.persistence.md_handler - DEBUG - Bắt đầu lưu báo cáo Markdown.
2025-10-15 13:27:49,783 - APP.persistence.md_handler - DEBUG - Đường dẫn file báo cáo Markdown: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots\XAUUSD\Reports\report_20251015_132749.md
2025-10-15 13:27:49,783 - APP.persistence.json_handler - DEBUG - Bắt đầu quá trình lưu báo cáo JSON.
2025-10-15 13:27:49,784 - APP.persistence.md_handler - DEBUG - Bắt đầu trích xuất báo cáo human-readable.
2025-10-15 13:27:49,784 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất khối JSON ưu tiên.
2025-10-15 13:27:49,785 - APP.persistence.md_handler - WARNING - Không tìm thấy điểm bắt đầu báo cáo hợp lệ, trả về toàn bộ nội dung.
2025-10-15 13:27:49,786 - APP.analysis.report_parser - WARNING - Không tìm thấy khối JSON hợp lệ nào trong văn bản.
2025-10-15 13:27:49,787 - APP.persistence.json_handler - DEBUG - Đã thêm 1 khối JSON vào data_to_save.
2025-10-15 13:27:49,787 - APP.persistence.md_handler - INFO - Đã lưu báo cáo Markdown thành công tại: report_20251015_132749.md
2025-10-15 13:27:49,788 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất tóm tắt và chữ ký.
2025-10-15 13:27:49,788 - APP.utils.general_utils - DEBUG - Bắt đầu cleanup_old_files trong thư mục: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots\XAUUSD\Reports, pattern: *.md, giữ lại: 10 file.
2025-10-15 13:27:49,789 - APP.analysis.report_parser - DEBUG - Hoàn tất trích xuất. High Prob: False
2025-10-15 13:27:49,790 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất cài đặt giao dịch từ báo cáo.
2025-10-15 13:27:49,792 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất khối JSON ưu tiên.
2025-10-15 13:27:49,792 - APP.utils.general_utils - DEBUG - Đã xóa file cũ: report_20251015_075215.md
2025-10-15 13:27:49,792 - APP.analysis.report_parser - WARNING - Không tìm thấy khối JSON hợp lệ nào trong văn bản.
2025-10-15 13:27:49,793 - APP.utils.general_utils - DEBUG - Kết thúc cleanup_old_files.
2025-10-15 13:27:49,793 - APP.analysis.report_parser - DEBUG - Không tìm thấy JSON hợp lệ, đang sử dụng regex để phân tích.
2025-10-15 13:27:49,793 - APP.persistence.md_handler - DEBUG - Kết thúc việc lưu báo cáo Markdown.
2025-10-15 13:27:49,794 - APP.analysis.report_parser - DEBUG - Đang xác định hướng từ dòng: ''
2025-10-15 13:27:49,795 - APP.utils.threading_utils - DEBUG - Task song song 'save_report' hoàn tất thành công.
2025-10-15 13:27:49,796 - APP.analysis.report_parser - DEBUG - Không tìm thấy hướng giao dịch trong dòng.
2025-10-15 13:27:49,798 - APP.analysis.report_parser - DEBUG - Hoàn tất phân tích bằng regex. Cài đặt: {'direction': None}
2025-10-15 13:27:49,798 - APP.persistence.json_handler - DEBUG - Đã parse và lưu plan: {'direction': None}
2025-10-15 13:27:49,799 - APP.persistence.json_handler - INFO - Đã lưu file JSON báo cáo thành công tại: ctx_20251015_132749.json
2025-10-15 13:27:49,800 - APP.utils.general_utils - DEBUG - Bắt đầu cleanup_old_files trong thư mục: C:\Users\leanhchi\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Files\Screenshots\XAUUSD\Reports, pattern: ctx_*.json, giữ lại: 10 file.
2025-10-15 13:27:49,805 - APP.utils.general_utils - DEBUG - Đã xóa file cũ: ctx_20251015_075215.json
2025-10-15 13:27:49,826 - APP.utils.threading_utils - WARNING - await_idle hết thời gian cho group=<all>
2025-10-15 13:27:49,828 - APP.utils.general_utils - DEBUG - Kết thúc cleanup_old_files.
2025-10-15 13:27:49,836 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất cài đặt giao dịch từ báo cáo.
2025-10-15 13:27:49,836 - APP.analysis.report_parser - DEBUG - Bắt đầu trích xuất khối JSON ưu tiên.
2025-10-15 13:27:49,837 - APP.analysis.report_parser - WARNING - Không tìm thấy khối JSON hợp lệ nào trong văn bản.
2025-10-15 13:27:49,838 - APP.analysis.report_parser - DEBUG - Không tìm thấy JSON hợp lệ, đang sử dụng regex để phân tích.
2025-10-15 13:27:49,838 - APP.analysis.report_parser - DEBUG - Đang xác định hướng từ dòng: ''
2025-10-15 13:27:49,877 - APP.analysis.report_parser - DEBUG - Không tìm thấy hướng giao dịch trong dòng.
2025-10-15 13:27:49,895 - APP.analysis.report_parser - DEBUG - Hoàn tất phân tích bằng regex. Cài đặt: {'direction': None}
2025-10-15 13:27:49,922 - APP.persistence.json_handler - DEBUG - Kết thúc quá trình lưu báo cáo JSON.
2025-10-15 13:27:49,924 - APP.utils.threading_utils - DEBUG - Task song song 'save_report' hoàn tất thành công.
2025-10-15 13:27:49,925 - APP.core.analysis_worker - INFO - Đã lưu báo cáo MD và JSON song song.
2025-10-15 13:27:49,987 - APP.core.analysis_worker - DEBUG - Kết thúc AnalysisWorker.run.
2025-10-15 13:27:50,017 - APP.utils.threading_utils - DEBUG - Task 'analysis.session.manual-20251015-132706' (group=analysis.session) hoàn tất sau 43.97s
2025-10-15 13:27:50,317 - APP.ui.app_ui - INFO - Ứng dụng đã đóng thành công.
2025-10-15 13:27:50,320 - __main__ - INFO - Ứng dụng đã đóng thành công.
